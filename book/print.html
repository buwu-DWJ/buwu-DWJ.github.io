<!DOCTYPE HTML>
<html lang="chs" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>dwj_mdbook</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="pre.html">å‰è¨€</a></li><li class="chapter-item expanded affix "><li class="part-title">Summary</li><li class="chapter-item expanded "><a href="markdown.html"><strong aria-hidden="true">1.</strong> markdown</a></li><li class="chapter-item expanded "><a href="python.html"><strong aria-hidden="true">2.</strong> python</a></li><li class="chapter-item expanded "><a href="ml/ml.html"><strong aria-hidden="true">3.</strong> æœºå™¨å­¦ä¹ </a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> DRL</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="DRL/RL.html"><strong aria-hidden="true">4.1.</strong> RL</a></li><li class="chapter-item expanded "><a href="DRL/DRL.html"><strong aria-hidden="true">4.2.</strong> DRL</a></li><li class="chapter-item expanded "><a href="DRL/fin.html"><strong aria-hidden="true">4.3.</strong> FIN</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">dwj_mdbook</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="the-owl-of-minerva-spreads-its-wings-only-with-the-falling-of-the-dusk"><a class="header" href="#the-owl-of-minerva-spreads-its-wings-only-with-the-falling-of-the-dusk">The owl of Minerva spreads its wings only with the falling of the dusk</a></h2>
<p><img src="pic/buwu.jpg" alt="1" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="markdownä¸å…¶æ”¯æŒçš„çš„latex"><a class="header" href="#markdownä¸å…¶æ”¯æŒçš„çš„latex">Markdownä¸å…¶æ”¯æŒçš„çš„LaTeX</a></h1>
<h1 id="markdown"><a class="header" href="#markdown">Markdown</a></h1>
<ul>
<li>åœ†ç‚¹çªå‡ºï¼š- +æ–‡å­—</li>
<li>åºå·åˆ—è¡¨ï¼šæ•°å­—+.</li>
<li>é“¾æ¥ï¼š[æ–‡æœ¬](é“¾æ¥)</li>
<li>å›¾ç‰‡ï¼š![æ–‡æœ¬](é“¾æ¥/æœ¬åœ°)</li>
<li>æ–œä½“ï¼š*æ–‡å­—*</li>
<li>åŠ ç²—ï¼š**æ–‡å­—**</li>
<li>ç²—æ–œä½“ï¼š***æ–‡å­—***</li>
<li>åˆ†å‰²çº¿ï¼š*********æˆ–è€…----------</li>
</ul>
<blockquote>
<p>é‡‡ç”¨&gt;+æ–‡å­—</p>
</blockquote>
<p>å‡ ä¸ª#å°±ä»£è¡¨å‡ çº§æ ‡é¢˜</p>
<p><code>åå¼•å·</code></p>
<pre><code class="language-python">import numpy as np  
åˆ©ç”¨ä¸‰ä¸ªåå¼•å·ï¼Œåé¢åŠ ä¸Šä»£ç ä½¿ç”¨çš„è¯­è¨€ï¼Œå¦‚pythonå¯å®ç°é«˜äº®
</code></pre>
<h4 id="è¡¨æ ¼"><a class="header" href="#è¡¨æ ¼">è¡¨æ ¼</a></h4>
<pre><code class="language-markdown">|  è¡¨å¤´   | è¡¨å¤´  |
|  ----  | ----  |
| å•å…ƒæ ¼  | å•å…ƒæ ¼ |
| å•å…ƒæ ¼  | å•å…ƒæ ¼ |  
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>è¡¨å¤´</th><th>è¡¨å¤´</th></tr></thead><tbody>
<tr><td>å•å…ƒæ ¼</td><td>å•å…ƒæ ¼</td></tr>
<tr><td>å•å…ƒæ ¼</td><td>å•å…ƒæ ¼</td></tr>
</tbody></table>
</div>
<p>è¿˜å¯è®¾ç½®è¡¨æ ¼çš„å¯¹é½æ–¹å¼</p>
<ul>
<li>:- å®ç°å·¦å¯¹é½</li>
<li>-: å®ç°å³å¯¹é½</li>
<li>:-: å®ç°å±…ä¸­</li>
</ul>
<pre><code class="language-markdown">| å·¦å¯¹é½ | å³å¯¹é½ | å±…ä¸­å¯¹é½ |
| :-----| ----: | :----: |
| 1 | 1 | 1 |
</code></pre>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">å·¦å¯¹é½</th><th style="text-align: right">å³å¯¹é½</th><th style="text-align: center">å±…ä¸­å¯¹é½</th></tr></thead><tbody>
<tr><td style="text-align: left">1</td><td style="text-align: right">1</td><td style="text-align: center">1</td></tr>
</tbody></table>
</div>
<h1 id="markdownä¸­çš„latex"><a class="header" href="#markdownä¸­çš„latex">markdownä¸­çš„LaTeX</a></h1>
<p>æ”¯æŒçš„å†™æ³•è¯¦æƒ…è§<a href="https://katex.org/docs/supported.html">katexå®˜æ–¹æ–‡æ¡£</a></p>
<h4 id="å¤šè¡Œå…¬å¼"><a class="header" href="#å¤šè¡Œå…¬å¼">å¤šè¡Œå…¬å¼</a></h4>
<p>ä¸ºå…¬å¼åŠ ç¼–å·ï¼š\tag{number}<br />
$$
f(x) = x+1\tag{1}
$$
åœ¨VSCODEä¸­å¿…é¡»ä½¿ç”¨<code>aligned</code>ç¯å¢ƒï¼Œå¦‚ï¼š<br />
$$
\begin{aligned}
a&amp;=1\
&amp;=2
\end{aligned}
$$</p>
<pre><code class="language-markdown">$$
\begin{aligned}
a&amp;=1\\
&amp;=2
\end{aligned}
$$
</code></pre>
<h4 id="åˆ†æ®µå‡½æ•°"><a class="header" href="#åˆ†æ®µå‡½æ•°">åˆ†æ®µå‡½æ•°</a></h4>
<p>ä½¿ç”¨<code>cases</code>ç¯å¢ƒ</p>
<pre><code class="language-LaTeX">$$
f(x) = 
\begin{cases}
a, a&lt;1,\\
b, a\geq1.
\end{cases}
$$
æ•ˆæœå¦‚ä¸‹
</code></pre>
<p>$$
f(x) = 
\begin{cases}
a&amp;, a&lt;1,\
b&amp;, a\geq1.
\end{cases}
$$</p>
<p>æ–‡å†…é“¾æ¥</p>
<pre><code class="language-markdown">[èƒ½å¤Ÿç‚¹å‡»çš„é“¾æ¥](#name)
&lt;div id=&quot;name&quot;&gt;&lt;/div&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pythonåŸºç¡€"><a class="header" href="#pythonåŸºç¡€">pythonåŸºç¡€</a></h1>
<p>å¯¼å…¥æœ¬åœ°è„šæœ¬å‡½æ•°</p>
<pre><code class="language-python">from ..helpers import p4f
</code></pre>
<p>å‡½æ•°ä»¥åŠç±»æ³¨é‡Š</p>
<pre><code class="language-python">#å‡½æ•°
def fetch_bigtable_rows(big_table, keys, other_silly_variable=None):
    &quot;&quot;&quot;Fetches rows from a Bigtable.

    Retrieves rows pertaining to the given keys from the Table instance
    represented by big_table.  Silly things may happen if
    other_silly_variable is not None.

    Args:
        big_table: An open Bigtable Table instance.
        keys: A sequence of strings representing the key of each table row
            to fetch.
        other_silly_variable: Another optional variable, that has a much
            longer name than the other args, and which does nothing.

    Returns:
        A dict mapping keys to the corresponding table row data
        fetched. Each row is represented as a tuple of strings. For
        example:

        {'Serak': ('Rigel VII', 'Preparer'),
         'Zim': ('Irk', 'Invader'),
         'Lrrr': ('Omicron Persei 8', 'Emperor')}

        If a key from the keys argument is missing from the dictionary,
        then that row was not found in the table.

    Raises:
        IOError: An error occurred accessing the bigtable.Table object.
    &quot;&quot;&quot;
    pass

#ç±»

class SampleClass(object):
    &quot;&quot;&quot;Summary of class here.

    Longer class information....
    Longer class information....

    Attributes:
        likes_spam: A boolean indicating if we like SPAM or not.
        eggs: An integer count of the eggs we have laid.
    &quot;&quot;&quot;

    def __init__(self, likes_spam=False):
        &quot;&quot;&quot;Inits SampleClass with blah.&quot;&quot;&quot;
        self.likes_spam = likes_spam
        self.eggs = 0

    def public_method(self):
        &quot;&quot;&quot;Performs operation blah.&quot;&quot;&quot;
</code></pre>
<h2 id="ä¸€-numpy"><a class="header" href="#ä¸€-numpy">ä¸€ï¼ numpy</a></h2>
<p><code>import numpy as np</code></p>
<h3 id="åŸºç¡€"><a class="header" href="#åŸºç¡€">åŸºç¡€</a></h3>
<ul>
<li>æ•°ç»„ï¼šnp.array([[1,2,3],[4,5,6],...])</li>
<li>åºåˆ—ï¼šnp.arange(a,b,c)  åˆå€¼aï¼Œç»ˆå€¼bï¼Œæ­¥é•¿cï¼Œä¸å«ç»ˆå€¼</li>
<li>åºåˆ—ï¼šnp.linspace(a,b,c)    åˆå€¼aï¼Œç»ˆå€¼bï¼Œä¸ªæ•°cï¼Œå«ç»ˆå€¼</li>
<li>ç©ºæ•°ç»„ï¼šnp.empty((a,b),np.int) shape&amp;type</li>
<li>é›¶æ•°ç»„ï¼šnp.zeros((a,b),np.int)</li>
<li>å•ä½é˜µï¼šnp.eye(N,M=None,k=0) è¡Œæ•°Nï¼Œåˆ—æ•°Mï¼Œkä¸ºå¯¹è§’çº¿ä¸Šç§»(æ­£)æˆ–ä¸‹ç§»(è´Ÿ)</li>
<li>å…¨1é˜µï¼šnp.ones((a,b),np.int)</li>
<li>è½¬ç½®ä¸å†…ç§¯ï¼šnp.dot(A.T,A)</li>
</ul>
<h3 id="åˆ‡ç‰‡ä¸ç´¢å¼•"><a class="header" href="#åˆ‡ç‰‡ä¸ç´¢å¼•">åˆ‡ç‰‡ä¸ç´¢å¼•</a></h3>
<p>åˆ‡ç‰‡æ˜¯è§†å›¾è€Œéå‰¯æœ¬ï¼Œè‹¥è¦å‰¯æœ¬ï¼š<code>arr[5:8].copy()</code><br />
å¸ƒå°”å‹ç´¢å¼•ï¼šdata[data&lt;0]=0, ~å¯ç”¨æ¥åè½¬æ¡ä»¶</p>
<h3 id="é€šç”¨å‡½æ•°func"><a class="header" href="#é€šç”¨å‡½æ•°func">é€šç”¨å‡½æ•°func</a></h3>
<h4 id="ä¸€å…ƒå‡½æ•°np-f-arr"><a class="header" href="#ä¸€å…ƒå‡½æ•°np-f-arr">ä¸€å…ƒå‡½æ•°ï¼šnp. <em>f</em> (arr)</a></h4>
<ul>
<li>abs,fabs,sqrtå¼€æ ¹,squareå¹³æ–¹</li>
<li>exp,log,log10,log2</li>
<li>sign,ceilå‘ä¸Šå–æ•´,floorå‘ä¸‹å–æ•´,rintå››èˆäº”å…¥,modfæ‹†æˆæ•´æ•°å’Œå°æ•°</li>
<li>isnan,isfinite,isinf</li>
<li>cos,sin,cosh,sinh,tan,tanh</li>
</ul>
<h4 id="äºŒå…ƒå‡½æ•°np-f-arr"><a class="header" href="#äºŒå…ƒå‡½æ•°np-f-arr">äºŒå…ƒå‡½æ•°ï¼šnp. <em>f</em> (arr)</a></h4>
<ul>
<li>add,substract,multiply,divide,floor_divide é™¤åå–æ•´</li>
<li>power,maximum,fmax,mod</li>
<li>copysign å¾—åˆ°ç¬¬äºŒä¸ªæ•°ç»„çš„ç¬¦å·</li>
<li>greater,greater_equal,less,less_equal,equal,not_equalè¿”å›å¸ƒå°”å€¼</li>
<li>meshgrid æ¥å—ä¸¤ä¸ªä¸€ç»´æ•°ç»„ï¼Œäº§ç”Ÿä¸¤ä¸ªäºŒç»´æ•°ç»„ï¼Œå¯¹åº”æ‰€æœ‰(x,y)å¯¹</li>
</ul>
<p>np.where()æ˜¯ x if condition else yçš„çŸ¢é‡åŒ–ç‰ˆæœ¬<br />
np.where(arr&gt;2,2,-2)<br />
np.where(arr&gt;2,2,arr)</p>
<h3 id="æ•°ç»„ç»Ÿè®¡æ–¹æ³•"><a class="header" href="#æ•°ç»„ç»Ÿè®¡æ–¹æ³•">æ•°ç»„ç»Ÿè®¡æ–¹æ³•</a></h3>
<ul>
<li>sum,mean,std,var,min,max</li>
<li>argmax,argmin ç´¢å¼•,cumsum,cumprod</li>
<li>æŸ¥è¯¢æ•°ç»„ä¸­æ˜¯å¦æœ‰true:all,any(ç¤ºä¾‹:<code>(a=b).all()</code>)</li>
</ul>
<h3 id="æ’åº"><a class="header" href="#æ’åº">æ’åº</a></h3>
<p>sort</p>
<h3 id="é›†åˆè¿ç®—æ•°å­—1"><a class="header" href="#é›†åˆè¿ç®—æ•°å­—1">é›†åˆè¿ç®—,æ•°å­—1</a></h3>
<ul>
<li>unique(x)</li>
<li>intersect1d(x,y) äº¤é›†</li>
<li>union1d(x,y) å¹¶é›†</li>
<li>in1d(x,y) åŒ…å«äº</li>
<li>setdiff1d(x,y) å·®é›†</li>
<li>setxor1d(x,y) å¯¹ç§°å·®</li>
</ul>
<h3 id="å¸¸ç”¨numpylinalgå‡½æ•°npl"><a class="header" href="#å¸¸ç”¨numpylinalgå‡½æ•°npl">å¸¸ç”¨numpy.linalgå‡½æ•°(npl)</a></h3>
<ul>
<li>diag å¯¹è§’é˜µå’Œä¸€ç»´æ•°ç»„è½¬åŒ–</li>
<li>dot,trace,det</li>
<li>eig ç‰¹å¾å€¼ç‰¹å¾å‘é‡</li>
<li>inv é€†</li>
<li>pinv Moore-Penrose ä¼ªé€†</li>
<li>qr QRåˆ†è§£</li>
<li>svd å¥‡å¼‚å€¼åˆ†è§£</li>
<li>solve è§£Ax=b ,Aæ–¹é’ˆ</li>
<li>lstsq Ax=bæœ€å°äºŒä¹˜è§£</li>
</ul>
<h3 id="éƒ¨åˆ†numpyrandomå‡½æ•°"><a class="header" href="#éƒ¨åˆ†numpyrandomå‡½æ•°">éƒ¨åˆ†numpy.randomå‡½æ•°</a></h3>
<ul>
<li>seed ç¡®å®šéšæœºæ•°ç”Ÿæˆå™¨ç§å­</li>
<li>permutation è¿”å›æ–°çš„æ‰“ä¹±çš„x,xä¸å˜</li>
<li>shuffle åŸåœ°æ‰“ä¹±x</li>
<li>rand å‡åŒ€åˆ†å¸ƒ</li>
<li>randint ç»™å®šèŒƒå›´å†…éšæœºå–æ•´æ•°</li>
<li>randn æ ‡å‡†æ­£æ€åˆ†å¸ƒ</li>
<li>binomial äºŒé¡¹åˆ†å¸ƒ</li>
<li>normal æ­£æ€åˆ†å¸ƒ</li>
<li>beta,gamma</li>
<li>chisquare å¡æ–¹åˆ†å¸ƒ</li>
<li>uniform [0,1)å‡åŒ€åˆ†å¸ƒ</li>
</ul>
<h3 id="æ•°ç»„åˆå¹¶ä¸æ‹¼æ¥"><a class="header" href="#æ•°ç»„åˆå¹¶ä¸æ‹¼æ¥">æ•°ç»„åˆå¹¶ä¸æ‹¼æ¥</a></h3>
<ul>
<li>append(arr,values,axis=None)</li>
</ul>
<h2 id="äºŒ-pytorch"><a class="header" href="#äºŒ-pytorch">äºŒï¼ pytorch</a></h2>
<p>åˆ›å»ºç½‘ç»œçš„ä¸€ç§å¿«æ·æ–¹æ³•ï¼šSequential</p>
<pre><code class="language-python">net = torch.nn.Sequential(
        torch.nn.Linear(STATE_SIZE, HIDDEN_SIZE),
        torch.nn.ReLU(),
        torch.nn.Linear(HIDDEN_SIZE, ACTION_SIZE),
        )
</code></pre>
<h3 id="21-æ„é€ å¼ é‡çš„å‡½æ•°"><a class="header" href="#21-æ„é€ å¼ é‡çš„å‡½æ•°">2.1 æ„é€ å¼ é‡çš„å‡½æ•°</a></h3>
<p>torch.tensor()<br />
torch.zeros(), torch.zeros_like()<br />
torch.ones(), torch.ones_like()<br />
torch.full(), torch.full_like() å…¨å¡«å……ä¸ºæŒ‡å®šå€¼<br />
torch.empty(), torch.empty_like()<br />
torch.eye()<br />
torch.arange(), torch.range(), torch.linspace()<br />
torch.logspace() ç­‰æ¯”<br />
torch.rand(), torch.rand_like() æ ‡å‡†å‡åŒ€<br />
torch.randn(), torch.randn_like(), torch.normal() æ ‡å‡†æ­£æ€<br />
torch.randint(), torch.randint_like()<br />
torch.bernoulli() ä¸¤ç‚¹åˆ†å¸ƒ<br />
torch.multinomial()<br />
torch.randperm() {0,1,2,3...,n-1}çš„éšæœºæ’åˆ—</p>
<h3 id="22-é‡æ’å¼ é‡å…ƒç´ "><a class="header" href="#22-é‡æ’å¼ é‡å…ƒç´ ">2.2 é‡æ’å¼ é‡å…ƒç´ </a></h3>
<p>ä»¥ä¸‹ä¸‰ç§ä¸ä¼šæ”¹å˜å¼ é‡çš„å®é™…ä½ç½®ï¼ˆæµ…æ‹·è´ï¼‰</p>
<ul>
<li>reshape()</li>
<li>squeeze()ï¼šæ¶ˆé™¤å¼ é‡ä¸­å¤§å°ä¸º $1$ çš„ç»´åº¦ï¼Œ<code>t.squeeze()</code></li>
<li>unsqueeze()ï¼šæ·»åŠ ä¸€ä¸ªå¤§å°ä¸º $0$ çš„ç»´åº¦ï¼Œ<code>t.unsqueeze(dim=2)</code></li>
</ul>
<h3 id="23-å¼ é‡æ‰©å±•å’Œæ‹¼æ¥"><a class="header" href="#23-å¼ é‡æ‰©å±•å’Œæ‹¼æ¥">2.3 å¼ é‡æ‰©å±•å’Œæ‹¼æ¥</a></h3>
<ul>
<li>repeat()</li>
<li>cat()ï¼šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¦æ‹¼æ¥çš„å¼ é‡çš„åˆ—è¡¨ï¼Œç¬¬äºŒä¸ªæ˜¯å»¶å“ªä¸€ä¸ªç»´åº¦</li>
<li>stack()ï¼šåŒä¸Šï¼Œä¸åŒåœ¨äº stack è¦æ±‚æ‹¼æ¥çš„å¼ é‡å¤§å°å®Œå…¨ä¸€æ ·ï¼Œå»¶ä¸€ä¸ªæ–°çš„ç»´åº¦æ‹¼æ¥</li>
</ul>
<h3 id="24-æ±‚è§£ä¼˜åŒ–é—®é¢˜"><a class="header" href="#24-æ±‚è§£ä¼˜åŒ–é—®é¢˜">2.4 æ±‚è§£ä¼˜åŒ–é—®é¢˜</a></h3>
<ul>
<li>åœ¨æ„é€ ç”¨åšè‡ªå˜é‡çš„ torch.Tensor ç±»å®ä¾‹æ—¶ï¼Œåº”å°†å‚æ•° requires_grad è®¾ç½®ä¸º True</li>
<li>è°ƒç”¨å¼ é‡ç±»å®ä¾‹çš„æˆå‘˜æ–¹æ³• backward() å¯ä»¥æ±‚åå¯¼ï¼Œè°ƒç”¨å®Œåï¼Œ<strong>è‡ªå˜é‡</strong>çš„å±æ€§ grad å°±å‚¨å­˜äº†åå¯¼çš„æ•°å€¼</li>
</ul>
<pre><code class="language-python">from math import pi
import torch
x = torch.tensor([ pi/3 , pi/6 ], requires_grad=True)
f = -((x.cos()**2).sum)**2
print(f'value = {f}')
f.backward()
print(f'grad = {x.grad}')
</code></pre>
<h4 id="ä¼˜åŒ–ç®—æ³•ä¸torchoptimåŒ…"><a class="header" href="#ä¼˜åŒ–ç®—æ³•ä¸torchoptimåŒ…">ä¼˜åŒ–ç®—æ³•ä¸torch.optimåŒ…</a></h4>
<p>åœ¨æ¢¯åº¦ä¸‹é™æ—¶ï¼Œå…ˆè°ƒç”¨ä¼˜åŒ–å™¨å®ä¾‹çš„æ–¹æ³• zero_grad() æ¸…ç©ºä¼˜åŒ–å™¨åœ¨ä¸Šæ¬¡è¿­ä»£ä¸­å‚¨å­˜çš„æ•°æ®ï¼Œç„¶åè°ƒç”¨ torch.tensor ç±»å®ä¾‹çš„æ–¹æ³• backward() æ±‚æ¢¯åº¦ï¼Œæœ€åä½¿ç”¨ä¼˜åŒ–å™¨çš„æ–¹æ³• step() æ›´æ–°è‡ªå˜é‡çš„å€¼</p>
<pre><code class="language-python">optimizer.zero_grad()
f.backward()
optimizer.step()
</code></pre>
<p>ä½¿ç”¨ torch.optim.SGD æ¢¯åº¦ä¸‹é™çš„ä¸€ä¸ªå®ä¾‹</p>
<pre><code class="language-python">from math import pi
import torch
import torch.optim
x = torch.tensor([ pi/3 , pi/6 ], requires_grad=True)
optimizer = torch.optim.SGD([x,], lr=0.1 ,momentum=0)
for step in range(11):
    if step:
        optimizer.zero_grad()
        f.backward()
        optimizer.step()
    f = -((x.cos()**2).sum)**2
    print(f'step {step}: x = {x.tolist()}, f(x) = {f}')
</code></pre>
<h4 id="torchnnå­åŒ…ä¸æŸå¤±ç±»"><a class="header" href="#torchnnå­åŒ…ä¸æŸå¤±ç±»">torch.nnå­åŒ…ä¸æŸå¤±ç±»</a></h4>
<p>torch.nn.Module ç±»åŠå…¶å­ç±»å¯æœ‰ä»¥ä¸‹ç”¨é€”</p>
<ul>
<li>è¡¨ç¤ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼å¦‚ï¼štorch.nn.Sequential ç±»å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œ</li>
<li>è¡¨ç¤ºç¥ç»ç½‘ç»œçš„ä¸€ä¸ªå±‚ï¼šå¦‚ torch.nn.Linear çº¿æ€§å±‚ï¼Œtorch.nn.ReLU æ¿€æ´»å±‚</li>
<li>è¡¨ç¤ºæŸå¤±ï¼štorch.nn.MSELossï¼Œtorh.nn.CrossEntropyLoss ç­‰</li>
</ul>
<p><strong>æ¿€æ´»å±‚</strong>ä¸­é€å…ƒç´ æ¿€æ´»åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»</p>
<ul>
<li>S å‹æ¿€æ´»ï¼šSigmoidï¼ŒSoftsignï¼ŒTanhï¼ŒHardtanhï¼ŒReLU6</li>
<li>å•ä¾§æ¿€æ´»ï¼šReLUï¼ŒLeakyReLUï¼ŒPReLUï¼ŒRReLUï¼ŒThresholdï¼ŒELUï¼ŒSELUï¼ŒSoftplusï¼ŒLogSigmoid</li>
<li>è¤¶çš±æ¿€æ´»ï¼šHardshrinkageï¼ŒSoftshrinkageï¼ŒTanhshrinkage</li>
</ul>
<p>éé€å…ƒç´ æ¿€æ´»</p>
<ul>
<li>Softmaxï¼ŒSoftmax2dï¼ŒLogSoftmax</li>
</ul>
<p>torch.nn é‡Œçš„æŸå¤±ç±»éƒ½æ˜¯ torch.nn.Module ç±»çš„å­ç±»</p>
<pre><code class="language-python">criterion = torch.nn.MSELoss()
pred = torch.arange(5, requires_grad=True)
y = torch.ones(5)
loss = criterion(pred, y)
loss.backward()
</code></pre>
<h4 id="è®­ç»ƒé›†éªŒè¯é›†ä¸è®­ç»ƒé›†"><a class="header" href="#è®­ç»ƒé›†éªŒè¯é›†ä¸è®­ç»ƒé›†">è®­ç»ƒé›†ã€éªŒè¯é›†ä¸è®­ç»ƒé›†</a></h4>
<p>è®­ç»ƒé›†ç”¨æ¥è®¡ç®—å‚æ•°ï¼ŒéªŒè¯é›†æ¥åˆ¤å®šæ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆï¼Œæµ‹è¯•æœºæ¥è¯„ä»·æœ€ç»ˆç»“æœ</p>
<p><img src="img/1.jpg" alt="1" /></p>
<div class="table-wrapper"><table><thead><tr><th></th><th>æ¬ æ‹Ÿåˆ</th><th>è¿‡æ‹Ÿåˆ</th></tr></thead><tbody>
<tr><td>æ³›åŒ–å·®é”™ä¸»è¦æ¥æº</td><td>åå·®å·®é”™ (bias)</td><td>æ–¹å·®å·®é”™ (variance)</td></tr>
<tr><td>æ¨¡å‹å¤æ‚åº¦</td><td>è¿‡ä½</td><td>è¿‡é«˜</td></tr>
<tr><td>å­¦ä¹ æ›²çº¿å’ŒéªŒè¯æ›²çº¿ç‰¹å¾</td><td>æ”¶æ•›åˆ°æ¯”è¾ƒå¤§çš„å·®é”™å€¼</td><td>ä¸¤æ¡æ›²çº¿ä¹‹é—´å·®åˆ«å¤§</td></tr>
<tr><td>è§£å†³æ–¹æ¡ˆ</td><td>å¢åŠ æ¨¡å‹å¤æ‚åº¦</td><td>å‡å°æ¨¡å‹å¤æ‚åº¦æˆ–å¢å¤§è®­ç»ƒé›†</td></tr>
</tbody></table>
</div>
<h3 id="25-æ ‡å‡†åŒ–"><a class="header" href="#25-æ ‡å‡†åŒ–">2.5 æ ‡å‡†åŒ–</a></h3>
<ul>
<li>æ‰¹æ ‡å‡†åŒ–( batch normalization )ï¼šå¯¹åŒä¸€é€šé“ä½¿ç”¨ç›¸åŒçš„å‡å€¼å’Œæ–¹å·®è¿›è¡Œå½’ä¸€åŒ–ï¼Œæ›´é€‚ç”¨äºç‰¹å¾æå–è¿™æ ·çš„åº”ç”¨</li>
<li>å®ä¾‹æ ‡å‡†åŒ–( instance normalization )ï¼šå¯¹åŒä¸€é€šé“ä½¿ç”¨ä¸åŒçš„å‡å€¼å’Œæ–¹å·®è¿›è¡Œå½’ä¸€åŒ–ï¼Œæ›´é€‚ç”¨äºç”Ÿæˆæ•°æ®è¿™æ ·çš„åº”ç”¨</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>æ ‡å‡†åŒ–æ“ä½œç±»å‹</th><th>ç»´åº¦</th><th>æ ‡å‡†åŒ–ç±»</th><th>è¾“å…¥è¾“å‡ºå¼ é‡ç»´åº¦</th><th>é€‚ç”¨ç½‘ç»œ</th></tr></thead><tbody>
<tr><td>æ‰¹æ ‡å‡†åŒ–</td><td>1</td><td>torch.nn.BatchNorm1d</td><td>$(n,c,l[0])$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>æ‰¹æ ‡å‡†åŒ–</td><td>2</td><td>torch.nn.BatchNorm2d</td><td>$(n,c,l[0],l[1])$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>æ‰¹æ ‡å‡†åŒ–</td><td>3</td><td>torch.nn.BatchNorm3d</td><td>$(n,c,l[0],l[1],l[2])$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>å®ä¾‹æ ‡å‡†åŒ–</td><td>1</td><td>torch.nn.InstanceNorm1d</td><td>$(n,c,l[0])$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>å®ä¾‹æ ‡å‡†åŒ–</td><td>2</td><td>torch.nn.InstanceNorm2d</td><td>$(n,c,l[0],l[1])$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>å®ä¾‹æ ‡å‡†åŒ–</td><td>3</td><td>torch.nn.InstanceNorm3d</td><td>$(n,c,l[0]),l[1],l[2]$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
<tr><td>å±‚æ ‡å‡†åŒ–</td><td>ä¸é™</td><td>torch.nn.LayerNorm</td><td>$(n,L$</td><td>å‰é¦ˆç¥ç»ç½‘ç»œ</td></tr>
</tbody></table>
</div>
<h3 id="26-ç½‘ç»œæƒé‡åˆå§‹åŒ–"><a class="header" href="#26-ç½‘ç»œæƒé‡åˆå§‹åŒ–">2.6 ç½‘ç»œæƒé‡åˆå§‹åŒ–</a></h3>
<p>pytorch ä¸­å®Œæˆæƒé‡åˆå§‹åŒ–éœ€è¦ torch.nn.init å­åŒ…å’Œ torch.nn.Module ç±»æˆå‘˜æ–¹æ³• apply()ï¼</p>
<div class="table-wrapper"><table><thead><tr><th>å‡½æ•°å</th><th>å…ƒç´ åˆ†å¸ƒ</th><th>åˆ†å¸ƒå‚æ•°ç¡®å®šæ–¹æ³•</th></tr></thead><tbody>
<tr><td>torch.nn.init.uniform_()</td><td>å‡åŒ€åˆ†å¸ƒ</td><td>ä¼ å…¥è¡¨ç¤ºæœ€å°å€¼çš„å‚æ•° a (é»˜è®¤ä¸º 0 )å’Œè¡¨ç¤ºæœ€å¤§å€¼çš„å‚æ•° b (é»˜è®¤ä¸º 1 )</td></tr>
<tr><td>torch.nn.init.normal_()</td><td>æ­£æ€åˆ†å¸ƒ</td><td>ä¼ å…¥è¡¨ç¤ºå‡å€¼çš„å‚æ•° mean (é»˜è®¤ä¸º 0 )å’Œè¡¨ç¤ºæ–¹å·®çš„å‚æ•° std (é»˜è®¤ä¸º 1 )</td></tr>
<tr><td>torch.nn.init.constant_()</td><td>å¸¸é‡</td><td>ä¼ å…¥å¸¸é‡ vaL</td></tr>
<tr><td>torch.nn.init.xavier_uniform_()</td><td>å‡åŒ€åˆ†å¸ƒ</td><td>å‡å€¼ä¸º 0 ï¼Œæ ‡å‡†å·® $\sigma$ æ ¹æ®è¾“å…¥çš„å¼ é‡å¤§å°å’Œå¢ç›Šå‡½æ•° gain è®¡ç®—å¾—åˆ°</td></tr>
<tr><td>torch.nn.init.xavier_uniform_()</td><td>å‡åŒ€åˆ†å¸ƒ</td><td>å‡å€¼ä¸º 0 ï¼Œæ ‡å‡†å·® $\sigma$ æ ¹æ®è¾“å…¥çš„å¼ é‡å¤§å°å’Œå¢ç›Šå‡½æ•° gain è®¡ç®—å¾—åˆ°</td></tr>
</tbody></table>
</div>
<p>apply() æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ª python å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯ torch.nn.Module ç±»ï¼</p>
<pre><code class="language-python">import torch.nn.init as init
def weights_init(m):
    init.xavier_normal_(m.weight)
    init.constant_(m.bias, 0)
</code></pre>
<h3 id="27-å·ç§¯ç¥ç»ç½‘ç»œ"><a class="header" href="#27-å·ç§¯ç¥ç»ç½‘ç»œ">2.7 å·ç§¯ç¥ç»ç½‘ç»œ</a></h3>
<p>å¯¹ä¸€ç»´å·ç§¯ï¼Œè®¾ $X$ ä¸ºè¾“å…¥å¼ é‡ï¼Œå¤§å°ä¸º $(l_x,)$ï¼Œ$W$ ä¸ºå·ç§¯æ ¸ï¼Œå¤§å°ä¸º $(k,)$ ï¼Œè¾“å‡ºå¼ é‡ä¸º $Z$ ï¼Œå¤§å°ä¸º $(l_z,)$ï¼Œåˆ™æœ‰
$$
l_z=l_x-k+1
$$</p>
<p><strong>è¡¥å…¨</strong> (pad) è¿ç®—</p>
<p><img src="img/2.jpg" alt="2" /></p>
<p>åœ¨è¡¥é›¶å (å‰åå„è¡¥ $p_{x-}$ ï¼Œ$p_{x+}$) ï¼Œç›¸åº”çš„å¼ é‡ç»´åº¦ä¸º
$$
l_{è¡¥å}=p_{x-}+l_x+p_{x+}
$$</p>
<p>æ ¸çš„<strong>è†¨èƒ€</strong>(dilate)ï¼ŒåŸºæœ¬äº’ç›¸å…³ä¸­ï¼Œæ¯ä¸ªæƒé‡è¿ç»­å¯¹åº”ç€è¾“å…¥å¼ é‡ä¸­çš„å…ƒç´ ï¼Œæ­¤æ—¶å¯è®¤ä¸ºè†¨èƒ€ç³»æ•°ä¸º $k_{è†¨èƒ€}=1$ ï¼Œè†¨èƒ€å‰åæ ¸å¤§å°å…³ç³»ä¸º
$$
k_{è†¨èƒ€å}=d_{è†¨èƒ€}(k-1)+1
$$
å›¾ 8-4 ç»™å‡ºäº†è†¨èƒ€ç³»æ•° $d_{è†¨èƒ€}=2$ çš„ä¾‹å­ï¼è†¨èƒ€å‰ï¼Œæ ¸çš„å¤§å°ä¸º $k=3$ ï¼Œè†¨èƒ€åï¼Œ$k_{è†¨èƒ€å}=5$</p>
<p><img src="img/3.jpg" alt="3" /></p>
<p><strong>æ­¥å¹…</strong>(stride)ï¼ŒåŸºæœ¬äº’ç›¸å…³ä¸­ï¼Œå·ç§¯æ ¸æ¯æ¬¡ç›¸å¯¹è¾“å…¥å¼ é‡ $X$ å‘å³ç§»åŠ¨ä¸€ä¸ªå…ƒç´ çš„ä½ç½®å¹¶å¾—åˆ°ä¸€ä¸ªè¾“å‡ºå¼ é‡ï¼Œä¸€å…± $l_z=l_x-k+1$ ä¸ªè¾“å‡ºï¼å°†æ­¤è¾“å‡ºå¤§å°è®°ä¸º $l_{zæ­¥å¹…å‰}$ è§†ä¸ºå¯ä»¥è®¤ä¸ºåŸºæœ¬äº’ç›¸å…³æ“ä½œçš„æ­¥å¹… $s_{æ­¥å¹…}=1$ ï¼Œå¦‚æœè€ƒè™‘æ›´å¤§æ­¥å¹…ï¼Œåˆ™æœ‰
$$
l_z = \left[ \frac{l_{zæ­¥å¹…å‰}-1}{s_{æ­¥å¹…}}+1 \right]
$$</p>
<p>è¡¥å…¨ã€æ­¥å¹…ã€è†¨èƒ€å¯ä»¥ç»¼åˆä½¿ç”¨ï¼ç»¼åˆå‰æ–‡ï¼Œè¾“å…¥å¤§å° $\left( l_{x},\right)$ ï¼Œè¾“å‡ºå¤§å° $\left(l_{z},\right)$ ï¼Œæ ¸å¼ é‡å¤§å° $(k,)$ï¼Œä¸¤ä¾§åˆ†åˆ«è¡¥å…¨æ•° $p_{x-}$ å’Œ $p_{x+}$ ï¼Œæ­¥å¹… $s_{æ­¥å¹…}$ï¼Œè†¨èƒ€ç³»æ•° $d_{è†¨èƒ€}$ ä¹‹é—´çš„å…³ç³»æ»¡è¶³
$$
\begin{aligned}
l_{xè¡¥å}&amp;=p_{x-}+l_x+p_{x+}\
k_{è†¨èƒ€å}&amp;=d_{è†¨èƒ€}(k-1)+1\
l_{zæ­¥å¹…å‰}&amp;=l_{xè¡¥å}-k_{è†¨èƒ€å}+1\
l_z &amp;= \left[ \frac{l_{zæ­¥å¹…å‰}-1}{s_{æ­¥å¹…}}+1 \right]
\end{aligned}
$$
å°†ä»¥ä¸Šå‡ å¼ç»¼åˆèµ·æ¥ï¼Œå¯ä»¥å¾—åˆ°
$$
l_z=\left[ \frac{ (p_{x-}+l_x+p_{x+})-(d_{è†¨èƒ€}(k-1)+1) }{s_{æ­¥å¹…}} +1 \right]
$$</p>
<h4 id="torchnn-é‡Œçš„å·ç§¯å±‚"><a class="header" href="#torchnn-é‡Œçš„å·ç§¯å±‚">torch.nn é‡Œçš„å·ç§¯å±‚</a></h4>
<div class="table-wrapper"><table><thead><tr><th>è¿ç®—ç±»å‹</th><th>è¿ç®—ç»´åº¦</th><th>torch.nn.Moduleå­ç±»</th><th>ç±»å®ä¾‹è¾“å…¥å¼ é‡çš„å¤§å°</th><th>ç±»å®ä¾‹è¾“å‡ºå¼ é‡çš„å¤§å°</th></tr></thead><tbody>
<tr><td>äº’ç›¸å…³</td><td>1</td><td>torch.nn.Conv1d</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>äº’ç›¸å…³</td><td>2</td><td>torch.nn.Conv2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>äº’ç›¸å…³</td><td>3</td><td>torch.nn.Conv3d</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
</tbody></table>
</div>
<p>$n$ ä¸ºæ ·æœ¬çš„è®¡æ•°ï¼Œ $c$ è¡¨ç¤ºæ•°æ®çš„é€šé“æ•°ï¼Œå³ä¸€æ¡æ•°æ®æœ‰å‡ ä¸ª $d$ ç»´å¼ é‡ï¼å·ç§¯å±‚çš„è¾“å‡ºé€šé“æ•°è¡¨ç¤ºæœ€å¤šæ”¯æŒçš„ç‰¹å¾ä¸ªæ•°ï¼å› ä¸ºæ¯ä¸ªé€šé“ä½¿ç”¨ç›¸åŒçš„å·ç§¯æ ¸è®¡ç®—ï¼Œæ¯ä¸ªå·ç§¯æ ¸åªèƒ½æå–ä¸€ç§ç‰¹å¾ï¼</p>
<pre><code class="language-python">conv = torch.nn.Conv2d(16, 33, kernel_size={3, 5}, stride={2, 1}, padding={4, 2}, dilation={3, 1})
inputs = torch.rand(20, 16, 50, 100) #20æ¡æ ·æœ¬ï¼Œ16ä¸ªé€šé“ï¼Œæ¯ä¸ªé€šé“å¤§å°ä¸º 50*100
outputs = conv(inputs)
outputs.size()
</code></pre>
<h4 id="å¼ é‡çš„æ± åŒ–"><a class="header" href="#å¼ é‡çš„æ± åŒ–">å¼ é‡çš„æ± åŒ–</a></h4>
<p><strong>æ± åŒ–</strong> (pooling)ï¼Œæ ¸ä¸éœ€è¦æƒé‡</p>
<ul>
<li>æœ€å¤§æ± åŒ–(max pool)ï¼šè¾“å‡ºå¼ é‡çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯è‹¥å¹²ä¸ªè¾“å…¥å¼ é‡çš„æœ€å¤§å€¼</li>
<li>å¹³å‡æ± åŒ–(average pool)ï¼šè¾“å‡ºå…ƒç´ ç”±è‹¥å¹²ä¸ªè¾“å…¥å…ƒç´ æ±‚å¹³å‡å¾—åˆ°</li>
<li>$l_p$æ± åŒ–($l_p$ pool)ï¼šè®¡ç®—è¾“å…¥å…ƒç´ ç»„åˆçš„ $l_p$ èŒƒæ•°</li>
</ul>
<p><img src="img/4.jpg" alt="4" /></p>
<p><img src="img/5.jpg" alt="5" /></p>
<p>ä»¥ä¸‹ä¸ºä¸å¸¦â€œè‡ªé€‚åº”â€(adaptive)çš„ç‰ˆæœ¬ï¼Œå¸¦è‡ªé€‚åº”åªéœ€åœ¨ MaxPool1d å‰åŠ ä¸Š Adaptiveï¼Œæ­¤æ—¶ä¸èƒ½è®¾ç½®è¡¥å…¨æ•°ç­‰ï¼Œä»–ä¼šè‡ªåŠ¨å¸®ä½ è®¡ç®—</p>
<div class="table-wrapper"><table><thead><tr><th>è¿ç®—ç±»å‹</th><th>è¿ç®—ç»´åº¦</th><th>torch.nn.Moduleå­ç±»</th><th>ç±»å®ä¾‹è¾“å…¥å¼ é‡çš„å¤§å°</th><th>ç±»å®ä¾‹è¾“å‡ºå¼ é‡çš„å¤§å°</th></tr></thead><tbody>
<tr><td>æœ€å¤§æ± åŒ–</td><td>1</td><td>torch.nn.MaxPool1d</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>æœ€å¤§æ± åŒ–</td><td>2</td><td>torch.nn.MaxPool2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>æœ€å¤§æ± åŒ–</td><td>3</td><td>torch.nn.MaxPool3d</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
<tr><td>å¹³å‡æ± åŒ–</td><td>1</td><td>torch.nn.AvgPool1d</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>å¹³å‡æ± åŒ–</td><td>2</td><td>torch.nn.AvgPool2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>å¹³å‡æ± åŒ–</td><td>3</td><td>torch.nn.AvgPool3d</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
<tr><td>$l_p$æ± åŒ–</td><td>1</td><td>torch.nn.LPPool1d</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>$l_p$æ± åŒ–</td><td>2</td><td>torch.nn.LPPool2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>æœ€å¤§åæ± åŒ–</td><td>1</td><td>torch.nn.MaxUnpool1d</td><td>$(n,c_x,l_x[0]$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>æœ€å¤§åæ± åŒ–</td><td>2</td><td>torch.nn.MaxUnpool2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>æœ€å¤§åæ± åŒ–</td><td>3</td><td>torch.nn.MaxUnpool3d</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
</tbody></table>
</div>
<h4 id="å¼ é‡çš„ä¸Šé‡‡æ ·"><a class="header" href="#å¼ é‡çš„ä¸Šé‡‡æ ·">å¼ é‡çš„ä¸Šé‡‡æ ·</a></h4>
<p>å¼ é‡çš„<strong>ä¸Šé‡‡æ ·</strong>(up-sample)ï¼Œå°†è¾“å…¥å¼ é‡çš„æ¯ä¸ªç»´åº¦å¤§å°æ‰©å±•è‹¥å¹²å€ï¼</p>
<ul>
<li>æœ€é‚»è¿‘ä¸Šé‡‡æ ·( nearest up-sample )ï¼šæŒ‰ç…§ä¸€ä¸ªæ¯”ä¾‹å› å­( scale factor )å°†æ¯ä¸ªå…ƒç´ é‡å¤è‹¥å¹²æ¬¡</li>
<li>çº¿æ€§æ’å€¼ä¸Šé‡‡æ ·( linearup-sample )</li>
</ul>
<p>pytorch ä¸­ä¸Šé‡‡æ ·ç”¨çš„æ˜¯ torch.nn çš„å­åŒ… torch.nn.Unsample ç±»ï¼</p>
<div class="table-wrapper"><table><thead><tr><th>è¿ç®—ç±»å‹</th><th>è¿ç®—ç»´åº¦</th><th>torch.nn.Unsampleç±»å®ä¾‹æ„é€ å‚æ•°</th><th>ç±»å®ä¾‹è¾“å…¥å¼ é‡çš„å¤§å°</th><th>ç±»å®ä¾‹è¾“å‡ºå¼ é‡çš„å¤§å°</th></tr></thead><tbody>
<tr><td>æœ€é‚»è¿‘ä¸Šé‡‡æ ·</td><td>1</td><td>mode='nearest'(é»˜è®¤å€¼)</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>æœ€é‚»è¿‘ä¸Šé‡‡æ ·</td><td>2</td><td>mode='nearest'(é»˜è®¤å€¼)</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>æœ€é‚»è¿‘ä¸Šé‡‡æ ·</td><td>3</td><td>mode='nearest'(é»˜è®¤å€¼)</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
<tr><td>çº¿æ€§ä¸Šé‡‡æ ·</td><td>1</td><td>mode='linear'</td><td>$(n,c_x,l_x[0])$</td><td>$(n,c_x,l_z[0])$</td></tr>
<tr><td>çº¿æ€§ä¸Šé‡‡æ ·</td><td>2</td><td>mode='bilinear'</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_z[0],l_z[1])$</td></tr>
<tr><td>çº¿æ€§ä¸Šé‡‡æ ·</td><td>3</td><td>mode='trilinear'</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_z[0],l_z[1],l_z[2])$</td></tr>
</tbody></table>
</div>
<h4 id="å¼ é‡çš„è¡¥å…¨è¿ç®—"><a class="header" href="#å¼ é‡çš„è¡¥å…¨è¿ç®—">å¼ é‡çš„è¡¥å…¨è¿ç®—</a></h4>
<ul>
<li>å¸¸æ•°è¡¥å…¨( constant pad )ï¼šè¾“å…¥å¼ é‡å‰åè¡¥ä¸Šå¸¸æ•°</li>
<li>é‡å¤è¡¥å…¨( replication pad )ï¼šç”¨æœ€è¾¹ä¸Šçš„å€¼è¡¥å…¨</li>
<li>åå°„è¡¥å…¨( reflection pad )ï¼šä»¥è¾¹ç•Œä¸ºå¯¹ç§°è½´è¡¥å…¨</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>è¿ç®—ç±»å‹</th><th>è¿ç®—ç»´åº¦</th><th>torch.nn.Moduleå­ç±»</th><th>ç±»å®ä¾‹è¾“å…¥å¼ é‡çš„å¤§å°</th><th>ç±»å®ä¾‹è¾“å‡ºå¼ é‡çš„å¤§å°</th></tr></thead><tbody>
<tr><td>å¸¸æ•°è¡¥å…¨</td><td>2</td><td>torch.nn.ConstantPad2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_{xè¡¥å}[0],l_{xè¡¥å}[1])$</td></tr>
<tr><td>é‡å¤è¡¥å…¨</td><td>2</td><td>torch.nn.ReplicationPad2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_{xè¡¥å},l_{xè¡¥å}[1])$</td></tr>
<tr><td>åå°„è¡¥å…¨</td><td>2</td><td>torch.nn.ReflectionPad2d</td><td>$(n,c_x,l_x[0],l_x[1])$</td><td>$(n,c_x,l_{xè¡¥å}[0],l_{xè¡¥å}[1])$</td></tr>
<tr><td>åå°„è¡¥å…¨</td><td>3</td><td>torch.nn.Reflection3d</td><td>$(n,c_x,l_x[0],l_x[1],l_x[2])$</td><td>$(n,c_x,l_{xè¡¥å}[0],l_{xè¡¥å}[1],l_{xè¡¥å}[2])$</td></tr>
</tbody></table>
</div>
<pre><code class="language-python">inputs = torch.arange(12).view(1, 1, 3, 4)
pad = nn.ConstantPad2d(padding=[1, 1, 1, 1], value=-1)
pad = nn.Replication2d(padding=[1, 1, 1, 1])
pad = nn.Reflection2d(padding=[1, 1, 1, 1])
</code></pre>
<p>ä¾‹å¦‚å®ç°ä¸‹å›¾çš„å·ç§¯ç½‘ç»œï¼Œå¯ä»¥å‚è€ƒçš„æ„å»ºç½‘ç»œæ–¹æ³•ï¼š</p>
<p><img src="img/6.jpg" alt="6" /></p>
<pre><code class="language-python">import torch.nn

class Net(torch.nn.Module):

    def __init__(self):
        super(Net, self).__init__()
        self.conv0 = torch.nn.Conv2d(1, 64, kernel_size=3, padding=1)
        self.relu1 = torch.nn.ReLU()
        self.conv2 = torch.nn.Conv2d(64, 128, kernel_size=3, padding=1)
        self.relu3 = torch.nn.ReLU()
        self.pool4 = torch.nn.MaxPool2d(stride=2, kernel_size=2)
        self.fc5 = torch.nn.Linear(128*14*14, 1024)
        self.relu6 = torch.nn.ReLU()
        self.drop7 = torch.nn.Dropout(p=0.5)
        self.fc8 = torch.nn.Linear(1024, 10)

    def forward(self, x):
        x = self.conv0(x)
        x = self.relu1(x)
        x = self.conv2(x)
        x = self.relu3(x)
        x = self.pool4(x)
        x = x.view(-1, 128 * 14 * 14)
        x = self.fc5(x)
        x = self.relu6(x)
        x = self.drop7(x)
        x = self.fc8(x)
        return x
    
net = Net()
</code></pre>
<p>å¦å¤–å¯ç”¨ sequential æ–¹æ³•</p>
<pre><code class="language-python">import torch.nn

class Net(torch.nn.Module):

    def __init__(self):
        super(Net, self).__init__()
        self.conv = torch.nn.Sequential(
            torch.nn.Conv2d(1, 64, kernel_size=3, padding=1)
            torch.nn.ReLU()
            torch.nn.Conv2d(64, 128, kernel_size=3, padding=1)
            torch.nn.ReLU()
            torch.nn.MaxPool2d(stride=2, kernel_size=2))
        self.dense = torch.nn.Sequential(
            torch.nn.Linear(128*14*14, 1024)
            torch.nn.ReLU()
            torch.nn.Dropout(p=0.5)
            torch.nn.Linear(1024, 10))

    def forward(self, x):
        x = self.conv(x)
        x = x.view(-1, 128 * 14 * 14)
        x = self.dense(x)
        return x
    
net = Net()
</code></pre>
<h3 id="28-å¾ªç¯ç¥ç»ç½‘ç»œ"><a class="header" href="#28-å¾ªç¯ç¥ç»ç½‘ç»œ">2.8 å¾ªç¯ç¥ç»ç½‘ç»œ</a></h3>
<p>TODO:å¾ªç¯ç¥ç»ç½‘ç»œ</p>
<p>ä»¥ä¸‹æ˜¯ LSTM ç¤ºä¾‹</p>
<pre><code class="language-python">import torch.nn

class Net(torch.nn.Module):

    def __init__(self, input_size, hidden_size):
        super(Net, self).__init__()
        self.rnn = torch.nn.LSTM(input_size, hidden_size)
        self.fc = torch.nn.Linear(hidden_size, 1)

    def forward(self, x):
        x = x[:, :, None]
        x, _ = self.rnn(x)
        x = self.fc(x)
        x = x[:, :, 0]
        return x

net = Net(input_size=1, hidden_size=5)
</code></pre>
<h3 id="29-ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ"><a class="header" href="#29-ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ">2.9 ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</a></h3>
<ul>
<li>ç”Ÿæˆç½‘ç»œ( generative network )ï¼šä¸€èˆ¬ä¸€æ¡éšæœºè¾“å…¥æ˜¯ä¸€ä¸ªæœ‰å¤šä¸ªå…ƒç´ çš„å¼ é‡ $Z$ï¼Œå¼ é‡ $Z$ çš„å–å€¼ç©ºé—´ç§°ä¸ºâ€œæ½œåœ¨ç©ºé—´â€( latent space )ï¼Œå¼ é‡ $Z$ çš„å…ƒç´ ä¸ªæ•°ç§°ä¸ºâ€œæ½œåœ¨å¤§å°â€( latent size )ï¼ç”Ÿæˆç½‘ç»œ $g$ å¯ä»¥å°†è¿™æ¡æ½œåœ¨å¼ é‡æ ·æœ¬ $Z$ æ˜ å°„ä¸ºä¸€æ¡æ•°æ®å¼ é‡ $X=g(Z)$ï¼</li>
<li>é‰´åˆ«ç½‘ç»œ( discriminative network )ï¼šå¯¹ç”Ÿæˆç½‘ç»œç”Ÿæˆçš„æ•°æ®è¿›è¡Œåˆ¤å®šï¼</li>
</ul>
<p>ä»¥ $l$ è®°äº¤å‰ç†µæŸå¤±å‡½æ•°</p>
<p>ç›®çš„ï¼šè®­ç»ƒé‰´åˆ«ç½‘ç»œ $d$ ä½¿å¾—
$$
\begin{aligned}
&amp;min_d l(d(X),1),\qquadå…¶ä¸­Xæ˜¯çœŸå®æ•°æ®\
&amp;min_d l(d(g(X)),0)
\end{aligned}
$$
è®­ç»ƒç”Ÿæˆç½‘ç»œä½¿å¾—
$$
max_g min_d l(d(g(Z)),0)
$$</p>
<p>ä»¥ä¸‹æ˜¯CIFAR-10å›¾åƒç”Ÿæˆçš„å®ä¾‹</p>
<pre><code class="language-python">'''è¯»å–æ•°æ®'''
from torch.utils.data import DataLoader
from torchvision.datasets import CIFAR10
import torchvision.transforms as transforms
from torchvision.utils import save_image

dataset = CIFAR10(root='./data', download=True,
        transform=transforms.ToTensor())
dataloader = DataLoader(dataset, batch_size=64, shuffle=True)

for batch_idx, data in enumerate(dataloader):
    real_images, _ = data
    batch_size = real_images.size(0)
    print ('#{} has {} images.'.format(batch_idx, batch_size))
    if batch_idx % 100 == 0:
        path = './data/CIFAR10_shuffled_batch{:03d}.png'.format(batch_idx)
        save_image(real_images, path, normalize=True)

'''ç”Ÿæˆç½‘ç»œä¸é‰´åˆ«ç½‘ç»œçš„æ­å»º'''
import torch.nn as nn

# æ­å»ºç”Ÿæˆç½‘ç»œ
latent_size = 64 # æ½œåœ¨å¤§å°
n_channel = 3 # è¾“å‡ºé€šé“æ•°
n_g_feature = 64 # ç”Ÿæˆç½‘ç»œéšè—å±‚å¤§å°
gnet = nn.Sequential( 
        # è¾“å…¥å¤§å° = (64, 1, 1)
        nn.ConvTranspose2d(latent_size, 4 * n_g_feature, kernel_size=4,
                bias=False),
        nn.BatchNorm2d(4 * n_g_feature),
        nn.ReLU(),
        # å¤§å° = (256, 4, 4)
        nn.ConvTranspose2d(4 * n_g_feature, 2 * n_g_feature, kernel_size=4,
                stride=2, padding=1, bias=False),
        nn.BatchNorm2d(2 * n_g_feature),
        nn.ReLU(),
        # å¤§å° = (128, 8, 8)
        nn.ConvTranspose2d(2 * n_g_feature, n_g_feature, kernel_size=4,
                stride=2, padding=1, bias=False),
        nn.BatchNorm2d(n_g_feature),
        nn.ReLU(),
        # å¤§å° = (64, 16, 16)
        nn.ConvTranspose2d(n_g_feature, n_channel, kernel_size=4,
                stride=2, padding=1),
        nn.Sigmoid(),
        # å›¾ç‰‡å¤§å° = (3, 32, 32)
        )
print (gnet)

# æ­å»ºé‰´åˆ«ç½‘ç»œ
n_d_feature = 64 # é‰´åˆ«ç½‘ç»œéšè—å±‚å¤§å°
dnet = nn.Sequential( 
        # å›¾ç‰‡å¤§å° = (3, 32, 32)
        nn.Conv2d(n_channel, n_d_feature, kernel_size=4,
                stride=2, padding=1),
        nn.LeakyReLU(0.2),
        # å¤§å° = (64, 16, 16)
        nn.Conv2d(n_d_feature, 2 * n_d_feature, kernel_size=4,
                stride=2, padding=1, bias=False),
        nn.BatchNorm2d(2 * n_d_feature),
        nn.LeakyReLU(0.2),
        # å¤§å° = (128, 8, 8)
        nn.Conv2d(2 * n_d_feature, 4 * n_d_feature, kernel_size=4,
                stride=2, padding=1, bias=False),
        nn.BatchNorm2d(4 * n_d_feature),
        nn.LeakyReLU(0.2),
        # å¤§å° = (256, 4, 4)
        nn.Conv2d(4 * n_d_feature, 1, kernel_size=4),
        # å¯¹æ•°èµ”ç‡å¼ é‡å¤§å° = (1, 1, 1)
        )
print(dnet)

'''ç½‘ç»œåˆå§‹åŒ–'''
import torch.nn.init as init

def weights_init(m): # ç”¨äºåˆå§‹åŒ–æƒé‡å€¼çš„å‡½æ•°
    if type(m) in [nn.ConvTranspose2d, nn.Conv2d]:
        init.xavier_normal_(m.weight)
    elif type(m) == nn.BatchNorm2d:
        init.normal_(m.weight, 1.0, 0.02)
        init.constant_(m.bias, 0)

gnet.apply(weights_init)
dnet.apply(weights_init)

'''è®­ç»ƒå¹¶è¾“å‡ºå›¾ç‰‡'''
import torch
import torch.optim

# æŸå¤±
criterion = nn.BCEWithLogitsLoss()

# ä¼˜åŒ–å™¨
goptimizer = torch.optim.Adam(gnet.parameters(),
        lr=0.0002, betas=(0.5, 0.999))
doptimizer = torch.optim.Adam(dnet.parameters(), 
        lr=0.0002, betas=(0.5, 0.999))

# ç”¨äºæµ‹è¯•çš„å›ºå®šå™ªå£°,ç”¨æ¥æŸ¥çœ‹ç›¸åŒçš„æ½œåœ¨å¼ é‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç”Ÿæˆå›¾ç‰‡çš„å˜æ¢
batch_size = 64
fixed_noises = torch.randn(batch_size, latent_size, 1, 1)

# è®­ç»ƒè¿‡ç¨‹
epoch_num = 10
for epoch in range(epoch_num):
    for batch_idx, data in enumerate(dataloader):
        # è½½å…¥æœ¬æ‰¹æ¬¡æ•°æ®
        real_images, _ = data
        batch_size = real_images.size(0)
        
        # è®­ç»ƒé‰´åˆ«ç½‘ç»œ
        labels = torch.ones(batch_size) # çœŸå®æ•°æ®å¯¹åº”æ ‡ç­¾ä¸º1
        preds = dnet(real_images) # å¯¹çœŸå®æ•°æ®è¿›è¡Œåˆ¤åˆ«
        outputs = preds.reshape(-1)
        dloss_real = criterion(outputs, labels) # çœŸå®æ•°æ®çš„é‰´åˆ«å™¨æŸå¤±
        dmean_real = outputs.sigmoid().mean()
                # è®¡ç®—é‰´åˆ«å™¨å°†å¤šå°‘æ¯”ä¾‹çš„çœŸæ•°æ®åˆ¤å®šä¸ºçœŸ,ä»…ç”¨äºè¾“å‡ºæ˜¾ç¤º
        
        noises = torch.randn(batch_size, latent_size, 1, 1) # æ½œåœ¨å™ªå£°
        fake_images = gnet(noises) # ç”Ÿæˆå‡æ•°æ®
        labels = torch.zeros(batch_size) # å‡æ•°æ®å¯¹åº”æ ‡ç­¾ä¸º0
        fake = fake_images.detach()
                # ä½¿å¾—æ¢¯åº¦çš„è®¡ç®—ä¸å›æº¯åˆ°ç”Ÿæˆç½‘ç»œ,å¯ç”¨äºåŠ å¿«è®­ç»ƒé€Ÿåº¦.åˆ å»æ­¤æ­¥ç»“æœä¸å˜
        preds = dnet(fake) # å¯¹å‡æ•°æ®è¿›è¡Œé‰´åˆ«
        outputs = preds.view(-1)
        dloss_fake = criterion(outputs, labels) # å‡æ•°æ®çš„é‰´åˆ«å™¨æŸå¤±
        dmean_fake = outputs.sigmoid().mean()
                # è®¡ç®—é‰´åˆ«å™¨å°†å¤šå°‘æ¯”ä¾‹çš„å‡æ•°æ®åˆ¤å®šä¸ºçœŸ,ä»…ç”¨äºè¾“å‡ºæ˜¾ç¤º
        
        dloss = dloss_real + dloss_fake # æ€»çš„é‰´åˆ«å™¨æŸå¤±
        dnet.zero_grad()
        dloss.backward()
        doptimizer.step()
        
        # è®­ç»ƒç”Ÿæˆç½‘ç»œ
        labels = torch.ones(batch_size)
                # ç”Ÿæˆç½‘ç»œå¸Œæœ›æ‰€æœ‰ç”Ÿæˆçš„æ•°æ®éƒ½è¢«è®¤ä¸ºæ˜¯çœŸæ•°æ®
        preds = dnet(fake_images) # æŠŠå‡æ•°æ®é€šè¿‡é‰´åˆ«ç½‘ç»œ
        outputs = preds.view(-1)
        gloss = criterion(outputs, labels) # çœŸæ•°æ®çœ‹åˆ°çš„æŸå¤±
        gmean_fake = outputs.sigmoid().mean()
                # è®¡ç®—é‰´åˆ«å™¨å°†å¤šå°‘æ¯”ä¾‹çš„å‡æ•°æ®åˆ¤å®šä¸ºçœŸ,ä»…ç”¨äºè¾“å‡ºæ˜¾ç¤º
        gnet.zero_grad()
        gloss.backward()
        goptimizer.step()
        
        # è¾“å‡ºæœ¬æ­¥è®­ç»ƒç»“æœ
        print('[{}/{}]'.format(epoch, epoch_num) +
                '[{}/{}]'.format(batch_idx, len(dataloader)) +
                'é‰´åˆ«ç½‘ç»œæŸå¤±:{:g} ç”Ÿæˆç½‘ç»œæŸå¤±:{:g}'.format(dloss, gloss) +
                'çœŸæ•°æ®åˆ¤çœŸæ¯”ä¾‹:{:g} å‡æ•°æ®åˆ¤çœŸæ¯”ä¾‹:{:g}/{:g}'.format(
                dmean_real, dmean_fake, gmean_fake))
        if batch_idx % 100 == 0:
            fake = gnet(fixed_noises) # ç”±å›ºå®šæ½œåœ¨å¼ é‡ç”Ÿæˆå‡æ•°æ®
            save_image(fake, # ä¿å­˜å‡æ•°æ®
                    './data/images_epoch{:02d}_batch{:03d}.png'.format(
                    epoch, batch_idx))
</code></pre>
<h2 id="pythonä¹‹ç¦…"><a class="header" href="#pythonä¹‹ç¦…">pythonä¹‹ç¦…</a></h2>
<p><strong>print</strong>å†™æ³•</p>
<pre><code class="language-python">name = 'ROSE'
country = 'China'
age = 20

print('hi, my name is {}. im from {}, and im {}'.format(name,country,age))

æœ€ç®€å•å†™æ³•
print(f'hi, my name is {name}, im from {country}, and im {age+1}')
</code></pre>
<p>for å¾ªç¯æ—¶ä½¿ç”¨ enumerate å¯è¿”å›ä¸¤ä¸ªå‚æ•°ï¼Œå‰ä¸€ä¸ªæ˜¯ index ï¼Œç¬¬äºŒä¸ªæ˜¯å¯¹åº”å‚æ•°</p>
<pre><code class="language-python">for idx,step in enumerate(range(10))
</code></pre>
<h2 id="3-pandas"><a class="header" href="#3-pandas">3. Pandas</a></h2>
<p>Series([1, 2, 3, 4], index=[a, b, c, d])<br />
æŸ¥ç¼ºå¤±æ•°æ® .isnull(), .notnull(), è¿”å›åŒç»“æ„çš„å¸ƒå°”å€¼<br />
Serieså¯¹è±¡æœ¬èº«åŠå…¶ç´¢å¼•æœ‰ä¸ª name å±æ€§</p>
<pre><code class="language-python">a = pd.Series([1 ,2 ,3 ,4], index=['a', 'b', 'c', 'd'])  
a.name = 'series'
</code></pre>
<p>å°†åºåˆ—ä½œä¸º DataFrame çš„ä¸€åˆ—æ—¶ï¼Œnameå±æ€§å°±å˜ä¸ºé‚£ä¸€åˆ—çš„åˆ—å</p>
<p>DataFrame</p>
<pre><code class="language-python">data = np.ones([3,4])
d = pd.DataFrame(data, index=['a','b','c'], columns=['a','b','c','d'])
</code></pre>
<p>.head() å–å‰äº”è¡Œï¼Œ.tail()<br />
.del() åˆ é™¤æŸä¸€åˆ—ï¼Œ.drop()åˆ é™¤æŒ‡å®šè½´ä¸ŠæŸäº›é¡¹<br />
.append() .difference() .intersection() .union()</p>
<p>ç´¢å¼• ç”¨æ ‡ç­¾å data.loc['a',['c','d']] ä¸ç”¨æ ‡ç­¾å data.iloc[2,[2,3]]</p>
<p>å¸¸ç”¨æ–¹æ³• .cumsum() .cumprod() .diff() .pct_change()</p>
<p><strong>æ¢æŒ‡å®šåˆ—å</strong> d=d.rename( index={1:'new'}, columns={'a':'shit'} )</p>
<h2 id="4-matplotlib"><a class="header" href="#4-matplotlib">4. matplotlib</a></h2>
<pre><code class="language-python">import matplotlib.pyplot as plt

data1 = np.linspace(1,200,2000)
data2 = np.random.randn(2000)
fig = plt.figure()
ax1 = fig.add_subplot(2,2,1)
plt.plot(data1, label='first')
plt.plot(data2,'.', label='second')
ax1.set_xticks([1,2,40])
ax1.legend(loc='best')
ax1.set_title('first plot')
ax1.set_xlabel('index')
ax2 = fig.add_subplot(2,2,2)
</code></pre>
<p>'-'å®çº¿ '--'çŸ­åˆ’çº¿ '-.'ç‚¹åˆ’çº¿ ':'è™šçº¿ '.'ç‚¹ 'v'å€’ä¸‰è§’ ç­‰<br />
colorå‚æ•° 'b'è“ 'g'ç»¿ 'r'çº¢ 'c'é’ 'm'å“çº¢ 'y'é»„ 'k'é»‘ 'w'ç™½</p>
<h2 id="5-backtrader"><a class="header" href="#5-backtrader">5. backtrader</a></h2>
<pre><code class="language-python">import backtrader as bt

cerebro = bt.Cerebro()

# è®¾ç½®åˆå§‹èµ„é‡‘
cerebro.broker.setcash(100000.0)

#è·å–å½“å‰brokerçš„èµ„é‡‘æ•°
cerebro.broker.getvalue()

#è®¾ç½®äº¤æ˜“æ‰‹ç»­è´¹
cerebro.broker.setcommission(0.005)

# Create a Data Feedï¼ˆé»˜è®¤çš„é›…è™æ•°æ®æ ¼å¼ï¼‰
data = bt.feeds.YahooFinanceCSVData(
        dataname=datapath,
        # Do not pass values before this date
        fromdate=datetime.datetime(2000, 1, 1),
        # Do not pass values after this date
        todate=datetime.datetime(2000, 12, 31),
        reverse=False)

#ä¸€èˆ¬çš„CSVæ–‡ä»¶
data = bt.feeds.GenericCSVData(
        dataname='æ•°æ®æ–‡ä»¶æ‰€åœ¨ä½ç½®',
        datetime=2,
        open=3,
        high=4,
        low=5,
        close=6,
        volume=10,
        dtformat=('%Y%m%d'),
        fromdate=datetime(2010, 1, 1),
        todate=datetime(2020, 4, 12)
    )

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æœºå™¨å­¦ä¹ "><a class="header" href="#æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </a></h1>
<p><strong>æœºå™¨å­¦ä¹ </strong>ï¼ˆMachine Learningï¼ŒMLï¼‰æ˜¯æŒ‡ä»æœ‰é™çš„è§‚æµ‹æ•°æ®ä¸­å­¦ä¹ ï¼ˆæˆ–â€œçŒœæµ‹â€ï¼‰å‡ºå…·æœ‰ä¸€èˆ¬æ€§çš„è§„å¾‹ï¼Œå¹¶åˆ©ç”¨è¿™äº›è§„å¾‹å¯¹æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹çš„æ–¹æ³•ã€‚<br />
æœºå™¨å­¦ä¹ æ–¹æ³•å¯ä»¥ç²—ç•¥åœ°åˆ†ä¸ºä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼šæ¨¡å‹ã€å­¦ä¹ å‡†åˆ™ã€ä¼˜åŒ–ç®—æ³•ï¼</p>
<ul>
<li><strong>æ¨¡å‹</strong>ï¼šæ ¹æ®ç»éªŒæ¥å‡è®¾ä¸€ä¸ªå‡½æ•°é›†åˆ â„± ï¼Œç§°ä¸ºå‡è®¾ç©ºé—´ï¼ˆHypothesis Spaceï¼‰ï¼Œç„¶åé€šè¿‡è§‚æµ‹å…¶åœ¨è®­ç»ƒé›† ğ’Ÿ ä¸Šçš„ç‰¹æ€§ï¼Œä»ä¸­é€‰æ‹©ä¸€ä¸ªç†æƒ³çš„å‡è®¾ï¼ˆHypothesisï¼‰ğ‘“âˆ—âˆˆ â„±ï¼é€šå¸¸åˆ†ä¸ºçº¿æ€§&amp;éçº¿æ€§.</li>
<li><strong>å­¦ä¹ å‡†åˆ™</strong>ï¼š
<ul>
<li>æŸå¤±å‡½æ•°ï¼š
<ul>
<li>é£é™©æœ€å°åŒ–å‡†åˆ™ï¼šç»éªŒé£é™©æœ€å°åŒ–ï¼ˆEmpirical Risk Minimizationï¼ŒERMï¼‰å‡†åˆ™ä¸ç»“æ„é£é™©æœ€å°åŒ–ï¼ˆStructure Risk Minimizationï¼ŒSRMï¼‰å‡†åˆ™. å‰è€…æ˜¯è¦æ±‚ä½ å¯¹è®­ç»ƒé›†çš„æ‹Ÿåˆï¼Œåè€…æ˜¯ä¿è¯æ³›åŒ–èƒ½åŠ›.</li>
</ul>
</li>
</ul>
</li>
<li><strong>ä¼˜åŒ–ç®—æ³•</strong>ï¼šåœ¨ç¡®å®šäº†è®­ç»ƒé›† ğ’Ÿ ã€å‡è®¾ç©ºé—´ â„± ä»¥åŠå­¦ä¹ å‡†åˆ™åï¼Œå¦‚ä½•æ‰¾åˆ°æœ€ä¼˜çš„æ¨¡å‹ ğ‘“(ğ’™,ğœƒâˆ—) å°±æˆäº†ä¸€ä¸ªæœ€ä¼˜åŒ–ï¼ˆOptimizationï¼‰é—®é¢˜ï¼æœºå™¨å­¦ä¹ çš„è®­ç»ƒè¿‡ç¨‹å…¶å®å°±æ˜¯æœ€ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£è¿‡ç¨‹ï¼</li>
</ul>
<p><strong>ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ </strong>ä¸»è¦å…³æ³¨å¦‚ä½•å­¦ä¹ ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼ä¸€èˆ¬éœ€è¦é¦–å…ˆå°†æ•°æ®è¡¨ç¤ºä¸ºä¸€ç»„<strong>ç‰¹å¾</strong>ï¼ˆFeatureï¼‰ï¼Œç‰¹å¾çš„è¡¨ç¤ºå½¢å¼å¯ä»¥æ˜¯è¿ç»­çš„æ•°å€¼ã€ç¦»æ•£çš„ç¬¦å·æˆ–å…¶ä»–å½¢å¼ï¼ç„¶åå°†è¿™äº›ç‰¹å¾è¾“å…¥åˆ°é¢„æµ‹æ¨¡å‹ï¼Œå¹¶è¾“å‡ºé¢„æµ‹ç»“æœï¼è¿™ç±»æœºå™¨å­¦ä¹ å¯ä»¥çœ‹ä½œ<strong>æµ…å±‚å­¦ä¹ </strong>ï¼ˆShallow Learningï¼‰ï¼æµ…å±‚å­¦ä¹ çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯ä¸æ¶‰åŠç‰¹å¾å­¦ä¹ ï¼Œå…¶ç‰¹å¾ä¸»è¦é äººå·¥ç»éªŒæˆ–ç‰¹å¾è½¬æ¢æ–¹æ³•æ¥æŠ½å–ï¼<br />
åœ¨å®é™…ä»»åŠ¡ä¸­ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸€èˆ¬ä¼šåŒ…å«ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼ˆå¦‚å›¾1.2æ‰€ç¤ºï¼‰ï¼š</p>
<ol>
<li>æ•°æ®é¢„å¤„ç†ï¼šç»è¿‡æ•°æ®çš„é¢„å¤„ç†ï¼Œå¦‚å»é™¤å™ªå£°ç­‰ï¼æ¯”å¦‚åœ¨æ–‡æœ¬åˆ†ç±»ä¸­ï¼Œå»é™¤åœç”¨è¯ç­‰ï¼</li>
<li>ç‰¹å¾æå–ï¼šä»åŸå§‹æ•°æ®ä¸­æå–ä¸€äº›æœ‰æ•ˆçš„ç‰¹å¾ï¼æ¯”å¦‚åœ¨å›¾åƒåˆ†ç±»ä¸­ï¼Œæå–è¾¹ç¼˜ã€å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ï¼ˆScale Invariant Feature Transformï¼ŒSIFTï¼‰ç‰¹å¾ç­‰ï¼</li>
<li>ç‰¹å¾è½¬æ¢ï¼šå¯¹ç‰¹å¾è¿›è¡Œä¸€å®šçš„åŠ å·¥ï¼Œæ¯”å¦‚é™ç»´å’Œå‡ç»´ï¼é™ç»´åŒ…æ‹¬ç‰¹å¾æŠ½å–ï¼ˆFeature Extractionï¼‰å’Œç‰¹å¾é€‰æ‹©ï¼ˆFeature Selectionï¼‰ä¸¤ç§é€”å¾„ï¼å¸¸ç”¨çš„ç‰¹å¾è½¬æ¢æ–¹æ³•æœ‰ä¸»æˆåˆ†åˆ†æï¼ˆPrincipal Components Analysisï¼ŒPCAï¼‰ã€çº¿æ€§åˆ¤åˆ«åˆ†æï¼ˆLinear Discriminant Analysisï¼ŒLDAï¼‰ç­‰.</li>
<li>é¢„æµ‹ï¼šæœºå™¨å­¦ä¹ çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå­¦ä¹ ä¸€ä¸ªå‡½æ•°å¹¶è¿›è¡Œé¢„æµ‹ï¼
<img src="ml/img/1.JPG" alt="ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ­¥éª¤" /></li>
</ol>
<blockquote>
<p><strong>è¡¨ç¤ºå­¦ä¹ </strong>ï¼šä¸ºäº†æé«˜æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„å‡†ç¡®ç‡ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†è¾“å…¥ä¿¡æ¯è½¬æ¢ä¸ºæœ‰æ•ˆçš„ç‰¹å¾ï¼Œæˆ–è€…æ›´ä¸€èˆ¬æ€§åœ°ç§°ä¸º<strong>è¡¨ç¤º</strong>ï¼ˆRepresentationï¼‰ï¼å¦‚æœæœ‰ä¸€ç§ç®—æ³•å¯ä»¥è‡ªåŠ¨åœ°å­¦ä¹ å‡ºæœ‰æ•ˆçš„ç‰¹å¾ï¼Œå¹¶æé«˜æœ€ç»ˆæœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ï¼Œé‚£ä¹ˆè¿™ç§å­¦ä¹ å°±å¯ä»¥å«ä½œè¡¨ç¤ºå­¦ä¹ ï¼ˆRepresentation Learningï¼‰ï¼<br />
<strong>è¯­ä¹‰é¸¿æ²Ÿ</strong>ï¼šè¡¨ç¤ºå­¦ä¹ çš„å…³é”®æ˜¯è§£å†³è¯­ä¹‰é¸¿æ²Ÿï¼ˆSemantic Gapï¼‰é—®é¢˜ï¼å³è½¦è¿™ä¸€æ¦‚å¿µæ˜¯é«˜å±‚è¯­ä¹‰ç‰¹å¾ï¼Œè½¿è½¦ã€è‡ªè¡Œè½¦ã€å¡è½¦æ˜¯åº•å±‚ç‰¹å¾ï¼Œå¦‚ä½•åŒä¸åŒè½¦ç§æå–å‡ºé‚£ä¸ªé«˜å±‚ç‰¹å¾â€œè½¦â€å‘¢ï¼Ÿå¦‚æœä¸€ä¸ªé¢„æµ‹æ¨¡å‹ç›´æ¥å»ºç«‹åœ¨åº•å±‚ç‰¹å¾ä¹‹ä¸Šï¼Œä¼šå¯¼è‡´å¯¹é¢„æµ‹æ¨¡å‹çš„èƒ½åŠ›è¦æ±‚è¿‡é«˜ï¼å¦‚æœå¯ä»¥æœ‰ä¸€ä¸ªå¥½çš„è¡¨ç¤ºåœ¨æŸç§ç¨‹åº¦ä¸Šèƒ½å¤Ÿåæ˜ å‡ºæ•°æ®çš„é«˜å±‚è¯­ä¹‰ç‰¹å¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½ç›¸å¯¹å®¹æ˜“åœ°æ„å»ºåç»­çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</p>
</blockquote>
<h2 id="ä¸€-ç»ªè®º"><a class="header" href="#ä¸€-ç»ªè®º"><strong>ä¸€ï¼ ç»ªè®º</strong></a></h2>
<p>å†…å®¹ä¸º <a href="https://github.com/Vay-keen/Machine-learning-learning-notes">Vay-keen æ•´ç†çš„å‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹ç¬”è®°</a></p>
<h3 id="11-æœºå™¨å­¦ä¹ çš„å®šä¹‰"><a class="header" href="#11-æœºå™¨å­¦ä¹ çš„å®šä¹‰"><strong>1.1 æœºå™¨å­¦ä¹ çš„å®šä¹‰</strong></a></h3>
<p>æ­£å¦‚æˆ‘ä»¬æ ¹æ®è¿‡å»çš„ç»éªŒæ¥åˆ¤æ–­æ˜å¤©çš„å¤©æ°”ï¼Œåƒè´§ä»¬å¸Œæœ›ä»è´­ä¹°ç»éªŒä¸­æŒ‘é€‰ä¸€ä¸ªå¥½ç“œï¼Œé‚£èƒ½ä¸èƒ½è®©è®¡ç®—æœºå¸®åŠ©äººç±»æ¥å®ç°è¿™ä¸ªå‘¢ï¼Ÿæœºå™¨å­¦ä¹ æ­£æ˜¯è¿™æ ·çš„ä¸€é—¨å­¦ç§‘ï¼Œäººçš„â€œç»éªŒâ€å¯¹åº”è®¡ç®—æœºä¸­çš„â€œæ•°æ®â€ï¼Œè®©è®¡ç®—æœºæ¥å­¦ä¹ è¿™äº›ç»éªŒæ•°æ®ï¼Œç”Ÿæˆä¸€ä¸ªç®—æ³•æ¨¡å‹ï¼Œåœ¨é¢å¯¹æ–°çš„æƒ…å†µä¸­ï¼Œè®¡ç®—æœºä¾¿èƒ½ä½œå‡ºæœ‰æ•ˆçš„åˆ¤æ–­ï¼Œè¿™ä¾¿æ˜¯æœºå™¨å­¦ä¹ ã€‚</p>
<p>å¦ä¸€æœ¬ç»å…¸æ•™æçš„ä½œè€…Mitchellç»™å‡ºäº†ä¸€ä¸ªå½¢å¼åŒ–çš„å®šä¹‰ï¼Œå‡è®¾ï¼š</p>
<ul>
<li>Pï¼šè®¡ç®—æœºç¨‹åºåœ¨æŸä»»åŠ¡ç±»Tä¸Šçš„æ€§èƒ½ã€‚</li>
<li>Tï¼šè®¡ç®—æœºç¨‹åºå¸Œæœ›å®ç°çš„ä»»åŠ¡ç±»ã€‚</li>
<li>Eï¼šè¡¨ç¤ºç»éªŒï¼Œå³å†å²çš„æ•°æ®é›†ã€‚</li>
</ul>
<p>è‹¥è¯¥è®¡ç®—æœºç¨‹åºé€šè¿‡åˆ©ç”¨ç»éªŒEåœ¨ä»»åŠ¡Tä¸Šè·å¾—äº†æ€§èƒ½Pçš„æ”¹å–„ï¼Œåˆ™ç§°è¯¥ç¨‹åºå¯¹Eè¿›è¡Œäº†å­¦ä¹ ã€‚</p>
<h3 id="12-æœºå™¨å­¦ä¹ çš„ä¸€äº›åŸºæœ¬æœ¯è¯­"><a class="header" href="#12-æœºå™¨å­¦ä¹ çš„ä¸€äº›åŸºæœ¬æœ¯è¯­"><strong>1.2 æœºå™¨å­¦ä¹ çš„ä¸€äº›åŸºæœ¬æœ¯è¯­</strong></a></h3>
<p>å‡è®¾æˆ‘ä»¬æ”¶é›†äº†ä¸€æ‰¹è¥¿ç“œçš„æ•°æ®ï¼Œä¾‹å¦‚ï¼šï¼ˆè‰²æ³½=é’ç»¿;æ ¹è’‚=èœ·ç¼©;æ•²å£°=æµŠå“)ï¼Œ (è‰²æ³½=ä¹Œé»‘;æ ¹è’‚=ç¨èœ·;æ•²å£°=æ²‰é—·)ï¼Œ (è‰²æ³½=æµ…è‡ª;æ ¹è’‚=ç¡¬æŒº;æ•²å£°=æ¸…è„†)â€¦â€¦æ¯å¯¹æ‹¬å·å†…æ˜¯ä¸€ä¸ªè¥¿ç“œçš„è®°å½•ï¼Œå®šä¹‰ï¼š</p>
<ul>
<li>æ‰€æœ‰è®°å½•çš„é›†åˆä¸ºï¼šæ•°æ®é›†ã€‚</li>
<li>æ¯ä¸€æ¡è®°å½•ä¸ºï¼šä¸€ä¸ªå®ä¾‹ï¼ˆinstanceï¼‰æˆ–æ ·æœ¬ï¼ˆsampleï¼‰ã€‚</li>
<li>ä¾‹å¦‚ï¼šè‰²æ³½æˆ–æ•²å£°ï¼Œå•ä¸ªçš„ç‰¹ç‚¹ä¸ºç‰¹å¾ï¼ˆfeatureï¼‰æˆ–å±æ€§ï¼ˆattributeï¼‰ã€‚</li>
<li>å¯¹äºä¸€æ¡è®°å½•ï¼Œå¦‚æœåœ¨åæ ‡è½´ä¸Šè¡¨ç¤ºï¼Œæ¯ä¸ªè¥¿ç“œéƒ½å¯ä»¥ç”¨åæ ‡è½´ä¸­çš„ä¸€ä¸ªç‚¹è¡¨ç¤ºï¼Œä¸€ä¸ªç‚¹ä¹Ÿæ˜¯ä¸€ä¸ªå‘é‡ï¼Œä¾‹å¦‚ï¼ˆé’ç»¿ï¼Œèœ·ç¼©ï¼ŒæµŠå“ï¼‰ï¼Œå³æ¯ä¸ªè¥¿ç“œä¸ºï¼šä¸€ä¸ªç‰¹å¾å‘é‡ï¼ˆfeature vectorï¼‰ã€‚</li>
<li>ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°ä¸ºï¼šç»´æ•°ï¼ˆdimensionalityï¼‰ï¼Œè¯¥è¥¿ç“œçš„ä¾‹å­ç»´æ•°ä¸º3ï¼Œå½“ç»´æ•°éå¸¸å¤§æ—¶ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨è¯´çš„â€œç»´æ•°ç¾éš¾â€ã€‚</li>
</ul>
<p>è®¡ç®—æœºç¨‹åºå­¦ä¹ ç»éªŒæ•°æ®ç”Ÿæˆç®—æ³•æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€æ¡è®°å½•ç§°ä¸ºä¸€ä¸ªâ€œè®­ç»ƒæ ·æœ¬â€ï¼ŒåŒæ—¶åœ¨è®­ç»ƒå¥½æ¨¡å‹åï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ–°çš„æ ·æœ¬æ¥æµ‹è¯•æ¨¡å‹çš„æ•ˆæœï¼Œåˆ™æ¯ä¸€ä¸ªæ–°çš„æ ·æœ¬ç§°ä¸ºä¸€ä¸ªâ€œæµ‹è¯•æ ·æœ¬â€ã€‚å®šä¹‰ï¼š</p>
<ul>
<li>æ‰€æœ‰è®­ç»ƒæ ·æœ¬çš„é›†åˆä¸ºï¼šè®­ç»ƒé›†ï¼ˆtrainning setï¼‰ï¼Œ[ç‰¹æ®Š]ã€‚</li>
<li>æ‰€æœ‰æµ‹è¯•æ ·æœ¬çš„é›†åˆä¸ºï¼šæµ‹è¯•é›†ï¼ˆtest setï¼‰ï¼Œ[ä¸€èˆ¬]ã€‚</li>
<li>æœºå™¨å­¦ä¹ å‡ºæ¥çš„æ¨¡å‹é€‚ç”¨äºæ–°æ ·æœ¬çš„èƒ½åŠ›ä¸ºï¼šæ³›åŒ–èƒ½åŠ›ï¼ˆgeneralizationï¼‰ï¼Œå³ä»ç‰¹æ®Šåˆ°ä¸€èˆ¬ã€‚</li>
</ul>
<p>è¥¿ç“œçš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ˜¯æƒ³è®¡ç®—æœºé€šè¿‡å­¦ä¹ è¥¿ç“œçš„ç‰¹å¾æ•°æ®ï¼Œè®­ç»ƒå‡ºä¸€ä¸ªå†³ç­–æ¨¡å‹ï¼Œæ¥åˆ¤æ–­ä¸€ä¸ªæ–°çš„è¥¿ç“œæ˜¯å¦æ˜¯å¥½ç“œã€‚å¯ä»¥å¾—çŸ¥æˆ‘ä»¬é¢„æµ‹çš„æ˜¯ï¼šè¥¿ç“œæ˜¯å¥½æ˜¯åï¼Œå³å¥½ç“œä¸å·®ç“œä¸¤ç§ï¼Œæ˜¯ç¦»æ•£å€¼ã€‚åŒæ ·åœ°ï¼Œä¹Ÿæœ‰é€šè¿‡å†å¹´çš„äººå£æ•°æ®ï¼Œæ¥é¢„æµ‹æœªæ¥çš„äººå£æ•°é‡ï¼Œäººå£æ•°é‡åˆ™æ˜¯è¿ç»­å€¼ã€‚å®šä¹‰ï¼š</p>
<ul>
<li>é¢„æµ‹å€¼ä¸ºç¦»æ•£å€¼çš„é—®é¢˜ä¸ºï¼šåˆ†ç±»ï¼ˆclassificationï¼‰ã€‚</li>
<li>é¢„æµ‹å€¼ä¸ºè¿ç»­å€¼çš„é—®é¢˜ä¸ºï¼šå›å½’ï¼ˆregressionï¼‰ã€‚</li>
</ul>
<p>æˆ‘ä»¬é¢„æµ‹è¥¿ç“œæ˜¯å¦æ˜¯å¥½ç“œçš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆæ˜æ˜¾å¯¹äºè®­ç»ƒé›†ä¸­çš„è¥¿ç“œï¼Œæˆ‘ä»¬äº‹å…ˆå·²ç»çŸ¥é“äº†è¯¥ç“œæ˜¯å¦æ˜¯å¥½ç“œï¼Œå­¦ä¹ å™¨é€šè¿‡å­¦ä¹ è¿™äº›å¥½ç“œæˆ–å·®ç“œçš„ç‰¹å¾ï¼Œä»è€Œæ€»ç»“å‡ºè§„å¾‹ï¼Œå³è®­ç»ƒé›†ä¸­çš„è¥¿ç“œæˆ‘ä»¬éƒ½åšäº†æ ‡è®°ï¼Œç§°ä¸ºæ ‡è®°ä¿¡æ¯ã€‚ä½†ä¹Ÿæœ‰æ²¡æœ‰æ ‡è®°ä¿¡æ¯çš„æƒ…å½¢ï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬æƒ³å°†ä¸€å †è¥¿ç“œæ ¹æ®ç‰¹å¾åˆ†æˆä¸¤ä¸ªå°å †ï¼Œä½¿å¾—æŸä¸€å †çš„è¥¿ç“œå°½å¯èƒ½ç›¸ä¼¼ï¼Œå³éƒ½æ˜¯å¥½ç“œæˆ–å·®ç“œï¼Œå¯¹äºè¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬äº‹å…ˆå¹¶ä¸çŸ¥é“è¥¿ç“œçš„å¥½åï¼Œæ ·æœ¬æ²¡æœ‰æ ‡è®°ä¿¡æ¯ã€‚å®šä¹‰ï¼š</p>
<ul>
<li>è®­ç»ƒæ•°æ®æœ‰æ ‡è®°ä¿¡æ¯çš„å­¦ä¹ ä»»åŠ¡ä¸ºï¼šç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰ï¼Œå®¹æ˜“çŸ¥é“ä¸Šé¢æ‰€æè¿°çš„åˆ†ç±»å’Œå›å½’éƒ½æ˜¯ç›‘ç£å­¦ä¹ çš„èŒƒç•´ã€‚</li>
<li>è®­ç»ƒæ•°æ®æ²¡æœ‰æ ‡è®°ä¿¡æ¯çš„å­¦ä¹ ä»»åŠ¡ä¸ºï¼šæ— ç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰ï¼Œå¸¸è§çš„æœ‰èšç±»å’Œå…³è”è§„åˆ™ã€‚</li>
</ul>
<h2 id="äºŒ-æ¨¡å‹çš„è¯„ä¼°ä¸é€‰æ‹©"><a class="header" href="#äºŒ-æ¨¡å‹çš„è¯„ä¼°ä¸é€‰æ‹©"><strong>äºŒï¼ æ¨¡å‹çš„è¯„ä¼°ä¸é€‰æ‹©</strong></a></h2>
<h3 id="21-è¯¯å·®ä¸è¿‡æ‹Ÿåˆ"><a class="header" href="#21-è¯¯å·®ä¸è¿‡æ‹Ÿåˆ"><strong>2.1 è¯¯å·®ä¸è¿‡æ‹Ÿåˆ</strong></a></h3>
<p>æˆ‘ä»¬å°†å­¦ä¹ å™¨å¯¹æ ·æœ¬çš„å®é™…é¢„æµ‹ç»“æœä¸æ ·æœ¬çš„çœŸå®å€¼ä¹‹é—´çš„å·®å¼‚æˆä¸ºï¼šè¯¯å·®ï¼ˆerrorï¼‰ã€‚å®šä¹‰ï¼š</p>
<ul>
<li>åœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®ç§°ä¸ºè®­ç»ƒè¯¯å·®ï¼ˆtraining errorï¼‰æˆ–ç»éªŒè¯¯å·®ï¼ˆempirical errorï¼‰ã€‚</li>
<li>åœ¨æµ‹è¯•é›†ä¸Šçš„è¯¯å·®ç§°ä¸ºæµ‹è¯•è¯¯å·®ï¼ˆtest errorï¼‰ã€‚</li>
<li>å­¦ä¹ å™¨åœ¨æ‰€æœ‰æ–°æ ·æœ¬ä¸Šçš„è¯¯å·®ç§°ä¸ºæ³›åŒ–è¯¯å·®ï¼ˆgeneralization errorï¼‰ã€‚</li>
</ul>
<p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„æ˜¯åœ¨æ–°æ ·æœ¬ä¸Šè¡¨ç°å¾—å¾ˆå¥½çš„å­¦ä¹ å™¨ï¼Œå³æ³›åŒ–è¯¯å·®å°çš„å­¦ä¹ å™¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥è®©å­¦ä¹ å™¨å°½å¯èƒ½åœ°ä»è®­ç»ƒé›†ä¸­å­¦å‡ºæ™®é€‚æ€§çš„â€œä¸€èˆ¬ç‰¹å¾â€ï¼Œè¿™æ ·åœ¨é‡åˆ°æ–°æ ·æœ¬æ—¶æ‰èƒ½åšå‡ºæ­£ç¡®çš„åˆ¤åˆ«ã€‚ç„¶è€Œï¼Œå½“å­¦ä¹ å™¨æŠŠè®­ç»ƒé›†å­¦å¾—â€œå¤ªå¥½â€çš„æ—¶å€™ï¼Œå³æŠŠä¸€äº›è®­ç»ƒæ ·æœ¬çš„è‡ªèº«ç‰¹ç‚¹å½“åšäº†æ™®éç‰¹å¾ï¼›åŒæ—¶ä¹Ÿæœ‰å­¦ä¹ èƒ½åŠ›ä¸è¶³çš„æƒ…å†µï¼Œå³è®­ç»ƒé›†çš„åŸºæœ¬ç‰¹å¾éƒ½æ²¡æœ‰å­¦ä¹ å‡ºæ¥ã€‚æˆ‘ä»¬å®šä¹‰ï¼š</p>
<ul>
<li>å­¦ä¹ èƒ½åŠ›è¿‡å¼ºï¼Œä»¥è‡³äºæŠŠè®­ç»ƒæ ·æœ¬æ‰€åŒ…å«çš„ä¸å¤ªä¸€èˆ¬çš„ç‰¹æ€§éƒ½å­¦åˆ°äº†ï¼Œç§°ä¸ºï¼šè¿‡æ‹Ÿåˆï¼ˆoverfittingï¼‰ã€‚</li>
<li>å­¦ä¹ èƒ½å¤ªå·®ï¼Œè®­ç»ƒæ ·æœ¬çš„ä¸€èˆ¬æ€§è´¨å°šæœªå­¦å¥½ï¼Œç§°ä¸ºï¼šæ¬ æ‹Ÿåˆï¼ˆunderfittingï¼‰ã€‚</li>
</ul>
<p>å¯ä»¥å¾—çŸ¥ï¼šåœ¨è¿‡æ‹Ÿåˆé—®é¢˜ä¸­ï¼Œè®­ç»ƒè¯¯å·®ååˆ†å°ï¼Œä½†æµ‹è¯•è¯¯å·®æ•™å¤§ï¼›åœ¨æ¬ æ‹Ÿåˆé—®é¢˜ä¸­ï¼Œè®­ç»ƒè¯¯å·®å’Œæµ‹è¯•è¯¯å·®éƒ½æ¯”è¾ƒå¤§ã€‚ç›®å‰ï¼Œæ¬ æ‹Ÿåˆé—®é¢˜æ¯”è¾ƒå®¹æ˜“å…‹æœï¼Œä¾‹å¦‚å¢åŠ è¿­ä»£æ¬¡æ•°ç­‰ï¼Œä½†è¿‡æ‹Ÿåˆé—®é¢˜è¿˜æ²¡æœ‰ååˆ†å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œè¿‡æ‹Ÿåˆæ˜¯æœºå™¨å­¦ä¹ é¢ä¸´çš„å…³é”®éšœç¢ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7181172996.png" alt="1" /></p>
<h3 id="22-è¯„ä¼°æ–¹æ³•"><a class="header" href="#22-è¯„ä¼°æ–¹æ³•"><strong>2.2 è¯„ä¼°æ–¹æ³•</strong></a></h3>
<p>åœ¨ç°å®ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€æœ‰å¤šç§ç®—æ³•å¯ä¾›é€‰æ‹©ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªç®—æ³•æ‰æ˜¯æœ€é€‚åˆçš„å‘¢ï¼Ÿå¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„æ˜¯æ³›åŒ–è¯¯å·®å°çš„å­¦ä¹ å™¨ï¼Œç†æƒ³çš„è§£å†³æ–¹æ¡ˆæ˜¯å¯¹æ¨¡å‹çš„æ³›åŒ–è¯¯å·®è¿›è¡Œè¯„ä¼°ï¼Œç„¶åé€‰æ‹©æ³›åŒ–è¯¯å·®æœ€å°çš„é‚£ä¸ªå­¦ä¹ å™¨ã€‚ä½†æ˜¯ï¼Œæ³›åŒ–è¯¯å·®æŒ‡çš„æ˜¯æ¨¡å‹åœ¨æ‰€æœ‰æ–°æ ·æœ¬ä¸Šçš„é€‚ç”¨èƒ½åŠ›ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è·å¾—æ³›åŒ–è¯¯å·®ã€‚</p>
<p>å› æ­¤ï¼Œé€šå¸¸æˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªâ€œæµ‹è¯•é›†â€æ¥æµ‹è¯•å­¦ä¹ å™¨å¯¹æ–°æ ·æœ¬çš„åˆ¤åˆ«èƒ½åŠ›ï¼Œç„¶åä»¥â€œæµ‹è¯•é›†â€ä¸Šçš„â€œæµ‹è¯•è¯¯å·®â€ä½œä¸ºâ€œæ³›åŒ–è¯¯å·®â€çš„è¿‘ä¼¼ã€‚æ˜¾ç„¶ï¼šæˆ‘ä»¬é€‰å–çš„æµ‹è¯•é›†åº”å°½å¯èƒ½ä¸è®­ç»ƒé›†äº’æ–¥ï¼Œä¸‹é¢ç”¨ä¸€ä¸ªå°æ•…äº‹æ¥è§£é‡Šwhyï¼š</p>
<p>å‡è®¾è€å¸ˆå‡ºäº†10 é“ä¹ é¢˜ä¾›åŒå­¦ä»¬ç»ƒä¹ ï¼Œè€ƒè¯•æ—¶è€å¸ˆåˆç”¨åŒæ ·çš„è¿™10é“é¢˜ä½œä¸ºè¯•é¢˜ï¼Œå¯èƒ½æœ‰çš„ç«¥é‹åªä¼šåšè¿™10 é“é¢˜å´èƒ½å¾—é«˜åˆ†ï¼Œå¾ˆæ˜æ˜¾ï¼šè¿™ä¸ªè€ƒè¯•æˆç»©å¹¶ä¸èƒ½æœ‰æ•ˆåœ°åæ˜ å‡ºçœŸå®æ°´å¹³ã€‚å›åˆ°æˆ‘ä»¬çš„é—®é¢˜ä¸Šæ¥ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°æ³›åŒ–æ€§èƒ½å¥½çš„æ¨¡å‹ï¼Œå¥½æ¯”å¸Œæœ›åŒå­¦ä»¬è¯¾ç¨‹å­¦å¾—å¥½å¹¶è·å¾—äº†å¯¹æ‰€å­¦çŸ¥è¯†&quot;ä¸¾ä¸€åä¸‰&quot;çš„èƒ½åŠ›ï¼›è®­ç»ƒæ ·æœ¬ç›¸å½“äºç»™åŒå­¦ä»¬ç»ƒä¹ çš„ä¹ é¢˜ï¼Œæµ‹è¯•è¿‡ç¨‹åˆ™ç›¸å½“äºè€ƒè¯•ã€‚æ˜¾ç„¶ï¼Œè‹¥æµ‹è¯•æ ·æœ¬è¢«ç”¨ä½œè®­ç»ƒäº†ï¼Œåˆ™å¾—åˆ°çš„å°†æ˜¯è¿‡äº&quot;ä¹è§‚&quot;çš„ä¼°è®¡ç»“æœã€‚</p>
<h3 id="23-è®­ç»ƒé›†ä¸æµ‹è¯•é›†çš„åˆ’åˆ†æ–¹æ³•"><a class="header" href="#23-è®­ç»ƒé›†ä¸æµ‹è¯•é›†çš„åˆ’åˆ†æ–¹æ³•"><strong>2.3 è®­ç»ƒé›†ä¸æµ‹è¯•é›†çš„åˆ’åˆ†æ–¹æ³•</strong></a></h3>
<p>å¦‚ä¸Šæ‰€è¿°ï¼šæˆ‘ä»¬å¸Œæœ›ç”¨ä¸€ä¸ªâ€œæµ‹è¯•é›†â€çš„â€œæµ‹è¯•è¯¯å·®â€æ¥ä½œä¸ºâ€œæ³›åŒ–è¯¯å·®â€çš„è¿‘ä¼¼ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹åˆå§‹æ•°æ®é›†è¿›è¡Œæœ‰æ•ˆåˆ’åˆ†ï¼Œåˆ’åˆ†å‡ºäº’æ–¥çš„â€œè®­ç»ƒé›†â€å’Œâ€œæµ‹è¯•é›†â€ã€‚ä¸‹é¢ä»‹ç»å‡ ç§å¸¸ç”¨çš„åˆ’åˆ†æ–¹æ³•ï¼š</p>
<h4 id="231-ç•™å‡ºæ³•"><a class="header" href="#231-ç•™å‡ºæ³•"><strong>2.3.1 ç•™å‡ºæ³•</strong></a></h4>
<p>å°†æ•°æ®é›†Dåˆ’åˆ†ä¸ºä¸¤ä¸ªäº’æ–¥çš„é›†åˆï¼Œä¸€ä¸ªä½œä¸ºè®­ç»ƒé›†Sï¼Œä¸€ä¸ªä½œä¸ºæµ‹è¯•é›†Tï¼Œæ»¡è¶³D=SâˆªTä¸”Sâˆ©T=âˆ…ï¼Œå¸¸è§çš„åˆ’åˆ†ä¸ºï¼šå¤§çº¦2/3-4/5çš„æ ·æœ¬ç”¨ä½œè®­ç»ƒï¼Œå‰©ä¸‹çš„ç”¨ä½œæµ‹è¯•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè®­ç»ƒ/æµ‹è¯•é›†çš„åˆ’åˆ†è¦å°½å¯èƒ½ä¿æŒæ•°æ®åˆ†å¸ƒçš„ä¸€è‡´æ€§ï¼Œä»¥é¿å…ç”±äºåˆ†å¸ƒçš„å·®å¼‚å¼•å…¥é¢å¤–çš„åå·®ï¼Œå¸¸è§çš„åšæ³•æ˜¯é‡‡å–åˆ†å±‚æŠ½æ ·ã€‚åŒæ—¶ï¼Œç”±äºåˆ’åˆ†çš„éšæœºæ€§ï¼Œå•æ¬¡çš„ç•™å‡ºæ³•ç»“æœå¾€å¾€ä¸å¤Ÿç¨³å®šï¼Œä¸€èˆ¬è¦é‡‡ç”¨è‹¥å¹²æ¬¡éšæœºåˆ’åˆ†ï¼Œé‡å¤å®éªŒå–å¹³å‡å€¼çš„åšæ³•ã€‚</p>
<h4 id="232-äº¤å‰éªŒè¯æ³•"><a class="header" href="#232-äº¤å‰éªŒè¯æ³•"><strong>2.3.2 äº¤å‰éªŒè¯æ³•</strong></a></h4>
<p>å°†æ•°æ®é›†Dåˆ’åˆ†ä¸ºkä¸ªå¤§å°ç›¸åŒçš„äº’æ–¥å­é›†ï¼Œæ»¡è¶³D=D1âˆªD2âˆª...âˆªDkï¼ŒDiâˆ©Dj=âˆ…ï¼ˆiâ‰ jï¼‰ï¼ŒåŒæ ·åœ°å°½å¯èƒ½ä¿æŒæ•°æ®åˆ†å¸ƒçš„ä¸€è‡´æ€§ï¼Œå³é‡‡ç”¨åˆ†å±‚æŠ½æ ·çš„æ–¹æ³•è·å¾—è¿™äº›å­é›†ã€‚äº¤å‰éªŒè¯æ³•çš„æ€æƒ³æ˜¯ï¼šæ¯æ¬¡ç”¨k-1ä¸ªå­é›†çš„å¹¶é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œä½™ä¸‹çš„é‚£ä¸ªå­é›†ä½œä¸ºæµ‹è¯•é›†ï¼Œè¿™æ ·å°±æœ‰Kç§è®­ç»ƒé›†/æµ‹è¯•é›†åˆ’åˆ†çš„æƒ…å†µï¼Œä»è€Œå¯è¿›è¡Œkæ¬¡è®­ç»ƒå’Œæµ‹è¯•ï¼Œæœ€ç»ˆè¿”å›kæ¬¡æµ‹è¯•ç»“æœçš„å‡å€¼ã€‚äº¤å‰éªŒè¯æ³•ä¹Ÿç§°â€œkæŠ˜äº¤å‰éªŒè¯â€ï¼Œkæœ€å¸¸ç”¨çš„å–å€¼æ˜¯10ï¼Œä¸‹å›¾ç»™å‡ºäº†10æŠ˜äº¤å‰éªŒè¯çš„ç¤ºæ„å›¾ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc718115d224.png" alt="2" /></p>
<p>ä¸ç•™å‡ºæ³•ç±»ä¼¼ï¼Œå°†æ•°æ®é›†Dåˆ’åˆ†ä¸ºKä¸ªå­é›†çš„è¿‡ç¨‹å…·æœ‰éšæœºæ€§ï¼Œå› æ­¤KæŠ˜äº¤å‰éªŒè¯é€šå¸¸ä¹Ÿè¦é‡å¤pæ¬¡ï¼Œç§°ä¸ºpæ¬¡kæŠ˜äº¤å‰éªŒè¯ï¼Œå¸¸è§çš„æ˜¯10æ¬¡10æŠ˜äº¤å‰éªŒè¯ï¼Œå³è¿›è¡Œäº†100æ¬¡è®­ç»ƒ/æµ‹è¯•ã€‚ç‰¹æ®Šåœ°å½“åˆ’åˆ†çš„kä¸ªå­é›†çš„æ¯ä¸ªå­é›†ä¸­åªæœ‰ä¸€ä¸ªæ ·æœ¬æ—¶ï¼Œç§°ä¸ºâ€œç•™ä¸€æ³•â€ï¼Œæ˜¾ç„¶ï¼Œç•™ä¸€æ³•çš„è¯„ä¼°ç»“æœæ¯”è¾ƒå‡†ç¡®ï¼Œä½†å¯¹è®¡ç®—æœºçš„æ¶ˆè€—ä¹Ÿæ˜¯å·¨å¤§çš„ã€‚</p>
<h4 id="233-è‡ªåŠ©æ³•"><a class="header" href="#233-è‡ªåŠ©æ³•"><strong>2.3.3 è‡ªåŠ©æ³•</strong></a></h4>
<p>æˆ‘ä»¬å¸Œæœ›è¯„ä¼°çš„æ˜¯ç”¨æ•´ä¸ªDè®­ç»ƒå‡ºçš„æ¨¡å‹ã€‚ä½†åœ¨ç•™å‡ºæ³•å’Œäº¤å‰éªŒè¯æ³•ä¸­ï¼Œç”±äºä¿ç•™äº†ä¸€éƒ¨åˆ†æ ·æœ¬ç”¨äºæµ‹è¯•ï¼Œå› æ­¤å®é™…è¯„ä¼°çš„æ¨¡å‹æ‰€ä½¿ç”¨çš„è®­ç»ƒé›†æ¯”Då°ï¼Œè¿™å¿…ç„¶ä¼šå¼•å…¥ä¸€äº›å› è®­ç»ƒæ ·æœ¬è§„æ¨¡ä¸åŒè€Œå¯¼è‡´çš„ä¼°è®¡åå·®ã€‚ç•™ä¸€æ³•å—è®­ç»ƒæ ·æœ¬è§„æ¨¡å˜åŒ–çš„å½±å“è¾ƒå°ï¼Œä½†è®¡ç®—å¤æ‚åº¦åˆå¤ªé«˜äº†ã€‚â€œè‡ªåŠ©æ³•â€æ­£æ˜¯è§£å†³äº†è¿™æ ·çš„é—®é¢˜ã€‚</p>
<p>è‡ªåŠ©æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šç»™å®šåŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†Dï¼Œæ¯æ¬¡éšæœºä»D ä¸­æŒ‘é€‰ä¸€ä¸ªæ ·æœ¬ï¼Œå°†å…¶æ‹·è´æ”¾å…¥D'ï¼Œç„¶åå†å°†è¯¥æ ·æœ¬æ”¾å›åˆå§‹æ•°æ®é›†D ä¸­ï¼Œä½¿å¾—è¯¥æ ·æœ¬åœ¨ä¸‹æ¬¡é‡‡æ ·æ—¶ä»æœ‰å¯èƒ½è¢«é‡‡åˆ°ã€‚é‡å¤æ‰§è¡Œm æ¬¡ï¼Œå°±å¯ä»¥å¾—åˆ°äº†åŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†D'ã€‚å¯ä»¥å¾—çŸ¥åœ¨mæ¬¡é‡‡æ ·ä¸­ï¼Œæ ·æœ¬å§‹ç»ˆä¸è¢«é‡‡åˆ°çš„æ¦‚ç‡å–æé™ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71811246dd.png" alt="3" /></p>
<p>è¿™æ ·ï¼Œé€šè¿‡è‡ªåŠ©é‡‡æ ·ï¼Œåˆå§‹æ ·æœ¬é›†Dä¸­å¤§çº¦æœ‰36.8%çš„æ ·æœ¬æ²¡æœ‰å‡ºç°åœ¨D'ä¸­ï¼Œäºæ˜¯å¯ä»¥å°†D'ä½œä¸ºè®­ç»ƒé›†ï¼ŒD-D'ä½œä¸ºæµ‹è¯•é›†ã€‚è‡ªåŠ©æ³•åœ¨æ•°æ®é›†è¾ƒå°ï¼Œéš¾ä»¥æœ‰æ•ˆåˆ’åˆ†è®­ç»ƒé›†/æµ‹è¯•é›†æ—¶å¾ˆæœ‰ç”¨ï¼Œä½†ç”±äºè‡ªåŠ©æ³•äº§ç”Ÿçš„æ•°æ®é›†ï¼ˆéšæœºæŠ½æ ·ï¼‰æ”¹å˜äº†åˆå§‹æ•°æ®é›†çš„åˆ†å¸ƒï¼Œå› æ­¤å¼•å…¥äº†ä¼°è®¡åå·®ã€‚åœ¨åˆå§‹æ•°æ®é›†è¶³å¤Ÿæ—¶ï¼Œç•™å‡ºæ³•å’Œäº¤å‰éªŒè¯æ³•æ›´åŠ å¸¸ç”¨ã€‚</p>
<h3 id="24-è°ƒå‚"><a class="header" href="#24-è°ƒå‚"><strong>2.4 è°ƒå‚</strong></a></h3>
<p>å¤§å¤šæ•°å­¦ä¹ ç®—æ³•éƒ½æœ‰äº›å‚æ•°(parameter) éœ€è¦è®¾å®šï¼Œå‚æ•°é…ç½®ä¸åŒï¼Œå­¦å¾—æ¨¡å‹çš„æ€§èƒ½å¾€å¾€æœ‰æ˜¾è‘—å·®åˆ«ï¼Œè¿™å°±æ˜¯é€šå¸¸æ‰€è¯´çš„&quot;å‚æ•°è°ƒèŠ‚&quot;æˆ–ç®€ç§°&quot;è°ƒå‚&quot; (parameter tuning)ã€‚</p>
<p>å­¦ä¹ ç®—æ³•çš„å¾ˆå¤šå‚æ•°æ˜¯åœ¨å®æ•°èŒƒå›´å†…å–å€¼ï¼Œå› æ­¤ï¼Œå¯¹æ¯ç§å‚æ•°å–å€¼éƒ½è®­ç»ƒå‡ºæ¨¡å‹æ¥æ˜¯ä¸å¯è¡Œçš„ã€‚å¸¸ç”¨çš„åšæ³•æ˜¯ï¼šå¯¹æ¯ä¸ªå‚æ•°é€‰å®šä¸€ä¸ªèŒƒå›´å’Œæ­¥é•¿Î»ï¼Œè¿™æ ·ä½¿å¾—å­¦ä¹ çš„è¿‡ç¨‹å˜å¾—å¯è¡Œã€‚ä¾‹å¦‚ï¼šå‡å®šç®—æ³•æœ‰3 ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä»…è€ƒè™‘5 ä¸ªå€™é€‰å€¼ï¼Œè¿™æ ·å¯¹æ¯ä¸€ç»„è®­ç»ƒ/æµ‹è¯•é›†å°±æœ‰5<em>5</em>5= 125 ä¸ªæ¨¡å‹éœ€è€ƒå¯Ÿï¼Œç”±æ­¤å¯è§ï¼šæ‹¿ä¸‹ä¸€ä¸ªå‚æ•°ï¼ˆå³ç»éªŒå€¼ï¼‰å¯¹äºç®—æ³•äººå‘˜æ¥è¯´æ˜¯æœ‰å¤šä¹ˆçš„happyã€‚</p>
<p>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“é€‰å®šå¥½æ¨¡å‹å’Œè°ƒå‚å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆå§‹çš„æ•°æ®é›†Dé‡æ–°è®­ç»ƒæ¨¡å‹ï¼Œå³è®©æœ€åˆåˆ’åˆ†å‡ºæ¥ç”¨äºè¯„ä¼°çš„æµ‹è¯•é›†ä¹Ÿè¢«æ¨¡å‹å­¦ä¹ ï¼Œå¢å¼ºæ¨¡å‹çš„å­¦ä¹ æ•ˆæœã€‚ç”¨ä¸Šé¢è€ƒè¯•çš„ä¾‹å­æ¥æ¯”å–»ï¼šå°±åƒé«˜ä¸­æ—¶å¤§å®¶æ¯æ¬¡è€ƒè¯•å®Œï¼Œè¦å°†è€ƒå·çš„é¢˜ç›®æ¶ˆåŒ–æ‰ï¼ˆå¤§å¤šæ•°é¢˜ç›®éƒ½è¿˜æ˜¯ä¹‹å‰æ²¡æœ‰è§è¿‡çš„å§ï¼Ÿï¼‰ï¼Œè¿™æ ·å³ä½¿è€ƒå·®äº†ä¹Ÿèƒ½å¼€å¿ƒçš„ç©è€äº†~</p>
<h3 id="25-æ€§èƒ½åº¦é‡"><a class="header" href="#25-æ€§èƒ½åº¦é‡"><strong>2.5 æ€§èƒ½åº¦é‡</strong></a></h3>
<p>æ€§èƒ½åº¦é‡ï¼ˆperformance measureï¼‰æ˜¯è¡¡é‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„è¯„ä»·æ ‡å‡†ï¼Œåœ¨å¯¹æ¯”ä¸åŒæ¨¡å‹çš„èƒ½åŠ›æ—¶ï¼Œä½¿ç”¨ä¸åŒçš„æ€§èƒ½åº¦é‡å¾€å¾€ä¼šå¯¼è‡´ä¸åŒçš„è¯„åˆ¤ç»“æœã€‚æœ¬èŠ‚é™¤2.5.1å¤–ï¼Œå…¶å®ƒä¸»è¦ä»‹ç»åˆ†ç±»æ¨¡å‹çš„æ€§èƒ½åº¦é‡ã€‚</p>
<h4 id="251-æœ€å¸¸è§çš„æ€§èƒ½åº¦é‡"><a class="header" href="#251-æœ€å¸¸è§çš„æ€§èƒ½åº¦é‡"><strong>2.5.1 æœ€å¸¸è§çš„æ€§èƒ½åº¦é‡</strong></a></h4>
<p>åœ¨å›å½’ä»»åŠ¡ä¸­ï¼Œå³é¢„æµ‹è¿ç»­å€¼çš„é—®é¢˜ï¼Œæœ€å¸¸ç”¨çš„æ€§èƒ½åº¦é‡æ˜¯â€œå‡æ–¹è¯¯å·®â€ï¼ˆmean squared errorï¼‰,å¾ˆå¤šçš„ç»å…¸ç®—æ³•éƒ½æ˜¯é‡‡ç”¨äº†MSEä½œä¸ºè¯„ä»·å‡½æ•°ï¼Œæƒ³å¿…å¤§å®¶éƒ½ååˆ†ç†Ÿæ‚‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf76276.png" alt="1.png" /></p>
<p>åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œå³é¢„æµ‹ç¦»æ•£å€¼çš„é—®é¢˜ï¼Œæœ€å¸¸ç”¨çš„æ˜¯é”™è¯¯ç‡å’Œç²¾åº¦ï¼Œé”™è¯¯ç‡æ˜¯åˆ†ç±»é”™è¯¯çš„æ ·æœ¬æ•°å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ï¼Œç²¾åº¦åˆ™æ˜¯åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬æ•°å æ ·æœ¬æ€»æ•°çš„æ¯”ä¾‹ï¼Œæ˜“çŸ¥ï¼šé”™è¯¯ç‡+ç²¾åº¦=1ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf4c704.png" alt="2.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf6fb84.png" alt="3.png" /></p>
<h4 id="252-æŸ¥å‡†ç‡æŸ¥å…¨ç‡f1"><a class="header" href="#252-æŸ¥å‡†ç‡æŸ¥å…¨ç‡f1"><strong>2.5.2 æŸ¥å‡†ç‡/æŸ¥å…¨ç‡/F1</strong></a></h4>
<p>é”™è¯¯ç‡å’Œç²¾åº¦è™½ç„¶å¸¸ç”¨ï¼Œä½†ä¸èƒ½æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼šåœ¨æ¨èç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒæ¨é€ç»™ç”¨æˆ·çš„å†…å®¹ç”¨æˆ·æ˜¯å¦æ„Ÿå…´è¶£ï¼ˆå³æŸ¥å‡†ç‡ï¼‰ï¼Œæˆ–è€…è¯´æ‰€æœ‰ç”¨æˆ·æ„Ÿå…´è¶£çš„å†…å®¹æˆ‘ä»¬æ¨é€å‡ºæ¥äº†å¤šå°‘ï¼ˆå³æŸ¥å…¨ç‡ï¼‰ã€‚å› æ­¤ï¼Œä½¿ç”¨æŸ¥å‡†/æŸ¥å…¨ç‡æ›´é€‚åˆæè¿°è¿™ç±»é—®é¢˜ã€‚å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œåˆ†ç±»ç»“æœæ··æ·†çŸ©é˜µä¸æŸ¥å‡†/æŸ¥å…¨ç‡å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf885a4.png" alt="4.png" /></p>
<p>åˆæ¬¡æ¥è§¦æ—¶ï¼ŒFNä¸FPå¾ˆéš¾æ­£ç¡®çš„ç†è§£ï¼ŒæŒ‰ç…§æƒ¯æ€§æ€ç»´å®¹æ˜“æŠŠFNç†è§£æˆï¼šFalse-&gt;Negtiveï¼Œå³å°†é”™çš„é¢„æµ‹ä¸ºé”™çš„ï¼Œè¿™æ ·FNå’ŒTNå°±åäº†ï¼Œåæ¥æ‰¾åˆ°ä¸€å¼ å›¾ï¼Œæè¿°å¾—å¾ˆè¯¦ç»†ï¼Œä¸ºæ–¹ä¾¿ç†è§£ï¼ŒæŠŠè¿™å¼ å›¾ä¹Ÿè´´åœ¨äº†ä¸‹è¾¹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf871a6.png" alt="5.png" /></p>
<p>æ­£å¦‚å¤©ä¸‹æ²¡æœ‰å…è´¹çš„åˆé¤ï¼ŒæŸ¥å‡†ç‡å’ŒæŸ¥å…¨ç‡æ˜¯ä¸€å¯¹çŸ›ç›¾çš„åº¦é‡ã€‚ä¾‹å¦‚æˆ‘ä»¬æƒ³è®©æ¨é€çš„å†…å®¹å°½å¯èƒ½ç”¨æˆ·å…¨éƒ½æ„Ÿå…´è¶£ï¼Œé‚£åªèƒ½æ¨é€æˆ‘ä»¬æŠŠæ¡é«˜çš„å†…å®¹ï¼Œè¿™æ ·å°±æ¼æ‰äº†ä¸€äº›ç”¨æˆ·æ„Ÿå…´è¶£çš„å†…å®¹ï¼ŒæŸ¥å…¨ç‡å°±ä½äº†ï¼›å¦‚æœæƒ³è®©ç”¨æˆ·æ„Ÿå…´è¶£çš„å†…å®¹éƒ½è¢«æ¨é€ï¼Œé‚£åªæœ‰å°†æ‰€æœ‰å†…å®¹éƒ½æ¨é€ä¸Šï¼Œå®å¯é”™æ€ä¸€åƒï¼Œä¸å¯æ”¾è¿‡ä¸€ä¸ªï¼Œè¿™æ ·æŸ¥å‡†ç‡å°±å¾ˆä½äº†ã€‚</p>
<p>â€œP-Ræ›²çº¿â€æ­£æ˜¯æè¿°æŸ¥å‡†/æŸ¥å…¨ç‡å˜åŒ–çš„æ›²çº¿ï¼ŒP-Ræ›²çº¿å®šä¹‰å¦‚ä¸‹ï¼šæ ¹æ®å­¦ä¹ å™¨çš„é¢„æµ‹ç»“æœï¼ˆä¸€èˆ¬ä¸ºä¸€ä¸ªå®å€¼æˆ–æ¦‚ç‡ï¼‰å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œæ’åºï¼Œå°†æœ€å¯èƒ½æ˜¯â€œæ­£ä¾‹â€çš„æ ·æœ¬æ’åœ¨å‰é¢ï¼Œæœ€ä¸å¯èƒ½æ˜¯â€œæ­£ä¾‹â€çš„æ’åœ¨åé¢ï¼ŒæŒ‰æ­¤é¡ºåºé€ä¸ªæŠŠæ ·æœ¬ä½œä¸ºâ€œæ­£ä¾‹â€è¿›è¡Œé¢„æµ‹ï¼Œæ¯æ¬¡è®¡ç®—å‡ºå½“å‰çš„På€¼å’ŒRå€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71dafc4411.png" alt="6.png" /></p>
<p>P-Ræ›²çº¿å¦‚ä½•è¯„ä¼°å‘¢ï¼Ÿè‹¥ä¸€ä¸ªå­¦ä¹ å™¨Açš„P-Ræ›²çº¿è¢«å¦ä¸€ä¸ªå­¦ä¹ å™¨Bçš„P-Ræ›²çº¿å®Œå…¨åŒ…ä½ï¼Œåˆ™ç§°ï¼šBçš„æ€§èƒ½ä¼˜äºAã€‚è‹¥Aå’ŒBçš„æ›²çº¿å‘ç”Ÿäº†äº¤å‰ï¼Œåˆ™è°çš„æ›²çº¿ä¸‹çš„é¢ç§¯å¤§ï¼Œè°çš„æ€§èƒ½æ›´ä¼˜ã€‚ä½†ä¸€èˆ¬æ¥è¯´ï¼Œæ›²çº¿ä¸‹çš„é¢ç§¯æ˜¯å¾ˆéš¾è¿›è¡Œä¼°ç®—çš„ï¼Œæ‰€ä»¥è¡ç”Ÿå‡ºäº†â€œå¹³è¡¡ç‚¹â€ï¼ˆBreak-Event Pointï¼Œç®€ç§°BEPï¼‰ï¼Œå³å½“P=Ræ—¶çš„å–å€¼ï¼Œå¹³è¡¡ç‚¹çš„å–å€¼è¶Šé«˜ï¼Œæ€§èƒ½æ›´ä¼˜ã€‚</p>
<p>På’ŒRæŒ‡æ ‡æœ‰æ—¶ä¼šå‡ºç°çŸ›ç›¾çš„æƒ…å†µï¼Œè¿™æ ·å°±éœ€è¦ç»¼åˆè€ƒè™‘ä»–ä»¬ï¼Œæœ€å¸¸è§çš„æ–¹æ³•å°±æ˜¯F-Measureï¼Œåˆç§°F-Scoreã€‚F-Measureæ˜¯På’ŒRçš„åŠ æƒè°ƒå’Œå¹³å‡ï¼Œå³ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf40ff6.png" alt="7.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf75407.png" alt="8.png" /></p>
<p>ç‰¹åˆ«åœ°ï¼Œå½“Î²=1æ—¶ï¼Œä¹Ÿå°±æ˜¯å¸¸è§çš„F1åº¦é‡ï¼Œæ˜¯På’ŒRçš„è°ƒå’Œå¹³å‡ï¼Œå½“F1è¾ƒé«˜æ—¶ï¼Œæ¨¡å‹çš„æ€§èƒ½è¶Šå¥½ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf20885.png" alt="9.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc71daf4b90a.png" alt="10.png" /></p>
<p>æœ‰æ—¶å€™æˆ‘ä»¬ä¼šæœ‰å¤šä¸ªäºŒåˆ†ç±»æ··æ·†çŸ©é˜µï¼Œä¾‹å¦‚ï¼šå¤šæ¬¡è®­ç»ƒæˆ–è€…åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šè®­ç»ƒï¼Œé‚£ä¹ˆä¼°ç®—å…¨å±€æ€§èƒ½çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œåˆ†ä¸ºå®è§‚å’Œå¾®è§‚ã€‚ç®€å•ç†è§£ï¼Œå®è§‚å°±æ˜¯å…ˆç®—å‡ºæ¯ä¸ªæ··æ·†çŸ©é˜µçš„På€¼å’ŒRå€¼ï¼Œç„¶åå–å¾—å¹³å‡På€¼macro-På’Œå¹³å‡Rå€¼macro-Rï¼Œåœ¨ç®—å‡ºFÎ²æˆ–F1ï¼Œè€Œå¾®è§‚åˆ™æ˜¯è®¡ç®—å‡ºæ··æ·†çŸ©é˜µçš„å¹³å‡TPã€FPã€TNã€FNï¼Œæ¥ç€è¿›è¡Œè®¡ç®—Pã€Rï¼Œè¿›è€Œæ±‚å‡ºFÎ²æˆ–F1ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed70230e.png" alt="11.png" /></p>
<h4 id="253-rocä¸auc"><a class="header" href="#253-rocä¸auc"><strong>2.5.3 ROCä¸AUC</strong></a></h4>
<p>å¦‚ä¸Šæ‰€è¿°ï¼šå­¦ä¹ å™¨å¯¹æµ‹è¯•æ ·æœ¬çš„è¯„ä¼°ç»“æœä¸€èˆ¬ä¸ºä¸€ä¸ªå®å€¼æˆ–æ¦‚ç‡ï¼Œè®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œå¤§äºé˜ˆå€¼ä¸ºæ­£ä¾‹ï¼Œå°äºé˜ˆå€¼ä¸ºè´Ÿä¾‹ï¼Œå› æ­¤è¿™ä¸ªå®å€¼çš„å¥½åç›´æ¥å†³å®šäº†å­¦ä¹ å™¨çš„æ³›åŒ–æ€§èƒ½ï¼Œè‹¥å°†è¿™äº›å®å€¼æ’åºï¼Œåˆ™æ’åºçš„å¥½åå†³å®šäº†å­¦ä¹ å™¨çš„æ€§èƒ½é«˜ä½ã€‚ROCæ›²çº¿æ­£æ˜¯ä»è¿™ä¸ªè§’åº¦å‡ºå‘æ¥ç ”ç©¶å­¦ä¹ å™¨çš„æ³›åŒ–æ€§èƒ½ï¼ŒROCæ›²çº¿ä¸P-Ræ›²çº¿ååˆ†ç±»ä¼¼ï¼Œéƒ½æ˜¯æŒ‰ç…§æ’åºçš„é¡ºåºé€ä¸€æŒ‰ç…§æ­£ä¾‹é¢„æµ‹ï¼Œä¸åŒçš„æ˜¯ROCæ›²çº¿ä»¥â€œçœŸæ­£ä¾‹ç‡â€ï¼ˆTrue Positive Rateï¼Œç®€ç§°TPRï¼‰ä¸ºæ¨ªè½´ï¼Œçºµè½´ä¸ºâ€œå‡æ­£ä¾‹ç‡â€ï¼ˆFalse Positive Rateï¼Œç®€ç§°FPRï¼‰ï¼ŒROCåé‡ç ”ç©¶åŸºäºæµ‹è¯•æ ·æœ¬è¯„ä¼°å€¼çš„æ’åºå¥½åã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed6bee91.png" alt="12.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed75cefe.png" alt="13.png" /></p>
<p>ç®€å•åˆ†æå›¾åƒï¼Œå¯ä»¥å¾—çŸ¥ï¼šå½“FN=0æ—¶ï¼ŒTNä¹Ÿå¿…é¡»0ï¼Œåä¹‹ä¹Ÿæˆç«‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”»ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¯•ç€ä½¿ç”¨ä¸åŒçš„æˆªæ–­ç‚¹ï¼ˆå³é˜ˆå€¼ï¼‰å»åˆ†å‰²é˜Ÿåˆ—ï¼Œæ¥åˆ†ææ›²çº¿çš„å½¢çŠ¶ï¼Œï¼ˆ0,0ï¼‰è¡¨ç¤ºå°†æ‰€æœ‰çš„æ ·æœ¬é¢„æµ‹ä¸ºè´Ÿä¾‹ï¼Œï¼ˆ1,1ï¼‰åˆ™è¡¨ç¤ºå°†æ‰€æœ‰çš„æ ·æœ¬é¢„æµ‹ä¸ºæ­£ä¾‹ï¼Œï¼ˆ0,1ï¼‰è¡¨ç¤ºæ­£ä¾‹å…¨éƒ¨å‡ºç°åœ¨è´Ÿä¾‹ä¹‹å‰çš„ç†æƒ³æƒ…å†µï¼Œï¼ˆ1,0ï¼‰åˆ™è¡¨ç¤ºè´Ÿä¾‹å…¨éƒ¨å‡ºç°åœ¨æ­£ä¾‹ä¹‹å‰çš„æœ€å·®æƒ…å†µã€‚é™äºç¯‡å¹…ï¼Œè¿™é‡Œä¸å†è®ºè¿°ã€‚</p>
<p>ç°å®ä¸­çš„ä»»åŠ¡é€šå¸¸éƒ½æ˜¯æœ‰é™ä¸ªæµ‹è¯•æ ·æœ¬ï¼Œå› æ­¤åªèƒ½ç»˜åˆ¶å‡ºè¿‘ä¼¼ROCæ›²çº¿ã€‚ç»˜åˆ¶æ–¹æ³•ï¼šé¦–å…ˆæ ¹æ®æµ‹è¯•æ ·æœ¬çš„è¯„ä¼°å€¼å¯¹æµ‹è¯•æ ·æœ¬æ’åºï¼Œæ¥ç€æŒ‰ç…§ä»¥ä¸‹è§„åˆ™è¿›è¡Œç»˜åˆ¶ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed740a24.png" alt="14.png" /></p>
<p>åŒæ ·åœ°ï¼Œè¿›è¡Œæ¨¡å‹çš„æ€§èƒ½æ¯”è¾ƒæ—¶ï¼Œè‹¥ä¸€ä¸ªå­¦ä¹ å™¨Açš„ROCæ›²çº¿è¢«å¦ä¸€ä¸ªå­¦ä¹ å™¨Bçš„ROCæ›²çº¿å®Œå…¨åŒ…ä½ï¼Œåˆ™ç§°Bçš„æ€§èƒ½ä¼˜äºAã€‚è‹¥Aå’ŒBçš„æ›²çº¿å‘ç”Ÿäº†äº¤å‰ï¼Œåˆ™è°çš„æ›²çº¿ä¸‹çš„é¢ç§¯å¤§ï¼Œè°çš„æ€§èƒ½æ›´ä¼˜ã€‚ROCæ›²çº¿ä¸‹çš„é¢ç§¯å®šä¹‰ä¸ºAUCï¼ˆArea Uder ROC Curveï¼‰ï¼Œä¸åŒäºP-Rçš„æ˜¯ï¼Œè¿™é‡Œçš„AUCæ˜¯å¯ä¼°ç®—çš„ï¼Œå³AOCæ›²çº¿ä¸‹æ¯ä¸€ä¸ªå°çŸ©å½¢çš„é¢ç§¯ä¹‹å’Œã€‚æ˜“çŸ¥ï¼šAUCè¶Šå¤§ï¼Œè¯æ˜æ’åºçš„è´¨é‡è¶Šå¥½ï¼ŒAUCä¸º1æ—¶ï¼Œè¯æ˜æ‰€æœ‰æ­£ä¾‹æ’åœ¨äº†è´Ÿä¾‹çš„å‰é¢ï¼ŒAUCä¸º0æ—¶ï¼Œæ‰€æœ‰çš„è´Ÿä¾‹æ’åœ¨äº†æ­£ä¾‹çš„å‰é¢ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed6e2c57.png" alt="15.png" /></p>
<h4 id="254-ä»£ä»·æ•æ„Ÿé”™è¯¯ç‡ä¸ä»£ä»·æ›²çº¿"><a class="header" href="#254-ä»£ä»·æ•æ„Ÿé”™è¯¯ç‡ä¸ä»£ä»·æ›²çº¿"><strong>2.5.4 ä»£ä»·æ•æ„Ÿé”™è¯¯ç‡ä¸ä»£ä»·æ›²çº¿</strong></a></h4>
<p>ä¸Šé¢çš„æ–¹æ³•ä¸­ï¼Œå°†å­¦ä¹ å™¨çš„çŠ¯é”™åŒç­‰å¯¹å¾…ï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå°†æ­£ä¾‹é¢„æµ‹æˆå‡ä¾‹ä¸å°†å‡ä¾‹é¢„æµ‹æˆæ­£ä¾‹çš„ä»£ä»·å¸¸å¸¸æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¾‹å¦‚ï¼šå°†æ— ç–¾ç—…--&gt;æœ‰ç–¾ç—…åªæ˜¯å¢å¤šäº†æ£€æŸ¥ï¼Œä½†æœ‰ç–¾ç—…--&gt;æ— ç–¾ç—…å´æ˜¯å¢åŠ äº†ç”Ÿå‘½å±é™©ã€‚ä»¥äºŒåˆ†ç±»ä¸ºä¾‹ï¼Œç”±æ­¤å¼•å…¥äº†â€œä»£ä»·çŸ©é˜µâ€ï¼ˆcost matrixï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed6ed582.png" alt="16.png" /></p>
<p>åœ¨éå‡ç­‰é”™è¯¯ä»£ä»·ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯æœ€å°åŒ–â€œæ€»ä½“ä»£ä»·â€ï¼Œè¿™æ ·â€œä»£ä»·æ•æ„Ÿâ€çš„é”™è¯¯ç‡ï¼ˆ2.5.1èŠ‚ä»‹ç»ï¼‰ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed70bebe.png" alt="17.png" /></p>
<p>åŒæ ·å¯¹äºROCæ›²çº¿ï¼Œåœ¨éå‡ç­‰é”™è¯¯ä»£ä»·ä¸‹ï¼Œæ¼”å˜æˆäº†â€œä»£ä»·æ›²çº¿â€ï¼Œä»£ä»·æ›²çº¿æ¨ªè½´æ˜¯å–å€¼åœ¨[0,1]ä¹‹é—´çš„æ­£ä¾‹æ¦‚ç‡ä»£ä»·ï¼Œå¼ä¸­pè¡¨ç¤ºæ­£ä¾‹çš„æ¦‚ç‡ï¼Œçºµè½´æ˜¯å–å€¼ä¸º[0,1]çš„å½’ä¸€åŒ–ä»£ä»·ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed6e952e.png" alt="18.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed6eee7b.png" alt="19.png" /></p>
<p>ä»£ä»·æ›²çº¿çš„ç»˜åˆ¶å¾ˆç®€å•ï¼šè®¾ROCæ›²çº¿ä¸Šä¸€ç‚¹çš„åæ ‡ä¸º(TPRï¼ŒFPR) ï¼Œåˆ™å¯ç›¸åº”è®¡ç®—å‡ºFNRï¼Œç„¶ååœ¨ä»£ä»·å¹³é¢ä¸Šç»˜åˆ¶ä¸€æ¡ä»(0ï¼ŒFPR) åˆ°(1ï¼ŒFNR) çš„çº¿æ®µï¼Œçº¿æ®µä¸‹çš„é¢ç§¯å³è¡¨ç¤ºäº†è¯¥æ¡ä»¶ä¸‹çš„æœŸæœ›æ€»ä½“ä»£ä»·ï¼›å¦‚æ­¤å°†ROC æ›²çº¿åœŸçš„æ¯ä¸ªç‚¹è½¬åŒ–ä¸ºä»£ä»·å¹³é¢ä¸Šçš„ä¸€æ¡çº¿æ®µï¼Œç„¶åå–æ‰€æœ‰çº¿æ®µçš„ä¸‹ç•Œï¼Œå›´æˆçš„é¢ç§¯å³ä¸ºåœ¨æ‰€æœ‰æ¡ä»¶ä¸‹å­¦ä¹ å™¨çš„æœŸæœ›æ€»ä½“ä»£ä»·ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc71ed716e0d.png" alt="20.png" /></p>
<p>åœ¨æ­¤æ¨¡å‹çš„æ€§èƒ½åº¦é‡æ–¹æ³•å°±ä»‹ç»å®Œäº†ï¼Œä»¥å‰ä¸€ç›´ä»¥ä¸ºå‡æ–¹è¯¯å·®å’Œç²¾å‡†åº¦å°±å¯ä»¥äº†ï¼Œç°åœ¨æ‰å‘ç°å¤©ç©ºå¦‚æ­¤å¹¿é˜”~</p>
<h3 id="26-æ¯”è¾ƒæ£€éªŒ"><a class="header" href="#26-æ¯”è¾ƒæ£€éªŒ"><strong>2.6 æ¯”è¾ƒæ£€éªŒ</strong></a></h3>
<p>åœ¨æ¯”è¾ƒå­¦ä¹ å™¨æ³›åŒ–æ€§èƒ½çš„è¿‡ç¨‹ä¸­ï¼Œç»Ÿè®¡å‡è®¾æ£€éªŒï¼ˆhypothesis testï¼‰ä¸ºå­¦ä¹ å™¨æ€§èƒ½æ¯”è¾ƒæä¾›äº†é‡è¦ä¾æ®ï¼Œå³è‹¥Aåœ¨æŸæµ‹è¯•é›†ä¸Šçš„æ€§èƒ½ä¼˜äºBï¼Œé‚£Aå­¦ä¹ å™¨æ¯”Bå¥½çš„æŠŠæ¡æœ‰å¤šå¤§ã€‚ ä¸ºæ–¹ä¾¿è®ºè¿°ï¼Œæœ¬ç¯‡ä¸­éƒ½æ˜¯ä»¥â€œé”™è¯¯ç‡â€ä½œä¸ºæ€§èƒ½åº¦é‡çš„æ ‡å‡†ã€‚</p>
<h4 id="261-å‡è®¾æ£€éªŒ"><a class="header" href="#261-å‡è®¾æ£€éªŒ"><strong>2.6.1 å‡è®¾æ£€éªŒ</strong></a></h4>
<p>â€œå‡è®¾â€æŒ‡çš„æ˜¯å¯¹æ ·æœ¬æ€»ä½“çš„åˆ†å¸ƒæˆ–å·²çŸ¥åˆ†å¸ƒä¸­æŸä¸ªå‚æ•°å€¼çš„ä¸€ç§çŒœæƒ³ï¼Œä¾‹å¦‚ï¼šå‡è®¾æ€»ä½“æœä»æ³Šæ¾åˆ†å¸ƒï¼Œæˆ–å‡è®¾æ­£æ€æ€»ä½“çš„æœŸæœ›u=u0ã€‚å›åˆ°æœ¬ç¯‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æµ‹è¯•è·å¾—æµ‹è¯•é”™è¯¯ç‡ï¼Œä½†ç›´è§‚ä¸Šæµ‹è¯•é”™è¯¯ç‡å’Œæ³›åŒ–é”™è¯¯ç‡ç›¸å·®ä¸ä¼šå¤ªè¿œï¼Œå› æ­¤å¯ä»¥é€šè¿‡æµ‹è¯•é”™è¯¯ç‡æ¥æ¨æµ‹æ³›åŒ–é”™è¯¯ç‡çš„åˆ†å¸ƒï¼Œè¿™å°±æ˜¯ä¸€ç§å‡è®¾æ£€éªŒã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211aed8e3.png" alt="1.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a5817d.png" alt="2.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a336b5.png" alt="3.png" /></p>
<h4 id="262-äº¤å‰éªŒè¯tæ£€éªŒ"><a class="header" href="#262-äº¤å‰éªŒè¯tæ£€éªŒ"><strong>2.6.2 äº¤å‰éªŒè¯tæ£€éªŒ</strong></a></h4>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a68ef9.png" alt="4.png" /></p>
<h4 id="263-mcnemaræ£€éªŒ"><a class="header" href="#263-mcnemaræ£€éªŒ"><strong>2.6.3 McNemaræ£€éªŒ</strong></a></h4>
<p>MaNemarä¸»è¦ç”¨äºäºŒåˆ†ç±»é—®é¢˜ï¼Œä¸æˆå¯¹tæ£€éªŒä¸€æ ·ä¹Ÿæ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­¦ä¹ å™¨çš„æ€§èƒ½å¤§å°ã€‚ä¸»è¦æ€æƒ³æ˜¯ï¼šè‹¥ä¸¤å­¦ä¹ å™¨çš„æ€§èƒ½ç›¸åŒï¼Œåˆ™Aé¢„æµ‹æ­£ç¡®Bé¢„æµ‹é”™è¯¯æ•°åº”ç­‰äºBé¢„æµ‹é”™è¯¯Aé¢„æµ‹æ­£ç¡®æ•°ï¼Œå³e01=e10ï¼Œä¸”|e01-e10|æœä»Nï¼ˆ1ï¼Œe01+e10ï¼‰åˆ†å¸ƒã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a2c7f9.png" alt="5.png" /></p>
<p>å› æ­¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„å˜é‡æœä»è‡ªç”±åº¦ä¸º1çš„å¡æ–¹åˆ†å¸ƒï¼Œå³æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒNï¼ˆ0,1ï¼‰çš„éšæœºå˜é‡çš„å¹³æ–¹å’Œï¼Œä¸‹å¼åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œæ•…è‡ªç”±åº¦ä¸º1ï¼Œæ£€éªŒçš„æ–¹æ³•åŒä¸Šï¼šåšå‡ºå‡è®¾--&gt;æ±‚å‡ºæ»¡è¶³æ˜¾è‘—åº¦çš„ä¸´ç•Œç‚¹--&gt;ç»™å‡ºæ‹’ç»åŸŸ--&gt;éªŒè¯å‡è®¾ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a34e96.png" alt="6.png" /></p>
<h4 id="264-friedmanæ£€éªŒä¸nemenyiåç»­æ£€éªŒ"><a class="header" href="#264-friedmanæ£€éªŒä¸nemenyiåç»­æ£€éªŒ"><strong>2.6.4 Friedmanæ£€éªŒä¸Nemenyiåç»­æ£€éªŒ</strong></a></h4>
<p>ä¸Šè¿°çš„ä¸‰ç§æ£€éªŒéƒ½åªèƒ½åœ¨ä¸€ç»„æ•°æ®é›†ä¸Šï¼ŒFæ£€éªŒåˆ™å¯ä»¥åœ¨å¤šç»„æ•°æ®é›†è¿›è¡Œå¤šä¸ªå­¦ä¹ å™¨æ€§èƒ½çš„æ¯”è¾ƒï¼ŒåŸºæœ¬æ€æƒ³æ˜¯åœ¨åŒä¸€ç»„æ•°æ®é›†ä¸Šï¼Œæ ¹æ®æµ‹è¯•ç»“æœï¼ˆä¾‹ï¼šæµ‹è¯•é”™è¯¯ç‡ï¼‰å¯¹å­¦ä¹ å™¨çš„æ€§èƒ½è¿›è¡Œæ’åºï¼Œèµ‹äºˆåºå€¼1,2,3...ï¼Œç›¸åŒåˆ™å¹³åˆ†åºå€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a2db45.png" alt="7.png" /></p>
<p>è‹¥å­¦ä¹ å™¨çš„æ€§èƒ½ç›¸åŒï¼Œåˆ™å®ƒä»¬çš„å¹³å‡åºå€¼åº”è¯¥ç›¸åŒï¼Œä¸”ç¬¬iä¸ªç®—æ³•çš„å¹³å‡åºå€¼riæœä»æ­£æ€åˆ†å¸ƒNï¼ˆï¼ˆk+1ï¼‰/2ï¼Œï¼ˆk+1ï¼‰(k-1)/12ï¼‰ï¼Œåˆ™æœ‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a45349.png" alt="8.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a2684c.png" alt="9.png" /></p>
<p>æœä»è‡ªç”±åº¦ä¸ºk-1å’Œ(k-1)(N-1)çš„Fåˆ†å¸ƒã€‚ä¸‹é¢æ˜¯Fæ£€éªŒå¸¸ç”¨çš„ä¸´ç•Œå€¼ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7211a7e3f0.png" alt="10.png" /></p>
<p>è‹¥â€œH0ï¼šæ‰€æœ‰ç®—æ³•çš„æ€§èƒ½ç›¸åŒâ€è¿™ä¸ªå‡è®¾è¢«æ‹’ç»ï¼Œåˆ™éœ€è¦è¿›è¡Œåç»­æ£€éªŒï¼Œæ¥å¾—åˆ°å…·ä½“çš„ç®—æ³•ä¹‹é—´çš„å·®å¼‚ã€‚å¸¸ç”¨çš„å°±æ˜¯Nemenyiåç»­æ£€éªŒã€‚Nemenyiæ£€éªŒè®¡ç®—å‡ºå¹³å‡åºå€¼å·®åˆ«çš„ä¸´ç•Œå€¼åŸŸï¼Œä¸‹è¡¨æ˜¯å¸¸ç”¨çš„qaå€¼ï¼Œè‹¥ä¸¤ä¸ªç®—æ³•çš„å¹³å‡åºå€¼å·®è¶…å‡ºäº†ä¸´ç•Œå€¼åŸŸCDï¼Œåˆ™ç›¸åº”çš„ç½®ä¿¡åº¦1-Î±æ‹’ç»â€œä¸¤ä¸ªç®—æ³•æ€§èƒ½ç›¸åŒâ€çš„å‡è®¾ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722232932b.png" alt="11.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc7222348519.png" alt="12.png" /></p>
<h3 id="27-åå·®ä¸æ–¹å·®"><a class="header" href="#27-åå·®ä¸æ–¹å·®"><strong>2.7 åå·®ä¸æ–¹å·®</strong></a></h3>
<p>åå·®-æ–¹å·®åˆ†è§£æ˜¯è§£é‡Šå­¦ä¹ å™¨æ³›åŒ–æ€§èƒ½çš„é‡è¦å·¥å…·ã€‚åœ¨å­¦ä¹ ç®—æ³•ä¸­ï¼Œåå·®æŒ‡çš„æ˜¯é¢„æµ‹çš„æœŸæœ›å€¼ä¸çœŸå®å€¼çš„åå·®ï¼Œæ–¹å·®åˆ™æ˜¯æ¯ä¸€æ¬¡é¢„æµ‹å€¼ä¸é¢„æµ‹å€¼å¾—æœŸæœ›ä¹‹é—´çš„å·®å‡æ–¹ã€‚å®é™…ä¸Šï¼Œåå·®ä½“ç°äº†å­¦ä¹ å™¨é¢„æµ‹çš„å‡†ç¡®åº¦ï¼Œè€Œæ–¹å·®ä½“ç°äº†å­¦ä¹ å™¨é¢„æµ‹çš„ç¨³å®šæ€§ã€‚é€šè¿‡å¯¹æ³›åŒ–è¯¯å·®çš„è¿›è¡Œåˆ†è§£ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<ul>
<li><strong>æœŸæœ›æ³›åŒ–è¯¯å·®=æ–¹å·®+åå·®</strong></li>
<li><strong>åå·®åˆ»ç”»å­¦ä¹ å™¨çš„æ‹Ÿåˆèƒ½åŠ›</strong></li>
<li><strong>æ–¹å·®ä½“ç°å­¦ä¹ å™¨çš„ç¨³å®šæ€§</strong></li>
</ul>
<p>æ˜“çŸ¥ï¼šæ–¹å·®å’Œåå·®å…·æœ‰çŸ›ç›¾æ€§ï¼Œè¿™å°±æ˜¯å¸¸è¯´çš„åå·®-æ–¹å·®çª˜å¢ƒï¼ˆbias-variance dilammaï¼‰ï¼Œéšç€è®­ç»ƒç¨‹åº¦çš„æå‡ï¼ŒæœŸæœ›é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®å¼‚è¶Šæ¥è¶Šå°ï¼Œå³åå·®è¶Šæ¥è¶Šå°ï¼Œä½†æ˜¯å¦ä¸€æ–¹é¢ï¼Œéšç€è®­ç»ƒç¨‹åº¦åŠ å¤§ï¼Œå­¦ä¹ ç®—æ³•å¯¹æ•°æ®é›†çš„æ³¢åŠ¨è¶Šæ¥è¶Šæ•æ„Ÿï¼Œæ–¹å·®å€¼è¶Šæ¥è¶Šå¤§ã€‚æ¢å¥è¯è¯´ï¼šåœ¨æ¬ æ‹Ÿåˆæ—¶ï¼Œåå·®ä¸»å¯¼æ³›åŒ–è¯¯å·®ï¼Œè€Œè®­ç»ƒåˆ°ä¸€å®šç¨‹åº¦åï¼Œåå·®è¶Šæ¥è¶Šå°ï¼Œæ–¹å·®ä¸»å¯¼äº†æ³›åŒ–è¯¯å·®ã€‚å› æ­¤è®­ç»ƒä¹Ÿä¸è¦è´ªæ¯ï¼Œé€‚åº¦è¾„æ­¢ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722234b09f.png" alt="13.png" /></p>
<h2 id="ä¸‰-çº¿æ€§æ¨¡å‹"><a class="header" href="#ä¸‰-çº¿æ€§æ¨¡å‹"><strong>ä¸‰ï¼ çº¿æ€§æ¨¡å‹</strong></a></h2>
<p>è°ˆåŠçº¿æ€§æ¨¡å‹ï¼Œå…¶å®æˆ‘ä»¬å¾ˆæ—©å°±å·²ç»ä¸å®ƒæ‰“è¿‡äº¤é“ï¼Œè¿˜è®°å¾—é«˜ä¸­æ•°å­¦å¿…ä¿®3è¯¾æœ¬ä¸­é‚£ä¸ªé¡½çš®çš„â€œæœ€å°äºŒä¹˜æ³•â€å—ï¼Ÿè¿™å°±æ˜¯çº¿æ€§æ¨¡å‹çš„ç»å…¸ç®—æ³•ä¹‹ä¸€ï¼šæ ¹æ®ç»™å®šçš„ï¼ˆxï¼Œyï¼‰ç‚¹å¯¹ï¼Œæ±‚å‡ºä¸€æ¡ä¸è¿™äº›ç‚¹æ‹Ÿåˆæ•ˆæœæœ€å¥½çš„ç›´çº¿y=ax+bï¼Œä¹‹å‰æˆ‘ä»¬åˆ©ç”¨ä¸‹é¢çš„å…¬å¼ä¾¿å¯ä»¥è®¡ç®—å‡ºæ‹Ÿåˆç›´çº¿çš„ç³»æ•°a,bï¼ˆ3.1ä¸­ç»™å‡ºäº†å…·ä½“çš„è®¡ç®—è¿‡ç¨‹ï¼‰ï¼Œä»è€Œå¯¹äºä¸€ä¸ªæ–°çš„xï¼Œå¯ä»¥é¢„æµ‹å®ƒæ‰€å¯¹åº”çš„yå€¼ã€‚å‰é¢æˆ‘ä»¬æåˆ°ï¼šåœ¨æœºå™¨å­¦ä¹ çš„æœ¯è¯­ä¸­ï¼Œå½“é¢„æµ‹å€¼ä¸ºè¿ç»­å€¼æ—¶ï¼Œç§°ä¸ºâ€œå›å½’é—®é¢˜â€ï¼Œç¦»æ•£å€¼æ—¶ä¸ºâ€œåˆ†ç±»é—®é¢˜â€ã€‚æœ¬ç¯‡å…ˆä»çº¿æ€§å›å½’ä»»åŠ¡å¼€å§‹ï¼Œæ¥ç€è®¨è®ºåˆ†ç±»å’Œå¤šåˆ†ç±»é—®é¢˜ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b068e48.png" alt="1.png" /></p>
<h3 id="31-çº¿æ€§å›å½’"><a class="header" href="#31-çº¿æ€§å›å½’"><strong>3.1 çº¿æ€§å›å½’</strong></a></h3>
<p>çº¿æ€§å›å½’é—®é¢˜å°±æ˜¯è¯•å›¾å­¦åˆ°ä¸€ä¸ªçº¿æ€§æ¨¡å‹å°½å¯èƒ½å‡†ç¡®åœ°é¢„æµ‹æ–°æ ·æœ¬çš„è¾“å‡ºå€¼ï¼Œä¾‹å¦‚ï¼šé€šè¿‡å†å¹´çš„äººå£æ•°æ®é¢„æµ‹2017å¹´äººå£æ•°é‡ã€‚åœ¨è¿™ç±»é—®é¢˜ä¸­ï¼Œå¾€å¾€æˆ‘ä»¬ä¼šå…ˆå¾—åˆ°ä¸€ç³»åˆ—çš„æœ‰æ ‡è®°æ•°æ®ï¼Œä¾‹å¦‚ï¼š2000--&gt;13äº¿...2016--&gt;15äº¿ï¼Œè¿™æ—¶è¾“å…¥çš„å±æ€§åªæœ‰ä¸€ä¸ªï¼Œå³å¹´ä»½ï¼›ä¹Ÿæœ‰è¾“å…¥å¤šå±æ€§çš„æƒ…å½¢ï¼Œå‡è®¾æˆ‘ä»¬é¢„æµ‹ä¸€ä¸ªäººçš„æ”¶å…¥ï¼Œè¿™æ—¶è¾“å…¥çš„å±æ€§å€¼å°±ä¸æ­¢ä¸€ä¸ªäº†ï¼Œä¾‹å¦‚ï¼šï¼ˆå­¦å†ï¼Œå¹´é¾„ï¼Œæ€§åˆ«ï¼Œé¢œå€¼ï¼Œèº«é«˜ï¼Œä½“é‡ï¼‰--&gt;15kã€‚</p>
<p>æœ‰æ—¶è¿™äº›è¾“å…¥çš„å±æ€§å€¼å¹¶ä¸èƒ½ç›´æ¥è¢«æˆ‘ä»¬çš„å­¦ä¹ æ¨¡å‹æ‰€ç”¨ï¼Œéœ€è¦è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œå¯¹äºè¿ç»­å€¼çš„å±æ€§ï¼Œä¸€èˆ¬éƒ½å¯ä»¥è¢«å­¦ä¹ å™¨æ‰€ç”¨ï¼Œæœ‰æ—¶ä¼šæ ¹æ®å…·ä½“çš„æƒ…å½¢ä½œç›¸åº”çš„é¢„å¤„ç†ï¼Œä¾‹å¦‚ï¼šå½’ä¸€åŒ–ç­‰ï¼›å¯¹äºç¦»æ•£å€¼çš„å±æ€§ï¼Œå¯ä½œä¸‹é¢çš„å¤„ç†ï¼š</p>
<ul>
<li>
<p>è‹¥å±æ€§å€¼ä¹‹é—´å­˜åœ¨â€œåºå…³ç³»â€ï¼Œåˆ™å¯ä»¥å°†å…¶è½¬åŒ–ä¸ºè¿ç»­å€¼ï¼Œä¾‹å¦‚ï¼šèº«é«˜å±æ€§åˆ†ä¸ºâ€œé«˜â€â€œä¸­ç­‰â€â€œçŸ®â€ï¼Œå¯è½¬åŒ–ä¸ºæ•°å€¼ï¼š{1ï¼Œ 0.5ï¼Œ 0}ã€‚</p>
</li>
<li>
<p>è‹¥å±æ€§å€¼ä¹‹é—´ä¸å­˜åœ¨â€œåºå…³ç³»â€ï¼Œåˆ™é€šå¸¸å°†å…¶è½¬åŒ–ä¸ºå‘é‡çš„å½¢å¼ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å±æ€§åˆ†ä¸ºâ€œç”·â€â€œå¥³â€ï¼Œå¯è½¬åŒ–ä¸ºäºŒç»´å‘é‡ï¼š{ï¼ˆ1ï¼Œ0ï¼‰ï¼Œï¼ˆ0ï¼Œ1ï¼‰}ã€‚</p>
</li>
</ul>
<p>ï¼ˆ1ï¼‰å½“è¾“å…¥å±æ€§åªæœ‰ä¸€ä¸ªçš„æ—¶å€™ï¼Œå°±æ˜¯æœ€ç®€å•çš„æƒ…å½¢ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é«˜ä¸­æ—¶æœ€ç†Ÿæ‚‰çš„â€œæœ€å°äºŒä¹˜æ³•â€ï¼ˆEuclidean distanceï¼‰ï¼Œé¦–å…ˆè®¡ç®—å‡ºæ¯ä¸ªæ ·æœ¬é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®å¹¶æ±‚å’Œï¼Œé€šè¿‡æœ€å°åŒ–å‡æ–¹è¯¯å·®MSEï¼Œä½¿ç”¨æ±‚åå¯¼ç­‰äºé›¶çš„æ–¹æ³•è®¡ç®—å‡ºæ‹Ÿåˆç›´çº¿y=wx+bçš„ä¸¤ä¸ªå‚æ•°wå’Œbï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0ccec4.png" alt="2.png" /></p>
<p>ï¼ˆ2ï¼‰å½“è¾“å…¥å±æ€§æœ‰å¤šä¸ªçš„æ—¶å€™ï¼Œä¾‹å¦‚å¯¹äºä¸€ä¸ªæ ·æœ¬æœ‰dä¸ªå±æ€§{ï¼ˆx1,x2...xdï¼‰,y}ï¼Œåˆ™y=wx+béœ€è¦å†™æˆï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72567b8bcd.png" alt="0.png" /></p>
<p>é€šå¸¸å¯¹äºå¤šå…ƒé—®é¢˜ï¼Œå¸¸å¸¸ä½¿ç”¨çŸ©é˜µçš„å½¢å¼æ¥è¡¨ç¤ºæ•°æ®ã€‚åœ¨æœ¬é—®é¢˜ä¸­ï¼Œå°†å…·æœ‰mä¸ªæ ·æœ¬çš„æ•°æ®é›†è¡¨ç¤ºæˆçŸ©é˜µXï¼Œå°†ç³»æ•°wä¸båˆå¹¶æˆä¸€ä¸ªåˆ—å‘é‡ï¼Œè¿™æ ·æ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ä»¥åŠæ‰€æœ‰æ ·æœ¬çš„å‡æ–¹è¯¯å·®æœ€å°åŒ–å°±å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0ad8f7.png" alt="3.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0af652.png" alt="4.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b090543.png" alt="5.png" /></p>
<p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å°äºŒä¹˜æ³•å¯¹wå’Œbè¿›è¡Œä¼°è®¡ï¼Œä»¤å‡æ–¹è¯¯å·®çš„æ±‚å¯¼ç­‰äº0ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä¸€ä¸ªçŸ©é˜µçš„è¡Œåˆ—å¼ä¸ç­‰äº0æ—¶ï¼Œæˆ‘ä»¬æ‰å¯èƒ½å¯¹å…¶æ±‚é€†ï¼Œå› æ­¤å¯¹äºä¸‹å¼ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çŸ©é˜µï¼ˆXçš„è½¬ç½®*Xï¼‰çš„è¡Œåˆ—å¼æ˜¯å¦ä¸º0ï¼Œè‹¥ä¸ä¸º0ï¼Œåˆ™å¯ä»¥æ±‚å‡ºå…¶è§£ï¼Œè‹¥ä¸º0ï¼Œåˆ™éœ€è¦ä½¿ç”¨å…¶å®ƒçš„æ–¹æ³•è¿›è¡Œè®¡ç®—ï¼Œä¹¦ä¸­æåˆ°äº†å¼•å…¥æ­£åˆ™åŒ–ï¼Œæ­¤å¤„ä¸è¿›è¡Œæ·±å…¥ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0cde33.png" alt="6.png" /></p>
<p>å¦ä¸€æ–¹é¢ï¼Œæœ‰æ—¶åƒä¸Šé¢è¿™ç§åŸå§‹çš„çº¿æ€§å›å½’å¯èƒ½å¹¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œä¾‹å¦‚ï¼šyå€¼å¹¶ä¸æ˜¯çº¿æ€§å˜åŒ–ï¼Œè€Œæ˜¯åœ¨æŒ‡æ•°å°ºåº¦ä¸Šå˜åŒ–ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨çº¿æ€§æ¨¡å‹æ¥é€¼è¿‘yçš„è¡ç”Ÿç‰©ï¼Œä¾‹å¦‚lnyï¼Œè¿™æ—¶è¡ç”Ÿçš„çº¿æ€§æ¨¡å‹å¦‚ä¸‹æ‰€ç¤ºï¼Œå®é™…ä¸Šå°±æ˜¯ç›¸å½“äºå°†æŒ‡æ•°æ›²çº¿æŠ•å½±åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b103cbf.png" alt="7.png" /></p>
<p>æ›´ä¸€èˆ¬åœ°ï¼Œè€ƒè™‘æ‰€æœ‰yçš„è¡ç”Ÿç‰©çš„æƒ…å½¢ï¼Œå°±å¾—åˆ°äº†â€œå¹¿ä¹‰çš„çº¿æ€§æ¨¡å‹â€ï¼ˆgeneralized linear modelï¼‰ï¼Œå…¶ä¸­ï¼Œgï¼ˆ*ï¼‰ç§°ä¸ºè”ç³»å‡½æ•°ï¼ˆlink functionï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0a2841.png" alt="8.png" /></p>
<h3 id="32-çº¿æ€§å‡ ç‡å›å½’"><a class="header" href="#32-çº¿æ€§å‡ ç‡å›å½’"><strong>3.2 çº¿æ€§å‡ ç‡å›å½’</strong></a></h3>
<p>å›å½’å°±æ˜¯é€šè¿‡è¾“å…¥çš„å±æ€§å€¼å¾—åˆ°ä¸€ä¸ªé¢„æµ‹å€¼ï¼Œåˆ©ç”¨ä¸Šè¿°å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„ç‰¹å¾ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡ä¸€ä¸ªè”ç³»å‡½æ•°ï¼Œå°†é¢„æµ‹å€¼è½¬åŒ–ä¸ºç¦»æ•£å€¼ä»è€Œè¿›è¡Œåˆ†ç±»å‘¢ï¼Ÿçº¿æ€§å‡ ç‡å›å½’æ­£æ˜¯ç ”ç©¶è¿™æ ·çš„é—®é¢˜ã€‚å¯¹æ•°å‡ ç‡å¼•å…¥äº†ä¸€ä¸ªå¯¹æ•°å‡ ç‡å‡½æ•°ï¼ˆlogistic functionï¼‰,å°†é¢„æµ‹å€¼æŠ•å½±åˆ°0-1ä¹‹é—´ï¼Œä»è€Œå°†çº¿æ€§å›å½’é—®é¢˜è½¬åŒ–ä¸ºäºŒåˆ†ç±»é—®é¢˜ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0c7748.png" alt="9.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc722b0a655d.png" alt="10.png" /></p>
<p>è‹¥å°†yçœ‹åšæ ·æœ¬ä¸ºæ­£ä¾‹çš„æ¦‚ç‡ï¼Œï¼ˆ1-yï¼‰çœ‹åšæ ·æœ¬ä¸ºåä¾‹çš„æ¦‚ç‡ï¼Œåˆ™ä¸Šå¼å®é™…ä¸Šä½¿ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„é¢„æµ‹ç»“æœå™¨é€¼è¿‘çœŸå®æ ‡è®°çš„å¯¹æ•°å‡ ç‡ã€‚å› æ­¤è¿™ä¸ªæ¨¡å‹ç§°ä¸ºâ€œå¯¹æ•°å‡ ç‡å›å½’â€ï¼ˆlogistic regressionï¼‰ï¼Œä¹Ÿæœ‰ä¸€äº›ä¹¦ç±ç§°ä¹‹ä¸ºâ€œé€»è¾‘å›å½’â€ã€‚ä¸‹é¢ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„æ–¹æ³•æ¥è®¡ç®—å‡ºwå’Œbä¸¤ä¸ªå‚æ•°çš„å–å€¼ï¼Œä¸‹é¢åªåˆ—å‡ºæ±‚è§£çš„æ€è·¯ï¼Œä¸åˆ—å‡ºå…·ä½“çš„è®¡ç®—è¿‡ç¨‹ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b824f0c.png" alt="11.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b817961.png" alt="12.png" /></p>
<h3 id="33-çº¿æ€§åˆ¤åˆ«åˆ†æ"><a class="header" href="#33-çº¿æ€§åˆ¤åˆ«åˆ†æ"><strong>3.3 çº¿æ€§åˆ¤åˆ«åˆ†æ</strong></a></h3>
<p>çº¿æ€§åˆ¤åˆ«åˆ†æï¼ˆLinear Discriminant Analysisï¼Œç®€ç§°LDAï¼‰,å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†è®­ç»ƒæ ·æœ¬æŠ•å½±åˆ°ä¸€æ¡ç›´çº¿ä¸Šï¼Œä½¿å¾—åŒç±»çš„æ ·ä¾‹å°½å¯èƒ½è¿‘ï¼Œä¸åŒç±»çš„æ ·ä¾‹å°½å¯èƒ½è¿œã€‚å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b863ebb.png" alt="13.png" /><img src="https://i.loli.net/2018/10/17/5bc723b85bfa9.png" alt="14.png" /></p>
<p>æƒ³è®©åŒç±»æ ·æœ¬ç‚¹çš„æŠ•å½±ç‚¹å°½å¯èƒ½æ¥è¿‘ï¼Œä¸åŒç±»æ ·æœ¬ç‚¹æŠ•å½±ä¹‹é—´å°½å¯èƒ½è¿œï¼Œå³ï¼šè®©å„ç±»çš„åæ–¹å·®ä¹‹å’Œå°½å¯èƒ½å°ï¼Œä¸ç”¨ç±»ä¹‹é—´ä¸­å¿ƒçš„è·ç¦»å°½å¯èƒ½å¤§ã€‚åŸºäºè¿™æ ·çš„è€ƒè™‘ï¼ŒLDAå®šä¹‰äº†ä¸¤ä¸ªæ•£åº¦çŸ©é˜µã€‚</p>
<ul>
<li>ç±»å†…æ•£åº¦çŸ©é˜µï¼ˆwithin-class scatter matrixï¼‰</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc723b8156e1.png" alt="15.png" /></p>
<ul>
<li>ç±»é—´æ•£åº¦çŸ©é˜µ(between-class scaltter matrix)</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc723b7e9db3.png" alt="16.png" /></p>
<p>å› æ­¤å¾—åˆ°äº†LDAçš„æœ€å¤§åŒ–ç›®æ ‡ï¼šâ€œå¹¿ä¹‰ç‘åˆ©å•†â€ï¼ˆgeneralized Rayleigh quotientï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b7e8a61.png" alt="17.png" /></p>
<p>ä»è€Œåˆ†ç±»é—®é¢˜è½¬åŒ–ä¸ºæœ€ä¼˜åŒ–æ±‚è§£wçš„é—®é¢˜ï¼Œå½“æ±‚è§£å‡ºwåï¼Œå¯¹æ–°çš„æ ·æœ¬è¿›è¡Œåˆ†ç±»æ—¶ï¼Œåªéœ€å°†è¯¥æ ·æœ¬ç‚¹æŠ•å½±åˆ°è¿™æ¡ç›´çº¿ä¸Šï¼Œæ ¹æ®ä¸å„ä¸ªç±»åˆ«çš„ä¸­å¿ƒå€¼è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œåˆ¤å®šå‡ºæ–°æ ·æœ¬ä¸å“ªä¸ªç±»åˆ«è·ç¦»æœ€è¿‘ã€‚æ±‚è§£wçš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼Œä½¿ç”¨çš„æ–¹æ³•ä¸ºÎ»ä¹˜å­ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b83d5e0.png" alt="18.png" /></p>
<p>è‹¥å°†wçœ‹åšä¸€ä¸ªæŠ•å½±çŸ©é˜µï¼Œç±»ä¼¼PCAçš„æ€æƒ³ï¼Œåˆ™LDAå¯å°†æ ·æœ¬æŠ•å½±åˆ°N-1ç»´ç©ºé—´ï¼ˆNä¸ºç±»ç°‡æ•°ï¼‰ï¼ŒæŠ•å½±çš„è¿‡ç¨‹ä½¿ç”¨äº†ç±»åˆ«ä¿¡æ¯ï¼ˆæ ‡è®°ä¿¡æ¯ï¼‰ï¼Œå› æ­¤LDAä¹Ÿå¸¸è¢«è§†ä¸ºä¸€ç§ç»å…¸çš„ç›‘ç£é™ç»´æŠ€æœ¯ã€‚
â€‹</p>
<h3 id="34-å¤šåˆ†ç±»å­¦ä¹ "><a class="header" href="#34-å¤šåˆ†ç±»å­¦ä¹ "><strong>3.4 å¤šåˆ†ç±»å­¦ä¹ </strong></a></h3>
<p>ç°å®ä¸­æˆ‘ä»¬ç»å¸¸é‡åˆ°ä¸åªä¸¤ä¸ªç±»åˆ«çš„åˆ†ç±»é—®é¢˜ï¼Œå³å¤šåˆ†ç±»é—®é¢˜ï¼Œåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬å¸¸å¸¸è¿ç”¨â€œæ‹†åˆ†â€çš„ç­–ç•¥ï¼Œé€šè¿‡å¤šä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨æ¥è§£å†³å¤šåˆ†ç±»é—®é¢˜ï¼Œå³å°†å¤šåˆ†ç±»é—®é¢˜æ‹†è§£ä¸ºå¤šä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œè®­ç»ƒå‡ºå¤šä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨ï¼Œæœ€åå°†å¤šä¸ªåˆ†ç±»ç»“æœè¿›è¡Œé›†æˆå¾—å‡ºç»“è®ºã€‚æœ€ä¸ºç»å…¸çš„æ‹†åˆ†ç­–ç•¥æœ‰ä¸‰ç§ï¼šâ€œä¸€å¯¹ä¸€â€ï¼ˆOvOï¼‰ã€â€œä¸€å¯¹å…¶ä½™â€ï¼ˆOvRï¼‰å’Œâ€œå¤šå¯¹å¤šâ€ï¼ˆMvMï¼‰ï¼Œæ ¸å¿ƒæ€æƒ³ä¸ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<ul>
<li>
<p>OvOï¼šç»™å®šæ•°æ®é›†Dï¼Œå‡å®šå…¶ä¸­æœ‰Nä¸ªçœŸå®ç±»åˆ«ï¼Œå°†è¿™Nä¸ªç±»åˆ«è¿›è¡Œä¸¤ä¸¤é…å¯¹ï¼ˆä¸€ä¸ªæ­£ç±»/ä¸€ä¸ªåç±»ï¼‰ï¼Œä»è€Œäº§ç”ŸNï¼ˆN-1ï¼‰/2ä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨ï¼Œåœ¨æµ‹è¯•é˜¶æ®µï¼Œå°†æ–°æ ·æœ¬æ”¾å…¥æ‰€æœ‰çš„äºŒåˆ†ç±»å­¦ä¹ å™¨ä¸­æµ‹è¯•ï¼Œå¾—å‡ºNï¼ˆN-1ï¼‰ä¸ªç»“æœï¼Œæœ€ç»ˆé€šè¿‡æŠ•ç¥¨äº§ç”Ÿæœ€ç»ˆçš„åˆ†ç±»ç»“æœã€‚</p>
</li>
<li>
<p>OvMï¼šç»™å®šæ•°æ®é›†Dï¼Œå‡å®šå…¶ä¸­æœ‰Nä¸ªçœŸå®ç±»åˆ«ï¼Œæ¯æ¬¡å–å‡ºä¸€ä¸ªç±»ä½œä¸ºæ­£ç±»ï¼Œå‰©ä½™çš„æ‰€æœ‰ç±»åˆ«ä½œä¸ºä¸€ä¸ªæ–°çš„åç±»ï¼Œä»è€Œäº§ç”ŸNä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨ï¼Œåœ¨æµ‹è¯•é˜¶æ®µï¼Œå¾—å‡ºNä¸ªç»“æœï¼Œè‹¥ä»…æœ‰ä¸€ä¸ªå­¦ä¹ å™¨é¢„æµ‹ä¸ºæ­£ç±»ï¼Œåˆ™å¯¹åº”çš„ç±»æ ‡ä½œä¸ºæœ€ç»ˆåˆ†ç±»ç»“æœã€‚</p>
</li>
<li>
<p>MvMï¼šç»™å®šæ•°æ®é›†Dï¼Œå‡å®šå…¶ä¸­æœ‰Nä¸ªçœŸå®ç±»åˆ«ï¼Œæ¯æ¬¡å–è‹¥å¹²ä¸ªç±»ä½œä¸ºæ­£ç±»ï¼Œè‹¥å¹²ä¸ªç±»ä½œä¸ºåç±»ï¼ˆé€šè¿‡ECOCç ç»™å‡ºï¼Œç¼–ç ï¼‰ï¼Œè‹¥è¿›è¡Œäº†Mæ¬¡åˆ’åˆ†ï¼Œåˆ™ç”Ÿæˆäº†Mä¸ªäºŒåˆ†ç±»å­¦ä¹ å™¨ï¼Œåœ¨æµ‹è¯•é˜¶æ®µï¼ˆè§£ç ï¼‰ï¼Œå¾—å‡ºMä¸ªç»“æœç»„æˆä¸€ä¸ªæ–°çš„ç ï¼Œæœ€ç»ˆé€šè¿‡è®¡ç®—æµ·æ˜/æ¬§å¼è·ç¦»é€‰æ‹©è·ç¦»æœ€å°çš„ç±»åˆ«ä½œä¸ºæœ€ç»ˆåˆ†ç±»ç»“æœã€‚</p>
</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc723b862bfb.png" alt="19.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc723b8300d5.png" alt="20.png" /></p>
<h3 id="35-ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜"><a class="header" href="#35-ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜"><strong>3.5 ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜</strong></a></h3>
<p>ç±»åˆ«ä¸å¹³è¡¡ï¼ˆclass-imbanlanceï¼‰å°±æ˜¯æŒ‡åˆ†ç±»é—®é¢˜ä¸­ä¸åŒç±»åˆ«çš„è®­ç»ƒæ ·æœ¬ç›¸å·®æ‚¬æ®Šçš„æƒ…å†µï¼Œä¾‹å¦‚æ­£ä¾‹æœ‰900ä¸ªï¼Œè€Œåä¾‹åªæœ‰100ä¸ªï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦è¿›è¡Œç›¸åº”çš„å¤„ç†æ¥å¹³è¡¡è¿™ä¸ªé—®é¢˜ã€‚å¸¸è§çš„åšæ³•æœ‰ä¸‰ç§ï¼š</p>
<ol>
<li>åœ¨è®­ç»ƒæ ·æœ¬è¾ƒå¤šçš„ç±»åˆ«ä¸­è¿›è¡Œâ€œæ¬ é‡‡æ ·â€ï¼ˆundersamplingï¼‰,æ¯”å¦‚ä»æ­£ä¾‹ä¸­é‡‡å‡º100ä¸ªï¼Œå¸¸è§çš„ç®—æ³•æœ‰ï¼šEasyEnsembleã€‚</li>
<li>åœ¨è®­ç»ƒæ ·æœ¬è¾ƒå°‘çš„ç±»åˆ«ä¸­è¿›è¡Œâ€œè¿‡é‡‡æ ·â€ï¼ˆoversamplingï¼‰,ä¾‹å¦‚é€šè¿‡å¯¹åä¾‹ä¸­çš„æ•°æ®è¿›è¡Œæ’å€¼ï¼Œæ¥äº§ç”Ÿé¢å¤–çš„åä¾‹ï¼Œå¸¸è§çš„ç®—æ³•æœ‰SMOTEã€‚</li>
<li>ç›´æ¥åŸºäºåŸæ•°æ®é›†è¿›è¡Œå­¦ä¹ ï¼Œå¯¹é¢„æµ‹å€¼è¿›è¡Œâ€œå†ç¼©æ”¾â€å¤„ç†ã€‚å…¶ä¸­å†ç¼©æ”¾ä¹Ÿæ˜¯ä»£ä»·æ•æ„Ÿå­¦ä¹ çš„åŸºç¡€ã€‚<img src="https://i.loli.net/2018/10/17/5bc726fe87ae2.png" alt="21.png" /></li>
</ol>
<h2 id="å››-å†³ç­–æ ‘"><a class="header" href="#å››-å†³ç­–æ ‘"><strong>å››ï¼ å†³ç­–æ ‘</strong></a></h2>
<h3 id="41-å†³ç­–æ ‘åŸºæœ¬æ¦‚å¿µ"><a class="header" href="#41-å†³ç­–æ ‘åŸºæœ¬æ¦‚å¿µ"><strong>4.1 å†³ç­–æ ‘åŸºæœ¬æ¦‚å¿µ</strong></a></h3>
<p>é¡¾åæ€ä¹‰ï¼Œå†³ç­–æ ‘æ˜¯åŸºäºæ ‘ç»“æ„æ¥è¿›è¡Œå†³ç­–çš„ï¼Œåœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªä¾‹å­ååˆ†æœ‰è¶£ï¼Œæ”¾åœ¨è¿™é‡Œæ­£å¥½åˆé€‚ã€‚ç°æƒ³è±¡ä¸€ä½æ‰æ€¥çš„æ¯äº²æƒ³è¦ç»™è‡ªå·±çš„å¥³å¨ƒä»‹ç»ä¸€ä¸ªç”·æœ‹å‹ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢çš„å¯¹è¯ï¼š</p>
<hr />
<pre><code>  å¥³å„¿ï¼šå¤šå¤§å¹´çºªäº†ï¼Ÿ
  æ¯äº²ï¼š26ã€‚
  å¥³å„¿ï¼šé•¿çš„å¸…ä¸å¸…ï¼Ÿ
  æ¯äº²ï¼šæŒºå¸…çš„ã€‚
  å¥³å„¿ï¼šæ”¶å…¥é«˜ä¸ï¼Ÿ
  æ¯äº²ï¼šä¸ç®—å¾ˆé«˜ï¼Œä¸­ç­‰æƒ…å†µã€‚
  å¥³å„¿ï¼šæ˜¯å…¬åŠ¡å‘˜ä¸ï¼Ÿ
  æ¯äº²ï¼šæ˜¯ï¼Œåœ¨ç¨åŠ¡å±€ä¸Šç­å‘¢ã€‚
  å¥³å„¿ï¼šé‚£å¥½ï¼Œæˆ‘å»è§è§ã€‚
</code></pre>
<hr />
<p>è¿™ä¸ªå¥³å­©çš„æŒ‘å‰”è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å†³ç­–æ ‘ï¼Œå³ç›¸å½“äºé€šè¿‡å¹´é¾„ã€é•¿ç›¸ã€æ”¶å…¥å’Œæ˜¯å¦å…¬åŠ¡å‘˜å°†ç”·ç«¥é‹åˆ†ä¸ºä¸¤ä¸ªç±»åˆ«ï¼šè§å’Œä¸è§ã€‚å‡è®¾è¿™ä¸ªå¥³å­©å¯¹ç”·äººçš„è¦æ±‚æ˜¯ï¼š30å²ä»¥ä¸‹ã€é•¿ç›¸ä¸­ç­‰ä»¥ä¸Šå¹¶ä¸”æ˜¯é«˜æ”¶å…¥è€…æˆ–ä¸­ç­‰ä»¥ä¸Šæ”¶å…¥çš„å…¬åŠ¡å‘˜ï¼Œé‚£ä¹ˆä½¿ç”¨ä¸‹å›¾å°±èƒ½å¾ˆå¥½åœ°è¡¨ç¤ºå¥³å­©çš„å†³ç­–é€»è¾‘ï¼ˆå³ä¸€é¢—å†³ç­–æ ‘ï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec84a77.png" alt="1.png" /></p>
<p>åœ¨ä¸Šå›¾çš„å†³ç­–æ ‘ä¸­ï¼Œå†³ç­–è¿‡ç¨‹çš„æ¯ä¸€æ¬¡åˆ¤å®šéƒ½æ˜¯å¯¹æŸä¸€å±æ€§çš„â€œæµ‹è¯•â€ï¼Œå†³ç­–æœ€ç»ˆç»“è®ºåˆ™å¯¹åº”æœ€ç»ˆçš„åˆ¤å®šç»“æœã€‚ä¸€èˆ¬ä¸€é¢—å†³ç­–æ ‘åŒ…å«ï¼šä¸€ä¸ªæ ¹èŠ‚ç‚¹ã€è‹¥å¹²ä¸ªå†…éƒ¨èŠ‚ç‚¹å’Œè‹¥å¹²ä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ˜“çŸ¥ï¼š</p>
<ul>
<li>æ¯ä¸ªéå¶èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾å±æ€§æµ‹è¯•ã€‚</li>
<li>æ¯ä¸ªåˆ†æ”¯ä»£è¡¨è¿™ä¸ªç‰¹å¾å±æ€§åœ¨æŸä¸ªå€¼åŸŸä¸Šçš„è¾“å‡ºã€‚</li>
<li>æ¯ä¸ªå¶å­èŠ‚ç‚¹å­˜æ”¾ä¸€ä¸ªç±»åˆ«ã€‚</li>
<li>æ¯ä¸ªèŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬é›†åˆé€šè¿‡å±æ€§æµ‹è¯•è¢«åˆ’åˆ†åˆ°å­èŠ‚ç‚¹ä¸­ï¼Œæ ¹èŠ‚ç‚¹åŒ…å«æ ·æœ¬å…¨é›†ã€‚</li>
</ul>
<h3 id="42-å†³ç­–æ ‘çš„æ„é€ "><a class="header" href="#42-å†³ç­–æ ‘çš„æ„é€ "><strong>4.2 å†³ç­–æ ‘çš„æ„é€ </strong></a></h3>
<p>å†³ç­–æ ‘çš„æ„é€ æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œæœ‰ä¸‰ç§æƒ…å½¢ä¼šå¯¼è‡´é€’å½’è¿”å›ï¼š(1) å½“å‰ç»“ç‚¹åŒ…å«çš„æ ·æœ¬å…¨å±äºåŒä¸€ç±»åˆ«ï¼Œè¿™æ—¶ç›´æ¥å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºå¶èŠ‚ç‚¹ï¼Œå¹¶è®¾ä¸ºç›¸åº”çš„ç±»åˆ«ï¼›(2) å½“å‰å±æ€§é›†ä¸ºç©ºï¼Œæˆ–æ˜¯æ‰€æœ‰æ ·æœ¬åœ¨æ‰€æœ‰å±æ€§ä¸Šå–å€¼ç›¸åŒï¼Œæ— æ³•åˆ’åˆ†ï¼Œè¿™æ—¶å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºå¶èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶ç±»åˆ«è®¾ä¸ºè¯¥èŠ‚ç‚¹æ‰€å«æ ·æœ¬æœ€å¤šçš„ç±»åˆ«ï¼›(3) å½“å‰ç»“ç‚¹åŒ…å«çš„æ ·æœ¬é›†åˆä¸ºç©ºï¼Œä¸èƒ½åˆ’åˆ†ï¼Œè¿™æ—¶ä¹Ÿå°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºå¶èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶ç±»åˆ«è®¾ä¸ºçˆ¶èŠ‚ç‚¹ä¸­æ‰€å«æ ·æœ¬æœ€å¤šçš„ç±»åˆ«ã€‚ç®—æ³•çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ecc27fe.png" alt="2.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼šå†³ç­–æ ‘å­¦ä¹ çš„å…³é”®åœ¨äºå¦‚ä½•é€‰æ‹©åˆ’åˆ†å±æ€§ï¼Œä¸åŒçš„åˆ’åˆ†å±æ€§å¾—å‡ºä¸åŒçš„åˆ†æ”¯ç»“æ„ï¼Œä»è€Œå½±å“æ•´é¢—å†³ç­–æ ‘çš„æ€§èƒ½ã€‚å±æ€§åˆ’åˆ†çš„ç›®æ ‡æ˜¯è®©å„ä¸ªåˆ’åˆ†å‡ºæ¥çš„å­èŠ‚ç‚¹å°½å¯èƒ½åœ°â€œçº¯â€ï¼Œå³å±äºåŒä¸€ç±»åˆ«ã€‚å› æ­¤ä¸‹é¢ä¾¿æ˜¯ä»‹ç»é‡åŒ–çº¯åº¦çš„å…·ä½“æ–¹æ³•ï¼Œå†³ç­–æ ‘æœ€å¸¸ç”¨çš„ç®—æ³•æœ‰ä¸‰ç§ï¼šID3ï¼ŒC4.5å’ŒCARTã€‚</p>
<h4 id="421-id3ç®—æ³•"><a class="header" href="#421-id3ç®—æ³•"><strong>4.2.1 ID3ç®—æ³•</strong></a></h4>
<p>ID3ç®—æ³•ä½¿ç”¨ä¿¡æ¯å¢ç›Šä¸ºå‡†åˆ™æ¥é€‰æ‹©åˆ’åˆ†å±æ€§ï¼Œâ€œä¿¡æ¯ç†µâ€(information entropy)æ˜¯åº¦é‡æ ·æœ¬ç»“åˆçº¯åº¦çš„å¸¸ç”¨æŒ‡æ ‡ï¼Œå‡å®šå½“å‰æ ·æœ¬é›†åˆDä¸­ç¬¬kç±»æ ·æœ¬æ‰€å æ¯”ä¾‹ä¸ºpkï¼Œåˆ™æ ·æœ¬é›†åˆDçš„ä¿¡æ¯ç†µå®šä¹‰ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec515a5.png" alt="3.png" /></p>
<p>å‡å®šé€šè¿‡å±æ€§åˆ’åˆ†æ ·æœ¬é›†Dï¼Œäº§ç”Ÿäº†Vä¸ªåˆ†æ”¯èŠ‚ç‚¹ï¼Œvè¡¨ç¤ºå…¶ä¸­ç¬¬vä¸ªåˆ†æ”¯èŠ‚ç‚¹ï¼Œæ˜“çŸ¥ï¼šåˆ†æ”¯èŠ‚ç‚¹åŒ…å«çš„æ ·æœ¬æ•°è¶Šå¤šï¼Œè¡¨ç¤ºè¯¥åˆ†æ”¯èŠ‚ç‚¹çš„å½±å“åŠ›è¶Šå¤§ã€‚æ•…å¯ä»¥è®¡ç®—å‡ºåˆ’åˆ†åç›¸æ¯”åŸå§‹æ•°æ®é›†Dè·å¾—çš„â€œä¿¡æ¯å¢ç›Šâ€ï¼ˆinformation gainï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec3e067.png" alt="4.png" /></p>
<p>ä¿¡æ¯å¢ç›Šè¶Šå¤§ï¼Œè¡¨ç¤ºä½¿ç”¨è¯¥å±æ€§åˆ’åˆ†æ ·æœ¬é›†Dçš„æ•ˆæœè¶Šå¥½ï¼Œå› æ­¤ID3ç®—æ³•åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡é€‰æ‹©æœ€å¤§ä¿¡æ¯å¢ç›Šçš„å±æ€§ä½œä¸ºå½“å‰çš„åˆ’åˆ†å±æ€§ã€‚</p>
<h4 id="422-c45ç®—æ³•"><a class="header" href="#422-c45ç®—æ³•"><strong>4.2.2 C4.5ç®—æ³•</strong></a></h4>
<p>ID3ç®—æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åå‘äºå–å€¼æ•°ç›®è¾ƒå¤šçš„å±æ€§ï¼Œä¾‹å¦‚ï¼šå¦‚æœå­˜åœ¨ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œè¿™æ ·æ ·æœ¬é›†Då°†ä¼šè¢«åˆ’åˆ†ä¸º|D|ä¸ªåˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯åªæœ‰ä¸€ä¸ªæ ·æœ¬ï¼Œè¿™æ ·åˆ’åˆ†åçš„ä¿¡æ¯ç†µä¸ºé›¶ï¼Œååˆ†çº¯å‡€ï¼Œä½†æ˜¯å¯¹åˆ†ç±»æ¯«æ— ç”¨å¤„ã€‚å› æ­¤C4.5ç®—æ³•ä½¿ç”¨äº†â€œå¢ç›Šç‡â€ï¼ˆgain ratioï¼‰æ¥é€‰æ‹©åˆ’åˆ†å±æ€§ï¼Œæ¥é¿å…è¿™ä¸ªé—®é¢˜å¸¦æ¥çš„å›°æ‰°ã€‚é¦–å…ˆä½¿ç”¨ID3ç®—æ³•è®¡ç®—å‡ºä¿¡æ¯å¢ç›Šé«˜äºå¹³å‡æ°´å¹³çš„å€™é€‰å±æ€§ï¼Œæ¥ç€C4.5è®¡ç®—è¿™äº›å€™é€‰å±æ€§çš„å¢ç›Šç‡ï¼Œå¢ç›Šç‡å®šä¹‰ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec69647.png" alt="5.png" /></p>
<h4 id="423-cartç®—æ³•"><a class="header" href="#423-cartç®—æ³•"><strong>4.2.3 CARTç®—æ³•</strong></a></h4>
<p>CARTå†³ç­–æ ‘ä½¿ç”¨â€œåŸºå°¼æŒ‡æ•°â€ï¼ˆGini indexï¼‰æ¥é€‰æ‹©åˆ’åˆ†å±æ€§ï¼ŒåŸºå°¼æŒ‡æ•°åæ˜ çš„æ˜¯ä»æ ·æœ¬é›†Dä¸­éšæœºæŠ½å–ä¸¤ä¸ªæ ·æœ¬ï¼Œå…¶ç±»åˆ«æ ‡è®°ä¸ä¸€è‡´çš„æ¦‚ç‡ï¼Œå› æ­¤Gini(D)è¶Šå°è¶Šå¥½ï¼ŒåŸºå°¼æŒ‡æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec5a2ff.png" alt="6.png" /></p>
<p>è¿›è€Œï¼Œä½¿ç”¨å±æ€§Î±åˆ’åˆ†åçš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec62eaf.png" alt="7.png" /></p>
<h3 id="43-å‰ªæå¤„ç†"><a class="header" href="#43-å‰ªæå¤„ç†"><strong>4.3 å‰ªæå¤„ç†</strong></a></h3>
<p>ä»å†³ç­–æ ‘çš„æ„é€ æµç¨‹ä¸­æˆ‘ä»¬å¯ä»¥ç›´è§‚åœ°çœ‹å‡ºï¼šä¸ç®¡æ€ä¹ˆæ ·çš„è®­ç»ƒé›†ï¼Œå†³ç­–æ ‘æ€»æ˜¯èƒ½å¾ˆå¥½åœ°å°†å„ä¸ªç±»åˆ«åˆ†ç¦»å¼€æ¥ï¼Œè¿™æ—¶å°±ä¼šé‡åˆ°ä¹‹å‰æåˆ°è¿‡çš„é—®é¢˜ï¼šè¿‡æ‹Ÿåˆï¼ˆoverfittingï¼‰ï¼Œå³å¤ªä¾èµ–äºè®­ç»ƒæ ·æœ¬ã€‚å‰ªæï¼ˆpruningï¼‰åˆ™æ˜¯å†³ç­–æ ‘ç®—æ³•å¯¹ä»˜è¿‡æ‹Ÿåˆçš„ä¸»è¦æ‰‹æ®µï¼Œå‰ªæçš„ç­–ç•¥æœ‰ä¸¤ç§å¦‚ä¸‹ï¼š</p>
<ul>
<li>é¢„å‰ªæï¼ˆprepruningï¼‰ï¼šåœ¨æ„é€ çš„è¿‡ç¨‹ä¸­å…ˆè¯„ä¼°ï¼Œå†è€ƒè™‘æ˜¯å¦åˆ†æ”¯ã€‚</li>
<li>åå‰ªæï¼ˆpost-pruningï¼‰ï¼šåœ¨æ„é€ å¥½ä¸€é¢—å®Œæ•´çš„å†³ç­–æ ‘åï¼Œè‡ªåº•å‘ä¸Šï¼Œè¯„ä¼°åˆ†æ”¯çš„å¿…è¦æ€§ã€‚</li>
</ul>
<p>è¯„ä¼°æŒ‡çš„æ˜¯æ€§èƒ½åº¦é‡ï¼Œå³å†³ç­–æ ‘çš„æ³›åŒ–æ€§èƒ½ã€‚ä¹‹å‰æåˆ°ï¼šå¯ä»¥ä½¿ç”¨æµ‹è¯•é›†ä½œä¸ºå­¦ä¹ å™¨æ³›åŒ–æ€§èƒ½çš„è¿‘ä¼¼ï¼Œå› æ­¤å¯ä»¥å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚é¢„å‰ªæè¡¨ç¤ºåœ¨æ„é€ æ•°çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹ä¸€ä¸ªèŠ‚ç‚¹è€ƒè™‘æ˜¯å¦åˆ†æ”¯æ—¶ï¼Œé¦–å…ˆè®¡ç®—å†³ç­–æ ‘ä¸åˆ†æ”¯æ—¶åœ¨æµ‹è¯•é›†ä¸Šçš„æ€§èƒ½ï¼Œå†è®¡ç®—åˆ†æ”¯ä¹‹åçš„æ€§èƒ½ï¼Œè‹¥åˆ†æ”¯å¯¹æ€§èƒ½æ²¡æœ‰æå‡ï¼Œåˆ™é€‰æ‹©ä¸åˆ†æ”¯ï¼ˆå³å‰ªæï¼‰ã€‚åå‰ªæåˆ™è¡¨ç¤ºåœ¨æ„é€ å¥½ä¸€é¢—å®Œæ•´çš„å†³ç­–æ ‘åï¼Œä»æœ€ä¸‹é¢çš„èŠ‚ç‚¹å¼€å§‹ï¼Œè€ƒè™‘è¯¥èŠ‚ç‚¹åˆ†æ”¯å¯¹æ¨¡å‹çš„æ€§èƒ½æ˜¯å¦æœ‰æå‡ï¼Œè‹¥æ— åˆ™å‰ªæï¼Œå³å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºå¶å­èŠ‚ç‚¹ï¼Œç±»åˆ«æ ‡è®°ä¸ºå…¶åŒ…å«æ ·æœ¬æœ€å¤šçš„ç±»åˆ«ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec80d34.png" alt="8.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec9e330.png" alt="9.png" /></p>
<p><img src="https://i.loli.net/2018/10/17/5bc728ec9d497.png" alt="10.png" /></p>
<p>ä¸Šå›¾åˆ†åˆ«è¡¨ç¤ºä¸å‰ªæå¤„ç†çš„å†³ç­–æ ‘ã€é¢„å‰ªæå†³ç­–æ ‘å’Œåå‰ªæå†³ç­–æ ‘ã€‚é¢„å‰ªæå¤„ç†ä½¿å¾—å†³ç­–æ ‘çš„å¾ˆå¤šåˆ†æ”¯è¢«å‰ªæ‰ï¼Œå› æ­¤å¤§å¤§é™ä½äº†è®­ç»ƒæ—¶é—´å¼€é”€ï¼ŒåŒæ—¶é™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©ï¼Œä½†å¦ä¸€æ–¹é¢ç”±äºå‰ªæåŒæ—¶å‰ªæ‰äº†å½“å‰èŠ‚ç‚¹åç»­å­èŠ‚ç‚¹çš„åˆ†æ”¯ï¼Œå› æ­¤é¢„å‰ªæâ€œè´ªå¿ƒâ€çš„æœ¬è´¨é˜»æ­¢äº†åˆ†æ”¯çš„å±•å¼€ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¸¦æ¥äº†æ¬ æ‹Ÿåˆçš„é£é™©ã€‚è€Œåå‰ªæåˆ™é€šå¸¸ä¿ç•™äº†æ›´å¤šçš„åˆ†æ”¯ï¼Œå› æ­¤é‡‡ç”¨åå‰ªæç­–ç•¥çš„å†³ç­–æ ‘æ€§èƒ½å¾€å¾€ä¼˜äºé¢„å‰ªæï¼Œä½†å…¶è‡ªåº•å‘ä¸Šéå†äº†æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶è®¡ç®—æ€§èƒ½ï¼Œè®­ç»ƒæ—¶é—´å¼€é”€ç›¸æ¯”é¢„å‰ªæå¤§å¤§æå‡ã€‚</p>
<h3 id="44-è¿ç»­å€¼ä¸ç¼ºå¤±å€¼å¤„ç†"><a class="header" href="#44-è¿ç»­å€¼ä¸ç¼ºå¤±å€¼å¤„ç†"><strong>4.4 è¿ç»­å€¼ä¸ç¼ºå¤±å€¼å¤„ç†</strong></a></h3>
<p>å¯¹äºè¿ç»­å€¼çš„å±æ€§ï¼Œè‹¥æ¯ä¸ªå–å€¼ä½œä¸ºä¸€ä¸ªåˆ†æ”¯åˆ™æ˜¾å¾—ä¸å¯è¡Œï¼Œå› æ­¤éœ€è¦è¿›è¡Œç¦»æ•£åŒ–å¤„ç†ï¼Œå¸¸ç”¨çš„æ–¹æ³•ä¸ºäºŒåˆ†æ³•ï¼ŒåŸºæœ¬æ€æƒ³ä¸ºï¼šç»™å®šæ ·æœ¬é›†Dä¸è¿ç»­å±æ€§Î±ï¼ŒäºŒåˆ†æ³•è¯•å›¾æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†ç‚¹tå°†æ ·æœ¬é›†Dåœ¨å±æ€§Î±ä¸Šåˆ†ä¸ºâ‰¤tä¸ï¼tã€‚</p>
<ul>
<li>é¦–å…ˆå°†Î±çš„æ‰€æœ‰å–å€¼æŒ‰å‡åºæ’åˆ—ï¼Œæ‰€æœ‰ç›¸é‚»å±æ€§çš„å‡å€¼ä½œä¸ºå€™é€‰åˆ’åˆ†ç‚¹ï¼ˆn-1ä¸ªï¼Œnä¸ºÎ±æ‰€æœ‰çš„å–å€¼æ•°ç›®ï¼‰ã€‚</li>
<li>è®¡ç®—æ¯ä¸€ä¸ªåˆ’åˆ†ç‚¹åˆ’åˆ†é›†åˆDï¼ˆå³åˆ’åˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ï¼‰åçš„ä¿¡æ¯å¢ç›Šã€‚</li>
<li>é€‰æ‹©æœ€å¤§ä¿¡æ¯å¢ç›Šçš„åˆ’åˆ†ç‚¹ä½œä¸ºæœ€ä¼˜åˆ’åˆ†ç‚¹ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc72a0968fad.png" alt="11.png" /></p>
<p>ç°å®ä¸­å¸¸ä¼šé‡åˆ°ä¸å®Œæ•´çš„æ ·æœ¬ï¼Œå³æŸäº›å±æ€§å€¼ç¼ºå¤±ã€‚æœ‰æ—¶è‹¥ç®€å•é‡‡å–å‰”é™¤ï¼Œåˆ™ä¼šé€ æˆå¤§é‡çš„ä¿¡æ¯æµªè´¹ï¼Œå› æ­¤åœ¨å±æ€§å€¼ç¼ºå¤±çš„æƒ…å†µä¸‹éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šï¼ˆ1ï¼‰å¦‚ä½•é€‰æ‹©åˆ’åˆ†å±æ€§ã€‚ï¼ˆ2ï¼‰ç»™å®šåˆ’åˆ†å±æ€§ï¼Œè‹¥æŸæ ·æœ¬åœ¨è¯¥å±æ€§ä¸Šç¼ºå¤±å€¼ï¼Œå¦‚ä½•åˆ’åˆ†åˆ°å…·ä½“çš„åˆ†æ”¯ä¸Šã€‚å‡å®šä¸ºæ ·æœ¬é›†ä¸­çš„æ¯ä¸€ä¸ªæ ·æœ¬éƒ½èµ‹äºˆä¸€ä¸ªæƒé‡ï¼Œæ ¹èŠ‚ç‚¹ä¸­çš„æƒé‡åˆå§‹åŒ–ä¸º1ï¼Œåˆ™å®šä¹‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72a098f3be.png" alt="12.png" /></p>
<p>å¯¹äºï¼ˆ1ï¼‰ï¼šé€šè¿‡åœ¨æ ·æœ¬é›†Dä¸­é€‰å–åœ¨å±æ€§Î±ä¸Šæ²¡æœ‰ç¼ºå¤±å€¼çš„æ ·æœ¬å­é›†ï¼Œè®¡ç®—åœ¨è¯¥æ ·æœ¬å­é›†ä¸Šçš„ä¿¡æ¯å¢ç›Šï¼Œæœ€ç»ˆçš„ä¿¡æ¯å¢ç›Šç­‰äºè¯¥æ ·æœ¬å­é›†åˆ’åˆ†åä¿¡æ¯å¢ç›Šä¹˜ä»¥æ ·æœ¬å­é›†å æ ·æœ¬é›†çš„æ¯”é‡ã€‚å³ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72a096ccc3.png" alt="13.png" /></p>
<p>å¯¹äºï¼ˆ2ï¼‰ï¼šè‹¥è¯¥æ ·æœ¬å­é›†åœ¨å±æ€§Î±ä¸Šçš„å€¼ç¼ºå¤±ï¼Œåˆ™å°†è¯¥æ ·æœ¬ä»¥ä¸åŒçš„æƒé‡ï¼ˆå³æ¯ä¸ªåˆ†æ”¯æ‰€å«æ ·æœ¬æ¯”ä¾‹ï¼‰åˆ’å…¥åˆ°æ‰€æœ‰åˆ†æ”¯èŠ‚ç‚¹ä¸­ã€‚è¯¥æ ·æœ¬åœ¨åˆ†æ”¯èŠ‚ç‚¹ä¸­çš„æƒé‡å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72a093ed3c.png" alt="14.png" /></p>
<h2 id="äº”-ç¥ç»ç½‘ç»œ"><a class="header" href="#äº”-ç¥ç»ç½‘ç»œ"><strong>äº”ï¼ ç¥ç»ç½‘ç»œ</strong></a></h2>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç¥ç»ç½‘ç»œä¸€èˆ¬æŒ‡çš„æ˜¯â€œç¥ç»ç½‘ç»œå­¦ä¹ â€ï¼Œæ˜¯æœºå™¨å­¦ä¹ ä¸ç¥ç»ç½‘ç»œä¸¤ä¸ªå­¦ç§‘çš„äº¤å‰éƒ¨åˆ†ã€‚æ‰€è°“ç¥ç»ç½‘ç»œï¼Œç›®å‰ç”¨å¾—æœ€å¹¿æ³›çš„ä¸€ä¸ªå®šä¹‰æ˜¯â€œç¥ç»ç½‘ç»œæ˜¯ç”±å…·æœ‰é€‚åº”æ€§çš„ç®€å•å•å…ƒç»„æˆçš„å¹¿æ³›å¹¶è¡Œäº’è¿çš„ç½‘ç»œï¼Œå®ƒçš„ç»„ç»‡èƒ½å¤Ÿæ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»ç³»ç»Ÿå¯¹çœŸå®ä¸–ç•Œç‰©ä½“æ‰€åšå‡ºçš„äº¤äº’ååº”â€ã€‚</p>
<h3 id="51-ç¥ç»å…ƒæ¨¡å‹"><a class="header" href="#51-ç¥ç»å…ƒæ¨¡å‹"><strong>5.1 ç¥ç»å…ƒæ¨¡å‹</strong></a></h3>
<p>ç¥ç»ç½‘ç»œä¸­æœ€åŸºæœ¬çš„å•å…ƒæ˜¯ç¥ç»å…ƒæ¨¡å‹ï¼ˆneuronï¼‰ã€‚åœ¨ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„åŸå§‹æœºåˆ¶ä¸­ï¼Œæ¯ä¸ªç¥ç»å…ƒé€šå¸¸éƒ½æœ‰å¤šä¸ªæ ‘çªï¼ˆdendriteï¼‰ï¼Œä¸€ä¸ªè½´çªï¼ˆaxonï¼‰å’Œä¸€ä¸ªç»†èƒä½“ï¼ˆcell bodyï¼‰ï¼Œæ ‘çªçŸ­è€Œå¤šåˆ†æ”¯ï¼Œè½´çªé•¿è€Œåªæœ‰ä¸€ä¸ªï¼›åœ¨åŠŸèƒ½ä¸Šï¼Œæ ‘çªç”¨äºä¼ å…¥å…¶å®ƒç¥ç»å…ƒä¼ é€’çš„ç¥ç»å†²åŠ¨ï¼Œè€Œè½´çªç”¨äºå°†ç¥ç»å†²åŠ¨ä¼ å‡ºåˆ°å…¶å®ƒç¥ç»å…ƒï¼Œå½“æ ‘çªæˆ–ç»†èƒä½“ä¼ å…¥çš„ç¥ç»å†²åŠ¨ä½¿å¾—ç¥ç»å…ƒå…´å¥‹æ—¶ï¼Œè¯¥ç¥ç»å…ƒå°±ä¼šé€šè¿‡è½´çªå‘å…¶å®ƒç¥ç»å…ƒä¼ é€’å…´å¥‹ã€‚ç¥ç»å…ƒçš„ç”Ÿç‰©å­¦ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸å¾—ä¸è¯´é«˜ä¸­çš„ç”ŸåŒ–çŸ¥è¯†å¤§å­¦å¿˜å¾—å¯æ˜¯çœŸå¹²å‡€...</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb6cc11.png" alt="1.png" /></p>
<p>ä¸€ç›´æ²¿ç”¨è‡³ä»Šçš„â€œM-Pç¥ç»å…ƒæ¨¡å‹â€æ­£æ˜¯å¯¹è¿™ä¸€ç»“æ„è¿›è¡Œäº†æŠ½è±¡ï¼Œä¹Ÿç§°â€œé˜ˆå€¼é€»è¾‘å•å…ƒâ€œï¼Œå…¶ä¸­æ ‘çªå¯¹åº”äºè¾“å…¥éƒ¨åˆ†ï¼Œæ¯ä¸ªç¥ç»å…ƒæ”¶åˆ°nä¸ªå…¶ä»–ç¥ç»å…ƒä¼ é€’è¿‡æ¥çš„è¾“å…¥ä¿¡å·ï¼Œè¿™äº›ä¿¡å·é€šè¿‡å¸¦æƒé‡çš„è¿æ¥ä¼ é€’ç»™ç»†èƒä½“ï¼Œè¿™äº›æƒé‡åˆç§°ä¸ºè¿æ¥æƒï¼ˆconnection weightï¼‰ã€‚ç»†èƒä½“åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå‰ä¸€éƒ¨åˆ†è®¡ç®—æ€»è¾“å…¥å€¼ï¼ˆå³è¾“å…¥ä¿¡å·çš„åŠ æƒå’Œï¼Œæˆ–è€…è¯´ç´¯ç§¯ç”µå¹³ï¼‰ï¼Œåä¸€éƒ¨åˆ†å…ˆè®¡ç®—æ€»è¾“å…¥å€¼ä¸è¯¥ç¥ç»å…ƒé˜ˆå€¼çš„å·®å€¼ï¼Œç„¶åé€šè¿‡æ¿€æ´»å‡½æ•°ï¼ˆactivation functionï¼‰çš„å¤„ç†ï¼Œäº§ç”Ÿè¾“å‡ºä»è½´çªä¼ é€ç»™å…¶å®ƒç¥ç»å…ƒã€‚M-Pç¥ç»å…ƒæ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb7be44.png" alt="2.png" /></p>
<p>ä¸çº¿æ€§åˆ†ç±»ååˆ†ç›¸ä¼¼ï¼Œç¥ç»å…ƒæ¨¡å‹æœ€ç†æƒ³çš„æ¿€æ´»å‡½æ•°ä¹Ÿæ˜¯é˜¶è·ƒå‡½æ•°ï¼Œå³å°†ç¥ç»å…ƒè¾“å…¥å€¼ä¸é˜ˆå€¼çš„å·®å€¼æ˜ å°„ä¸ºè¾“å‡ºå€¼1æˆ–0ï¼Œè‹¥å·®å€¼å¤§äºé›¶è¾“å‡º1ï¼Œå¯¹åº”å…´å¥‹ï¼›è‹¥å·®å€¼å°äºé›¶åˆ™è¾“å‡º0ï¼Œå¯¹åº”æŠ‘åˆ¶ã€‚ä½†é˜¶è·ƒå‡½æ•°ä¸è¿ç»­ï¼Œä¸å…‰æ»‘ï¼Œæ•…åœ¨M-Pç¥ç»å…ƒæ¨¡å‹ä¸­ï¼Œä¹Ÿé‡‡ç”¨Sigmoidå‡½æ•°æ¥è¿‘ä¼¼ï¼Œ Sigmoidå‡½æ•°å°†è¾ƒå¤§èŒƒå›´å†…å˜åŒ–çš„è¾“å…¥å€¼æŒ¤å‹åˆ° (0,1) è¾“å‡ºå€¼èŒƒå›´å†…ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºæŒ¤å‹å‡½æ•°ï¼ˆsquashing functionï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb40dc5.png" alt="3.png" /></p>
<p>å°†å¤šä¸ªç¥ç»å…ƒæŒ‰ä¸€å®šçš„å±‚æ¬¡ç»“æ„è¿æ¥èµ·æ¥ï¼Œå°±å¾—åˆ°äº†ç¥ç»ç½‘ç»œã€‚å®ƒæ˜¯ä¸€ç§åŒ…å«å¤šä¸ªå‚æ•°çš„æ¨¡å‹ï¼Œæ¯”æ–¹è¯´10ä¸ªç¥ç»å…ƒä¸¤ä¸¤è¿æ¥ï¼Œåˆ™æœ‰100ä¸ªå‚æ•°éœ€è¦å­¦ä¹ ï¼ˆæ¯ä¸ªç¥ç»å…ƒæœ‰9ä¸ªè¿æ¥æƒä»¥åŠ1ä¸ªé˜ˆå€¼ï¼‰ï¼Œè‹¥å°†æ¯ä¸ªç¥ç»å…ƒéƒ½çœ‹ä½œä¸€ä¸ªå‡½æ•°ï¼Œåˆ™æ•´ä¸ªç¥ç»ç½‘ç»œå°±æ˜¯ç”±è¿™äº›å‡½æ•°ç›¸äº’åµŒå¥—è€Œæˆã€‚</p>
<h3 id="52-æ„ŸçŸ¥æœºä¸å¤šå±‚ç½‘ç»œ"><a class="header" href="#52-æ„ŸçŸ¥æœºä¸å¤šå±‚ç½‘ç»œ"><strong>5.2 æ„ŸçŸ¥æœºä¸å¤šå±‚ç½‘ç»œ</strong></a></h3>
<p>æ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰æ˜¯ç”±ä¸¤å±‚ç¥ç»å…ƒç»„æˆçš„ä¸€ä¸ªç®€å•æ¨¡å‹ï¼Œä½†åªæœ‰è¾“å‡ºå±‚æ˜¯M-Pç¥ç»å…ƒï¼Œå³åªæœ‰è¾“å‡ºå±‚ç¥ç»å…ƒè¿›è¡Œæ¿€æ´»å‡½æ•°å¤„ç†ï¼Œä¹Ÿç§°ä¸ºåŠŸèƒ½ç¥ç»å…ƒï¼ˆfunctional neuronï¼‰ï¼›è¾“å…¥å±‚åªæ˜¯æ¥å—å¤–ç•Œä¿¡å·ï¼ˆæ ·æœ¬å±æ€§ï¼‰å¹¶ä¼ é€’ç»™è¾“å‡ºå±‚ï¼ˆè¾“å…¥å±‚çš„ç¥ç»å…ƒä¸ªæ•°ç­‰äºæ ·æœ¬çš„å±æ€§æ•°ç›®ï¼‰ï¼Œè€Œæ²¡æœ‰æ¿€æ´»å‡½æ•°ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ„ŸçŸ¥æœºä¸ä¹‹å‰çº¿æ€§æ¨¡å‹ä¸­çš„å¯¹æ•°å‡ ç‡å›å½’çš„æ€æƒ³åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡å¯¹å±æ€§åŠ æƒä¸å¦ä¸€ä¸ªå¸¸æ•°æ±‚å’Œï¼Œå†ä½¿ç”¨sigmoidå‡½æ•°å°†è¿™ä¸ªè¾“å‡ºå€¼å‹ç¼©åˆ°0-1ä¹‹é—´ï¼Œä»è€Œè§£å†³åˆ†ç±»é—®é¢˜ã€‚ä¸åŒçš„æ˜¯æ„ŸçŸ¥æœºçš„è¾“å‡ºå±‚åº”è¯¥å¯ä»¥æœ‰å¤šä¸ªç¥ç»å…ƒï¼Œä»è€Œå¯ä»¥å®ç°å¤šåˆ†ç±»é—®é¢˜ï¼ŒåŒæ—¶ä¸¤ä¸ªæ¨¡å‹æ‰€ç”¨çš„å‚æ•°ä¼°è®¡æ–¹æ³•ååˆ†ä¸åŒã€‚</p>
<p>ç»™å®šè®­ç»ƒé›†ï¼Œåˆ™æ„ŸçŸ¥æœºçš„n+1ä¸ªå‚æ•°ï¼ˆnä¸ªæƒé‡+1ä¸ªé˜ˆå€¼ï¼‰éƒ½å¯ä»¥é€šè¿‡å­¦ä¹ å¾—åˆ°ã€‚é˜ˆå€¼Î˜å¯ä»¥çœ‹ä½œä¸€ä¸ªè¾“å…¥å€¼å›ºå®šä¸º-1çš„å“‘ç»“ç‚¹çš„æƒé‡Ï‰n+1ï¼Œå³å‡è®¾æœ‰ä¸€ä¸ªå›ºå®šè¾“å…¥xn+1=-1çš„è¾“å…¥å±‚ç¥ç»å…ƒï¼Œå…¶å¯¹åº”çš„æƒé‡ä¸ºÏ‰n+1ï¼Œè¿™æ ·å°±æŠŠæƒé‡å’Œé˜ˆå€¼ç»Ÿä¸€ä¸ºæƒé‡çš„å­¦ä¹ äº†ã€‚ç®€å•æ„ŸçŸ¥æœºçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb3fdf0.png" alt="4.png" /></p>
<p>æ„ŸçŸ¥æœºæƒé‡çš„å­¦ä¹ è§„åˆ™å¦‚ä¸‹ï¼šå¯¹äºè®­ç»ƒæ ·æœ¬ï¼ˆxï¼Œyï¼‰ï¼Œå½“è¯¥æ ·æœ¬è¿›å…¥æ„ŸçŸ¥æœºå­¦ä¹ åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªè¾“å‡ºå€¼ï¼Œè‹¥è¯¥è¾“å‡ºå€¼ä¸æ ·æœ¬çš„çœŸå®æ ‡è®°ä¸ä¸€è‡´ï¼Œåˆ™æ„ŸçŸ¥æœºä¼šå¯¹æƒé‡è¿›è¡Œè°ƒæ•´ï¼Œè‹¥æ¿€æ´»å‡½æ•°ä¸ºé˜¶è·ƒå‡½æ•°ï¼Œåˆ™è°ƒæ•´çš„æ–¹æ³•ä¸ºï¼ˆåŸºäºæ¢¯åº¦ä¸‹é™æ³•ï¼‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb3ba63.png" alt="5.png" /></p>
<p>å…¶ä¸­ Î·âˆˆï¼ˆ0ï¼Œ1ï¼‰ç§°ä¸ºå­¦ä¹ ç‡ï¼Œå¯ä»¥çœ‹å‡ºæ„ŸçŸ¥æœºæ˜¯é€šè¿‡é€ä¸ªæ ·æœ¬è¾“å…¥æ¥æ›´æ–°æƒé‡ï¼Œé¦–å…ˆè®¾å®šå¥½åˆå§‹æƒé‡ï¼ˆä¸€èˆ¬ä¸ºéšæœºï¼‰ï¼Œé€ä¸ªåœ°è¾“å…¥æ ·æœ¬æ•°æ®ï¼Œè‹¥è¾“å‡ºå€¼ä¸çœŸå®æ ‡è®°ç›¸åŒåˆ™ç»§ç»­è¾“å…¥ä¸‹ä¸€ä¸ªæ ·æœ¬ï¼Œè‹¥ä¸ä¸€è‡´åˆ™æ›´æ–°æƒé‡ï¼Œç„¶åå†é‡æ–°é€ä¸ªæ£€éªŒï¼Œç›´åˆ°æ¯ä¸ªæ ·æœ¬æ•°æ®çš„è¾“å‡ºå€¼éƒ½ä¸çœŸå®æ ‡è®°ç›¸åŒã€‚å®¹æ˜“çœ‹å‡ºï¼šæ„ŸçŸ¥æœºæ¨¡å‹æ€»æ˜¯èƒ½å°†è®­ç»ƒæ•°æ®çš„æ¯ä¸€ä¸ªæ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®ï¼Œå’Œå†³ç­–æ ‘æ¨¡å‹æ€»æ˜¯èƒ½å°†æ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½åˆ†å¼€ä¸€æ ·ï¼Œæ„ŸçŸ¥æœºæ¨¡å‹å¾ˆå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆé—®é¢˜ã€‚</p>
<p>ç”±äºæ„ŸçŸ¥æœºæ¨¡å‹åªæœ‰ä¸€å±‚åŠŸèƒ½ç¥ç»å…ƒï¼Œå› æ­¤å…¶åŠŸèƒ½ååˆ†æœ‰é™ï¼Œåªèƒ½å¤„ç†çº¿æ€§å¯åˆ†çš„é—®é¢˜ï¼Œå¯¹äºè¿™ç±»é—®é¢˜ï¼Œæ„ŸçŸ¥æœºçš„å­¦ä¹ è¿‡ç¨‹ä¸€å®šä¼šæ”¶æ•›ï¼ˆconvergeï¼‰ï¼Œå› æ­¤æ€»æ˜¯å¯ä»¥æ±‚å‡ºé€‚å½“çš„æƒå€¼ã€‚ä½†æ˜¯å¯¹äºåƒä¹¦ä¸Šæåˆ°çš„å¼‚æˆ–é—®é¢˜ï¼Œåªé€šè¿‡ä¸€å±‚åŠŸèƒ½ç¥ç»å…ƒå¾€å¾€ä¸èƒ½è§£å†³ï¼Œå› æ­¤è¦è§£å†³éçº¿æ€§å¯åˆ†é—®é¢˜ï¼Œéœ€è¦è€ƒè™‘ä½¿ç”¨å¤šå±‚åŠŸèƒ½ç¥ç»å…ƒï¼Œå³ç¥ç»ç½‘ç»œã€‚å¤šå±‚ç¥ç»ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb58ec6.png" alt="6.png" /></p>
<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè¾“å…¥å±‚ä¸è¾“å‡ºå±‚ä¹‹é—´çš„å±‚ç§°ä¸ºéšå«å±‚æˆ–éšå±‚ï¼ˆhidden layerï¼‰ï¼Œéšå±‚å’Œè¾“å‡ºå±‚çš„ç¥ç»å…ƒéƒ½æ˜¯å…·æœ‰æ¿€æ´»å‡½æ•°çš„åŠŸèƒ½ç¥ç»å…ƒã€‚åªéœ€åŒ…å«ä¸€ä¸ªéšå±‚ä¾¿å¯ä»¥ç§°ä¸ºå¤šå±‚ç¥ç»ç½‘ç»œï¼Œå¸¸ç”¨çš„ç¥ç»ç½‘ç»œç§°ä¸ºâ€œå¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œâ€ï¼ˆmulti-layer feedforward neural networkï¼‰ï¼Œè¯¥ç»“æ„æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ¯å±‚ç¥ç»å…ƒä¸ä¸‹ä¸€å±‚ç¥ç»å…ƒä¹‹é—´å®Œå…¨äº’è¿</li>
<li>ç¥ç»å…ƒä¹‹é—´ä¸å­˜åœ¨åŒå±‚è¿æ¥</li>
<li>ç¥ç»å…ƒä¹‹é—´ä¸å­˜åœ¨è·¨å±‚è¿æ¥</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb47ff8.png" alt="7.png" /></p>
<p>æ ¹æ®ä¸Šé¢çš„ç‰¹ç‚¹å¯ä»¥å¾—çŸ¥ï¼šè¿™é‡Œçš„â€œå‰é¦ˆâ€æŒ‡çš„æ˜¯ç½‘ç»œæ‹“æ‰‘ç»“æ„ä¸­ä¸å­˜åœ¨ç¯æˆ–å›è·¯ï¼Œè€Œä¸æ˜¯æŒ‡è¯¥ç½‘ç»œåªèƒ½å‘å‰ä¼ æ’­è€Œä¸èƒ½å‘åä¼ æ’­ï¼ˆä¸‹èŠ‚ä¸­çš„BPç¥ç»ç½‘ç»œæ­£æ˜¯åŸºäºå‰é¦ˆç¥ç»ç½‘ç»œè€Œå¢åŠ äº†åé¦ˆè°ƒèŠ‚æœºåˆ¶ï¼‰ã€‚ç¥ç»ç½‘ç»œçš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ ¹æ®è®­ç»ƒæ•°æ®æ¥è°ƒæ•´ç¥ç»å…ƒä¹‹é—´çš„â€œè¿æ¥æƒâ€ä»¥åŠæ¯ä¸ªç¥ç»å…ƒçš„é˜ˆå€¼ï¼Œæ¢å¥è¯è¯´ï¼šç¥ç»ç½‘ç»œæ‰€å­¦ä¹ åˆ°çš„ä¸œè¥¿éƒ½è•´å«åœ¨ç½‘ç»œçš„è¿æ¥æƒä¸é˜ˆå€¼ä¸­ã€‚</p>
<h3 id="53-bpç¥ç»ç½‘ç»œç®—æ³•"><a class="header" href="#53-bpç¥ç»ç½‘ç»œç®—æ³•"><strong>5.3 BPç¥ç»ç½‘ç»œç®—æ³•</strong></a></h3>
<p>ç”±ä¸Šé¢å¯ä»¥å¾—çŸ¥ï¼šç¥ç»ç½‘ç»œçš„å­¦ä¹ ä¸»è¦è•´å«åœ¨æƒé‡å’Œé˜ˆå€¼ä¸­ï¼Œå¤šå±‚ç½‘ç»œä½¿ç”¨ä¸Šé¢ç®€å•æ„ŸçŸ¥æœºçš„æƒé‡è°ƒæ•´è§„åˆ™æ˜¾ç„¶ä¸å¤Ÿç”¨äº†ï¼ŒBPç¥ç»ç½‘ç»œç®—æ³•å³è¯¯å·®é€†ä¼ æ’­ç®—æ³•ï¼ˆerror BackPropagationï¼‰æ­£æ˜¯ä¸ºå­¦ä¹ å¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œè€Œè®¾è®¡ï¼ŒBPç¥ç»ç½‘ç»œç®—æ³•æ˜¯è¿„ä»Šä¸ºæ­¢æœ€æˆåŠŸçš„çš„ç¥ç»ç½‘ç»œå­¦ä¹ ç®—æ³•ã€‚</p>
<p>ä¸€èˆ¬è€Œè¨€ï¼Œåªéœ€åŒ…å«ä¸€ä¸ªè¶³å¤Ÿå¤šç¥ç»å…ƒçš„éšå±‚ï¼Œå°±èƒ½ä»¥ä»»æ„ç²¾åº¦é€¼è¿‘ä»»æ„å¤æ‚åº¦çš„è¿ç»­å‡½æ•°[Hornik et al.,1989]ï¼Œæ•…ä¸‹é¢ä»¥è®­ç»ƒå•éšå±‚çš„å‰é¦ˆç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œä»‹ç»BPç¥ç»ç½‘ç»œçš„ç®—æ³•æ€æƒ³ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb92ff5.png" alt="8.png" /></p>
<p>ä¸Šå›¾ä¸ºä¸€ä¸ªå•éšå±‚å‰é¦ˆç¥ç»ç½‘ç»œçš„æ‹“æ‰‘ç»“æ„ï¼ŒBPç¥ç»ç½‘ç»œç®—æ³•ä¹Ÿä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼ˆgradient descentï¼‰ï¼Œä»¥å•ä¸ªæ ·æœ¬çš„å‡æ–¹è¯¯å·®çš„è´Ÿæ¢¯åº¦æ–¹å‘å¯¹æƒé‡è¿›è¡Œè°ƒèŠ‚ã€‚å¯ä»¥çœ‹å‡ºï¼šBPç®—æ³•é¦–å…ˆå°†è¯¯å·®åå‘ä¼ æ’­ç»™éšå±‚ç¥ç»å…ƒï¼Œè°ƒèŠ‚éšå±‚åˆ°è¾“å‡ºå±‚çš„è¿æ¥æƒé‡ä¸è¾“å‡ºå±‚ç¥ç»å…ƒçš„é˜ˆå€¼ï¼›æ¥ç€æ ¹æ®éšå«å±‚ç¥ç»å…ƒçš„å‡æ–¹è¯¯å·®ï¼Œæ¥è°ƒèŠ‚è¾“å…¥å±‚åˆ°éšå«å±‚çš„è¿æ¥æƒå€¼ä¸éšå«å±‚ç¥ç»å…ƒçš„é˜ˆå€¼ã€‚BPç®—æ³•åŸºæœ¬çš„æ¨å¯¼è¿‡ç¨‹ä¸æ„ŸçŸ¥æœºçš„æ¨å¯¼è¿‡ç¨‹åŸç†æ˜¯ç›¸åŒçš„ï¼Œä¸‹é¢ç»™å‡ºè°ƒæ•´éšå«å±‚åˆ°è¾“å‡ºå±‚çš„æƒé‡è°ƒæ•´è§„åˆ™çš„æ¨å¯¼è¿‡ç¨‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb86229.png" alt="9.png" /></p>
<p>å­¦ä¹ ç‡Î·âˆˆï¼ˆ0ï¼Œ1ï¼‰æ§åˆ¶ç€æ²¿åæ¢¯åº¦æ–¹å‘ä¸‹é™çš„æ­¥é•¿ï¼Œè‹¥æ­¥é•¿å¤ªå¤§åˆ™ä¸‹é™å¤ªå¿«å®¹æ˜“äº§ç”Ÿéœ‡è¡ï¼Œè‹¥æ­¥é•¿å¤ªå°åˆ™æ”¶æ•›é€Ÿåº¦å¤ªæ…¢ï¼Œä¸€èˆ¬åœ°å¸¸æŠŠÎ·è®¾ç½®ä¸º0.1ï¼Œæœ‰æ—¶æ›´æ–°æƒé‡æ—¶ä¼šå°†è¾“å‡ºå±‚ä¸éšå«å±‚è®¾ç½®ä¸ºä¸åŒçš„å­¦ä¹ ç‡ã€‚BPç®—æ³•çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72cbb59e99.png" alt="10.png" /></p>
<p>BPç®—æ³•çš„æ›´æ–°è§„åˆ™æ˜¯åŸºäºæ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ä¸çœŸå®ç±»æ ‡çš„å‡æ–¹è¯¯å·®æ¥è¿›è¡Œæƒå€¼è°ƒèŠ‚ï¼Œå³BPç®—æ³•æ¯æ¬¡æ›´æ–°åªé’ˆå¯¹äºå•ä¸ªæ ·ä¾‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šBPç®—æ³•çš„æœ€ç»ˆç›®æ ‡æ˜¯è¦æœ€å°åŒ–æ•´ä¸ªè®­ç»ƒé›†Dä¸Šçš„ç´¯ç§¯è¯¯å·®ï¼Œå³ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72ce222a96.png" alt="11.png" /></p>
<p>å¦‚æœåŸºäºç´¯ç§¯è¯¯å·®æœ€å°åŒ–çš„æ›´æ–°è§„åˆ™ï¼Œåˆ™å¾—åˆ°äº†ç´¯ç§¯è¯¯å·®é€†ä¼ æ’­ç®—æ³•ï¼ˆaccumulated error backpropagationï¼‰ï¼Œå³æ¯æ¬¡è¯»å–å…¨éƒ¨çš„æ•°æ®é›†ä¸€éï¼Œè¿›è¡Œä¸€è½®å­¦ä¹ ï¼Œä»è€ŒåŸºäºå½“å‰çš„ç´¯ç§¯è¯¯å·®è¿›è¡Œæƒå€¼è°ƒæ•´ï¼Œå› æ­¤å‚æ•°æ›´æ–°çš„é¢‘ç‡ç›¸æ¯”æ ‡å‡†BPç®—æ³•ä½äº†å¾ˆå¤šï¼Œä½†åœ¨å¾ˆå¤šä»»åŠ¡ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œå¾€å¾€æ ‡å‡†BPç®—æ³•ä¼šè·å¾—è¾ƒå¥½çš„ç»“æœã€‚å¦å¤–å¯¹äºå¦‚ä½•è®¾ç½®éšå±‚ç¥ç»å…ƒä¸ªæ•°çš„é—®é¢˜ï¼Œè‡³ä»Šä»ç„¶æ²¡æœ‰å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå¸¸ä½¿ç”¨â€œè¯•é”™æ³•â€è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>å‰é¢æåˆ°ï¼ŒBPç¥ç»ç½‘ç»œå¼ºå¤§çš„å­¦ä¹ èƒ½åŠ›å¸¸å¸¸å®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§ç­–ç•¥æ¥ç¼“è§£BPç½‘ç»œçš„è¿‡æ‹Ÿåˆé—®é¢˜ï¼š</p>
<ul>
<li>æ—©åœï¼šå°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†ä¸æµ‹è¯•é›†ï¼Œè®­ç»ƒé›†ç”¨äºå­¦ä¹ ï¼Œæµ‹è¯•é›†ç”¨äºè¯„ä¼°æ€§èƒ½ï¼Œè‹¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒé›†çš„ç´¯ç§¯è¯¯å·®é™ä½ï¼Œè€Œæµ‹è¯•é›†çš„ç´¯ç§¯è¯¯å·®å‡é«˜ï¼Œåˆ™åœæ­¢è®­ç»ƒã€‚</li>
<li>å¼•å…¥æ­£åˆ™åŒ–ï¼ˆregularizationï¼‰ï¼šåŸºæœ¬æ€æƒ³æ˜¯åœ¨ç´¯ç§¯è¯¯å·®å‡½æ•°ä¸­å¢åŠ ä¸€ä¸ªç”¨äºæè¿°ç½‘ç»œå¤æ‚åº¦çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚æ‰€æœ‰æƒå€¼ä¸é˜ˆå€¼çš„å¹³æ–¹å’Œï¼Œå…¶ä¸­Î»âˆˆï¼ˆ0,1ï¼‰ç”¨äºå¯¹ç´¯ç§¯ç»éªŒè¯¯å·®ä¸ç½‘ç»œå¤æ‚åº¦è¿™ä¸¤é¡¹è¿›è¡ŒæŠ˜ä¸­ï¼Œå¸¸é€šè¿‡äº¤å‰éªŒè¯æ³•æ¥ä¼°è®¡ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc72ce227ff1.png" alt="12.png" /></p>
<h3 id="54-å…¨å±€æœ€å°ä¸å±€éƒ¨æœ€å°"><a class="header" href="#54-å…¨å±€æœ€å°ä¸å±€éƒ¨æœ€å°"><strong>5.4 å…¨å±€æœ€å°ä¸å±€éƒ¨æœ€å°</strong></a></h3>
<p>æ¨¡å‹å­¦ä¹ çš„è¿‡ç¨‹å®è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯»æ‰¾æœ€ä¼˜å‚æ•°çš„è¿‡ç¨‹ï¼Œä¾‹å¦‚BPç®—æ³•è¯•å›¾é€šè¿‡æœ€é€Ÿä¸‹é™æ¥å¯»æ‰¾ä½¿å¾—ç´¯ç§¯ç»éªŒè¯¯å·®æœ€å°çš„æƒå€¼ä¸é˜ˆå€¼ï¼Œåœ¨è°ˆåˆ°æœ€ä¼˜æ—¶ï¼Œä¸€èˆ¬ä¼šæåˆ°å±€éƒ¨æå°ï¼ˆlocal minimumï¼‰å’Œå…¨å±€æœ€å°ï¼ˆglobal minimumï¼‰ã€‚</p>
<ul>
<li>å±€éƒ¨æå°è§£ï¼šå‚æ•°ç©ºé—´ä¸­çš„æŸä¸ªç‚¹ï¼Œå…¶é‚»åŸŸç‚¹çš„è¯¯å·®å‡½æ•°å€¼å‡ä¸å°äºè¯¥ç‚¹çš„è¯¯å·®å‡½æ•°å€¼ã€‚</li>
<li>å…¨å±€æœ€å°è§£ï¼šå‚æ•°ç©ºé—´ä¸­çš„æŸä¸ªç‚¹ï¼Œæ‰€æœ‰å…¶ä»–ç‚¹çš„è¯¯å·®å‡½æ•°å€¼å‡ä¸å°äºè¯¥ç‚¹çš„è¯¯å·®å‡½æ•°å€¼ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc72ce2803dc.png" alt="13.png" /></p>
<p>è¦æˆä¸ºå±€éƒ¨æå°ç‚¹ï¼Œåªè¦æ»¡è¶³è¯¥ç‚¹åœ¨å‚æ•°ç©ºé—´ä¸­çš„æ¢¯åº¦ä¸ºé›¶ã€‚å±€éƒ¨æå°å¯ä»¥æœ‰å¤šä¸ªï¼Œè€Œå…¨å±€æœ€å°åªæœ‰ä¸€ä¸ªã€‚å…¨å±€æœ€å°ä¸€å®šæ˜¯å±€éƒ¨æå°ï¼Œä½†å±€éƒ¨æœ€å°å´ä¸ä¸€å®šæ˜¯å…¨å±€æœ€å°ã€‚æ˜¾ç„¶åœ¨å¾ˆå¤šæœºå™¨å­¦ä¹ ç®—æ³•ä¸­ï¼Œéƒ½è¯•å›¾æ‰¾åˆ°ç›®æ ‡å‡½æ•°çš„å…¨å±€æœ€å°ã€‚æ¢¯åº¦ä¸‹é™æ³•çš„ä¸»è¦æ€æƒ³å°±æ˜¯æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘å»æœç´¢æœ€ä¼˜è§£ï¼Œè´Ÿæ¢¯åº¦æ–¹å‘æ˜¯å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œè‹¥è¿­ä»£åˆ°æŸå¤„çš„æ¢¯åº¦ä¸º0ï¼Œåˆ™è¡¨ç¤ºè¾¾åˆ°ä¸€ä¸ªå±€éƒ¨æœ€å°ï¼Œå‚æ•°æ›´æ–°åœæ­¢ã€‚å› æ­¤åœ¨ç°å®ä»»åŠ¡ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥å°½å¯èƒ½åœ°å»æ¥è¿‘å…¨å±€æœ€å°ã€‚</p>
<ul>
<li>ä»¥å¤šç»„ä¸åŒå‚æ•°å€¼åˆå§‹åŒ–å¤šä¸ªç¥ç»ç½‘ç»œï¼ŒæŒ‰æ ‡å‡†æ–¹æ³•è®­ç»ƒï¼Œè¿­ä»£åœæ­¢åï¼Œå–å…¶ä¸­è¯¯å·®æœ€å°çš„è§£ä½œä¸ºæœ€ç»ˆå‚æ•°ã€‚</li>
<li>ä½¿ç”¨â€œæ¨¡æ‹Ÿé€€ç«â€æŠ€æœ¯ï¼Œè¿™é‡Œä¸åšå…·ä½“ä»‹ç»ã€‚</li>
<li>ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼Œå³åœ¨è®¡ç®—æ¢¯åº¦æ—¶åŠ å…¥äº†éšæœºå› ç´ ï¼Œä½¿å¾—åœ¨å±€éƒ¨æœ€å°æ—¶ï¼Œè®¡ç®—çš„æ¢¯åº¦ä»å¯èƒ½ä¸ä¸º0ï¼Œä»è€Œè¿­ä»£å¯ä»¥ç»§ç»­è¿›è¡Œã€‚</li>
</ul>
<h3 id="55-æ·±åº¦å­¦ä¹ "><a class="header" href="#55-æ·±åº¦å­¦ä¹ "><strong>5.5 æ·±åº¦å­¦ä¹ </strong></a></h3>
<p>ç†è®ºä¸Šï¼Œå‚æ•°è¶Šå¤šï¼Œæ¨¡å‹å¤æ‚åº¦å°±è¶Šé«˜ï¼Œå®¹é‡ï¼ˆcapabilityï¼‰å°±è¶Šå¤§ï¼Œä»è€Œèƒ½å®Œæˆæ›´å¤æ‚çš„å­¦ä¹ ä»»åŠ¡ã€‚æ·±åº¦å­¦ä¹ ï¼ˆdeep learningï¼‰æ­£æ˜¯ä¸€ç§æå…¶å¤æ‚è€Œå¼ºå¤§çš„æ¨¡å‹ã€‚</p>
<p>æ€ä¹ˆå¢å¤§æ¨¡å‹å¤æ‚åº¦å‘¢ï¼Ÿä¸¤ä¸ªåŠæ³•ï¼Œä¸€æ˜¯å¢åŠ éšå±‚çš„æ•°ç›®ï¼ŒäºŒæ˜¯å¢åŠ éšå±‚ç¥ç»å…ƒçš„æ•°ç›®ã€‚å‰è€…æ›´æœ‰æ•ˆä¸€äº›ï¼Œå› ä¸ºå®ƒä¸ä»…å¢åŠ äº†åŠŸèƒ½ç¥ç»å…ƒçš„æ•°é‡ï¼Œè¿˜å¢åŠ äº†æ¿€æ´»å‡½æ•°åµŒå¥—çš„å±‚æ•°ã€‚ä½†æ˜¯å¯¹äºå¤šéšå±‚ç¥ç»ç½‘ç»œï¼Œç»å…¸ç®—æ³•å¦‚æ ‡å‡†BPç®—æ³•å¾€å¾€ä¼šåœ¨è¯¯å·®é€†ä¼ æ’­æ—¶å‘æ•£ï¼ˆdivergeï¼‰ï¼Œæ— æ³•æ”¶æ•›è¾¾åˆ°ç¨³å®šçŠ¶æ€ã€‚</p>
<p>é‚£è¦æ€ä¹ˆæœ‰æ•ˆåœ°è®­ç»ƒå¤šéšå±‚ç¥ç»ç½‘ç»œå‘¢ï¼Ÿä¸€èˆ¬æ¥è¯´æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>æ— ç›‘ç£é€å±‚è®­ç»ƒï¼ˆunsupervised layer-wise trainingï¼‰ï¼šæ¯æ¬¡è®­ç»ƒä¸€å±‚éšèŠ‚ç‚¹ï¼ŒæŠŠä¸Šä¸€å±‚éšèŠ‚ç‚¹çš„è¾“å‡ºå½“ä½œè¾“å…¥æ¥è®­ç»ƒï¼Œæœ¬å±‚éšç»“ç‚¹è®­ç»ƒå¥½åï¼Œè¾“å‡ºå†ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥æ¥è®­ç»ƒï¼Œè¿™ç§°ä¸ºé¢„è®­ç»ƒï¼ˆpre-trainingï¼‰ã€‚å…¨éƒ¨é¢„è®­ç»ƒå®Œæˆåï¼Œå†å¯¹æ•´ä¸ªç½‘ç»œè¿›è¡Œå¾®è°ƒï¼ˆfine-tuningï¼‰è®­ç»ƒã€‚ä¸€ä¸ªå…¸å‹ä¾‹å­å°±æ˜¯æ·±åº¦ä¿¡å¿µç½‘ç»œï¼ˆdeep belief networkï¼Œç®€ç§°DBNï¼‰ã€‚è¿™ç§åšæ³•å…¶å®å¯ä»¥è§†ä¸ºæŠŠå¤§é‡çš„å‚æ•°è¿›è¡Œåˆ†ç»„ï¼Œå…ˆæ‰¾å‡ºæ¯ç»„è¾ƒå¥½çš„è®¾ç½®ï¼Œå†åŸºäºè¿™äº›å±€éƒ¨æœ€ä¼˜çš„ç»“æœæ¥è®­ç»ƒå…¨å±€æœ€ä¼˜ã€‚</p>
</li>
<li>
<p>æƒå…±äº«ï¼ˆweight sharingï¼‰ï¼šä»¤åŒä¸€å±‚ç¥ç»å…ƒä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¿æ¥æƒï¼Œå…¸å‹çš„ä¾‹å­æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networkï¼Œç®€ç§°CNNï¼‰ã€‚è¿™æ ·åšå¯ä»¥å¤§å¤§å‡å°‘éœ€è¦è®­ç»ƒçš„å‚æ•°æ•°ç›®ã€‚</p>
</li>
</ul>
<p><img src="https://i.loli.net/2018/10/17/5bc72ce28d756.png" alt="14.png" /></p>
<p>æ·±åº¦å­¦ä¹ å¯ä»¥ç†è§£ä¸ºä¸€ç§ç‰¹å¾å­¦ä¹ ï¼ˆfeature learningï¼‰æˆ–è€…è¡¨ç¤ºå­¦ä¹ ï¼ˆrepresentation learningï¼‰ï¼Œæ— è®ºæ˜¯DBNè¿˜æ˜¯CNNï¼Œéƒ½æ˜¯é€šè¿‡å¤šä¸ªéšå±‚æ¥æŠŠä¸è¾“å‡ºç›®æ ‡è”ç³»ä¸å¤§çš„åˆå§‹è¾“å…¥è½¬åŒ–ä¸ºä¸è¾“å‡ºç›®æ ‡æ›´åŠ å¯†åˆ‡çš„è¡¨ç¤ºï¼Œä½¿åŸæ¥åªé€šè¿‡å•å±‚æ˜ å°„éš¾ä»¥å®Œæˆçš„ä»»åŠ¡å˜ä¸ºå¯èƒ½ã€‚å³é€šè¿‡å¤šå±‚å¤„ç†ï¼Œé€æ¸å°†åˆå§‹çš„â€œä½å±‚â€ç‰¹å¾è¡¨ç¤ºè½¬åŒ–ä¸ºâ€œé«˜å±‚â€ç‰¹å¾è¡¨ç¤ºï¼Œä»è€Œä½¿å¾—æœ€åå¯ä»¥ç”¨ç®€å•çš„æ¨¡å‹æ¥å®Œæˆå¤æ‚çš„å­¦ä¹ ä»»åŠ¡ã€‚</p>
<p>ä¼ ç»Ÿä»»åŠ¡ä¸­ï¼Œæ ·æœ¬çš„ç‰¹å¾éœ€è¦äººç±»ä¸“å®¶æ¥è®¾è®¡ï¼Œè¿™ç§°ä¸ºç‰¹å¾å·¥ç¨‹ï¼ˆfeature engineeringï¼‰ã€‚ç‰¹å¾å¥½åå¯¹æ³›åŒ–æ€§èƒ½æœ‰è‡³å…³é‡è¦çš„å½±å“ã€‚è€Œæ·±åº¦å­¦ä¹ ä¸ºå…¨è‡ªåŠ¨æ•°æ®åˆ†æå¸¦æ¥äº†å¯èƒ½ï¼Œå¯ä»¥è‡ªåŠ¨äº§ç”Ÿæ›´å¥½çš„ç‰¹å¾ã€‚</p>
<h2 id="å…­-æ”¯æŒå‘é‡æœº"><a class="header" href="#å…­-æ”¯æŒå‘é‡æœº"><strong>å…­ï¼ æ”¯æŒå‘é‡æœº</strong></a></h2>
<p>æ”¯æŒå‘é‡æœºæ˜¯ä¸€ç§ç»å…¸çš„äºŒåˆ†ç±»æ¨¡å‹ï¼ŒåŸºæœ¬æ¨¡å‹å®šä¹‰ä¸ºç‰¹å¾ç©ºé—´ä¸­æœ€å¤§é—´éš”çš„çº¿æ€§åˆ†ç±»å™¨ï¼Œå…¶å­¦ä¹ çš„ä¼˜åŒ–ç›®æ ‡ä¾¿æ˜¯é—´éš”æœ€å¤§åŒ–ï¼Œå› æ­¤æ”¯æŒå‘é‡æœºæœ¬èº«å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå‡¸äºŒæ¬¡è§„åˆ’æ±‚è§£çš„é—®é¢˜ã€‚</p>
<h3 id="61-å‡½æ•°é—´éš”ä¸å‡ ä½•é—´éš”"><a class="header" href="#61-å‡½æ•°é—´éš”ä¸å‡ ä½•é—´éš”"><strong>6.1 å‡½æ•°é—´éš”ä¸å‡ ä½•é—´éš”</strong></a></h3>
<p>å¯¹äºäºŒåˆ†ç±»å­¦ä¹ ï¼Œå‡è®¾ç°åœ¨çš„æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œè¿™æ—¶åˆ†ç±»å­¦ä¹ æœ€åŸºæœ¬çš„æƒ³æ³•å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„è¶…å¹³é¢ï¼Œè¯¥è¶…å¹³é¢èƒ½å¤Ÿå°†ä¸åŒç±»åˆ«çš„æ ·æœ¬åˆ†å¼€ï¼Œç±»ä¼¼äºŒç»´å¹³é¢ä½¿ç”¨ax+by+c=0æ¥è¡¨ç¤ºï¼Œè¶…å¹³é¢å®é™…ä¸Šè¡¨ç¤ºçš„å°±æ˜¯é«˜ç»´çš„å¹³é¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f6a2ec8a.png" alt="1.png" /></p>
<p>å¯¹æ•°æ®ç‚¹è¿›è¡Œåˆ’åˆ†æ—¶ï¼Œæ˜“çŸ¥ï¼šå½“è¶…å¹³é¢è·ç¦»ä¸å®ƒæœ€è¿‘çš„æ•°æ®ç‚¹çš„é—´éš”è¶Šå¤§ï¼Œåˆ†ç±»çš„é²æ£’æ€§è¶Šå¥½ï¼Œå³å½“æ–°çš„æ•°æ®ç‚¹åŠ å…¥æ—¶ï¼Œè¶…å¹³é¢å¯¹è¿™äº›ç‚¹çš„é€‚åº”æ€§æœ€å¼ºï¼Œå‡ºé”™çš„å¯èƒ½æ€§æœ€å°ã€‚å› æ­¤éœ€è¦è®©æ‰€é€‰æ‹©çš„è¶…å¹³é¢èƒ½å¤Ÿæœ€å¤§åŒ–è¿™ä¸ªé—´éš”Gapï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œ å¸¸ç”¨çš„é—´éš”å®šä¹‰æœ‰ä¸¤ç§ï¼Œä¸€ç§ç§°ä¹‹ä¸ºå‡½æ•°é—´éš”ï¼Œä¸€ç§ä¸ºå‡ ä½•é—´éš”ï¼Œä¸‹é¢å°†åˆ†åˆ«ä»‹ç»è¿™ä¸¤ç§é—´éš”ï¼Œå¹¶å¯¹SVMä¸ºä»€ä¹ˆä¼šé€‰ç”¨å‡ ä½•é—´éš”åšäº†ä¸€äº›é˜è¿°ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f6a06d5a.png" alt="2.png" /></p>
<h4 id="611-å‡½æ•°é—´éš”"><a class="header" href="#611-å‡½æ•°é—´éš”"><strong>6.1.1 å‡½æ•°é—´éš”</strong></a></h4>
<p>åœ¨è¶…å¹³é¢w'x+b=0ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œ|w'x*+b|èƒ½å¤Ÿä»£è¡¨ç‚¹x<em>è·ç¦»è¶…å¹³é¢çš„è¿œè¿‘ï¼Œæ˜“çŸ¥ï¼šå½“w'x</em>+b&gt;0æ—¶ï¼Œè¡¨ç¤ºx<em>åœ¨è¶…å¹³é¢çš„ä¸€ä¾§ï¼ˆæ­£ç±»ï¼Œç±»æ ‡ä¸º1ï¼‰ï¼Œè€Œå½“w'x</em>+b&lt;0æ—¶ï¼Œåˆ™è¡¨ç¤ºx<em>åœ¨è¶…å¹³é¢çš„å¦å¤–ä¸€ä¾§ï¼ˆè´Ÿç±»ï¼Œç±»åˆ«ä¸º-1ï¼‰ï¼Œå› æ­¤ï¼ˆw'x</em>+bï¼‰y* çš„æ­£è´Ÿæ€§æ°èƒ½è¡¨ç¤ºæ•°æ®ç‚¹x*æ˜¯å¦è¢«åˆ†ç±»æ­£ç¡®ã€‚äºæ˜¯ä¾¿å¼•å‡ºäº†<strong>å‡½æ•°é—´éš”</strong>çš„å®šä¹‰ï¼ˆfunctional marginï¼‰:</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f690a14b.png" alt="3.png" /></p>
<p>è€Œè¶…å¹³é¢ï¼ˆw,bï¼‰å…³äºæ‰€æœ‰æ ·æœ¬ç‚¹ï¼ˆXiï¼ŒYiï¼‰çš„å‡½æ•°é—´éš”æœ€å°å€¼åˆ™ä¸ºè¶…å¹³é¢åœ¨è®­ç»ƒæ•°æ®é›†Tä¸Šçš„å‡½æ•°é—´éš”ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f690ac26.png" alt="4.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼šè¿™æ ·å®šä¹‰çš„å‡½æ•°é—´éš”åœ¨å¤„ç†SVMä¸Šä¼šæœ‰é—®é¢˜ï¼Œå½“è¶…å¹³é¢çš„ä¸¤ä¸ªå‚æ•°wå’ŒbåŒæ¯”ä¾‹æ”¹å˜æ—¶ï¼Œå‡½æ•°é—´éš”ä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œä½†æ˜¯å®é™…ä¸Šè¶…å¹³é¢è¿˜æ˜¯åŸæ¥çš„è¶…å¹³é¢ï¼Œå¹¶æ²¡æœ‰å˜åŒ–ã€‚ä¾‹å¦‚ï¼šw1x1+w2x2+w3x3+b=0å…¶å®ç­‰ä»·äº2w1x1+2w2x2+2w3x3+2b=0ï¼Œä½†è®¡ç®—çš„å‡½æ•°é—´éš”å´ç¿»äº†ä¸€å€ã€‚ä»è€Œå¼•å‡ºäº†èƒ½çœŸæ­£åº¦é‡ç‚¹åˆ°è¶…å¹³é¢è·ç¦»çš„æ¦‚å¿µ--å‡ ä½•é—´éš”ï¼ˆgeometrical marginï¼‰ã€‚</p>
<h4 id="612-å‡ ä½•é—´éš”"><a class="header" href="#612-å‡ ä½•é—´éš”"><strong>6.1.2 å‡ ä½•é—´éš”</strong></a></h4>
<p><strong>å‡ ä½•é—´éš”</strong>ä»£è¡¨çš„åˆ™æ˜¯æ•°æ®ç‚¹åˆ°è¶…å¹³é¢çš„çœŸå®è·ç¦»ï¼Œå¯¹äºè¶…å¹³é¢w'x+b=0ï¼Œwä»£è¡¨çš„æ˜¯è¯¥è¶…å¹³é¢çš„æ³•å‘é‡ï¼Œè®¾x<em>ä¸ºè¶…å¹³é¢å¤–ä¸€ç‚¹xåœ¨æ³•å‘é‡wæ–¹å‘ä¸Šçš„æŠ•å½±ç‚¹ï¼Œxä¸è¶…å¹³é¢çš„è·ç¦»ä¸ºrï¼Œåˆ™æœ‰x</em>=x-r(w/||w||)ï¼Œåˆx<em>åœ¨è¶…å¹³é¢ä¸Šï¼Œå³w'x</em>+b=0ï¼Œä»£å…¥å³å¯å¾—ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f697d499.png" alt="5.png" /></p>
<p>ä¸ºäº†å¾—åˆ°rçš„ç»å¯¹å€¼ï¼Œä»¤rå‘ˆä¸Šå…¶å¯¹åº”çš„ç±»åˆ«yï¼Œå³å¯å¾—åˆ°å‡ ä½•é—´éš”çš„å®šä¹‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f696fd10.png" alt="6.png" /></p>
<p>ä»ä¸Šè¿°å‡½æ•°é—´éš”ä¸å‡ ä½•é—´éš”çš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼šå®è´¨ä¸Šå‡½æ•°é—´éš”å°±æ˜¯|w'x+b|ï¼Œè€Œå‡ ä½•é—´éš”å°±æ˜¯ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»ã€‚</p>
<h3 id="62-æœ€å¤§é—´éš”ä¸æ”¯æŒå‘é‡"><a class="header" href="#62-æœ€å¤§é—´éš”ä¸æ”¯æŒå‘é‡"><strong>6.2 æœ€å¤§é—´éš”ä¸æ”¯æŒå‘é‡</strong></a></h3>
<p>é€šè¿‡å‰é¢çš„åˆ†æå¯çŸ¥ï¼šå‡½æ•°é—´éš”ä¸é€‚åˆç”¨æ¥æœ€å¤§åŒ–é—´éš”ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬è¦æ‰¾çš„æœ€å¤§é—´éš”æŒ‡çš„æ˜¯å‡ ä½•é—´éš”ï¼Œäºæ˜¯æœ€å¤§é—´éš”åˆ†ç±»å™¨çš„ç›®æ ‡å‡½æ•°å®šä¹‰ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f69af163.png" alt="7.png" /></p>
<p>ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬ä»¤r^ä¸º1ï¼ˆè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿æ¨å¯¼å’Œç›®æ ‡å‡½æ•°çš„ä¼˜åŒ–ï¼‰ï¼Œä»è€Œä¸Šè¿°ç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f697bb1d.png" alt="8.png" /></p>
<p>å¯¹äºy(w'x+b)=1çš„æ•°æ®ç‚¹ï¼Œå³ä¸‹å›¾ä¸­ä½äºw'x+b=1æˆ–w'x+b=-1ä¸Šçš„æ•°æ®ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>æ”¯æŒå‘é‡</strong>ï¼ˆsupport vectorï¼‰ï¼Œæ˜“çŸ¥ï¼šå¯¹äºæ‰€æœ‰çš„æ”¯æŒå‘é‡ï¼Œå®ƒä»¬æ°å¥½æ»¡è¶³y*(w'x*+b)=1ï¼Œè€Œæ‰€æœ‰ä¸æ˜¯æ”¯æŒå‘é‡çš„ç‚¹ï¼Œæœ‰y*(w'x*+b)&gt;1ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f6a838c4.png" alt="9.png" /></p>
<h3 id="63-ä»åŸå§‹ä¼˜åŒ–é—®é¢˜åˆ°å¯¹å¶é—®é¢˜"><a class="header" href="#63-ä»åŸå§‹ä¼˜åŒ–é—®é¢˜åˆ°å¯¹å¶é—®é¢˜"><strong>6.3 ä»åŸå§‹ä¼˜åŒ–é—®é¢˜åˆ°å¯¹å¶é—®é¢˜</strong></a></h3>
<p>å¯¹äºä¸Šè¿°å¾—åˆ°çš„ç›®æ ‡å‡½æ•°ï¼Œæ±‚1/||w||çš„æœ€å¤§å€¼ç›¸å½“äºæ±‚||w||^2çš„æœ€å°å€¼ï¼Œå› æ­¤å¾ˆå®¹æ˜“å°†åŸæ¥çš„ç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f6978cbb.png" alt="10.png" /></p>
<p>å³å˜ä¸ºäº†ä¸€ä¸ªå¸¦çº¦æŸçš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ŒæŒ‰ä¹¦ä¸Šæ‰€è¯´å¯ä»¥ä½¿ç”¨ç°æˆçš„ä¼˜åŒ–è®¡ç®—åŒ…ï¼ˆQPä¼˜åŒ–åŒ…ï¼‰æ±‚è§£ï¼Œä½†ç”±äºSVMçš„ç‰¹æ®Šæ€§ï¼Œä¸€èˆ¬æˆ‘ä»¬å°†åŸé—®é¢˜å˜æ¢ä¸ºå®ƒçš„<strong>å¯¹å¶é—®é¢˜</strong>ï¼Œæ¥ç€å†å¯¹å…¶å¯¹å¶é—®é¢˜è¿›è¡Œæ±‚è§£ã€‚ä¸ºä»€ä¹ˆé€šè¿‡å¯¹å¶é—®é¢˜è¿›è¡Œæ±‚è§£ï¼Œæœ‰ä¸‹é¢ä¸¤ä¸ªåŸå› ï¼š</p>
<ul>
<li>ä¸€æ˜¯å› ä¸ºä½¿ç”¨å¯¹å¶é—®é¢˜æ›´å®¹æ˜“æ±‚è§£ï¼›</li>
<li>äºŒæ˜¯å› ä¸ºé€šè¿‡å¯¹å¶é—®é¢˜æ±‚è§£å‡ºç°äº†å‘é‡å†…ç§¯çš„å½¢å¼ï¼Œä»è€Œèƒ½æ›´åŠ è‡ªç„¶åœ°å¼•å‡ºæ ¸å‡½æ•°ã€‚</li>
</ul>
<p>å¯¹å¶é—®é¢˜ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯ä»¥ç†è§£æˆä¼˜åŒ–ç­‰ä»·çš„é—®é¢˜ï¼Œæ›´ä¸€èˆ¬åœ°ï¼Œæ˜¯å°†ä¸€ä¸ªåŸå§‹ç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–è½¬åŒ–ä¸ºå®ƒçš„å¯¹å¶å‡½æ•°æœ€å¤§åŒ–çš„é—®é¢˜ã€‚å¯¹äºå½“å‰çš„ä¼˜åŒ–é—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬å†™å‡ºå®ƒçš„æœ—æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f9332be7.png" alt="11.png" /></p>
<p>ä¸Šå¼å¾ˆå®¹æ˜“éªŒè¯ï¼šå½“å…¶ä¸­æœ‰ä¸€ä¸ªçº¦æŸæ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼ŒLçš„æœ€å¤§å€¼ä¸º âˆï¼ˆåªéœ€ä»¤å…¶å¯¹åº”çš„Î±ä¸º âˆå³å¯ï¼‰ï¼›å½“æ‰€æœ‰çº¦æŸæ¡ä»¶éƒ½æ»¡è¶³æ—¶ï¼ŒLçš„æœ€å¤§å€¼ä¸º1/2||w||^2ï¼ˆæ­¤æ—¶ä»¤æ‰€æœ‰çš„Î±ä¸º0ï¼‰ï¼Œå› æ­¤å®é™…ä¸ŠåŸé—®é¢˜ç­‰ä»·äºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f93321c5.png" alt="12.png" /></p>
<p>ç”±äºè¿™ä¸ªçš„æ±‚è§£é—®é¢˜ä¸å¥½åšï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬å°†æœ€å°å’Œæœ€å¤§çš„ä½ç½®äº¤æ¢ä¸€ä¸‹ï¼ˆéœ€æ»¡è¶³KKTæ¡ä»¶ï¼‰ ï¼Œå˜æˆåŸé—®é¢˜çš„å¯¹å¶é—®é¢˜ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f9330967.png" alt="13.png" /></p>
<p>è¿™æ ·å°±å°†åŸé—®é¢˜çš„æ±‚æœ€å°å˜æˆäº†å¯¹å¶é—®é¢˜æ±‚æœ€å¤§ï¼ˆç”¨å¯¹å¶è¿™ä¸ªè¯è¿˜æ˜¯å¾ˆå½¢è±¡ï¼‰ï¼Œæ¥ä¸‹æ¥ä¾¿å¯ä»¥å…ˆæ±‚Lå¯¹wå’Œbçš„æå°ï¼Œå†æ±‚Lå¯¹Î±çš„æå¤§ã€‚</p>
<p>ï¼ˆ1ï¼‰é¦–å…ˆæ±‚Lå¯¹wå’Œbçš„æå°ï¼Œåˆ†åˆ«æ±‚Lå…³äºwå’Œbçš„åå¯¼ï¼Œå¯ä»¥å¾—å‡ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f9333e66.png" alt="14.png" /></p>
<p>å°†ä¸Šè¿°ç»“æœä»£å…¥Lå¾—åˆ°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f935ae21.png" alt="15.png" /></p>
<p>ï¼ˆ2ï¼‰æ¥ç€Lå…³äºÎ±æå¤§æ±‚è§£Î±ï¼ˆé€šè¿‡SMOç®—æ³•æ±‚è§£ï¼Œæ­¤å¤„ä¸åšæ·±å…¥ï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f9338a9d.png" alt="16.png" /></p>
<p>ï¼ˆ3ï¼‰æœ€åä¾¿å¯ä»¥æ ¹æ®æ±‚è§£å‡ºçš„Î±ï¼Œè®¡ç®—å‡ºwå’Œbï¼Œä»è€Œå¾—åˆ°åˆ†ç±»è¶…å¹³é¢å‡½æ•°ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f93419ca.png" alt="17.png" /></p>
<p>åœ¨å¯¹æ–°çš„ç‚¹è¿›è¡Œé¢„æµ‹æ—¶ï¼Œå®é™…ä¸Šå°±æ˜¯å°†æ•°æ®ç‚¹x*ä»£å…¥åˆ†ç±»å‡½æ•°f(x)=w'x+bä¸­ï¼Œè‹¥f(x)&gt;0ï¼Œåˆ™ä¸ºæ­£ç±»ï¼Œf(x)&lt;0ï¼Œåˆ™ä¸ºè´Ÿç±»ï¼Œæ ¹æ®å‰é¢æ¨å¯¼å¾—å‡ºçš„wä¸bï¼Œåˆ†ç±»å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¤æ—¶ä¾¿å‡ºç°äº†ä¸Šé¢æ‰€æåˆ°çš„å†…ç§¯å½¢å¼ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f9353166.png" alt="18.png" /></p>
<p>è¿™é‡Œå®é™…ä¸Šåªéœ€è®¡ç®—æ–°æ ·æœ¬ä¸æ”¯æŒå‘é‡çš„å†…ç§¯ï¼Œå› ä¸ºå¯¹äºéæ”¯æŒå‘é‡çš„æ•°æ®ç‚¹ï¼Œå…¶å¯¹åº”çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­ä¸€å®šä¸º0ï¼Œæ ¹æ®æœ€ä¼˜åŒ–ç†è®ºï¼ˆK-Tæ¡ä»¶ï¼‰ï¼Œå¯¹äºä¸ç­‰å¼çº¦æŸy(w'x+b)-1â‰¥0ï¼Œæ»¡è¶³ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f933c947.png" alt="19.png" /></p>
<h3 id="64-æ ¸å‡½æ•°"><a class="header" href="#64-æ ¸å‡½æ•°"><strong>6.4 æ ¸å‡½æ•°</strong></a></h3>
<p>ç”±äºä¸Šè¿°çš„è¶…å¹³é¢åªèƒ½è§£å†³çº¿æ€§å¯åˆ†çš„é—®é¢˜ï¼Œå¯¹äºçº¿æ€§ä¸å¯åˆ†çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼šå¼‚æˆ–é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ ¸å‡½æ•°å°†å…¶è¿›è¡Œæ¨å¹¿ã€‚ä¸€èˆ¬åœ°ï¼Œè§£å†³çº¿æ€§ä¸å¯åˆ†é—®é¢˜æ—¶ï¼Œå¸¸å¸¸é‡‡ç”¨<strong>æ˜ å°„</strong>çš„æ–¹å¼ï¼Œå°†ä½ç»´åŸå§‹ç©ºé—´æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´ï¼Œä½¿å¾—æ•°æ®é›†åœ¨é«˜ç»´ç©ºé—´ä¸­å˜å¾—çº¿æ€§å¯åˆ†ï¼Œä»è€Œå†ä½¿ç”¨çº¿æ€§å­¦ä¹ å™¨åˆ†ç±»ã€‚å¦‚æœåŸå§‹ç©ºé—´ä¸ºæœ‰é™ç»´ï¼Œå³å±æ€§æ•°æœ‰é™ï¼Œé‚£ä¹ˆæ€»æ˜¯å­˜åœ¨ä¸€ä¸ªé«˜ç»´ç‰¹å¾ç©ºé—´ä½¿å¾—æ ·æœ¬çº¿æ€§å¯åˆ†ã€‚è‹¥âˆ…ä»£è¡¨ä¸€ä¸ªæ˜ å°„ï¼Œåˆ™åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„åˆ’åˆ†å‡½æ•°å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc72f934303e.png" alt="20.png" /></p>
<p>æŒ‰ç…§åŒæ ·çš„æ–¹æ³•ï¼Œå…ˆå†™å‡ºæ–°ç›®æ ‡å‡½æ•°çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼Œæ¥ç€å†™å‡ºå…¶å¯¹å¶é—®é¢˜ï¼Œæ±‚Lå…³äºwå’Œbçš„æå¤§ï¼Œæœ€åè¿ç”¨SOMæ±‚è§£Î±ã€‚å¯ä»¥å¾—å‡ºï¼š</p>
<p>ï¼ˆ1ï¼‰åŸå¯¹å¶é—®é¢˜å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc68b3b.png" alt="21.png" /></p>
<p>ï¼ˆ2ï¼‰åŸåˆ†ç±»å‡½æ•°å˜ä¸ºï¼š
â€‹    <img src="https://i.loli.net/2018/10/17/5bc730cc1b673.png" alt="22.png" /></p>
<p>æ±‚è§£çš„è¿‡ç¨‹ä¸­ï¼Œåªæ¶‰åŠåˆ°äº†é«˜ç»´ç‰¹å¾ç©ºé—´ä¸­çš„å†…ç§¯è¿ç®—ï¼Œç”±äºç‰¹å¾ç©ºé—´çš„ç»´æ•°å¯èƒ½ä¼šéå¸¸å¤§ï¼Œä¾‹å¦‚ï¼šè‹¥åŸå§‹ç©ºé—´ä¸ºäºŒç»´ï¼Œæ˜ å°„åçš„ç‰¹å¾ç©ºé—´ä¸º5ç»´ï¼Œè‹¥åŸå§‹ç©ºé—´ä¸ºä¸‰ç»´ï¼Œæ˜ å°„åçš„ç‰¹å¾ç©ºé—´å°†æ˜¯19ç»´ï¼Œä¹‹åç”šè‡³å¯èƒ½å‡ºç°æ— ç©·ç»´ï¼Œæ ¹æœ¬æ— æ³•è¿›è¡Œå†…ç§¯è¿ç®—äº†ï¼Œæ­¤æ—¶ä¾¿å¼•å‡ºäº†<strong>æ ¸å‡½æ•°</strong>ï¼ˆKernelï¼‰çš„æ¦‚å¿µã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc49adc.png" alt="23.png" /></p>
<p>å› æ­¤ï¼Œæ ¸å‡½æ•°å¯ä»¥ç›´æ¥è®¡ç®—éšå¼æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´åçš„å‘é‡å†…ç§¯ï¼Œè€Œä¸éœ€è¦æ˜¾å¼åœ°å†™å‡ºæ˜ å°„åçš„ç»“æœï¼Œå®ƒè™½ç„¶å®Œæˆäº†å°†ç‰¹å¾ä»ä½ç»´åˆ°é«˜ç»´çš„è½¬æ¢ï¼Œä½†æœ€ç»ˆå´æ˜¯åœ¨ä½ç»´ç©ºé—´ä¸­å®Œæˆå‘é‡å†…ç§¯è®¡ç®—ï¼Œä¸é«˜ç»´ç‰¹å¾ç©ºé—´ä¸­çš„è®¡ç®—ç­‰æ•ˆ**ï¼ˆä½ç»´è®¡ç®—ï¼Œé«˜ç»´è¡¨ç°ï¼‰**ï¼Œä»è€Œé¿å…äº†ç›´æ¥åœ¨é«˜ç»´ç©ºé—´æ— æ³•è®¡ç®—çš„é—®é¢˜ã€‚å¼•å…¥æ ¸å‡½æ•°åï¼ŒåŸæ¥çš„å¯¹å¶é—®é¢˜ä¸åˆ†ç±»å‡½æ•°åˆ™å˜ä¸ºï¼š</p>
<p>ï¼ˆ1ï¼‰å¯¹å¶é—®é¢˜ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc173b2.png" alt="24.png" /></p>
<p>ï¼ˆ2ï¼‰åˆ†ç±»å‡½æ•°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc05959.png" alt="25.png" /></p>
<p>å› æ­¤ï¼Œåœ¨çº¿æ€§ä¸å¯åˆ†é—®é¢˜ä¸­ï¼Œæ ¸å‡½æ•°çš„é€‰æ‹©æˆäº†æ”¯æŒå‘é‡æœºçš„æœ€å¤§å˜æ•°ï¼Œè‹¥é€‰æ‹©äº†ä¸åˆé€‚çš„æ ¸å‡½æ•°ï¼Œåˆ™æ„å‘³ç€å°†æ ·æœ¬æ˜ å°„åˆ°äº†ä¸€ä¸ªä¸åˆé€‚çš„ç‰¹å¾ç©ºé—´ï¼Œåˆ™æå¯èƒ½å¯¼è‡´æ€§èƒ½ä¸ä½³ã€‚åŒæ—¶ï¼Œæ ¸å‡½æ•°éœ€è¦æ»¡è¶³ä»¥ä¸‹è¿™ä¸ªå¿…è¦æ¡ä»¶ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730ccc468c.png" alt="26.png" /></p>
<p>ç”±äºæ ¸å‡½æ•°çš„æ„é€ ååˆ†å›°éš¾ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ä»ä¸€äº›å¸¸ç”¨çš„æ ¸å‡½æ•°ä¸­é€‰æ‹©ï¼Œä¸‹é¢åˆ—å‡ºäº†å‡ ç§å¸¸ç”¨çš„æ ¸å‡½æ•°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730ccc541a.png" alt="27.png" /></p>
<h3 id="65-è½¯é—´éš”æ”¯æŒå‘é‡æœº"><a class="header" href="#65-è½¯é—´éš”æ”¯æŒå‘é‡æœº"><strong>6.5 è½¯é—´éš”æ”¯æŒå‘é‡æœº</strong></a></h3>
<p>å‰é¢çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬ä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼šå½“æ•°æ®çº¿æ€§å¯åˆ†æ—¶ï¼Œç›´æ¥ä½¿ç”¨æœ€å¤§é—´éš”çš„è¶…å¹³é¢åˆ’åˆ†ï¼›å½“æ•°æ®çº¿æ€§ä¸å¯åˆ†æ—¶ï¼Œåˆ™é€šè¿‡æ ¸å‡½æ•°å°†æ•°æ®æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´ï¼Œä½¿ä¹‹çº¿æ€§å¯åˆ†ã€‚ç„¶è€Œåœ¨ç°å®é—®é¢˜ä¸­ï¼Œå¯¹äºæŸäº›æƒ…å½¢è¿˜æ˜¯å¾ˆéš¾å¤„ç†ï¼Œä¾‹å¦‚æ•°æ®ä¸­æœ‰<strong>å™ªå£°</strong>çš„æƒ…å½¢ï¼Œå™ªå£°æ•°æ®ï¼ˆ<strong>outlier</strong>ï¼‰æœ¬èº«å°±åç¦»äº†æ­£å¸¸ä½ç½®ï¼Œä½†æ˜¯åœ¨å‰é¢çš„SVMæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬è¦æ±‚æ‰€æœ‰çš„æ ·æœ¬æ•°æ®éƒ½å¿…é¡»æ»¡è¶³çº¦æŸï¼Œå¦‚æœä¸è¦è¿™äº›å™ªå£°æ•°æ®è¿˜å¥½ï¼Œå½“åŠ å…¥è¿™äº›outlieråå¯¼è‡´åˆ’åˆ†è¶…å¹³é¢è¢«æŒ¤æ­ªäº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹æ”¯æŒå‘é‡æœºçš„æ³›åŒ–æ€§èƒ½é€ æˆå¾ˆå¤§çš„å½±å“ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730ccce68e.png" alt="28.png" /></p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…è®¸æŸä¸€äº›æ•°æ®ç‚¹ä¸æ»¡è¶³çº¦æŸï¼Œå³å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šåç§»è¶…å¹³é¢ï¼ŒåŒæ—¶ä½¿å¾—ä¸æ»¡è¶³çº¦æŸçš„æ•°æ®ç‚¹å°½å¯èƒ½å°‘ï¼Œè¿™ä¾¿å¼•å‡ºäº†**â€œè½¯é—´éš”â€æ”¯æŒå‘é‡æœº**çš„æ¦‚å¿µ</p>
<ul>
<li>å…è®¸æŸäº›æ•°æ®ç‚¹ä¸æ»¡è¶³çº¦æŸy(w'x+b)â‰¥1ï¼›</li>
<li>åŒæ—¶åˆä½¿å¾—ä¸æ»¡è¶³çº¦æŸçš„æ ·æœ¬å°½å¯èƒ½å°‘ã€‚</li>
</ul>
<p>è¿™æ ·ä¼˜åŒ–ç›®æ ‡å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc6c9fe.png" alt="29.png" /></p>
<p>å¦‚åŒé˜¶è·ƒå‡½æ•°ï¼Œ0/1æŸå¤±å‡½æ•°è™½ç„¶è¡¨ç¤ºæ•ˆæœæœ€å¥½ï¼Œä½†æ˜¯æ•°å­¦æ€§è´¨ä¸ä½³ã€‚å› æ­¤å¸¸ç”¨å…¶å®ƒå‡½æ•°ä½œä¸ºâ€œæ›¿ä»£æŸå¤±å‡½æ•°â€ã€‚</p>
<p><img src="https://i.loli.net/2018/10/17/5bc730cc5e5a9.png" alt="30.png" /></p>
<p>æ”¯æŒå‘é‡æœºä¸­çš„æŸå¤±å‡½æ•°ä¸º<strong>hingeæŸå¤±</strong>ï¼Œå¼•å…¥**â€œæ¾å¼›å˜é‡â€**ï¼Œç›®æ ‡å‡½æ•°ä¸çº¦æŸæ¡ä»¶å¯ä»¥å†™ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7317aa3411.png" alt="31.png" /></p>
<p>å…¶ä¸­Cä¸ºä¸€ä¸ªå‚æ•°ï¼Œæ§åˆ¶ç€ç›®æ ‡å‡½æ•°ä¸æ–°å¼•å…¥æ­£åˆ™é¡¹ä¹‹é—´çš„æƒé‡ï¼Œè¿™æ ·æ˜¾ç„¶æ¯ä¸ªæ ·æœ¬æ•°æ®éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ¾å¼›å˜é‡ï¼Œç”¨ä»¥è¡¨ç¤ºè¯¥æ ·æœ¬ä¸æ»¡è¶³çº¦æŸçš„ç¨‹åº¦ï¼Œå°†æ–°çš„ç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºæ‹‰æ ¼æœ—æ—¥å‡½æ•°å¾—åˆ°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7317a4c96e.png" alt="32.png" /></p>
<p>æŒ‰ç…§ä¸ä¹‹å‰ç›¸åŒçš„æ–¹æ³•ï¼Œå…ˆè®©Læ±‚å…³äºwï¼Œbä»¥åŠæ¾å¼›å˜é‡çš„æå°ï¼Œå†ä½¿ç”¨SMOæ±‚å‡ºÎ±ï¼Œæœ‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7317a6dff2.png" alt="33.png" /></p>
<p>å°†wä»£å…¥LåŒ–ç®€ï¼Œä¾¿å¾—åˆ°å…¶å¯¹å¶é—®é¢˜ï¼š</p>
<p><img src="https://i.loli.net/2018/10/17/5bc7317ab6646.png" alt="34.png" /></p>
<p>å°†â€œè½¯é—´éš”â€ä¸‹äº§ç”Ÿçš„å¯¹å¶é—®é¢˜ä¸åŸå¯¹å¶é—®é¢˜å¯¹æ¯”å¯ä»¥å‘ç°ï¼šæ–°çš„å¯¹å¶é—®é¢˜åªæ˜¯çº¦æŸæ¡ä»¶ä¸­çš„Î±å¤šå‡ºäº†ä¸€ä¸ªä¸Šé™Cï¼Œå…¶å®ƒçš„å®Œå…¨ç›¸åŒï¼Œå› æ­¤åœ¨å¼•å…¥æ ¸å‡½æ•°å¤„ç†çº¿æ€§ä¸å¯åˆ†é—®é¢˜æ—¶ï¼Œä¾¿èƒ½ä½¿ç”¨ä¸â€œç¡¬é—´éš”â€æ”¯æŒå‘é‡æœºå®Œå…¨ç›¸åŒçš„æ–¹æ³•ã€‚</p>
<h2 id="ä¸ƒ-è´å¶æ–¯åˆ†ç±»å™¨"><a class="header" href="#ä¸ƒ-è´å¶æ–¯åˆ†ç±»å™¨"><strong>ä¸ƒï¼ è´å¶æ–¯åˆ†ç±»å™¨</strong></a></h2>
<p>è´å¶æ–¯åˆ†ç±»å™¨æ˜¯ä¸€ç§æ¦‚ç‡æ¡†æ¶ä¸‹çš„ç»Ÿè®¡å­¦ä¹ åˆ†ç±»å™¨ï¼Œå¯¹åˆ†ç±»ä»»åŠ¡è€Œè¨€ï¼Œå‡è®¾åœ¨ç›¸å…³æ¦‚ç‡éƒ½å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œè´å¶æ–¯åˆ†ç±»å™¨è€ƒè™‘å¦‚ä½•åŸºäºè¿™äº›æ¦‚ç‡ä¸ºæ ·æœ¬åˆ¤å®šæœ€ä¼˜çš„ç±»æ ‡ã€‚åœ¨å¼€å§‹ä»‹ç»è´å¶æ–¯å†³ç­–è®ºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥å›é¡¾ä¸‹æ¦‚ç‡è®ºå§”å‘˜ä¼šå¸¸å§”--è´å¶æ–¯å…¬å¼ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd7a2575.png" alt="1.png" /></p>
<h3 id="71-è´å¶æ–¯å†³ç­–è®º"><a class="header" href="#71-è´å¶æ–¯å†³ç­–è®º"><strong>7.1 è´å¶æ–¯å†³ç­–è®º</strong></a></h3>
<p>è‹¥å°†ä¸Šè¿°å®šä¹‰ä¸­æ ·æœ¬ç©ºé—´çš„åˆ’åˆ†Biçœ‹åšä¸ºç±»æ ‡ï¼ŒAçœ‹åšä¸ºä¸€ä¸ªæ–°çš„æ ·æœ¬ï¼Œåˆ™å¾ˆå®¹æ˜“å°†æ¡ä»¶æ¦‚ç‡ç†è§£ä¸ºæ ·æœ¬Aæ˜¯ç±»åˆ«Biçš„æ¦‚ç‡ã€‚åœ¨æœºå™¨å­¦ä¹ è®­ç»ƒæ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€æˆ‘ä»¬éƒ½è¯•å›¾å»ä¼˜åŒ–ä¸€ä¸ªé£é™©å‡½æ•°ï¼Œå› æ­¤åœ¨æ¦‚ç‡æ¡†æ¶ä¸‹æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºè´å¶æ–¯å®šä¹‰â€œ<strong>æ¡ä»¶é£é™©</strong>â€ï¼ˆconditional riskï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd15db94.png" alt="2.png" /></p>
<p>æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯å¯»æ‰¾ä¸€ä¸ªåˆ¤å®šå‡†åˆ™æœ€å°åŒ–æ‰€æœ‰æ ·æœ¬çš„æ¡ä»¶é£é™©æ€»å’Œï¼Œå› æ­¤å°±æœ‰äº†<strong>è´å¶æ–¯åˆ¤å®šå‡†åˆ™</strong>ï¼ˆBayes decision ruleï¼‰:ä¸ºæœ€å°åŒ–æ€»ä½“é£é™©ï¼Œåªéœ€åœ¨æ¯ä¸ªæ ·æœ¬ä¸Šé€‰æ‹©é‚£ä¸ªä½¿å¾—æ¡ä»¶é£é™©æœ€å°çš„ç±»æ ‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd308600.png" alt="3.png" /></p>
<p>è‹¥æŸå¤±å‡½æ•°Î»å–0-1æŸå¤±ï¼Œåˆ™æœ‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd37c502.png" alt="4.png" /></p>
<p>å³å¯¹äºæ¯ä¸ªæ ·æœ¬xï¼Œé€‰æ‹©å…¶åéªŒæ¦‚ç‡Pï¼ˆc | xï¼‰æœ€å¤§æ‰€å¯¹åº”çš„ç±»æ ‡ï¼Œèƒ½ä½¿å¾—æ€»ä½“é£é™©å‡½æ•°æœ€å°ï¼Œä»è€Œå°†åŸé—®é¢˜è½¬åŒ–ä¸ºä¼°è®¡åéªŒæ¦‚ç‡Pï¼ˆc | xï¼‰ã€‚ä¸€èˆ¬è¿™é‡Œæœ‰ä¸¤ç§ç­–ç•¥æ¥å¯¹åéªŒæ¦‚ç‡è¿›è¡Œä¼°è®¡ï¼š</p>
<ul>
<li>åˆ¤åˆ«å¼æ¨¡å‹ï¼šç›´æ¥å¯¹ Pï¼ˆc | xï¼‰è¿›è¡Œå»ºæ¨¡æ±‚è§£ã€‚ä¾‹æˆ‘ä»¬å‰é¢æ‰€ä»‹ç»çš„å†³ç­–æ ‘ã€ç¥ç»ç½‘ç»œã€SVMéƒ½æ˜¯å±äºåˆ¤åˆ«å¼æ¨¡å‹ã€‚</li>
<li>ç”Ÿæˆå¼æ¨¡å‹ï¼šé€šè¿‡å…ˆå¯¹è”åˆåˆ†å¸ƒPï¼ˆx,cï¼‰å»ºæ¨¡ï¼Œä»è€Œè¿›ä¸€æ­¥æ±‚è§£ Pï¼ˆc | xï¼‰ã€‚</li>
</ul>
<p>è´å¶æ–¯åˆ†ç±»å™¨å°±å±äºç”Ÿæˆå¼æ¨¡å‹ï¼ŒåŸºäºè´å¶æ–¯å…¬å¼å¯¹åéªŒæ¦‚ç‡Pï¼ˆc | xï¼‰ è¿›è¡Œä¸€é¡¹ç¥å¥‡çš„å˜æ¢ï¼Œå·´æ‹‰æ‹‰èƒ½é‡.... Pï¼ˆc | xï¼‰å˜èº«ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd501ad3.png" alt="5.png" /></p>
<p>å¯¹äºç»™å®šçš„æ ·æœ¬xï¼ŒPï¼ˆxï¼‰ä¸ç±»æ ‡æ— å…³ï¼ŒPï¼ˆcï¼‰ç§°ä¸ºç±»å…ˆéªŒæ¦‚ç‡ï¼Œpï¼ˆx | c ï¼‰ç§°ä¸ºç±»æ¡ä»¶æ¦‚ç‡ã€‚è¿™æ—¶ä¼°è®¡åéªŒæ¦‚ç‡Pï¼ˆc | xï¼‰å°±å˜æˆä¸ºä¼°è®¡ç±»å…ˆéªŒæ¦‚ç‡å’Œç±»æ¡ä»¶æ¦‚ç‡çš„é—®é¢˜ã€‚å¯¹äºå…ˆéªŒæ¦‚ç‡å’ŒåéªŒæ¦‚ç‡ï¼Œåœ¨çœ‹è¿™ç« ä¹‹å‰ä¹Ÿæ˜¯æ¨¡ç³Šäº†æˆ‘å¥½ä¹…ï¼Œè¿™é‡Œæ™®åŠä¸€ä¸‹å®ƒä»¬çš„åŸºæœ¬æ¦‚å¿µã€‚</p>
<ul>
<li>å…ˆéªŒæ¦‚ç‡ï¼š æ ¹æ®ä»¥å¾€ç»éªŒå’Œåˆ†æå¾—åˆ°çš„æ¦‚ç‡ã€‚</li>
<li>åéªŒæ¦‚ç‡ï¼šåéªŒæ¦‚ç‡æ˜¯åŸºäºæ–°çš„ä¿¡æ¯ï¼Œä¿®æ­£åŸæ¥çš„å…ˆéªŒæ¦‚ç‡åæ‰€è·å¾—çš„æ›´æ¥è¿‘å®é™…æƒ…å†µçš„æ¦‚ç‡ä¼°è®¡ã€‚</li>
</ul>
<p>å®é™…ä¸Šå…ˆéªŒæ¦‚ç‡å°±æ˜¯åœ¨æ²¡æœ‰ä»»ä½•ç»“æœå‡ºæ¥çš„æƒ…å†µä¸‹ä¼°è®¡çš„æ¦‚ç‡ï¼Œè€ŒåéªŒæ¦‚ç‡åˆ™æ˜¯åœ¨æœ‰ä¸€å®šä¾æ®åçš„é‡æ–°ä¼°è®¡ï¼Œç›´è§‚æ„ä¹‰ä¸ŠåéªŒæ¦‚ç‡å°±æ˜¯æ¡ä»¶æ¦‚ç‡ã€‚ä¸‹é¢ç›´æ¥ä¸ŠWikiä¸Šçš„ä¸€ä¸ªä¾‹å­ï¼Œç®€å•ç²—æš´å¿«é€Ÿå®Œäº‹...</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd799610.png" alt="6.png" /></p>
<p>å›å½’æ­£é¢˜ï¼Œå¯¹äºç±»å…ˆéªŒæ¦‚ç‡Pï¼ˆcï¼‰ï¼Œpï¼ˆcï¼‰å°±æ˜¯æ ·æœ¬ç©ºé—´ä¸­å„ç±»æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ï¼Œæ ¹æ®å¤§æ•°å®šç†ï¼ˆå½“æ ·æœ¬è¶³å¤Ÿå¤šæ—¶ï¼Œé¢‘ç‡è¶‹äºç¨³å®šç­‰äºå…¶æ¦‚ç‡ï¼‰ï¼Œè¿™æ ·å½“è®­ç»ƒæ ·æœ¬å……è¶³æ—¶ï¼Œp(c)å¯ä»¥ä½¿ç”¨å„ç±»å‡ºç°çš„é¢‘ç‡æ¥ä»£æ›¿ã€‚å› æ­¤åªå‰©ä¸‹ç±»æ¡ä»¶æ¦‚ç‡pï¼ˆx | c ï¼‰ï¼Œå®ƒè¡¨è¾¾çš„æ„æ€æ˜¯åœ¨ç±»åˆ«cä¸­å‡ºç°xçš„æ¦‚ç‡ï¼Œå®ƒæ¶‰åŠåˆ°å±æ€§çš„è”åˆæ¦‚ç‡é—®é¢˜ï¼Œè‹¥åªæœ‰ä¸€ä¸ªç¦»æ•£å±æ€§è¿˜å¥½ï¼Œå½“å±æ€§å¤šæ—¶é‡‡ç”¨é¢‘ç‡ä¼°è®¡èµ·æ¥å°±ååˆ†å›°éš¾ï¼Œå› æ­¤è¿™é‡Œä¸€èˆ¬é‡‡ç”¨æå¤§ä¼¼ç„¶æ³•è¿›è¡Œä¼°è®¡ã€‚</p>
<h3 id="72-æå¤§ä¼¼ç„¶æ³•"><a class="header" href="#72-æå¤§ä¼¼ç„¶æ³•"><strong>7.2 æå¤§ä¼¼ç„¶æ³•</strong></a></h3>
<p>æå¤§ä¼¼ç„¶ä¼°è®¡ï¼ˆMaximum Likelihood Estimationï¼Œç®€ç§°MLEï¼‰ï¼Œæ˜¯ä¸€ç§æ ¹æ®æ•°æ®é‡‡æ ·æ¥ä¼°è®¡æ¦‚ç‡åˆ†å¸ƒçš„ç»å…¸æ–¹æ³•ã€‚å¸¸ç”¨çš„ç­–ç•¥æ˜¯å…ˆå‡å®šæ€»ä½“å…·æœ‰æŸç§ç¡®å®šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œå†åŸºäºè®­ç»ƒæ ·æœ¬å¯¹æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°è¿›è¡Œä¼°è®¡ã€‚è¿ç”¨åˆ°ç±»æ¡ä»¶æ¦‚ç‡pï¼ˆx | c ï¼‰ä¸­ï¼Œå‡è®¾pï¼ˆx | c ï¼‰æœä»ä¸€ä¸ªå‚æ•°ä¸ºÎ¸çš„åˆ†å¸ƒï¼Œé—®é¢˜å°±å˜ä¸ºæ ¹æ®å·²çŸ¥çš„è®­ç»ƒæ ·æœ¬æ¥ä¼°è®¡Î¸ã€‚æå¤§ä¼¼ç„¶æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šä¼°è®¡å‡ºçš„å‚æ•°ä½¿å¾—å·²çŸ¥æ ·æœ¬å‡ºç°çš„æ¦‚ç‡æœ€å¤§ï¼Œå³ä½¿å¾—è®­ç»ƒæ•°æ®çš„ä¼¼ç„¶æœ€å¤§ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd70fb73.png" alt="7.png" /></p>
<p>æ‰€ä»¥ï¼Œè´å¶æ–¯åˆ†ç±»å™¨çš„è®­ç»ƒè¿‡ç¨‹å°±æ˜¯å‚æ•°ä¼°è®¡ã€‚æ€»ç»“æœ€å¤§ä¼¼ç„¶æ³•ä¼°è®¡å‚æ•°çš„è¿‡ç¨‹ï¼Œä¸€èˆ¬åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p>
<ul>
<li>1.å†™å‡ºä¼¼ç„¶å‡½æ•°ï¼›</li>
<li>2.å¯¹ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°ï¼Œå¹¶æ•´ç†ï¼›</li>
<li>3.æ±‚å¯¼æ•°ï¼Œä»¤åå¯¼æ•°ä¸º0ï¼Œå¾—åˆ°ä¼¼ç„¶æ–¹ç¨‹ç»„ï¼›</li>
<li>4.è§£ä¼¼ç„¶æ–¹ç¨‹ç»„ï¼Œå¾—åˆ°æ‰€æœ‰å‚æ•°å³ä¸ºæ‰€æ±‚ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼šå‡è®¾æ ·æœ¬å±æ€§éƒ½æ˜¯è¿ç»­å€¼ï¼Œpï¼ˆx | c ï¼‰æœä»ä¸€ä¸ªå¤šç»´é«˜æ–¯åˆ†å¸ƒï¼Œåˆ™é€šè¿‡MLEè®¡ç®—å‡ºçš„å‚æ•°åˆšå¥½åˆ†åˆ«ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd705729.png" alt="8.png" /></p>
<p>ä¸Šè¿°ç»“æœçœ‹èµ·æ¥ååˆ†åˆä¹å®é™…ï¼Œä½†æ˜¯é‡‡ç”¨æœ€å¤§ä¼¼ç„¶æ³•ä¼°è®¡å‚æ•°çš„æ•ˆæœå¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºä½œå‡ºçš„å‡è®¾æ˜¯å¦åˆç†ï¼Œæ˜¯å¦ç¬¦åˆæ½œåœ¨çš„çœŸå®æ•°æ®åˆ†å¸ƒã€‚è¿™å°±éœ€è¦å¤§é‡çš„ç»éªŒçŸ¥è¯†ï¼Œæç»Ÿè®¡è¶Šæ¥è¶Šå€¼é’±ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼Œå¤§ç‰›ä»¬ææŒ‡ä¸€ç®—æ¯”æˆ‘ä»¬æ¬ç –å‡ å¤©æ›´æœ‰æ•ˆæœã€‚</p>
<h3 id="73-æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨"><a class="header" href="#73-æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨"><strong>7.3 æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</strong></a></h3>
<p>ä¸éš¾çœ‹å‡ºï¼šåŸå§‹çš„è´å¶æ–¯åˆ†ç±»å™¨æœ€å¤§çš„é—®é¢˜åœ¨äºè”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°çš„ä¼°è®¡ï¼Œé¦–å…ˆéœ€è¦æ ¹æ®ç»éªŒæ¥å‡è®¾è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå…¶æ¬¡å½“å±æ€§å¾ˆå¤šæ—¶ï¼Œè®­ç»ƒæ ·æœ¬å¾€å¾€è¦†ç›–ä¸å¤Ÿï¼Œå‚æ•°çš„ä¼°è®¡ä¼šå‡ºç°å¾ˆå¤§çš„åå·®ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼ˆnaive Bayes classifierï¼‰é‡‡ç”¨äº†â€œå±æ€§æ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾â€ï¼Œå³æ ·æœ¬æ•°æ®çš„æ‰€æœ‰å±æ€§ä¹‹é—´ç›¸äº’ç‹¬ç«‹ã€‚è¿™æ ·ç±»æ¡ä»¶æ¦‚ç‡pï¼ˆx | c ï¼‰å¯ä»¥æ”¹å†™ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd55e102.png" alt="9.png" /></p>
<p>è¿™æ ·ï¼Œä¸ºæ¯ä¸ªæ ·æœ¬ä¼°è®¡ç±»æ¡ä»¶æ¦‚ç‡å˜æˆä¸ºæ¯ä¸ªæ ·æœ¬çš„æ¯ä¸ªå±æ€§ä¼°è®¡ç±»æ¡ä»¶æ¦‚ç‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fd6678cd.png" alt="10.png" /></p>
<p>ç›¸æ¯”åŸå§‹è´å¶æ–¯åˆ†ç±»å™¨ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨åŸºäºå•ä¸ªçš„å±æ€§è®¡ç®—ç±»æ¡ä»¶æ¦‚ç‡æ›´åŠ å®¹æ˜“æ“ä½œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šè‹¥æŸä¸ªå±æ€§å€¼åœ¨è®­ç»ƒé›†ä¸­å’ŒæŸä¸ªç±»åˆ«æ²¡æœ‰ä¸€èµ·å‡ºç°è¿‡ï¼Œè¿™æ ·ä¼šæŠ¹æ‰å…¶å®ƒçš„å±æ€§ä¿¡æ¯ï¼Œå› ä¸ºè¯¥æ ·æœ¬çš„ç±»æ¡ä»¶æ¦‚ç‡è¢«è®¡ç®—ä¸º0ã€‚å› æ­¤åœ¨ä¼°è®¡æ¦‚ç‡å€¼æ—¶ï¼Œå¸¸å¸¸ç”¨è¿›è¡Œå¹³æ»‘ï¼ˆsmoothingï¼‰å¤„ç†ï¼Œæ‹‰æ™®æ‹‰æ–¯ä¿®æ­£ï¼ˆLaplacian correctionï¼‰å°±æ˜¯å…¶ä¸­çš„ä¸€ç§ç»å…¸æ–¹æ³•ï¼Œå…·ä½“è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc83fe54aaed.png" alt="11.png" /></p>
<p>å½“è®­ç»ƒé›†è¶Šå¤§æ—¶ï¼Œæ‹‰æ™®æ‹‰æ–¯ä¿®æ­£å¼•å…¥çš„å½±å“è¶Šæ¥è¶Šå°ã€‚å¯¹äºè´å¶æ–¯åˆ†ç±»å™¨ï¼Œæ¨¡å‹çš„è®­ç»ƒå°±æ˜¯å‚æ•°ä¼°è®¡ï¼Œå› æ­¤å¯ä»¥äº‹å…ˆå°†æ‰€æœ‰çš„æ¦‚ç‡å‚¨å­˜å¥½ï¼Œå½“æœ‰æ–°æ ·æœ¬éœ€è¦åˆ¤å®šæ—¶ï¼Œç›´æ¥æŸ¥è¡¨è®¡ç®—å³å¯ã€‚</p>
<h2 id="å…«-emç®—æ³•"><a class="header" href="#å…«-emç®—æ³•"><strong>å…«ï¼ EMç®—æ³•</strong></a></h2>
<p>EMï¼ˆExpectation-Maximizationï¼‰ç®—æ³•æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¼°è®¡å‚æ•°éšå˜é‡çš„åˆ©å™¨ï¼Œä¹Ÿç§°ä¸ºâ€œæœŸæœ›æœ€å¤§ç®—æ³•â€ï¼Œæ˜¯æ•°æ®æŒ–æ˜çš„åå¤§ç»å…¸ç®—æ³•ä¹‹ä¸€ã€‚EMç®—æ³•ä¸»è¦åº”ç”¨äºè®­ç»ƒé›†æ ·æœ¬ä¸å®Œæ•´å³å­˜åœ¨éšå˜é‡æ—¶çš„æƒ…å½¢ï¼ˆä¾‹å¦‚æŸä¸ªå±æ€§å€¼æœªçŸ¥ï¼‰ï¼Œé€šè¿‡å…¶ç‹¬ç‰¹çš„â€œä¸¤æ­¥èµ°â€ç­–ç•¥èƒ½è¾ƒå¥½åœ°ä¼°è®¡å‡ºéšå˜é‡çš„å€¼ã€‚</p>
<h3 id="81-emç®—æ³•æ€æƒ³"><a class="header" href="#81-emç®—æ³•æ€æƒ³"><strong>8.1 EMç®—æ³•æ€æƒ³</strong></a></h3>
<p>EMæ˜¯ä¸€ç§è¿­ä»£å¼çš„æ–¹æ³•ï¼Œå®ƒçš„åŸºæœ¬æ€æƒ³å°±æ˜¯ï¼šè‹¥æ ·æœ¬æœä»çš„åˆ†å¸ƒå‚æ•°Î¸å·²çŸ¥ï¼Œåˆ™å¯ä»¥æ ¹æ®å·²è§‚æµ‹åˆ°çš„è®­ç»ƒæ ·æœ¬æ¨æ–­å‡ºéšå˜é‡Zçš„æœŸæœ›å€¼ï¼ˆEæ­¥ï¼‰ï¼Œè‹¥Zçš„å€¼å·²çŸ¥åˆ™è¿ç”¨æœ€å¤§ä¼¼ç„¶æ³•ä¼°è®¡å‡ºæ–°çš„Î¸å€¼ï¼ˆMæ­¥ï¼‰ã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°Zå’ŒÎ¸å€¼ä¸å†å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>ç®€å•æ¥è®²ï¼šå‡è®¾æˆ‘ä»¬æƒ³ä¼°è®¡Aå’ŒBè¿™ä¸¤ä¸ªå‚æ•°ï¼Œåœ¨å¼€å§‹çŠ¶æ€ä¸‹äºŒè€…éƒ½æ˜¯æœªçŸ¥çš„ï¼Œä½†å¦‚æœçŸ¥é“äº†Açš„ä¿¡æ¯å°±å¯ä»¥å¾—åˆ°Bçš„ä¿¡æ¯ï¼Œåè¿‡æ¥çŸ¥é“äº†Bä¹Ÿå°±å¾—åˆ°äº†Aã€‚å¯ä»¥è€ƒè™‘é¦–å…ˆèµ‹äºˆAæŸç§åˆå€¼ï¼Œä»¥æ­¤å¾—åˆ°Bçš„ä¼°è®¡å€¼ï¼Œç„¶åä»Bçš„å½“å‰å€¼å‡ºå‘ï¼Œé‡æ–°ä¼°è®¡Açš„å–å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°æ”¶æ•›ä¸ºæ­¢ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843bf53eb2.png" alt="1.png" /></p>
<p>ç°åœ¨å†æ¥å›æƒ³èšç±»çš„ä»£è¡¨ç®—æ³•K-Meansï¼šã€é¦–å…ˆéšæœºé€‰æ‹©ç±»ä¸­å¿ƒ=&gt;å°†æ ·æœ¬ç‚¹åˆ’åˆ†åˆ°ç±»ç°‡ä¸­=&gt;é‡æ–°è®¡ç®—ç±»ä¸­å¿ƒ=&gt;ä¸æ–­è¿­ä»£ç›´è‡³æ”¶æ•›ã€‘ï¼Œä¸éš¾å‘ç°è¿™ä¸ªè¿‡ç¨‹å’ŒEMè¿­ä»£çš„æ–¹æ³•æå…¶ç›¸ä¼¼ï¼Œäº‹å®ä¸Šï¼Œè‹¥å°†æ ·æœ¬çš„ç±»åˆ«çœ‹åšä¸ºâ€œéšå˜é‡â€ï¼ˆlatent variableï¼‰Zï¼Œç±»ä¸­å¿ƒçœ‹ä½œæ ·æœ¬çš„åˆ†å¸ƒå‚æ•°Î¸ï¼ŒK-Meanså°±æ˜¯é€šè¿‡EMç®—æ³•æ¥è¿›è¡Œè¿­ä»£çš„ï¼Œä¸æˆ‘ä»¬è¿™é‡Œä¸åŒçš„æ˜¯ï¼ŒK-Meansçš„ç›®æ ‡æ˜¯æœ€å°åŒ–æ ·æœ¬ç‚¹åˆ°å…¶å¯¹åº”ç±»ä¸­å¿ƒçš„è·ç¦»å’Œï¼Œä¸Šè¿°ä¸ºæå¤§åŒ–ä¼¼ç„¶å‡½æ•°ã€‚</p>
<h3 id="82-emç®—æ³•æ•°å­¦æ¨å¯¼"><a class="header" href="#82-emç®—æ³•æ•°å­¦æ¨å¯¼"><strong>8.2 EMç®—æ³•æ•°å­¦æ¨å¯¼</strong></a></h3>
<p>åœ¨ä¸Šç¯‡æå¤§ä¼¼ç„¶æ³•ä¸­ï¼Œå½“æ ·æœ¬å±æ€§å€¼éƒ½å·²çŸ¥æ—¶ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“é€šè¿‡æå¤§åŒ–å¯¹æ•°ä¼¼ç„¶ï¼Œæ¥ç€å¯¹æ¯ä¸ªå‚æ•°æ±‚åå¯¼è®¡ç®—å‡ºå‚æ•°çš„å€¼ã€‚ä½†å½“å­˜åœ¨éšå˜é‡æ—¶ï¼Œå°±æ— æ³•ç›´æ¥æ±‚è§£ï¼Œæ­¤æ—¶æˆ‘ä»¬é€šå¸¸æœ€å¤§åŒ–å·²è§‚å¯Ÿæ•°æ®çš„å¯¹æ•°â€œè¾¹é™…ä¼¼ç„¶â€ï¼ˆmarginal likelihoodï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843bfd84d2.png" alt="2.png" /></p>
<p>è¿™æ—¶å€™ï¼Œé€šè¿‡è¾¹ç¼˜ä¼¼ç„¶å°†éšå˜é‡Zå¼•å…¥è¿›æ¥ï¼Œå¯¹äºå‚æ•°ä¼°è®¡ï¼Œç°åœ¨ä¸æœ€å¤§ä¼¼ç„¶ä¸åŒçš„åªæ˜¯ä¼¼ç„¶å‡½æ•°å¼ä¸­å¤šäº†ä¸€ä¸ªæœªçŸ¥çš„å˜é‡Zï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°é€‚åˆçš„Î¸å’ŒZè®©L(Î¸)æœ€å¤§ï¼Œè¿™æ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ†åˆ«å¯¹æœªçŸ¥çš„Î¸å’ŒZæ±‚åå¯¼ï¼Œå†ä»¤å…¶ç­‰äº0ã€‚</p>
<p>ç„¶è€Œè§‚å¯Ÿä¸Šå¼å¯ä»¥å‘ç°ï¼Œå’Œçš„å¯¹æ•°ï¼ˆln(x1+x2+x3)ï¼‰æ±‚å¯¼ååˆ†å¤æ‚ï¼Œé‚£èƒ½å¦é€šè¿‡å˜æ¢ä¸Šå¼å¾—åˆ°ä¸€ç§æ±‚å¯¼ç®€å•çš„æ–°è¡¨è¾¾å¼å‘¢ï¼Ÿè¿™æ—¶å€™ Jensenä¸ç­‰å¼å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå…ˆå›é¡¾ä¸€ä¸‹é«˜ç­‰æ•°å­¦å‡¸å‡½æ•°çš„å†…å®¹ï¼š</p>
<p><strong>Jensen's inequality</strong>ï¼šè¿‡ä¸€ä¸ªå‡¸å‡½æ•°ä¸Šä»»æ„ä¸¤ç‚¹æ‰€ä½œå‰²çº¿ä¸€å®šåœ¨è¿™ä¸¤ç‚¹é—´çš„å‡½æ•°å›¾è±¡çš„ä¸Šæ–¹ã€‚ç†è§£èµ·æ¥ä¹Ÿååˆ†ç®€å•ï¼Œå¯¹äºå‡¸å‡½æ•°f(x)''&gt;0ï¼Œå³æ›²çº¿çš„å˜åŒ–ç‡æ˜¯è¶Šæ¥è¶Šå¤§å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥å‡½æ•°è¶Šåˆ°åé¢å¢é•¿è¶Šå‰å®³ï¼Œè¿™æ ·åœ¨ä¸€ä¸ªåŒºé—´ä¸‹ï¼Œå‡½æ•°çš„å‡å€¼å°±ä¼šå¤§ä¸€äº›äº†ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c064c72.png" alt="3.png" /></p>
<p>å› ä¸ºln(*)å‡½æ•°ä¸ºå‡¹å‡½æ•°ï¼Œæ•…å¯ä»¥å°†ä¸Šå¼â€œå’Œçš„å¯¹æ•°â€å˜ä¸ºâ€œå¯¹æ•°çš„å’Œâ€ï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“æ±‚å¯¼äº†ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c3490ad.png" alt="4.png" /></p>
<p>æ¥ç€æ±‚è§£Qiå’ŒÎ¸ï¼šé¦–å…ˆå›ºå®šÎ¸ï¼ˆåˆå§‹å€¼ï¼‰ï¼Œé€šè¿‡æ±‚è§£Qiä½¿å¾—Jï¼ˆÎ¸ï¼ŒQï¼‰åœ¨Î¸å¤„ä¸Lï¼ˆÎ¸ï¼‰ç›¸ç­‰ï¼Œå³æ±‚å‡ºLï¼ˆÎ¸ï¼‰çš„ä¸‹ç•Œï¼›ç„¶åå†å›ºå®šQiï¼Œè°ƒæ•´Î¸ï¼Œæœ€å¤§åŒ–ä¸‹ç•ŒJï¼ˆÎ¸ï¼ŒQï¼‰ã€‚ä¸æ–­é‡å¤ä¸¤ä¸ªæ­¥éª¤ç›´åˆ°ç¨³å®šã€‚é€šè¿‡jensenä¸ç­‰å¼çš„æ€§è´¨ï¼ŒQiçš„è®¡ç®—å…¬å¼å®é™…ä¸Šå°±æ˜¯åéªŒæ¦‚ç‡ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c21276c.png" alt="5.png" /></p>
<p>é€šè¿‡æ•°å­¦å…¬å¼çš„æ¨å¯¼ï¼Œç®€å•æ¥ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼šå›ºå®šÎ¸è®¡ç®—Qçš„è¿‡ç¨‹å°±æ˜¯åœ¨å»ºç«‹Lï¼ˆÎ¸ï¼‰çš„ä¸‹ç•Œï¼Œå³é€šè¿‡jensonä¸ç­‰å¼å¾—åˆ°çš„ä¸‹ç•Œï¼ˆEæ­¥ï¼‰ï¼›å›ºå®šQè®¡ç®—Î¸åˆ™æ˜¯ä½¿å¾—ä¸‹ç•Œæå¤§åŒ–ï¼ˆMæ­¥ï¼‰ï¼Œä»è€Œä¸æ–­æ¨é«˜è¾¹ç¼˜ä¼¼ç„¶Lï¼ˆÎ¸ï¼‰ã€‚ä»è€Œå¾ªåºæ¸è¿›åœ°è®¡ç®—å‡ºLï¼ˆÎ¸ï¼‰å–å¾—æå¤§å€¼æ—¶éšå˜é‡Zçš„ä¼°è®¡å€¼ã€‚</p>
<p>EMç®—æ³•ä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç§â€œåæ ‡ä¸‹é™æ³•â€ï¼Œé¦–å…ˆå›ºå®šä¸€ä¸ªå€¼ï¼Œå¯¹å¦å¤–ä¸€ä¸ªå€¼æ±‚æå€¼ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›ã€‚è¿™æ—¶å€™ä¹Ÿè®¸å¤§å®¶å°±æœ‰ç–‘é—®ï¼Œé—®ä»€ä¹ˆä¸ç›´æ¥è¿™ä¸¤ä¸ªå®¶ä¼™æ±‚åå¯¼ç”¨æ¢¯åº¦ä¸‹é™å‘¢ï¼Ÿè¿™æ—¶å€™å°±æ˜¯åæ ‡ä¸‹é™çš„ä¼˜åŠ¿ï¼Œæœ‰äº›ç‰¹æ®Šçš„å‡½æ•°ï¼Œä¾‹å¦‚æ›²çº¿å‡½æ•°z=y^2+x^2+x^2y+xy+...ï¼Œæ— æ³•ç›´æ¥æ±‚å¯¼ï¼Œè¿™æ—¶å¦‚æœå…ˆå›ºå®šå…¶ä¸­çš„ä¸€ä¸ªå˜é‡ï¼Œå†å¯¹å¦ä¸€ä¸ªå˜é‡æ±‚æå€¼ï¼Œåˆ™å˜å¾—å¯è¡Œã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c34e7ff.png" alt="6.png" /></p>
<h3 id="83-emç®—æ³•æµç¨‹"><a class="header" href="#83-emç®—æ³•æµç¨‹"><strong>8.3 EMç®—æ³•æµç¨‹</strong></a></h3>
<p>çœ‹å®Œæ•°å­¦æ¨å¯¼ï¼Œç®—æ³•çš„æµç¨‹ä¹Ÿå°±ååˆ†ç®€å•äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸€æ¥è‡ªè¥¿ç“œä¹¦ï¼Œå‘¨å¤©ä½¿çš„ä»‹ç»ååˆ†ç®€æ´ï¼›ç‰ˆæœ¬äºŒæ¥è‡ªäºå¤§ç‰›çš„åšå®¢ã€‚ç»“åˆç€æ•°å­¦æ¨å¯¼ï¼Œè‡ªè®¤ä¸ºç‰ˆæœ¬äºŒæ›´å…·æœ‰é€»è¾‘æ€§ï¼Œä¸¤è€…å”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºç‰ˆæœ¬äºŒå¤šå‡ºäº†çº¢æ¡†çš„éƒ¨åˆ†ï¼</p>
<p><strong>ç‰ˆæœ¬ä¸€ï¼š</strong></p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c0e19db.png" alt="7.png" /></p>
<p><strong>ç‰ˆæœ¬äºŒï¼š</strong></p>
<p><img src="https://i.loli.net/2018/10/18/5bc843c34775b.png" alt="8.png" /></p>
<h2 id="ä¹-é›†æˆå­¦ä¹ "><a class="header" href="#ä¹-é›†æˆå­¦ä¹ "><strong>ä¹ï¼ é›†æˆå­¦ä¹ </strong></a></h2>
<p>é¡¾åæ€ä¹‰ï¼Œé›†æˆå­¦ä¹ ï¼ˆensemble learningï¼‰æŒ‡çš„æ˜¯å°†å¤šä¸ªå­¦ä¹ å™¨è¿›è¡Œæœ‰æ•ˆåœ°ç»“åˆï¼Œç»„å»ºä¸€ä¸ªâ€œå­¦ä¹ å™¨å§”å‘˜ä¼šâ€ï¼Œå…¶ä¸­æ¯ä¸ªå­¦ä¹ å™¨æ‹…ä»»å§”å‘˜ä¼šæˆå‘˜å¹¶è¡Œä½¿æŠ•ç¥¨è¡¨å†³æƒï¼Œä½¿å¾—å§”å‘˜ä¼šæœ€åçš„å†³å®šæ›´èƒ½å¤Ÿå››æ–¹é€ ç¦æ™®åº¦ä¼—ç”Ÿ~...~ï¼Œå³å…¶æ³›åŒ–æ€§èƒ½è¦èƒ½ä¼˜äºå…¶ä¸­ä»»ä½•ä¸€ä¸ªå­¦ä¹ å™¨ã€‚</p>
<h3 id="91-ä¸ªä½“ä¸é›†æˆ"><a class="header" href="#91-ä¸ªä½“ä¸é›†æˆ"><strong>9.1 ä¸ªä½“ä¸é›†æˆ</strong></a></h3>
<p>é›†æˆå­¦ä¹ çš„åŸºæœ¬ç»“æ„ä¸ºï¼šå…ˆäº§ç”Ÿä¸€ç»„ä¸ªä½“å­¦ä¹ å™¨ï¼Œå†ä½¿ç”¨æŸç§ç­–ç•¥å°†å®ƒä»¬ç»“åˆåœ¨ä¸€èµ·ã€‚é›†æˆæ¨¡å‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0c15683.png" alt="1.png" /></p>
<p>åœ¨ä¸Šå›¾çš„é›†æˆæ¨¡å‹ä¸­ï¼Œè‹¥ä¸ªä½“å­¦ä¹ å™¨éƒ½å±äºåŒä¸€ç±»åˆ«ï¼Œä¾‹å¦‚éƒ½æ˜¯å†³ç­–æ ‘æˆ–éƒ½æ˜¯ç¥ç»ç½‘ç»œï¼Œåˆ™ç§°è¯¥é›†æˆä¸ºåŒè´¨çš„ï¼ˆhomogeneousï¼‰;è‹¥ä¸ªä½“å­¦ä¹ å™¨åŒ…å«å¤šç§ç±»å‹çš„å­¦ä¹ ç®—æ³•ï¼Œä¾‹å¦‚æ—¢æœ‰å†³ç­–æ ‘åˆæœ‰ç¥ç»ç½‘ç»œï¼Œåˆ™ç§°è¯¥é›†æˆä¸ºå¼‚è´¨çš„ï¼ˆheterogenousï¼‰ã€‚</p>
<blockquote>
<p><strong>åŒè´¨é›†æˆ</strong>ï¼šä¸ªä½“å­¦ä¹ å™¨ç§°ä¸ºâ€œåŸºå­¦ä¹ å™¨â€ï¼ˆbase learnerï¼‰ï¼Œå¯¹åº”çš„å­¦ä¹ ç®—æ³•ä¸ºâ€œåŸºå­¦ä¹ ç®—æ³•â€ï¼ˆbase learning algorithmï¼‰ã€‚
<strong>å¼‚è´¨é›†æˆ</strong>ï¼šä¸ªä½“å­¦ä¹ å™¨ç§°ä¸ºâ€œç»„ä»¶å­¦ä¹ å™¨â€ï¼ˆcomponent learnerï¼‰æˆ–ç›´ç§°ä¸ºâ€œä¸ªä½“å­¦ä¹ å™¨â€ã€‚</p>
</blockquote>
<p>ä¸Šé¢æˆ‘ä»¬å·²ç»æåˆ°è¦è®©é›†æˆèµ·æ¥çš„æ³›åŒ–æ€§èƒ½æ¯”å•ä¸ªå­¦ä¹ å™¨éƒ½è¦å¥½ï¼Œè™½è¯´å›¢ç»“åŠ›é‡å¤§ä½†ä¹Ÿæœ‰æœ¨æ¡¶çŸ­æ¿ç†è®ºè°ƒçš®æ£è›‹ï¼Œé‚£å¦‚ä½•åšåˆ°å‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†é›†æˆå­¦ä¹ çš„ä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼š<strong>å‡†ç¡®æ€§</strong>å’Œ<strong>å¤šæ ·æ€§</strong>ï¼ˆdiversityï¼‰ã€‚å‡†ç¡®æ€§æŒ‡çš„æ˜¯ä¸ªä½“å­¦ä¹ å™¨ä¸èƒ½å¤ªå·®ï¼Œè¦æœ‰ä¸€å®šçš„å‡†ç¡®åº¦ï¼›å¤šæ ·æ€§åˆ™æ˜¯ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´çš„è¾“å‡ºè¦å…·æœ‰å·®å¼‚æ€§ã€‚é€šè¿‡ä¸‹é¢çš„è¿™ä¸‰ä¸ªä¾‹å­å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºè¿™ä¸€ç‚¹ï¼Œå‡†ç¡®åº¦è¾ƒé«˜ï¼Œå·®å¼‚åº¦ä¹Ÿè¾ƒé«˜ï¼Œå¯ä»¥è¾ƒå¥½åœ°æå‡é›†æˆæ€§èƒ½ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d23e13.png" alt="2.png" /></p>
<p>ç°åœ¨è€ƒè™‘äºŒåˆ†ç±»çš„ç®€å•æƒ…å½¢ï¼Œå‡è®¾åŸºåˆ†ç±»å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼ˆèƒ½æä¾›è¾ƒé«˜çš„å·®å¼‚åº¦ï¼‰ï¼Œä¸”é”™è¯¯ç‡ç›¸ç­‰ä¸º Îµï¼Œåˆ™å¯ä»¥å°†é›†æˆå™¨çš„é¢„æµ‹çœ‹åšä¸€ä¸ªä¼¯åŠªåˆ©å®éªŒï¼Œæ˜“çŸ¥å½“æ‰€æœ‰åŸºåˆ†ç±»å™¨ä¸­ä¸è¶³ä¸€åŠé¢„æµ‹æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œé›†æˆå™¨é¢„æµ‹é”™è¯¯ï¼Œæ‰€ä»¥é›†æˆå™¨çš„é”™è¯¯ç‡å¯ä»¥è®¡ç®—ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0cce0bb.png" alt="3.png" /></p>
<p>æ­¤æ—¶ï¼Œé›†æˆå™¨é”™è¯¯ç‡éšç€åŸºåˆ†ç±»å™¨çš„ä¸ªæ•°çš„å¢åŠ å‘ˆæŒ‡æ•°ä¸‹é™ï¼Œä½†å‰ææ˜¯åŸºåˆ†ç±»å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œåœ¨å®é™…æƒ…å½¢ä¸­æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œå‡è®¾è®­ç»ƒæœ‰Aå’ŒBä¸¤ä¸ªåˆ†ç±»å™¨ï¼Œå¯¹äºæŸä¸ªæµ‹è¯•æ ·æœ¬ï¼Œæ˜¾ç„¶æ»¡è¶³ï¼šPï¼ˆA=1 | B=1ï¼‰&gt; Pï¼ˆA=1ï¼‰ï¼Œå› ä¸ºAå’ŒBä¸ºäº†è§£å†³ç›¸åŒçš„é—®é¢˜è€Œè®­ç»ƒï¼Œå› æ­¤åœ¨é¢„æµ‹æ–°æ ·æœ¬æ—¶å­˜åœ¨ç€å¾ˆå¤§çš„è”ç³»ã€‚å› æ­¤ï¼Œ<strong>ä¸ªä½“å­¦ä¹ å™¨çš„â€œå‡†ç¡®æ€§â€å’Œâ€œå·®å¼‚æ€§â€æœ¬èº«å°±æ˜¯ä¸€å¯¹çŸ›ç›¾çš„å˜é‡</strong>ï¼Œå‡†ç¡®æ€§é«˜æ„å‘³ç€ç‰ºç‰²å¤šæ ·æ€§ï¼Œæ‰€ä»¥äº§ç”Ÿâ€œ<strong>å¥½è€Œä¸åŒ</strong>â€çš„ä¸ªä½“å­¦ä¹ å™¨æ­£æ˜¯é›†æˆå­¦ä¹ ç ”ç©¶çš„æ ¸å¿ƒã€‚ç°é˜¶æ®µæœ‰ä¸‰ç§ä¸»æµçš„é›†æˆå­¦ä¹ æ–¹æ³•ï¼šBoostingã€Baggingä»¥åŠéšæœºæ£®æ—ï¼ˆRandom Forestï¼‰ï¼Œæ¥ä¸‹æ¥å°†è¿›è¡Œé€ä¸€ä»‹ç»ã€‚</p>
<h3 id="92-boosting"><a class="header" href="#92-boosting"><strong>9.2 Boosting</strong></a></h3>
<p>Boostingæ˜¯ä¸€ç§ä¸²è¡Œçš„å·¥ä½œæœºåˆ¶ï¼Œå³ä¸ªä½“å­¦ä¹ å™¨çš„è®­ç»ƒå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¿…é¡»ä¸€æ­¥ä¸€æ­¥åºåˆ—åŒ–è¿›è¡Œã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼šå¢åŠ å‰ä¸€ä¸ªåŸºå­¦ä¹ å™¨åœ¨è®­ç»ƒè®­ç»ƒè¿‡ç¨‹ä¸­é¢„æµ‹é”™è¯¯æ ·æœ¬çš„æƒé‡ï¼Œä½¿å¾—åç»­åŸºå­¦ä¹ å™¨æ›´åŠ å…³æ³¨è¿™äº›æ‰“æ ‡é”™è¯¯çš„è®­ç»ƒæ ·æœ¬ï¼Œå°½å¯èƒ½çº æ­£è¿™äº›é”™è¯¯ï¼Œä¸€ç›´å‘ä¸‹ä¸²è¡Œç›´è‡³äº§ç”Ÿéœ€è¦çš„Tä¸ªåŸºå­¦ä¹ å™¨ï¼ŒBoostingæœ€ç»ˆå¯¹è¿™Tä¸ªå­¦ä¹ å™¨è¿›è¡ŒåŠ æƒç»“åˆï¼Œäº§ç”Ÿå­¦ä¹ å™¨å§”å‘˜ä¼šã€‚</p>
<p>Boostingæ—ç®—æ³•æœ€è‘—åã€ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„å°±æ˜¯AdaBoostï¼Œå› æ­¤ä¸‹é¢ä¸»è¦æ˜¯å¯¹AdaBoostç®—æ³•è¿›è¡Œä»‹ç»ã€‚AdaBoostä½¿ç”¨çš„æ˜¯<strong>æŒ‡æ•°æŸå¤±å‡½æ•°</strong>ï¼Œå› æ­¤AdaBoostçš„æƒå€¼ä¸æ ·æœ¬åˆ†å¸ƒçš„æ›´æ–°éƒ½æ˜¯å›´ç»•ç€æœ€å°åŒ–æŒ‡æ•°æŸå¤±å‡½æ•°è¿›è¡Œçš„ã€‚çœ‹åˆ°è¿™é‡Œå›æƒ³ä¸€ä¸‹ä¹‹å‰çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œ<strong>ä¸éš¾å‘ç°æœºå™¨å­¦ä¹ çš„å¤§éƒ¨åˆ†å¸¦å‚æ¨¡å‹åªæ˜¯æ”¹å˜äº†æœ€ä¼˜åŒ–ç›®æ ‡ä¸­çš„æŸå¤±å‡½æ•°</strong>ï¼šå¦‚æœæ˜¯Square lossï¼Œé‚£å°±æ˜¯æœ€å°äºŒä¹˜äº†ï¼›å¦‚æœæ˜¯Hinge Lossï¼Œé‚£å°±æ˜¯è‘—åçš„SVMäº†ï¼›å¦‚æœæ˜¯log-Lossï¼Œé‚£å°±æ˜¯Logistic Regressionäº†ã€‚</p>
<p>å®šä¹‰åŸºå­¦ä¹ å™¨çš„é›†æˆä¸ºåŠ æƒç»“åˆï¼Œåˆ™æœ‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0ca2ca5.png" alt="4.png" /></p>
<p>AdaBoostç®—æ³•çš„æŒ‡æ•°æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d10461.png" alt="5.png" /></p>
<p>å…·ä½“è¯´æ¥ï¼Œæ•´ä¸ªAdaboost è¿­ä»£ç®—æ³•åˆ†ä¸º3æ­¥ï¼š</p>
<ul>
<li>åˆå§‹åŒ–è®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒã€‚å¦‚æœæœ‰Nä¸ªæ ·æœ¬ï¼Œåˆ™æ¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬æœ€å¼€å§‹æ—¶éƒ½è¢«èµ‹äºˆç›¸åŒçš„æƒå€¼ï¼š1/Nã€‚</li>
<li>è®­ç»ƒå¼±åˆ†ç±»å™¨ã€‚å…·ä½“è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŸä¸ªæ ·æœ¬ç‚¹å·²ç»è¢«å‡†ç¡®åœ°åˆ†ç±»ï¼Œé‚£ä¹ˆåœ¨æ„é€ ä¸‹ä¸€ä¸ªè®­ç»ƒé›†ä¸­ï¼Œå®ƒçš„æƒå€¼å°±è¢«é™ä½ï¼›ç›¸åï¼Œå¦‚æœæŸä¸ªæ ·æœ¬ç‚¹æ²¡æœ‰è¢«å‡†ç¡®åœ°åˆ†ç±»ï¼Œé‚£ä¹ˆå®ƒçš„æƒå€¼å°±å¾—åˆ°æé«˜ã€‚ç„¶åï¼Œæƒå€¼æ›´æ–°è¿‡çš„æ ·æœ¬é›†è¢«ç”¨äºè®­ç»ƒä¸‹ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œæ•´ä¸ªè®­ç»ƒè¿‡ç¨‹å¦‚æ­¤è¿­ä»£åœ°è¿›è¡Œä¸‹å»ã€‚</li>
<li>å°†å„ä¸ªè®­ç»ƒå¾—åˆ°çš„å¼±åˆ†ç±»å™¨ç»„åˆæˆå¼ºåˆ†ç±»å™¨ã€‚å„ä¸ªå¼±åˆ†ç±»å™¨çš„è®­ç»ƒè¿‡ç¨‹ç»“æŸåï¼ŒåŠ å¤§åˆ†ç±»è¯¯å·®ç‡å°çš„å¼±åˆ†ç±»å™¨çš„æƒé‡ï¼Œä½¿å…¶åœ¨æœ€ç»ˆçš„åˆ†ç±»å‡½æ•°ä¸­èµ·ç€è¾ƒå¤§çš„å†³å®šä½œç”¨ï¼Œè€Œé™ä½åˆ†ç±»è¯¯å·®ç‡å¤§çš„å¼±åˆ†ç±»å™¨çš„æƒé‡ï¼Œä½¿å…¶åœ¨æœ€ç»ˆçš„åˆ†ç±»å‡½æ•°ä¸­èµ·ç€è¾ƒå°çš„å†³å®šä½œç”¨ã€‚</li>
</ul>
<p>æ•´ä¸ªAdaBoostçš„ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d7c057.png" alt="6.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼š<strong>AdaBoostçš„æ ¸å¿ƒæ­¥éª¤å°±æ˜¯è®¡ç®—åŸºå­¦ä¹ å™¨æƒé‡å’Œæ ·æœ¬æƒé‡åˆ†å¸ƒ</strong>ï¼Œé‚£ä¸ºä½•æ˜¯ä¸Šè¿°çš„è®¡ç®—å…¬å¼å‘¢ï¼Ÿè¿™å°±æ¶‰åŠåˆ°äº†æˆ‘ä»¬ä¹‹å‰ä¸ºä»€ä¹ˆè¯´å¤§éƒ¨åˆ†å¸¦å‚æœºå™¨å­¦ä¹ ç®—æ³•åªæ˜¯æ”¹å˜äº†æŸå¤±å‡½æ•°ï¼Œå°±æ˜¯å› ä¸º<strong>å¤§éƒ¨åˆ†æ¨¡å‹çš„å‚æ•°éƒ½æ˜¯é€šè¿‡æœ€ä¼˜åŒ–æŸå¤±å‡½æ•°ï¼ˆå¯èƒ½è¿˜åŠ ä¸ªè§„åˆ™é¡¹ï¼‰è€Œè®¡ç®—ï¼ˆæ¢¯åº¦ä¸‹é™ï¼Œåæ ‡ä¸‹é™ç­‰ï¼‰å¾—åˆ°</strong>ï¼Œè¿™é‡Œæ­£æ˜¯é€šè¿‡æœ€ä¼˜åŒ–æŒ‡æ•°æŸå¤±å‡½æ•°ä»è€Œå¾—åˆ°è¿™ä¸¤ä¸ªå‚æ•°çš„è®¡ç®—å…¬å¼ï¼Œå…·ä½“çš„æ¨å¯¼è¿‡ç¨‹æ­¤å¤„ä¸è¿›è¡Œå±•å¼€ã€‚</p>
<p>Boostingç®—æ³•è¦æ±‚åŸºå­¦ä¹ å™¨èƒ½å¯¹ç‰¹å®šåˆ†å¸ƒçš„æ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œå³æ¯æ¬¡éƒ½æ›´æ–°æ ·æœ¬åˆ†å¸ƒæƒé‡ï¼Œè¿™é‡Œä¹¦ä¸Šæåˆ°äº†ä¸¤ç§æ–¹æ³•ï¼šâ€œé‡èµ‹æƒæ³•â€ï¼ˆre-weightingï¼‰å’Œâ€œé‡é‡‡æ ·æ³•â€ï¼ˆre-samplingï¼‰ï¼Œä¹¦ä¸Šçš„è§£é‡Šæœ‰äº›æ™¦æ¶©ï¼Œè¿™é‡Œè¿›è¡Œå±•å¼€ä¸€ä¸‹ï¼š</p>
<blockquote>
<p><strong>é‡èµ‹æƒæ³•</strong> : å¯¹æ¯ä¸ªæ ·æœ¬é™„åŠ ä¸€ä¸ªæƒé‡ï¼Œè¿™æ—¶æ¶‰åŠåˆ°æ ·æœ¬å±æ€§ä¸æ ‡ç­¾çš„è®¡ç®—ï¼Œéƒ½éœ€è¦ä¹˜ä¸Šä¸€ä¸ªæƒå€¼ã€‚
<strong>é‡é‡‡æ ·æ³•</strong> : å¯¹äºä¸€äº›æ— æ³•æ¥å—å¸¦æƒæ ·æœ¬çš„åŠå­¦ä¹ ç®—æ³•ï¼Œé€‚åˆç”¨â€œé‡é‡‡æ ·æ³•â€è¿›è¡Œå¤„ç†ã€‚æ–¹æ³•å¤§è‡´è¿‡ç¨‹æ˜¯ï¼Œæ ¹æ®å„ä¸ªæ ·æœ¬çš„æƒé‡ï¼Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œé‡é‡‡æ ·ï¼Œåˆå§‹æ—¶æ ·æœ¬æƒé‡ä¸€æ ·ï¼Œæ¯ä¸ªæ ·æœ¬è¢«é‡‡æ ·åˆ°çš„æ¦‚ç‡ä¸€è‡´ï¼Œæ¯æ¬¡ä»Nä¸ªåŸå§‹çš„è®­ç»ƒæ ·æœ¬ä¸­æŒ‰ç…§æƒé‡æœ‰æ”¾å›é‡‡æ ·Nä¸ªæ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ï¼Œç„¶åè®¡ç®—è®­ç»ƒé›†é”™è¯¯ç‡ï¼Œç„¶åè°ƒæ•´æƒé‡ï¼Œé‡å¤é‡‡æ ·ï¼Œé›†æˆå¤šä¸ªåŸºå­¦ä¹ å™¨ã€‚</p>
</blockquote>
<p>ä»åå·®-æ–¹å·®åˆ†è§£æ¥çœ‹ï¼šBoostingç®—æ³•ä¸»è¦å…³æ³¨äºé™ä½åå·®ï¼Œæ¯è½®çš„è¿­ä»£éƒ½å…³æ³¨äºè®­ç»ƒè¿‡ç¨‹ä¸­é¢„æµ‹é”™è¯¯çš„æ ·æœ¬ï¼Œå°†å¼±å­¦ä¹ æå‡ä¸ºå¼ºå­¦ä¹ å™¨ã€‚ä»AdaBoostçš„ç®—æ³•æµç¨‹æ¥çœ‹ï¼Œæ ‡å‡†çš„AdaBooståªé€‚ç”¨äºäºŒåˆ†ç±»é—®é¢˜ã€‚åœ¨æ­¤ï¼Œå½“é€‰ä¸ºæ•°æ®æŒ–æ˜åå¤§ç®—æ³•ä¹‹ä¸€çš„AdaBoostä»‹ç»åˆ°è¿™é‡Œï¼Œèƒ½å¤Ÿå½“é€‰æ­£æ˜¯è¯´æ˜è¿™ä¸ªç®—æ³•ååˆ†å©€å¨œå¤šå§¿ï¼ŒèƒŒåçš„æ•°å­¦è¯æ˜å’Œæ¨å¯¼å……åˆ†è¯æ˜äº†è¿™ä¸€ç‚¹ï¼Œé™äºç¯‡å¹…ä¸å†ç»§ç»­å±•å¼€ã€‚</p>
<h3 id="93-baggingä¸random-forest"><a class="header" href="#93-baggingä¸random-forest"><strong>9.3 Baggingä¸Random Forest</strong></a></h3>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒBaggingä¸éšæœºæ£®æ—ç®—æ³•å°±ç®€æ´äº†è®¸å¤šï¼Œä¸Šé¢å·²ç»æåˆ°äº§ç”Ÿâ€œå¥½è€Œä¸åŒâ€çš„ä¸ªä½“å­¦ä¹ å™¨æ˜¯é›†æˆå­¦ä¹ ç ”ç©¶çš„æ ¸å¿ƒï¼Œå³åœ¨ä¿è¯åŸºå­¦ä¹ å™¨å‡†ç¡®æ€§çš„åŒæ—¶å¢åŠ åŸºå­¦ä¹ å™¨ä¹‹é—´çš„å¤šæ ·æ€§ã€‚è€Œè¿™ä¸¤ç§ç®—æ³•çš„åŸºæœ¬æ€ï¼ˆtaoï¼‰æƒ³ï¼ˆluï¼‰éƒ½æ˜¯é€šè¿‡â€œè‡ªåŠ©é‡‡æ ·â€çš„æ–¹æ³•æ¥å¢åŠ å¤šæ ·æ€§ã€‚</p>
<h4 id="931-bagging"><a class="header" href="#931-bagging"><strong>9.3.1 Bagging</strong></a></h4>
<p>Baggingæ˜¯ä¸€ç§å¹¶è¡Œå¼çš„é›†æˆå­¦ä¹ æ–¹æ³•ï¼Œå³åŸºå­¦ä¹ å™¨çš„è®­ç»ƒä¹‹é—´æ²¡æœ‰å‰åé¡ºåºå¯ä»¥åŒæ—¶è¿›è¡Œï¼ŒBaggingä½¿ç”¨â€œæœ‰æ”¾å›â€é‡‡æ ·çš„æ–¹å¼é€‰å–è®­ç»ƒé›†ï¼Œå¯¹äºåŒ…å«mä¸ªæ ·æœ¬çš„è®­ç»ƒé›†ï¼Œè¿›è¡Œmæ¬¡æœ‰æ”¾å›çš„éšæœºé‡‡æ ·æ“ä½œï¼Œä»è€Œå¾—åˆ°mä¸ªæ ·æœ¬çš„é‡‡æ ·é›†ï¼Œè¿™æ ·è®­ç»ƒé›†ä¸­æœ‰æ¥è¿‘36.8%çš„æ ·æœ¬æ²¡æœ‰è¢«é‡‡åˆ°ã€‚æŒ‰ç…§ç›¸åŒçš„æ–¹å¼é‡å¤è¿›è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡‡é›†åˆ°Tä¸ªåŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†ï¼Œä»è€Œè®­ç»ƒå‡ºTä¸ªåŸºå­¦ä¹ å™¨ï¼Œæœ€ç»ˆå¯¹è¿™Tä¸ªåŸºå­¦ä¹ å™¨çš„è¾“å‡ºè¿›è¡Œç»“åˆã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0ce62fc.png" alt="7.png" /></p>
<p>Baggingç®—æ³•çš„æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d0e761.png" alt="8.png" /></p>
<p>å¯ä»¥çœ‹å‡ºBaggingä¸»è¦é€šè¿‡<strong>æ ·æœ¬çš„æ‰°åŠ¨</strong>æ¥å¢åŠ åŸºå­¦ä¹ å™¨ä¹‹é—´çš„å¤šæ ·æ€§ï¼Œå› æ­¤Baggingçš„åŸºå­¦ä¹ å™¨åº”ä¸ºé‚£äº›å¯¹è®­ç»ƒé›†ååˆ†æ•æ„Ÿçš„ä¸ç¨³å®šå­¦ä¹ ç®—æ³•ï¼Œä¾‹å¦‚ï¼šç¥ç»ç½‘ç»œä¸å†³ç­–æ ‘ç­‰ã€‚ä»åå·®-æ–¹å·®åˆ†è§£æ¥çœ‹ï¼ŒBaggingç®—æ³•ä¸»è¦å…³æ³¨äºé™ä½æ–¹å·®ï¼Œå³é€šè¿‡å¤šæ¬¡é‡å¤è®­ç»ƒæé«˜ç¨³å®šæ€§ã€‚ä¸åŒäºAdaBoostçš„æ˜¯ï¼ŒBaggingå¯ä»¥ååˆ†ç®€å•åœ°ç§»æ¤åˆ°å¤šåˆ†ç±»ã€å›å½’ç­‰é—®é¢˜ã€‚æ€»çš„è¯´èµ·æ¥åˆ™æ˜¯ï¼š<strong>AdaBoostå…³æ³¨äºé™ä½åå·®ï¼Œè€ŒBaggingå…³æ³¨äºé™ä½æ–¹å·®ã€‚</strong></p>
<h4 id="932-éšæœºæ£®æ—"><a class="header" href="#932-éšæœºæ£®æ—"><strong>9.3.2 éšæœºæ£®æ—</strong></a></h4>
<p>éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰æ˜¯Baggingçš„ä¸€ä¸ªæ‹“å±•ä½“ï¼Œå®ƒçš„åŸºå­¦ä¹ å™¨å›ºå®šä¸ºå†³ç­–æ ‘ï¼Œå¤šæ£µæ ‘ä¹Ÿå°±ç»„æˆäº†æ£®æ—ï¼Œè€Œâ€œéšæœºâ€åˆ™åœ¨äºé€‰æ‹©åˆ’åˆ†å±æ€§çš„éšæœºï¼Œéšæœºæ£®æ—åœ¨è®­ç»ƒåŸºå­¦ä¹ å™¨æ—¶ï¼Œä¹Ÿé‡‡ç”¨æœ‰æ”¾å›é‡‡æ ·çš„æ–¹å¼æ·»åŠ æ ·æœ¬æ‰°åŠ¨ï¼ŒåŒæ—¶å®ƒè¿˜å¼•å…¥äº†ä¸€ç§<strong>å±æ€§æ‰°åŠ¨</strong>ï¼Œå³åœ¨åŸºå†³ç­–æ ‘çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œåœ¨é€‰æ‹©åˆ’åˆ†å±æ€§æ—¶ï¼ŒRFå…ˆä»å€™é€‰å±æ€§é›†ä¸­éšæœºæŒ‘é€‰å‡ºä¸€ä¸ªåŒ…å«Kä¸ªå±æ€§çš„å­é›†ï¼Œå†ä»è¿™ä¸ªå­é›†ä¸­é€‰æ‹©æœ€ä¼˜åˆ’åˆ†å±æ€§ï¼Œä¸€èˆ¬æ¨èK=log2ï¼ˆdï¼‰ã€‚</p>
<p>è¿™æ ·éšæœºæ£®æ—ä¸­åŸºå­¦ä¹ å™¨çš„å¤šæ ·æ€§ä¸ä»…æ¥è‡ªæ ·æœ¬æ‰°åŠ¨ï¼Œè¿˜æ¥è‡ªå±æ€§æ‰°åŠ¨ï¼Œä»è€Œè¿›ä¸€æ­¥æå‡äº†åŸºå­¦ä¹ å™¨ä¹‹é—´çš„å·®å¼‚åº¦ã€‚ç›¸æ¯”å†³ç­–æ ‘çš„Baggingé›†æˆï¼Œéšæœºæ£®æ—çš„èµ·å§‹æ€§èƒ½è¾ƒå·®ï¼ˆç”±äºå±æ€§æ‰°åŠ¨ï¼ŒåŸºå†³ç­–æ ‘çš„å‡†ç¡®åº¦æœ‰æ‰€ä¸‹é™ï¼‰ï¼Œä½†éšç€åŸºå­¦ä¹ å™¨æ•°ç›®çš„å¢å¤šï¼Œéšæœºæ£®æ—å¾€å¾€ä¼šæ”¶æ•›åˆ°æ›´ä½çš„æ³›åŒ–è¯¯å·®ã€‚åŒæ—¶ä¸åŒäºBaggingä¸­å†³ç­–æ ‘ä»æ‰€æœ‰å±æ€§é›†ä¸­é€‰æ‹©æœ€ä¼˜åˆ’åˆ†å±æ€§ï¼Œéšæœºæ£®æ—åªåœ¨å±æ€§é›†çš„ä¸€ä¸ªå­é›†ä¸­é€‰æ‹©åˆ’åˆ†å±æ€§ï¼Œå› æ­¤è®­ç»ƒæ•ˆç‡æ›´é«˜ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d7a4fd.png" alt="9.png" /></p>
<h3 id="94-ç»“åˆç­–ç•¥"><a class="header" href="#94-ç»“åˆç­–ç•¥"><strong>9.4 ç»“åˆç­–ç•¥</strong></a></h3>
<p>ç»“åˆç­–ç•¥æŒ‡çš„æ˜¯åœ¨è®­ç»ƒå¥½åŸºå­¦ä¹ å™¨åï¼Œå¦‚ä½•å°†è¿™äº›åŸºå­¦ä¹ å™¨çš„è¾“å‡ºç»“åˆèµ·æ¥äº§ç”Ÿé›†æˆæ¨¡å‹çš„æœ€ç»ˆè¾“å‡ºï¼Œä¸‹é¢å°†ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ç»“åˆç­–ç•¥ï¼š</p>
<h4 id="941-å¹³å‡æ³•å›å½’é—®é¢˜"><a class="header" href="#941-å¹³å‡æ³•å›å½’é—®é¢˜"><strong>9.4.1 å¹³å‡æ³•ï¼ˆå›å½’é—®é¢˜ï¼‰</strong></a></h4>
<p><img src="https://i.loli.net/2018/10/18/5bc84d0d07983.png" alt="10.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc84de1b74ff.png" alt="11.png" /></p>
<p>æ˜“çŸ¥ç®€å•å¹³å‡æ³•æ˜¯åŠ æƒå¹³å‡æ³•çš„ä¸€ç§ç‰¹ä¾‹ï¼ŒåŠ æƒå¹³å‡æ³•å¯ä»¥è®¤ä¸ºæ˜¯é›†æˆå­¦ä¹ ç ”ç©¶çš„åŸºæœ¬å‡ºå‘ç‚¹ã€‚ç”±äºå„ä¸ªåŸºå­¦ä¹ å™¨çš„æƒå€¼åœ¨è®­ç»ƒä¸­å¾—å‡ºï¼Œ<strong>ä¸€èˆ¬è€Œè¨€ï¼Œåœ¨ä¸ªä½“å­¦ä¹ å™¨æ€§èƒ½ç›¸å·®è¾ƒå¤§æ—¶å®œä½¿ç”¨åŠ æƒå¹³å‡æ³•ï¼Œåœ¨ä¸ªä½“å­¦ä¹ å™¨æ€§èƒ½ç›¸å·®è¾ƒå°æ—¶å®œä½¿ç”¨ç®€å•å¹³å‡æ³•</strong>ã€‚</p>
<h4 id="942-æŠ•ç¥¨æ³•åˆ†ç±»é—®é¢˜"><a class="header" href="#942-æŠ•ç¥¨æ³•åˆ†ç±»é—®é¢˜"><strong>9.4.2 æŠ•ç¥¨æ³•ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰</strong></a></h4>
<p><img src="https://i.loli.net/2018/10/18/5bc84de2629c4.png" alt="12.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc84de25a74b.png" alt="13.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc84de1bacc4.png" alt="14.png" /></p>
<p>ç»å¯¹å¤šæ•°æŠ•ç¥¨æ³•ï¼ˆmajority votingï¼‰æä¾›äº†æ‹’ç»é€‰é¡¹ï¼Œè¿™åœ¨å¯é æ€§è¦æ±‚å¾ˆé«˜çš„å­¦ä¹ ä»»åŠ¡ä¸­æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºåˆ¶ã€‚åŒæ—¶ï¼Œå¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå„ä¸ªåŸºå­¦ä¹ å™¨çš„è¾“å‡ºå€¼æœ‰ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«ä¸ºç±»æ ‡è®°å’Œç±»æ¦‚ç‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84de2768c1.png" alt="15.png" /></p>
<p>ä¸€äº›åœ¨äº§ç”Ÿç±»åˆ«æ ‡è®°çš„åŒæ—¶ä¹Ÿç”Ÿæˆç½®ä¿¡åº¦çš„å­¦ä¹ å™¨ï¼Œç½®ä¿¡åº¦å¯è½¬åŒ–ä¸ºç±»æ¦‚ç‡ä½¿ç”¨ï¼Œ<strong>ä¸€èˆ¬åŸºäºç±»æ¦‚ç‡è¿›è¡Œç»“åˆå¾€å¾€æ¯”åŸºäºç±»æ ‡è®°è¿›è¡Œç»“åˆçš„æ•ˆæœæ›´å¥½</strong>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¯¹äºå¼‚è´¨é›†æˆï¼Œå…¶ç±»æ¦‚ç‡ä¸èƒ½ç›´æ¥è¿›è¡Œæ¯”è¾ƒï¼Œæ­¤æ—¶éœ€è¦å°†ç±»æ¦‚ç‡è½¬åŒ–ä¸ºç±»æ ‡è®°è¾“å‡ºï¼Œç„¶åå†æŠ•ç¥¨ã€‚</p>
<h4 id="943-å­¦ä¹ æ³•"><a class="header" href="#943-å­¦ä¹ æ³•"><strong>9.4.3 å­¦ä¹ æ³•</strong></a></h4>
<p>å­¦ä¹ æ³•æ˜¯ä¸€ç§æ›´é«˜çº§çš„ç»“åˆç­–ç•¥ï¼Œå³å­¦ä¹ å‡ºä¸€ç§â€œæŠ•ç¥¨â€çš„å­¦ä¹ å™¨ï¼ŒStackingæ˜¯å­¦ä¹ æ³•çš„å…¸å‹ä»£è¡¨ã€‚Stackingçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé¦–å…ˆè®­ç»ƒå‡ºTä¸ªåŸºå­¦ä¹ å™¨ï¼Œå¯¹äºä¸€ä¸ªæ ·æœ¬å®ƒä»¬ä¼šäº§ç”ŸTä¸ªè¾“å‡ºï¼Œå°†è¿™Tä¸ªåŸºå­¦ä¹ å™¨çš„è¾“å‡ºä¸è¯¥æ ·æœ¬çš„çœŸå®æ ‡è®°ä½œä¸ºæ–°çš„æ ·æœ¬ï¼Œmä¸ªæ ·æœ¬å°±ä¼šäº§ç”Ÿä¸€ä¸ªm*Tçš„æ ·æœ¬é›†ï¼Œæ¥è®­ç»ƒä¸€ä¸ªæ–°çš„â€œæŠ•ç¥¨â€å­¦ä¹ å™¨ã€‚æŠ•ç¥¨å­¦ä¹ å™¨çš„è¾“å…¥å±æ€§ä¸å­¦ä¹ ç®—æ³•å¯¹Stackingé›†æˆçš„æ³›åŒ–æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ï¼Œä¹¦ä¸­å·²ç»æåˆ°ï¼š<strong>æŠ•ç¥¨å­¦ä¹ å™¨é‡‡ç”¨ç±»æ¦‚ç‡ä½œä¸ºè¾“å…¥å±æ€§ï¼Œé€‰ç”¨å¤šå“åº”çº¿æ€§å›å½’ï¼ˆMLRï¼‰ä¸€èˆ¬ä¼šäº§ç”Ÿè¾ƒå¥½çš„æ•ˆæœ</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84de25cbaf.png" alt="16.png" /></p>
<h3 id="95-å¤šæ ·æ€§diversity"><a class="header" href="#95-å¤šæ ·æ€§diversity"><strong>9.5 å¤šæ ·æ€§ï¼ˆdiversityï¼‰</strong></a></h3>
<p>åœ¨é›†æˆå­¦ä¹ ä¸­ï¼ŒåŸºå­¦ä¹ å™¨ä¹‹é—´çš„å¤šæ ·æ€§æ˜¯å½±å“é›†æˆå™¨æ³›åŒ–æ€§èƒ½çš„é‡è¦å› ç´ ã€‚å› æ­¤å¢åŠ å¤šæ ·æ€§å¯¹äºé›†æˆå­¦ä¹ ç ”ç©¶ååˆ†é‡è¦ï¼Œä¸€èˆ¬çš„æ€è·¯æ˜¯åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å¼•å…¥éšæœºæ€§ï¼Œå¸¸è§çš„åšæ³•ä¸»è¦æ˜¯å¯¹æ•°æ®æ ·æœ¬ã€è¾“å…¥å±æ€§ã€è¾“å‡ºè¡¨ç¤ºã€ç®—æ³•å‚æ•°è¿›è¡Œæ‰°åŠ¨ã€‚</p>
<blockquote>
<p><strong>æ•°æ®æ ·æœ¬æ‰°åŠ¨</strong>ï¼Œå³åˆ©ç”¨å…·æœ‰å·®å¼‚çš„æ•°æ®é›†æ¥è®­ç»ƒä¸åŒçš„åŸºå­¦ä¹ å™¨ã€‚ä¾‹å¦‚ï¼šæœ‰æ”¾å›è‡ªåŠ©é‡‡æ ·æ³•ï¼Œä½†æ­¤ç±»åšæ³•åªå¯¹é‚£äº›ä¸ç¨³å®šå­¦ä¹ ç®—æ³•ååˆ†æœ‰æ•ˆï¼Œä¾‹å¦‚ï¼šå†³ç­–æ ‘å’Œç¥ç»ç½‘ç»œç­‰ï¼Œè®­ç»ƒé›†çš„ç¨å¾®æ”¹å˜èƒ½å¯¼è‡´å­¦ä¹ å™¨çš„æ˜¾è‘—å˜åŠ¨ã€‚
<strong>è¾“å…¥å±æ€§æ‰°åŠ¨</strong>ï¼Œå³éšæœºé€‰å–åŸç©ºé—´çš„ä¸€ä¸ªå­ç©ºé—´æ¥è®­ç»ƒåŸºå­¦ä¹ å™¨ã€‚ä¾‹å¦‚ï¼šéšæœºæ£®æ—ï¼Œä»åˆå§‹å±æ€§é›†ä¸­æŠ½å–å­é›†ï¼Œå†åŸºäºæ¯ä¸ªå­é›†æ¥è®­ç»ƒåŸºå­¦ä¹ å™¨ã€‚ä½†è‹¥è®­ç»ƒé›†åªåŒ…å«å°‘é‡å±æ€§ï¼Œåˆ™ä¸å®œä½¿ç”¨å±æ€§æ‰°åŠ¨ã€‚
<strong>è¾“å‡ºè¡¨ç¤ºæ‰°åŠ¨</strong>ï¼Œæ­¤ç±»åšæ³•å¯å¯¹è®­ç»ƒæ ·æœ¬çš„ç±»æ ‡ç¨ä½œå˜åŠ¨ï¼Œæˆ–å¯¹åŸºå­¦ä¹ å™¨çš„è¾“å‡ºè¿›è¡Œè½¬åŒ–ã€‚
<strong>ç®—æ³•å‚æ•°æ‰°åŠ¨</strong>ï¼Œé€šè¿‡éšæœºè®¾ç½®ä¸åŒçš„å‚æ•°ï¼Œä¾‹å¦‚ï¼šç¥ç»ç½‘ç»œä¸­ï¼Œéšæœºåˆå§‹åŒ–æƒé‡ä¸éšæœºè®¾ç½®éšå«å±‚èŠ‚ç‚¹æ•°ã€‚</p>
</blockquote>
<h2 id="å-èšç±»ç®—æ³•"><a class="header" href="#å-èšç±»ç®—æ³•"><strong>åï¼ èšç±»ç®—æ³•</strong></a></h2>
<p>èšç±»æ˜¯ä¸€ç§ç»å…¸çš„<strong>æ— ç›‘ç£å­¦ä¹ </strong>æ–¹æ³•ï¼Œ<strong>æ— ç›‘ç£å­¦ä¹ çš„ç›®æ ‡æ˜¯é€šè¿‡å¯¹æ— æ ‡è®°è®­ç»ƒæ ·æœ¬çš„å­¦ä¹ ï¼Œå‘æ˜å’Œæ­ç¤ºæ•°æ®é›†æœ¬èº«æ½œåœ¨çš„ç»“æ„ä¸è§„å¾‹</strong>ï¼Œå³ä¸ä¾èµ–äºè®­ç»ƒæ•°æ®é›†çš„ç±»æ ‡è®°ä¿¡æ¯ã€‚èšç±»åˆ™æ˜¯è¯•å›¾å°†æ•°æ®é›†çš„æ ·æœ¬åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªäº’ä¸ç›¸äº¤çš„ç±»ç°‡ï¼Œä»è€Œæ¯ä¸ªç°‡å¯¹åº”ä¸€ä¸ªæ½œåœ¨çš„ç±»åˆ«ã€‚</p>
<p>èšç±»ç›´è§‚ä¸Šæ¥è¯´æ˜¯å°†ç›¸ä¼¼çš„æ ·æœ¬èšåœ¨ä¸€èµ·ï¼Œä»è€Œå½¢æˆä¸€ä¸ª<strong>ç±»ç°‡ï¼ˆclusterï¼‰</strong>ã€‚é‚£é¦–å…ˆçš„é—®é¢˜æ˜¯å¦‚ä½•æ¥<strong>åº¦é‡ç›¸ä¼¼æ€§</strong>ï¼ˆsimilarity measureï¼‰å‘¢ï¼Ÿè¿™ä¾¿æ˜¯<strong>è·ç¦»åº¦é‡</strong>ï¼Œåœ¨ç”Ÿæ´»ä¸­æˆ‘ä»¬è¯´å·®åˆ«å°åˆ™ç›¸ä¼¼ï¼Œå¯¹åº”åˆ°å¤šç»´æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬å¯ä»¥å¯¹åº”äºé«˜ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œè‹¥å®ƒä»¬çš„è·ç¦»ç›¸è¿‘ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ç§°å®ƒä»¬ç›¸ä¼¼ã€‚é‚£æ¥ç€å¦‚ä½•æ¥è¯„ä»·èšç±»ç»“æœçš„å¥½åå‘¢ï¼Ÿè¿™ä¾¿æ˜¯<strong>æ€§èƒ½åº¦é‡</strong>ï¼Œæ€§èƒ½åº¦é‡ä¸ºè¯„ä»·èšç±»ç»“æœçš„å¥½åæä¾›äº†ä¸€ç³»åˆ—æœ‰æ•ˆæ€§æŒ‡æ ‡ã€‚</p>
<h3 id="101-è·ç¦»åº¦é‡"><a class="header" href="#101-è·ç¦»åº¦é‡"><strong>10.1 è·ç¦»åº¦é‡</strong></a></h3>
<p>è°ˆåŠè·ç¦»åº¦é‡ï¼Œæœ€ç†Ÿæ‚‰çš„è«è¿‡äºæ¬§å¼è·ç¦»äº†ï¼Œä»å¹´å¤´ä¸€ç›´ç”¨åˆ°å¹´å°¾çš„è·ç¦»è®¡ç®—å…¬å¼ï¼šå³å¯¹åº”å±æ€§ä¹‹é—´ç›¸å‡çš„å¹³æ–¹å’Œå†å¼€æ ¹å·ã€‚åº¦é‡è·ç¦»è¿˜æœ‰å…¶å®ƒçš„å¾ˆå¤šç»å…¸æ–¹æ³•ï¼Œé€šå¸¸å®ƒä»¬éœ€è¦æ»¡è¶³ä¸€äº›åŸºæœ¬æ€§è´¨ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed4c0390.png" alt="1.png" /></p>
<p>æœ€å¸¸ç”¨çš„è·ç¦»åº¦é‡æ–¹æ³•æ˜¯**â€œé—µå¯å¤«æ–¯åŸºè·ç¦»â€ï¼ˆMinkowski distance)**ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed49e31f.png" alt="2.png" /></p>
<p>å½“p=1æ—¶ï¼Œé—µå¯å¤«æ–¯åŸºè·ç¦»å³<strong>æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan distanceï¼‰</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed49c31f.png" alt="3.png" /></p>
<p>å½“p=2æ—¶ï¼Œé—µå¯å¤«æ–¯åŸºè·ç¦»å³<strong>æ¬§æ°è·ç¦»ï¼ˆEuclidean distanceï¼‰</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed497613.png" alt="4.png" /></p>
<p>æˆ‘ä»¬çŸ¥é“å±æ€§åˆ†ä¸ºä¸¤ç§ï¼š<strong>è¿ç»­å±æ€§</strong>å’Œ<strong>ç¦»æ•£å±æ€§</strong>ï¼ˆæœ‰é™ä¸ªå–å€¼ï¼‰ã€‚å¯¹äºè¿ç»­å€¼çš„å±æ€§ï¼Œä¸€èˆ¬éƒ½å¯ä»¥è¢«å­¦ä¹ å™¨æ‰€ç”¨ï¼Œæœ‰æ—¶ä¼šæ ¹æ®å…·ä½“çš„æƒ…å½¢ä½œç›¸åº”çš„é¢„å¤„ç†ï¼Œä¾‹å¦‚ï¼šå½’ä¸€åŒ–ç­‰ï¼›è€Œå¯¹äºç¦»æ•£å€¼çš„å±æ€§ï¼Œéœ€è¦ä½œä¸‹é¢è¿›ä¸€æ­¥çš„å¤„ç†ï¼š</p>
<blockquote>
<p>è‹¥å±æ€§å€¼ä¹‹é—´<strong>å­˜åœ¨åºå…³ç³»</strong>ï¼Œåˆ™å¯ä»¥å°†å…¶è½¬åŒ–ä¸ºè¿ç»­å€¼ï¼Œä¾‹å¦‚ï¼šèº«é«˜å±æ€§â€œé«˜â€â€œä¸­ç­‰â€â€œçŸ®â€ï¼Œå¯è½¬åŒ–ä¸º{1, 0.5, 0}ã€‚
è‹¥å±æ€§å€¼ä¹‹é—´<strong>ä¸å­˜åœ¨åºå…³ç³»</strong>ï¼Œåˆ™é€šå¸¸å°†å…¶è½¬åŒ–ä¸ºå‘é‡çš„å½¢å¼ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å±æ€§â€œç”·â€â€œå¥³â€ï¼Œå¯è½¬åŒ–ä¸º{ï¼ˆ1,0ï¼‰ï¼Œï¼ˆ0,1ï¼‰}ã€‚</p>
</blockquote>
<p>åœ¨è¿›è¡Œè·ç¦»åº¦é‡æ—¶ï¼Œæ˜“çŸ¥<strong>è¿ç»­å±æ€§å’Œå­˜åœ¨åºå…³ç³»çš„ç¦»æ•£å±æ€§éƒ½å¯ä»¥ç›´æ¥å‚ä¸è®¡ç®—</strong>ï¼Œå› ä¸ºå®ƒä»¬éƒ½å¯ä»¥åæ˜ ä¸€ç§ç¨‹åº¦ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºâ€œ<strong>æœ‰åºå±æ€§</strong>â€ï¼›è€Œå¯¹äºä¸å­˜åœ¨åºå…³ç³»çš„ç¦»æ•£å±æ€§ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºï¼šâ€œ<strong>æ— åºå±æ€§</strong>â€ï¼Œæ˜¾ç„¶æ— åºå±æ€§å†ä½¿ç”¨é—µå¯å¤«æ–¯åŸºè·ç¦»å°±è¡Œä¸é€šäº†ã€‚</p>
<p><strong>å¯¹äºæ— åºå±æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨VDMè¿›è¡Œè·ç¦»çš„è®¡ç®—</strong>ï¼Œä¾‹å¦‚ï¼šå¯¹äºç¦»æ•£å±æ€§çš„ä¸¤ä¸ªå–å€¼aå’Œbï¼Œå®šä¹‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed4e9560.png" alt="5.png" /></p>
<p>äºæ˜¯ï¼Œåœ¨è®¡ç®—ä¸¤ä¸ªæ ·æœ¬ä¹‹é—´çš„è·ç¦»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—µå¯å¤«æ–¯åŸºè·ç¦»å’ŒVDMæ··åˆåœ¨ä¸€èµ·è¿›è¡Œè®¡ç®—ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed507bc7.png" alt="6.png" /></p>
<p>è‹¥æˆ‘ä»¬å®šä¹‰çš„è·ç¦»è®¡ç®—æ–¹æ³•æ˜¯ç”¨æ¥åº¦é‡ç›¸ä¼¼æ€§ï¼Œä¾‹å¦‚ä¸‹é¢å°†è¦è®¨è®ºçš„èšç±»é—®é¢˜ï¼Œå³è·ç¦»è¶Šå°ï¼Œç›¸ä¼¼æ€§è¶Šå¤§ï¼Œåä¹‹è·ç¦»è¶Šå¤§ï¼Œç›¸ä¼¼æ€§è¶Šå°ã€‚è¿™æ—¶è·ç¦»çš„åº¦é‡æ–¹æ³•å¹¶ä¸ä¸€å®šéœ€è¦æ»¡è¶³å‰é¢æ‰€è¯´çš„å››ä¸ªåŸºæœ¬æ€§è´¨ï¼Œè¿™æ ·çš„æ–¹æ³•ç§°ä¸ºï¼š<strong>éåº¦é‡è·ç¦»ï¼ˆnon-metric distanceï¼‰</strong>ã€‚</p>
<h3 id="102-æ€§èƒ½åº¦é‡"><a class="header" href="#102-æ€§èƒ½åº¦é‡"><strong>10.2 æ€§èƒ½åº¦é‡</strong></a></h3>
<p>ç”±äºèšç±»ç®—æ³•ä¸ä¾èµ–äºæ ·æœ¬çš„çœŸå®ç±»æ ‡ï¼Œå°±ä¸èƒ½åƒç›‘ç£å­¦ä¹ çš„åˆ†ç±»é‚£èˆ¬ï¼Œé€šè¿‡è®¡ç®—åˆ†å¯¹åˆ†é”™ï¼ˆå³ç²¾ç¡®åº¦æˆ–é”™è¯¯ç‡ï¼‰æ¥è¯„ä»·å­¦ä¹ å™¨çš„å¥½åæˆ–ä½œä¸ºå­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¼˜åŒ–ç›®æ ‡ã€‚ä¸€èˆ¬èšç±»æœ‰ä¸¤ç±»æ€§èƒ½åº¦é‡æŒ‡æ ‡ï¼š<strong>å¤–éƒ¨æŒ‡æ ‡</strong>å’Œ<strong>å†…éƒ¨æŒ‡æ ‡</strong>ã€‚</p>
<h4 id="1021-å¤–éƒ¨æŒ‡æ ‡"><a class="header" href="#1021-å¤–éƒ¨æŒ‡æ ‡"><strong>10.2.1 å¤–éƒ¨æŒ‡æ ‡</strong></a></h4>
<p>å³å°†èšç±»ç»“æœä¸æŸä¸ªå‚è€ƒæ¨¡å‹çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œ<strong>ä»¥å‚è€ƒæ¨¡å‹çš„è¾“å‡ºä½œä¸ºæ ‡å‡†ï¼Œæ¥è¯„ä»·èšç±»å¥½å</strong>ã€‚å‡è®¾èšç±»ç»™å‡ºçš„ç»“æœä¸ºÎ»ï¼Œå‚è€ƒæ¨¡å‹ç»™å‡ºçš„ç»“æœæ˜¯Î»*ï¼Œåˆ™æˆ‘ä»¬å°†æ ·æœ¬è¿›è¡Œä¸¤ä¸¤é…å¯¹ï¼Œå®šä¹‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed59160e.png" alt="7.png" /></p>
<p>æ˜¾ç„¶aå’Œbä»£è¡¨ç€èšç±»ç»“æœå¥½åçš„æ­£èƒ½é‡ï¼Œbå’Œcåˆ™è¡¨ç¤ºå‚è€ƒç»“æœå’Œèšç±»ç»“æœç›¸çŸ›ç›¾ï¼ŒåŸºäºè¿™å››ä¸ªå€¼å¯ä»¥å¯¼å‡ºä»¥ä¸‹å¸¸ç”¨çš„å¤–éƒ¨è¯„ä»·æŒ‡æ ‡ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed587438.png" alt="8.png" /></p>
<h4 id="1022-å†…éƒ¨æŒ‡æ ‡"><a class="header" href="#1022-å†…éƒ¨æŒ‡æ ‡"><strong>10.2.2 å†…éƒ¨æŒ‡æ ‡</strong></a></h4>
<p>å†…éƒ¨æŒ‡æ ‡å³ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ¨¡å‹ï¼Œç›´æ¥å¯¹èšç±»çš„ç»“æœè¿›è¡Œè¯„ä¼°ï¼Œèšç±»çš„ç›®çš„æ˜¯æƒ³å°†é‚£äº›ç›¸ä¼¼çš„æ ·æœ¬å°½å¯èƒ½èšåœ¨ä¸€èµ·ï¼Œä¸ç›¸ä¼¼çš„æ ·æœ¬å°½å¯èƒ½åˆ†å¼€ï¼Œç›´è§‚æ¥è¯´ï¼š<strong>ç°‡å†…é«˜å†…èšç´§ç´§æŠ±å›¢ï¼Œç°‡é—´ä½è€¦åˆè€æ­»ä¸ç›¸å¾€æ¥</strong>ã€‚å®šä¹‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed581852.png" alt="9.png" /></p>
<p>åŸºäºä¸Šé¢çš„å››ä¸ªè·ç¦»ï¼Œå¯ä»¥å¯¼å‡ºä¸‹é¢è¿™äº›å¸¸ç”¨çš„å†…éƒ¨è¯„ä»·æŒ‡æ ‡ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84ed582854.png" alt="10.png" /></p>
<h3 id="103-åŸå‹èšç±»"><a class="header" href="#103-åŸå‹èšç±»"><strong>10.3 åŸå‹èšç±»</strong></a></h3>
<p>åŸå‹èšç±»å³â€œ<strong>åŸºäºåŸå‹çš„èšç±»</strong>â€ï¼ˆprototype-based clusteringï¼‰ï¼ŒåŸå‹è¡¨ç¤ºæ¨¡æ¿çš„æ„æ€ï¼Œå°±æ˜¯é€šè¿‡å‚è€ƒä¸€ä¸ªæ¨¡æ¿å‘é‡æˆ–æ¨¡æ¿åˆ†å¸ƒçš„æ–¹å¼æ¥å®Œæˆèšç±»çš„è¿‡ç¨‹ï¼Œå¸¸è§çš„K-Meansä¾¿æ˜¯åŸºäºç°‡ä¸­å¿ƒæ¥å®ç°èšç±»ï¼Œæ··åˆé«˜æ–¯èšç±»åˆ™æ˜¯åŸºäºç°‡åˆ†å¸ƒæ¥å®ç°èšç±»ã€‚</p>
<h4 id="1031-k-means"><a class="header" href="#1031-k-means"><strong>10.3.1 K-Means</strong></a></h4>
<p>K-Meansçš„æ€æƒ³ååˆ†ç®€å•ï¼Œ<strong>é¦–å…ˆéšæœºæŒ‡å®šç±»ä¸­å¿ƒï¼Œæ ¹æ®æ ·æœ¬ä¸ç±»ä¸­å¿ƒçš„è¿œè¿‘åˆ’åˆ†ç±»ç°‡ï¼Œæ¥ç€é‡æ–°è®¡ç®—ç±»ä¸­å¿ƒï¼Œè¿­ä»£ç›´è‡³æ”¶æ•›</strong>ã€‚ä½†æ˜¯å…¶ä¸­è¿­ä»£çš„è¿‡ç¨‹å¹¶ä¸æ˜¯ä¸»è§‚åœ°æƒ³è±¡å¾—å‡ºï¼Œäº‹å®ä¸Šï¼Œè‹¥å°†æ ·æœ¬çš„ç±»åˆ«çœ‹åšä¸ºâ€œéšå˜é‡â€ï¼ˆlatent variableï¼‰ï¼Œç±»ä¸­å¿ƒçœ‹ä½œæ ·æœ¬çš„åˆ†å¸ƒå‚æ•°ï¼Œè¿™ä¸€è¿‡ç¨‹æ­£æ˜¯é€šè¿‡<strong>EMç®—æ³•</strong>çš„ä¸¤æ­¥èµ°ç­–ç•¥è€Œè®¡ç®—å‡ºï¼Œå…¶æ ¹æœ¬çš„ç›®çš„æ˜¯ä¸ºäº†æœ€å°åŒ–å¹³æ–¹è¯¯å·®å‡½æ•°Eï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb82b5d3.png" alt="11.png" /></p>
<p>K-Meansçš„ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb9c0817.png" alt="12.png" /></p>
<h4 id="1032-å­¦ä¹ å‘é‡é‡åŒ–lvq"><a class="header" href="#1032-å­¦ä¹ å‘é‡é‡åŒ–lvq"><strong>10.3.2 å­¦ä¹ å‘é‡é‡åŒ–ï¼ˆLVQï¼‰</strong></a></h4>
<p>LVQä¹Ÿæ˜¯åŸºäºåŸå‹çš„èšç±»ç®—æ³•ï¼Œä¸K-Meansä¸åŒçš„æ˜¯ï¼Œ<strong>LVQä½¿ç”¨æ ·æœ¬çœŸå®ç±»æ ‡è®°è¾…åŠ©èšç±»</strong>ï¼Œé¦–å…ˆLVQæ ¹æ®æ ·æœ¬çš„ç±»æ ‡è®°ï¼Œä»å„ç±»ä¸­åˆ†åˆ«éšæœºé€‰å‡ºä¸€ä¸ªæ ·æœ¬ä½œä¸ºè¯¥ç±»ç°‡çš„åŸå‹ï¼Œä»è€Œç»„æˆäº†ä¸€ä¸ª<strong>åŸå‹ç‰¹å¾å‘é‡ç»„</strong>ï¼Œæ¥ç€ä»æ ·æœ¬é›†ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªæ ·æœ¬ï¼Œè®¡ç®—å…¶ä¸åŸå‹å‘é‡ç»„ä¸­æ¯ä¸ªå‘é‡çš„è·ç¦»ï¼Œå¹¶é€‰å–è·ç¦»æœ€å°çš„åŸå‹å‘é‡æ‰€åœ¨çš„ç±»ç°‡ä½œä¸ºå®ƒçš„åˆ’åˆ†ç»“æœï¼Œå†ä¸çœŸå®ç±»æ ‡æ¯”è¾ƒã€‚</p>
<blockquote>
<p><strong>è‹¥åˆ’åˆ†ç»“æœæ­£ç¡®ï¼Œåˆ™å¯¹åº”åŸå‹å‘é‡å‘è¿™ä¸ªæ ·æœ¬é è¿‘ä¸€äº›</strong>
<strong>è‹¥åˆ’åˆ†ç»“æœä¸æ­£ç¡®ï¼Œåˆ™å¯¹åº”åŸå‹å‘é‡å‘è¿™ä¸ªæ ·æœ¬è¿œç¦»ä¸€äº›</strong></p>
</blockquote>
<p>LVQç®—æ³•çš„æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb9d59f2.png" alt="13.png" /></p>
<h4 id="1033-é«˜æ–¯æ··åˆèšç±»"><a class="header" href="#1033-é«˜æ–¯æ··åˆèšç±»"><strong>10.3.3 é«˜æ–¯æ··åˆèšç±»</strong></a></h4>
<p>ç°åœ¨å¯ä»¥çœ‹å‡ºK-Meansä¸LVQéƒ½è¯•å›¾ä»¥ç±»ä¸­å¿ƒä½œä¸ºåŸå‹æŒ‡å¯¼èšç±»ï¼Œé«˜æ–¯æ··åˆèšç±»åˆ™é‡‡ç”¨é«˜æ–¯åˆ†å¸ƒæ¥æè¿°åŸå‹ã€‚ç°å‡è®¾<strong>æ¯ä¸ªç±»ç°‡ä¸­çš„æ ·æœ¬éƒ½æœä»ä¸€ä¸ªå¤šç»´é«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆç©ºé—´ä¸­çš„æ ·æœ¬å¯ä»¥çœ‹ä½œç”±kä¸ªå¤šç»´é«˜æ–¯åˆ†å¸ƒæ··åˆè€Œæˆ</strong>ã€‚</p>
<p>å¯¹äºå¤šç»´é«˜æ–¯åˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb870d98.png" alt="14.png" /></p>
<p>å…¶ä¸­uè¡¨ç¤ºå‡å€¼å‘é‡ï¼Œâˆ‘è¡¨ç¤ºåæ–¹å·®çŸ©é˜µï¼Œå¯ä»¥çœ‹å‡ºä¸€ä¸ªå¤šç»´é«˜æ–¯åˆ†å¸ƒå®Œå…¨ç”±è¿™ä¸¤ä¸ªå‚æ•°æ‰€ç¡®å®šã€‚æ¥ç€å®šä¹‰é«˜æ–¯æ··åˆåˆ†å¸ƒä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb876794.png" alt="15.png" /></p>
<p>Î±ç§°ä¸ºæ··åˆç³»æ•°ï¼Œè¿™æ ·ç©ºé—´ä¸­æ ·æœ¬çš„é‡‡é›†è¿‡ç¨‹åˆ™å¯ä»¥æŠ½è±¡ä¸ºï¼š<strong>ï¼ˆ1ï¼‰å…ˆé€‰æ‹©ä¸€ä¸ªç±»ç°‡ï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰ï¼Œï¼ˆ2ï¼‰å†æ ¹æ®å¯¹åº”é«˜æ–¯åˆ†å¸ƒçš„å¯†åº¦å‡½æ•°è¿›è¡Œé‡‡æ ·</strong>ï¼Œè¿™æ—¶å€™è´å¶æ–¯å…¬å¼åˆèƒ½å¤§å±•èº«æ‰‹äº†ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb9191d9.png" alt="16.png" /></p>
<p>æ­¤æ—¶åªéœ€è¦é€‰æ‹©PMæœ€å¤§æ—¶çš„ç±»ç°‡å¹¶å°†è¯¥æ ·æœ¬åˆ’åˆ†åˆ°å…¶ä¸­ï¼Œçœ‹åˆ°è¿™é‡Œå¾ˆå®¹æ˜“å‘ç°ï¼šè¿™å’Œé‚£ä¸ªä¼ è¯´ä¸­çš„è´å¶æ–¯åˆ†ç±»ä¸æ˜¯ç¥ä¼¼å—ï¼Œéƒ½æ˜¯é€šè¿‡è´å¶æ–¯å…¬å¼å±•å¼€ï¼Œç„¶åè®¡ç®—ç±»å…ˆéªŒæ¦‚ç‡å’Œç±»æ¡ä»¶æ¦‚ç‡ã€‚ä½†é—æ†¾çš„æ˜¯ï¼š<strong>è¿™é‡Œæ²¡æœ‰çœŸå®ç±»æ ‡ä¿¡æ¯ï¼Œå¯¹äºç±»æ¡ä»¶æ¦‚ç‡ï¼Œå¹¶ä¸èƒ½åƒè´å¶æ–¯åˆ†ç±»é‚£æ ·é€šè¿‡æœ€å¤§ä¼¼ç„¶æ³•ç¾å¥½åœ°è®¡ç®—å‡ºæ¥</strong>ï¼Œå› ä¸ºè¿™é‡Œçš„æ ·æœ¬å¯èƒ½å±äºæ‰€æœ‰çš„ç±»ç°‡ï¼Œè¿™é‡Œçš„ä¼¼ç„¶å‡½æ•°å˜ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb871d4a.png" alt="17.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼šç®€å•çš„æœ€å¤§ä¼¼ç„¶æ³•æ ¹æœ¬æ— æ³•æ±‚å‡ºæ‰€æœ‰çš„å‚æ•°ï¼Œè¿™æ ·PMä¹Ÿå°±æ²¡æ³•è®¡ç®—ã€‚<strong>è¿™é‡Œå°±è¦å¬å”¤å‡ºä¹‹å‰çš„EMå¤§æ³•ï¼Œé¦–å…ˆå¯¹é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°åŠæ··åˆç³»æ•°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼Œè®¡ç®—å‡ºå„ä¸ªPMï¼ˆå³Î³jiï¼Œç¬¬iä¸ªæ ·æœ¬å±äºjç±»ï¼‰ï¼Œå†æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼ˆå³LLï¼ˆDï¼‰åˆ†åˆ«å¯¹Î±ã€uå’Œâˆ‘æ±‚åå¯¼ ï¼‰ï¼Œå¯¹å‚æ•°è¿›è¡Œè¿­ä»£æ›´æ–°</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb8a6f32.png" alt="18.png" /></p>
<p>é«˜æ–¯æ··åˆèšç±»çš„ç®—æ³•æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb9c4fa4.png" alt="19.png" /></p>
<h3 id="104-å¯†åº¦èšç±»"><a class="header" href="#104-å¯†åº¦èšç±»"><strong>10.4 å¯†åº¦èšç±»</strong></a></h3>
<p>å¯†åº¦èšç±»åˆ™æ˜¯åŸºäºå¯†åº¦çš„èšç±»ï¼Œå®ƒä»æ ·æœ¬åˆ†å¸ƒçš„è§’åº¦æ¥è€ƒå¯Ÿæ ·æœ¬ä¹‹é—´çš„å¯è¿æ¥æ€§ï¼Œå¹¶åŸºäºå¯è¿æ¥æ€§ï¼ˆå¯†åº¦å¯è¾¾ï¼‰ä¸æ–­æ‹“å±•ç–†åŸŸï¼ˆç±»ç°‡ï¼‰ã€‚å…¶ä¸­æœ€è‘—åçš„ä¾¿æ˜¯<strong>DBSCAN</strong>ç®—æ³•ï¼Œé¦–å…ˆå®šä¹‰ä»¥ä¸‹æ¦‚å¿µï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc84fb9bd69c.png" alt="20.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc8509f8d619.png" alt="21.png" /></p>
<p>ç®€å•æ¥ç†è§£DBSCANä¾¿æ˜¯ï¼š<strong>æ‰¾å‡ºä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡æ‰€æœ‰å¯†åº¦å¯è¾¾çš„æ ·æœ¬é›†åˆå½¢æˆç°‡</strong>ã€‚é¦–å…ˆä»æ•°æ®é›†ä¸­ä»»é€‰ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡Aï¼Œæ‰¾å‡ºæ‰€æœ‰Aå¯†åº¦å¯è¾¾çš„æ ·æœ¬é›†åˆï¼Œå°†è¿™äº›æ ·æœ¬å½¢æˆä¸€ä¸ªå¯†åº¦ç›¸è¿çš„ç±»ç°‡ï¼Œç›´åˆ°æ‰€æœ‰çš„æ ¸å¿ƒå¯¹è±¡éƒ½éå†å®Œã€‚DBSCANç®—æ³•çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc8509feb587.png" alt="22.png" /></p>
<h3 id="105-å±‚æ¬¡èšç±»"><a class="header" href="#105-å±‚æ¬¡èšç±»"><strong>10.5 å±‚æ¬¡èšç±»</strong></a></h3>
<p>å±‚æ¬¡èšç±»æ˜¯ä¸€ç§åŸºäºæ ‘å½¢ç»“æ„çš„èšç±»æ–¹æ³•ï¼Œå¸¸ç”¨çš„æ˜¯<strong>è‡ªåº•å‘ä¸Š</strong>çš„ç»“åˆç­–ç•¥ï¼ˆ<strong>AGNESç®—æ³•</strong>ï¼‰ã€‚å‡è®¾æœ‰Nä¸ªå¾…èšç±»çš„æ ·æœ¬ï¼Œå…¶åŸºæœ¬æ­¥éª¤æ˜¯ï¼š</p>
<blockquote>
<p>1.åˆå§‹åŒ–--&gt;æŠŠæ¯ä¸ªæ ·æœ¬å½’ä¸ºä¸€ç±»ï¼Œè®¡ç®—æ¯ä¸¤ä¸ªç±»ä¹‹é—´çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯æ ·æœ¬ä¸æ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼›
2.å¯»æ‰¾å„ä¸ªç±»ä¹‹é—´æœ€è¿‘çš„ä¸¤ä¸ªç±»ï¼ŒæŠŠä»–ä»¬å½’ä¸ºä¸€ç±»ï¼ˆè¿™æ ·ç±»çš„æ€»æ•°å°±å°‘äº†ä¸€ä¸ªï¼‰ï¼›
3.é‡æ–°è®¡ç®—æ–°ç”Ÿæˆçš„è¿™ä¸ª<strong>ç±»ä¸å„ä¸ªæ—§ç±»ä¹‹é—´çš„ç›¸ä¼¼åº¦</strong>ï¼›
4.é‡å¤2å’Œ3ç›´åˆ°æ‰€æœ‰æ ·æœ¬ç‚¹éƒ½å½’ä¸ºä¸€ç±»ï¼Œç»“æŸã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºå…¶ä¸­æœ€å…³é”®çš„ä¸€æ­¥å°±æ˜¯<strong>è®¡ç®—ä¸¤ä¸ªç±»ç°‡çš„ç›¸ä¼¼åº¦</strong>ï¼Œè¿™é‡Œæœ‰å¤šç§åº¦é‡æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>å•é“¾æ¥ï¼ˆsingle-linkageï¼‰:å–ç±»é—´æœ€å°è·ç¦»ã€‚
<img src="https://i.loli.net/2018/10/18/5bc8509ebb022.png" alt="23.png" /></p>
</li>
<li>
<p>å…¨é“¾æ¥ï¼ˆcomplete-linkageï¼‰:å–ç±»é—´æœ€å¤§è·ç¦»
<img src="https://i.loli.net/2018/10/18/5bc8509eb2b30.png" alt="24.png" /></p>
</li>
<li>
<p>å‡é“¾æ¥ï¼ˆaverage-linkageï¼‰:å–ç±»é—´ä¸¤ä¸¤çš„å¹³å‡è·ç¦»
<img src="https://i.loli.net/2018/10/18/5bc8509f089a7.png" alt="25.png" /></p>
</li>
</ul>
<p>å¾ˆå®¹æ˜“çœ‹å‡ºï¼š<strong>å•é“¾æ¥çš„åŒ…å®¹æ€§æå¼ºï¼Œç¨å¾®æœ‰ç‚¹æš§æ˜§å°±å½“åšæ˜¯è‡ªå·±äººäº†ï¼Œå…¨é“¾æ¥åˆ™æ˜¯åšæŒåˆ°åº•ï¼Œåªè¦å­˜åœ¨ç¼ºç‚¹å°±åšå†³ä¸åˆå¹¶ï¼Œå‡è¿æ¥åˆ™æ˜¯ä»å…¨å±€å‡ºå‘é¡¾å…¨å¤§å±€</strong>ã€‚å±‚æ¬¡èšç±»æ³•çš„ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc8509f9d4a0.png" alt="26.png" /></p>
<blockquote>
<p>åœ¨æ­¤èšç±»ç®—æ³•å°±ä»‹ç»å®Œæ¯•ï¼Œåˆ†ç±»/èšç±»éƒ½æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸è§çš„ä»»åŠ¡ï¼Œæˆ‘å®éªŒå®¤çš„å¤§Bossä¹Ÿæ˜¯é ç€èšç±»èµ·å®¶ï¼Œä»æ­¤èµ°ä¸Šäººç”Ÿäº‹ä¸šé’±é€”...ä¹‹å·…å³°ï¼Œåœ¨ä¹¦æœ€åçš„é˜…è¯»ææ–™è¿˜çœ‹è§Bossçš„åå­—ï¼Œæ‰€ä»¥è¿™ç« ä¹Ÿæ˜¯å¿…è¯»ä¸å¯äº†...</p>
</blockquote>
<h2 id="åä¸€-é™ç»´ä¸åº¦é‡å­¦ä¹ "><a class="header" href="#åä¸€-é™ç»´ä¸åº¦é‡å­¦ä¹ "><strong>åä¸€ï¼ é™ç»´ä¸åº¦é‡å­¦ä¹ </strong></a></h2>
<p>æ ·æœ¬çš„ç‰¹å¾æ•°ç§°ä¸º<strong>ç»´æ•°</strong>ï¼ˆdimensionalityï¼‰ï¼Œå½“ç»´æ•°éå¸¸å¤§æ—¶ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨æ‰€è¯´çš„â€œ<strong>ç»´æ•°ç¾éš¾</strong>â€ï¼Œå…·ä½“è¡¨ç°åœ¨ï¼šåœ¨é«˜ç»´æƒ…å½¢ä¸‹ï¼Œ<strong>æ•°æ®æ ·æœ¬å°†å˜å¾—ååˆ†ç¨€ç–</strong>ï¼Œå› ä¸ºæ­¤æ—¶è¦æ»¡è¶³è®­ç»ƒæ ·æœ¬ä¸ºâ€œ<strong>å¯†é‡‡æ ·</strong>â€çš„æ€»ä½“æ ·æœ¬æ•°ç›®æ˜¯ä¸€ä¸ªè§¦ä¸å¯åŠçš„å¤©æ–‡æ•°å­—ï¼Œè°“å¯è¿œè§‚è€Œä¸å¯äºµç©ç„‰...<strong>è®­ç»ƒæ ·æœ¬çš„ç¨€ç–ä½¿å¾—å…¶ä»£è¡¨æ€»ä½“åˆ†å¸ƒçš„èƒ½åŠ›å¤§å¤§å‡å¼±ï¼Œä»è€Œæ¶ˆå‡äº†å­¦ä¹ å™¨çš„æ³›åŒ–èƒ½åŠ›</strong>ï¼›åŒæ—¶å½“ç»´æ•°å¾ˆé«˜æ—¶ï¼Œ<strong>è®¡ç®—è·ç¦»ä¹Ÿå˜å¾—ååˆ†å¤æ‚</strong>ï¼Œç”šè‡³è¿è®¡ç®—å†…ç§¯éƒ½ä¸å†å®¹æ˜“ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰ä½¿ç”¨æ ¸å‡½æ•°**â€œä½ç»´è®¡ç®—ï¼Œé«˜ç»´è¡¨ç°â€**çš„åŸå› ã€‚</p>
<p>ç¼“è§£ç»´æ•°ç¾éš¾çš„ä¸€ä¸ªé‡è¦é€”å¾„å°±æ˜¯<strong>é™ç»´ï¼Œå³é€šè¿‡æŸç§æ•°å­¦å˜æ¢å°†åŸå§‹é«˜ç»´ç©ºé—´è½¬å˜åˆ°ä¸€ä¸ªä½ç»´çš„å­ç©ºé—´</strong>ã€‚åœ¨è¿™ä¸ªå­ç©ºé—´ä¸­ï¼Œæ ·æœ¬çš„å¯†åº¦å°†å¤§å¹…æé«˜ï¼ŒåŒæ—¶è·ç¦»è®¡ç®—ä¹Ÿå˜å¾—å®¹æ˜“ã€‚è¿™æ—¶ä¹Ÿè®¸ä¼šæœ‰ç–‘é—®ï¼Œè¿™æ ·é™ç»´ä¹‹åä¸æ˜¯ä¼šä¸¢å¤±åŸå§‹æ•°æ®çš„ä¸€éƒ¨åˆ†ä¿¡æ¯å—ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨å¾ˆå¤šå®é™…çš„é—®é¢˜ä¸­ï¼Œè™½ç„¶è®­ç»ƒæ•°æ®æ˜¯é«˜ç»´çš„ï¼Œä½†æ˜¯ä¸å­¦ä¹ ä»»åŠ¡ç›¸å…³ä¹Ÿè®¸ä»…ä»…æ˜¯å…¶ä¸­çš„ä¸€ä¸ªä½ç»´å­ç©ºé—´ï¼Œä¹Ÿç§°ä¸ºä¸€ä¸ª<strong>ä½ç»´åµŒå…¥</strong>ï¼Œä¾‹å¦‚ï¼šæ•°æ®å±æ€§ä¸­å­˜åœ¨å™ªå£°å±æ€§ã€ç›¸ä¼¼å±æ€§æˆ–å†—ä½™å±æ€§ç­‰ï¼Œ<strong>å¯¹é«˜ç»´æ•°æ®è¿›è¡Œé™ç»´èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¾¾åˆ°æç‚¼ä½ç»´ä¼˜è´¨å±æ€§æˆ–é™å™ªçš„æ•ˆæœ</strong>ã€‚</p>
<h3 id="111-kè¿‘é‚»å­¦ä¹ "><a class="header" href="#111-kè¿‘é‚»å­¦ä¹ "><strong>11.1 Kè¿‘é‚»å­¦ä¹ </strong></a></h3>
<p>kè¿‘é‚»ç®—æ³•ç®€ç§°<strong>kNNï¼ˆk-Nearest Neighborï¼‰</strong>ï¼Œæ˜¯ä¸€ç§ç»å…¸çš„ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿå®åŠ›æ‹…å½“å…¥é€‰æ•°æ®æŒ–æ˜åå¤§ç®—æ³•ã€‚å…¶å·¥ä½œæœºåˆ¶ååˆ†ç®€å•ç²—æš´ï¼šç»™å®šæŸä¸ªæµ‹è¯•æ ·æœ¬ï¼ŒkNNåŸºäºæŸç§<strong>è·ç¦»åº¦é‡</strong>åœ¨è®­ç»ƒé›†ä¸­æ‰¾å‡ºä¸å…¶è·ç¦»æœ€è¿‘çš„kä¸ªå¸¦æœ‰çœŸå®æ ‡è®°çš„è®­ç»ƒæ ·æœ¬ï¼Œç„¶åç»™åŸºäºè¿™kä¸ªé‚»å±…çš„çœŸå®æ ‡è®°æ¥è¿›è¡Œé¢„æµ‹ï¼Œç±»ä¼¼äºå‰é¢é›†æˆå­¦ä¹ ä¸­æ‰€è®²åˆ°çš„åŸºå­¦ä¹ å™¨ç»“åˆç­–ç•¥ï¼šåˆ†ç±»ä»»åŠ¡é‡‡ç”¨æŠ•ç¥¨æ³•ï¼Œå›å½’ä»»åŠ¡åˆ™é‡‡ç”¨å¹³å‡æ³•ã€‚æ¥ä¸‹æ¥æœ¬ç¯‡ä¸»è¦å°±kNNåˆ†ç±»è¿›è¡Œè®¨è®ºã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a43873a.png" alt="1.png" /></p>
<p>ä»ä¸Šå›¾ã€æ¥è‡ªWikiã€‘ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå›¾ä¸­æœ‰ä¸¤ç§ç±»å‹çš„æ ·æœ¬ï¼Œä¸€ç±»æ˜¯è“è‰²æ­£æ–¹å½¢ï¼Œå¦ä¸€ç±»æ˜¯çº¢è‰²ä¸‰è§’å½¢ã€‚è€Œé‚£ä¸ªç»¿è‰²åœ†å½¢æ˜¯æˆ‘ä»¬å¾…åˆ†ç±»çš„æ ·æœ¬ã€‚åŸºäºkNNç®—æ³•çš„æ€è·¯ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š</p>
<blockquote>
<p>å¦‚æœK=3ï¼Œé‚£ä¹ˆç¦»ç»¿è‰²ç‚¹æœ€è¿‘çš„æœ‰2ä¸ªçº¢è‰²ä¸‰è§’å½¢å’Œ1ä¸ªè“è‰²çš„æ­£æ–¹å½¢ï¼Œè¿™3ä¸ªç‚¹æŠ•ç¥¨ï¼Œäºæ˜¯ç»¿è‰²çš„è¿™ä¸ªå¾…åˆ†ç±»ç‚¹å±äºçº¢è‰²çš„ä¸‰è§’å½¢ã€‚
å¦‚æœK=5ï¼Œé‚£ä¹ˆç¦»ç»¿è‰²ç‚¹æœ€è¿‘çš„æœ‰2ä¸ªçº¢è‰²ä¸‰è§’å½¢å’Œ3ä¸ªè“è‰²çš„æ­£æ–¹å½¢ï¼Œè¿™5ä¸ªç‚¹æŠ•ç¥¨ï¼Œäºæ˜¯ç»¿è‰²çš„è¿™ä¸ªå¾…åˆ†ç±»ç‚¹å±äºè“è‰²çš„æ­£æ–¹å½¢ã€‚</p>
</blockquote>
<p>å¯ä»¥å‘ç°ï¼š<strong>kNNè™½ç„¶æ˜¯ä¸€ç§ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œä½†æ˜¯å®ƒå´æ²¡æœ‰æ˜¾å¼çš„è®­ç»ƒè¿‡ç¨‹</strong>ï¼Œè€Œæ˜¯å½“æœ‰æ–°æ ·æœ¬éœ€è¦é¢„æµ‹æ—¶ï¼Œæ‰æ¥è®¡ç®—å‡ºæœ€è¿‘çš„kä¸ªé‚»å±…ï¼Œå› æ­¤<strong>kNNæ˜¯ä¸€ç§å…¸å‹çš„æ‡’æƒ°å­¦ä¹ æ–¹æ³•</strong>ï¼Œå†æ¥å›æƒ³ä¸€ä¸‹æœ´ç´ è´å¶æ–¯çš„æµç¨‹ï¼Œè®­ç»ƒçš„è¿‡ç¨‹å°±æ˜¯å‚æ•°ä¼°è®¡ï¼Œå› æ­¤æœ´ç´ è´å¶æ–¯ä¹Ÿå¯ä»¥æ‡’æƒ°å¼å­¦ä¹ ï¼Œæ­¤ç±»æŠ€æœ¯åœ¨<strong>è®­ç»ƒé˜¶æ®µå¼€é”€ä¸ºé›¶</strong>ï¼Œå¾…æ”¶åˆ°æµ‹è¯•æ ·æœ¬åå†è¿›è¡Œè®¡ç®—ã€‚ç›¸åº”åœ°æˆ‘ä»¬ç§°é‚£äº›ä¸€æœ‰è®­ç»ƒæ•°æ®ç«‹é©¬å¼€å·¥çš„ç®—æ³•ä¸ºâ€œ<strong>æ€¥åˆ‡å­¦ä¹ </strong>â€ï¼Œå¯è§å‰é¢æˆ‘ä»¬å­¦ä¹ çš„å¤§éƒ¨åˆ†ç®—æ³•éƒ½å½’å±äºæ€¥åˆ‡å­¦ä¹ ã€‚</p>
<p>å¾ˆå®¹æ˜“çœ‹å‡ºï¼š<strong>kNNç®—æ³•çš„æ ¸å¿ƒåœ¨äºkå€¼çš„é€‰å–ä»¥åŠè·ç¦»çš„åº¦é‡</strong>ã€‚kå€¼é€‰å–å¤ªå°ï¼Œæ¨¡å‹å¾ˆå®¹æ˜“å—åˆ°å™ªå£°æ•°æ®çš„å¹²æ‰°ï¼Œä¾‹å¦‚ï¼šæç«¯åœ°å–k=1ï¼Œè‹¥å¾…åˆ†ç±»æ ·æœ¬æ­£å¥½ä¸ä¸€ä¸ªå™ªå£°æ•°æ®è·ç¦»æœ€è¿‘ï¼Œå°±å¯¼è‡´äº†åˆ†ç±»é”™è¯¯ï¼›è‹¥kå€¼å¤ªå¤§ï¼Œ åˆ™åœ¨æ›´å¤§çš„é‚»åŸŸå†…è¿›è¡ŒæŠ•ç¥¨ï¼Œæ­¤æ—¶æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›å¤§å¤§å‡å¼±ï¼Œä¾‹å¦‚ï¼šæç«¯å–k=è®­ç»ƒæ ·æœ¬æ•°ï¼Œå°±ç›¸å½“äºæ¨¡å‹æ ¹æœ¬æ²¡æœ‰å­¦ä¹ ï¼Œæ‰€æœ‰æµ‹è¯•æ ·æœ¬çš„é¢„æµ‹ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚<strong>ä¸€èˆ¬åœ°æˆ‘ä»¬éƒ½é€šè¿‡äº¤å‰éªŒè¯æ³•æ¥é€‰å–ä¸€ä¸ªé€‚å½“çš„kå€¼</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a47db9a.png" alt="2.png" /></p>
<p>å¯¹äºè·ç¦»åº¦é‡ï¼Œ<strong>ä¸åŒçš„åº¦é‡æ–¹æ³•å¾—åˆ°çš„kä¸ªè¿‘é‚»ä¸å°½ç›¸åŒï¼Œä»è€Œå¯¹æœ€ç»ˆçš„æŠ•ç¥¨ç»“æœäº§ç”Ÿäº†å½±å“</strong>ï¼Œå› æ­¤é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„è·ç¦»åº¦é‡æ–¹æ³•ä¹Ÿååˆ†é‡è¦ã€‚åœ¨ä¸Šä¸€ç¯‡èšç±»ç®—æ³•ä¸­ï¼Œåœ¨åº¦é‡æ ·æœ¬ç›¸ä¼¼æ€§æ—¶ä»‹ç»äº†å¸¸ç”¨çš„å‡ ç§è·ç¦»è®¡ç®—æ–¹æ³•ï¼ŒåŒ…æ‹¬<strong>é—µå¯å¤«æ–¯åŸºè·ç¦»ï¼Œæ›¼å“ˆé¡¿è·ç¦»ï¼ŒVDM</strong>ç­‰ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œ<strong>kNNçš„è·ç¦»åº¦é‡å‡½æ•°ä¸€èˆ¬æ ¹æ®æ ·æœ¬çš„ç‰¹æ€§æ¥é€‰æ‹©åˆé€‚çš„è·ç¦»åº¦é‡ï¼ŒåŒæ—¶åº”å¯¹æ•°æ®è¿›è¡Œå»é‡çº²/å½’ä¸€åŒ–å¤„ç†æ¥æ¶ˆé™¤å¤§é‡çº²å±æ€§çš„å¼ºæƒæ”¿æ²»å½±å“</strong>ã€‚</p>
<h3 id="112-mdsç®—æ³•"><a class="header" href="#112-mdsç®—æ³•"><strong>11.2 MDSç®—æ³•</strong></a></h3>
<p>ä¸ç®¡æ˜¯ä½¿ç”¨æ ¸å‡½æ•°å‡ç»´è¿˜æ˜¯å¯¹æ•°æ®é™ç»´ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›<strong>åŸå§‹ç©ºé—´æ ·æœ¬ç‚¹ä¹‹é—´çš„è·ç¦»åœ¨æ–°ç©ºé—´ä¸­åŸºæœ¬ä¿æŒä¸å˜</strong>ï¼Œè¿™æ ·æ‰ä¸ä¼šä½¿å¾—åŸå§‹ç©ºé—´æ ·æœ¬ä¹‹é—´çš„å…³ç³»åŠæ€»ä½“åˆ†å¸ƒå‘ç”Ÿè¾ƒå¤§çš„æ”¹å˜ã€‚**â€œå¤šç»´ç¼©æ”¾â€ï¼ˆMDSï¼‰**æ­£æ˜¯åŸºäºè¿™æ ·çš„æ€æƒ³ï¼Œ<strong>MDSè¦æ±‚åŸå§‹ç©ºé—´æ ·æœ¬ä¹‹é—´çš„è·ç¦»åœ¨é™ç»´åçš„ä½ç»´ç©ºé—´ä¸­å¾—ä»¥ä¿æŒ</strong>ã€‚</p>
<p>å‡å®šmä¸ªæ ·æœ¬åœ¨åŸå§‹ç©ºé—´ä¸­ä»»æ„ä¸¤ä¸¤æ ·æœ¬ä¹‹é—´çš„è·ç¦»çŸ©é˜µä¸ºDâˆˆR(m*m)ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¾¿æ˜¯è·å¾—æ ·æœ¬åœ¨ä½ç»´ç©ºé—´ä¸­çš„è¡¨ç¤ºZâˆˆR(d'*m , d'&lt; d)ï¼Œä¸”ä»»æ„ä¸¤ä¸ªæ ·æœ¬åœ¨ä½ç»´ç©ºé—´ä¸­çš„æ¬§å¼è·ç¦»ç­‰äºåŸå§‹ç©ºé—´ä¸­çš„è·ç¦»ï¼Œå³||zi-zj||=Dist(ij)ã€‚å› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ ¹æ®å·²æœ‰çš„è·ç¦»çŸ©é˜µDæ¥æ±‚è§£å‡ºé™ç»´åçš„åæ ‡çŸ©é˜µZã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a4b664e.png" alt="3.png" /></p>
<p>ä»¤é™ç»´åçš„æ ·æœ¬åæ ‡çŸ©é˜µZè¢«ä¸­å¿ƒåŒ–ï¼Œ<strong>ä¸­å¿ƒåŒ–æ˜¯æŒ‡å°†æ¯ä¸ªæ ·æœ¬å‘é‡å‡å»æ•´ä¸ªæ ·æœ¬é›†çš„å‡å€¼å‘é‡ï¼Œæ•…æ‰€æœ‰æ ·æœ¬å‘é‡æ±‚å’Œå¾—åˆ°ä¸€ä¸ªé›¶å‘é‡</strong>ã€‚è¿™æ ·æ˜“çŸ¥ï¼šçŸ©é˜µBçš„æ¯ä¸€åˆ—ä»¥åŠæ¯ä¸€åˆ—æ±‚å’Œå‡ä¸º0ï¼Œå› ä¸ºæå–å…¬å› å­åéƒ½æœ‰ä¸€é¡¹ä¸ºæ‰€æœ‰æ ·æœ¬å‘é‡çš„å’Œå‘é‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a4a4ee2.png" alt="4.png" /></p>
<p>æ ¹æ®ä¸Šé¢çŸ©é˜µBçš„ç‰¹å¾ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—åˆ°ç­‰å¼ï¼ˆ2ï¼‰ã€ï¼ˆ3ï¼‰ä»¥åŠï¼ˆ4ï¼‰ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a4a777b.png" alt="5.png" /></p>
<p>è¿™æ—¶æ ¹æ®(1)--(4)å¼æˆ‘ä»¬ä¾¿å¯ä»¥è®¡ç®—å‡ºbijï¼Œå³<strong>bij=(1)-(2)<em>(1/m)-(3)</em>(1/m)+(4)*(1/(m^2))</strong>ï¼Œå†é€ä¸€åœ°è®¡ç®—æ¯ä¸ªb(ij)ï¼Œå°±å¾—åˆ°äº†é™ç»´åä½ç»´ç©ºé—´ä¸­çš„å†…ç§¯çŸ©é˜µB(B=Z'*Z)ï¼Œåªéœ€å¯¹Bè¿›è¡Œç‰¹å¾å€¼åˆ†è§£ä¾¿å¯ä»¥å¾—åˆ°Zã€‚MDSçš„ç®—æ³•æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a5340dd.png" alt="6.png" /></p>
<h3 id="113-ä¸»æˆåˆ†åˆ†æpca"><a class="header" href="#113-ä¸»æˆåˆ†åˆ†æpca"><strong>11.3 ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</strong></a></h3>
<p>ä¸åŒäºMDSé‡‡ç”¨è·ç¦»ä¿æŒçš„æ–¹æ³•ï¼Œ<strong>ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ç›´æ¥é€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå°†åŸå§‹ç©ºé—´ä¸­çš„æ ·æœ¬æŠ•å½±åˆ°æ–°çš„ä½ç»´ç©ºé—´ä¸­</strong>ã€‚ç®€å•æ¥ç†è§£è¿™ä¸€è¿‡ç¨‹ä¾¿æ˜¯ï¼š<strong>PCAé‡‡ç”¨ä¸€ç»„æ–°çš„åŸºæ¥è¡¨ç¤ºæ ·æœ¬ç‚¹ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªåŸºå‘é‡éƒ½æ˜¯åŸæ¥åŸºå‘é‡çš„çº¿æ€§ç»„åˆï¼Œé€šè¿‡ä½¿ç”¨å°½å¯èƒ½å°‘çš„æ–°åŸºå‘é‡æ¥è¡¨å‡ºæ ·æœ¬ï¼Œä»è€Œè¾¾åˆ°é™ç»´çš„ç›®çš„ã€‚</strong></p>
<p>å‡è®¾ä½¿ç”¨d'ä¸ªæ–°åŸºå‘é‡æ¥è¡¨ç¤ºåŸæ¥æ ·æœ¬ï¼Œå®è´¨ä¸Šæ˜¯å°†æ ·æœ¬æŠ•å½±åˆ°ä¸€ä¸ªç”±d'ä¸ªåŸºå‘é‡ç¡®å®šçš„ä¸€ä¸ª<strong>è¶…å¹³é¢</strong>ä¸Šï¼ˆ<strong>å³èˆå¼ƒäº†ä¸€äº›ç»´åº¦</strong>ï¼‰ï¼Œè¦ç”¨ä¸€ä¸ªè¶…å¹³é¢å¯¹ç©ºé—´ä¸­æ‰€æœ‰é«˜ç»´æ ·æœ¬è¿›è¡Œæ°å½“çš„è¡¨è¾¾ï¼Œæœ€ç†æƒ³çš„æƒ…å½¢æ˜¯ï¼š<strong>è‹¥è¿™äº›æ ·æœ¬ç‚¹éƒ½èƒ½åœ¨è¶…å¹³é¢ä¸Šè¡¨å‡ºä¸”è¿™äº›è¡¨å‡ºåœ¨è¶…å¹³é¢ä¸Šéƒ½èƒ½å¤Ÿå¾ˆå¥½åœ°åˆ†æ•£å¼€æ¥</strong>ã€‚ä½†æ˜¯ä¸€èˆ¬ä½¿ç”¨è¾ƒåŸç©ºé—´ä½ä¸€äº›ç»´åº¦çš„è¶…å¹³é¢æ¥åšåˆ°è¿™ä¸¤ç‚¹ååˆ†ä¸å®¹æ˜“ï¼Œå› æ­¤æˆ‘ä»¬é€€ä¸€æ­¥æµ·é˜”å¤©ç©ºï¼Œè¦æ±‚è¿™ä¸ªè¶…å¹³é¢åº”å…·æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ€§è´¨ï¼š</p>
<blockquote>
<p><strong>æœ€è¿‘é‡æ„æ€§</strong>ï¼šæ ·æœ¬ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»è¶³å¤Ÿè¿‘ï¼Œå³å°½å¯èƒ½åœ¨è¶…å¹³é¢é™„è¿‘ï¼›
<strong>æœ€å¤§å¯åˆ†æ€§</strong>ï¼šæ ·æœ¬ç‚¹åœ¨è¶…å¹³é¢ä¸Šçš„æŠ•å½±å°½å¯èƒ½åœ°åˆ†æ•£å¼€æ¥ï¼Œå³æŠ•å½±åçš„åæ ‡å…·æœ‰åŒºåˆ†æ€§ã€‚</p>
</blockquote>
<p>è¿™é‡Œååˆ†ç¥å¥‡çš„æ˜¯ï¼š<strong>æœ€è¿‘é‡æ„æ€§ä¸æœ€å¤§å¯åˆ†æ€§è™½ç„¶ä»ä¸åŒçš„å‡ºå‘ç‚¹æ¥å®šä¹‰ä¼˜åŒ–é—®é¢˜ä¸­çš„ç›®æ ‡å‡½æ•°ï¼Œä½†æœ€ç»ˆè¿™ä¸¤ç§ç‰¹æ€§å¾—åˆ°äº†å®Œå…¨ç›¸åŒçš„ä¼˜åŒ–é—®é¢˜</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a5213c1.png" alt="7.png" /></p>
<p>æ¥ç€ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ±‚è§£ä¸Šé¢çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¾—åˆ°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a4a102a.png" alt="8.png" /></p>
<p>å› æ­¤åªéœ€å¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œç‰¹å¾å€¼åˆ†è§£å³å¯æ±‚è§£å‡ºWï¼ŒPCAç®—æ³•çš„æ•´ä¸ªæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a540eb3.png" alt="9.png" /></p>
<p>å¦ä¸€ç¯‡åšå®¢ç»™å‡ºæ›´é€šä¿—æ›´è¯¦ç»†çš„ç†è§£ï¼š<a href="http://blog.csdn.net/u011826404/article/details/57472730">ä¸»æˆåˆ†åˆ†æè§£æï¼ˆåŸºäºæœ€å¤§æ–¹å·®ç†è®ºï¼‰</a></p>
<h3 id="114-æ ¸åŒ–çº¿æ€§é™ç»´"><a class="header" href="#114-æ ¸åŒ–çº¿æ€§é™ç»´"><strong>11.4 æ ¸åŒ–çº¿æ€§é™ç»´</strong></a></h3>
<p>è¯´èµ·æœºå™¨å­¦ä¹ ä½ ä¸­æœ‰æˆ‘/æˆ‘ä¸­æœ‰ä½ /æ°´ä¹³ç›¸è...åœ¨è¿™é‡Œèƒ½å¤Ÿå¾—åˆ°å¾ˆå¥½çš„ä½“ç°ã€‚æ­£å¦‚SVMåœ¨å¤„ç†éçº¿æ€§å¯åˆ†æ—¶ï¼Œé€šè¿‡å¼•å…¥æ ¸å‡½æ•°å°†æ ·æœ¬æŠ•å½±åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´ï¼Œæ¥ç€åœ¨é«˜ç»´ç©ºé—´å†å¯¹æ ·æœ¬ç‚¹ä½¿ç”¨è¶…å¹³é¢åˆ’åˆ†ã€‚è¿™é‡Œä¹Ÿæ˜¯ç›¸åŒçš„é—®é¢˜ï¼šè‹¥æˆ‘ä»¬çš„æ ·æœ¬æ•°æ®ç‚¹æœ¬èº«å°±ä¸æ˜¯çº¿æ€§åˆ†å¸ƒï¼Œé‚£è¿˜å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªè¶…å¹³é¢å»è¿‘ä¼¼è¡¨å‡ºå‘¢ï¼Ÿå› æ­¤ä¹Ÿå°±å¼•å…¥äº†æ ¸å‡½æ•°ï¼Œ<strong>å³å…ˆå°†æ ·æœ¬æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œå†åœ¨é«˜ç»´ç©ºé—´ä¸­ä½¿ç”¨çº¿æ€§é™ç»´çš„æ–¹æ³•</strong>ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»**æ ¸åŒ–ä¸»æˆåˆ†åˆ†æï¼ˆKPCAï¼‰**çš„æ€æƒ³ã€‚</p>
<p>è‹¥æ ¸å‡½æ•°çš„å½¢å¼å·²çŸ¥ï¼Œå³æˆ‘ä»¬çŸ¥é“å¦‚ä½•å°†ä½ç»´çš„åæ ‡å˜æ¢ä¸ºé«˜ç»´åæ ‡ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€å…ˆå°†æ•°æ®æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾ç©ºé—´ï¼Œå†åœ¨é«˜ç»´ç©ºé—´ä¸­è¿ç”¨PCAå³å¯ã€‚ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æ ¸å‡½æ•°å…·ä½“çš„æ˜ å°„è§„åˆ™ï¼Œä¾‹å¦‚ï¼šSigmoidã€é«˜æ–¯æ ¸ç­‰ï¼Œæˆ‘ä»¬åªçŸ¥é“å¦‚ä½•è®¡ç®—é«˜ç»´ç©ºé—´ä¸­çš„æ ·æœ¬å†…ç§¯ï¼Œè¿™æ—¶å°±å¼•å‡ºäº†KPCAçš„ä¸€ä¸ªé‡è¦åˆ›æ–°ä¹‹å¤„ï¼š<strong>å³ç©ºé—´ä¸­çš„ä»»ä¸€å‘é‡ï¼Œéƒ½å¯ä»¥ç”±è¯¥ç©ºé—´ä¸­çš„æ‰€æœ‰æ ·æœ¬çº¿æ€§è¡¨ç¤º</strong>ã€‚è¯æ˜è¿‡ç¨‹ä¹Ÿååˆ†ç®€å•ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851a51bd2a.png" alt="10.png" /></p>
<p>è¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥å°†é«˜ç»´ç‰¹å¾ç©ºé—´ä¸­çš„æŠ•å½±å‘é‡wiä½¿ç”¨æ‰€æœ‰é«˜ç»´æ ·æœ¬ç‚¹çº¿æ€§è¡¨å‡ºï¼Œæ¥ç€ä»£å…¥PCAçš„æ±‚è§£é—®é¢˜ï¼Œå¾—åˆ°ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b74b083.png" alt="11.png" /></p>
<p>åŒ–ç®€åˆ°æœ€åä¸€æ­¥ï¼Œå‘ç°ç»“æœååˆ†çš„ç¾å¦™ï¼Œåªéœ€å¯¹æ ¸çŸ©é˜µKè¿›è¡Œç‰¹å¾åˆ†è§£ï¼Œä¾¿å¯ä»¥å¾—å‡ºæŠ•å½±å‘é‡wiå¯¹åº”çš„ç³»æ•°å‘é‡Î±ï¼Œå› æ­¤é€‰å–ç‰¹å¾å€¼å‰d'å¤§å¯¹åº”çš„ç‰¹å¾å‘é‡ä¾¿æ˜¯d'ä¸ªç³»æ•°å‘é‡ã€‚è¿™æ—¶å¯¹äºéœ€è¦é™ç»´çš„æ ·æœ¬ç‚¹ï¼Œåªéœ€æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¾¿å¯ä»¥æ±‚å‡ºå…¶é™ç»´åçš„åæ ‡ã€‚å¯ä»¥çœ‹å‡ºï¼šKPCAåœ¨è®¡ç®—é™ç»´åçš„åæ ‡è¡¨ç¤ºæ—¶ï¼Œéœ€è¦ä¸æ‰€æœ‰æ ·æœ¬ç‚¹è®¡ç®—æ ¸å‡½æ•°å€¼å¹¶æ±‚å’Œï¼Œå› æ­¤è¯¥ç®—æ³•çš„è®¡ç®—å¼€é”€ååˆ†å¤§ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b735754.png" alt="12.png" /></p>
<h3 id="115-æµå½¢å­¦ä¹ "><a class="header" href="#115-æµå½¢å­¦ä¹ "><strong>11.5 æµå½¢å­¦ä¹ </strong></a></h3>
<p><strong>æµå½¢å­¦ä¹ ï¼ˆmanifold learningï¼‰æ˜¯ä¸€ç§å€ŸåŠ©æ‹“æ‰‘æµå½¢æ¦‚å¿µçš„é™ç»´æ–¹æ³•</strong>ï¼Œ<strong>æµå½¢æ˜¯æŒ‡åœ¨å±€éƒ¨ä¸æ¬§å¼ç©ºé—´åŒèƒšçš„ç©ºé—´</strong>ï¼Œå³åœ¨å±€éƒ¨ä¸æ¬§å¼ç©ºé—´å…·æœ‰ç›¸åŒçš„æ€§è´¨ï¼Œèƒ½ç”¨æ¬§æ°è·ç¦»è®¡ç®—æ ·æœ¬ä¹‹é—´çš„è·ç¦»ã€‚è¿™æ ·å³ä½¿é«˜ç»´ç©ºé—´çš„åˆ†å¸ƒååˆ†å¤æ‚ï¼Œä½†æ˜¯åœ¨å±€éƒ¨ä¸Šä¾ç„¶æ»¡è¶³æ¬§å¼ç©ºé—´çš„æ€§è´¨ï¼ŒåŸºäºæµå½¢å­¦ä¹ çš„é™ç»´æ­£æ˜¯è¿™ç§**â€œé‚»åŸŸä¿æŒâ€<strong>çš„æ€æƒ³ã€‚å…¶ä¸­</strong>ç­‰åº¦é‡æ˜ å°„ï¼ˆIsomapï¼‰è¯•å›¾åœ¨é™ç»´å‰åä¿æŒé‚»åŸŸå†…æ ·æœ¬ä¹‹é—´çš„è·ç¦»ï¼Œè€Œå±€éƒ¨çº¿æ€§åµŒå…¥ï¼ˆLLEï¼‰åˆ™æ˜¯ä¿æŒé‚»åŸŸå†…æ ·æœ¬ä¹‹é—´çš„çº¿æ€§å…³ç³»**ï¼Œä¸‹é¢å°†åˆ†åˆ«å¯¹è¿™ä¸¤ç§è‘—åçš„æµè¡Œå­¦ä¹ æ–¹æ³•è¿›è¡Œä»‹ç»ã€‚</p>
<h4 id="1151-ç­‰åº¦é‡æ˜ å°„isomap"><a class="header" href="#1151-ç­‰åº¦é‡æ˜ å°„isomap"><strong>11.5.1 ç­‰åº¦é‡æ˜ å°„ï¼ˆIsomapï¼‰</strong></a></h4>
<p>ç­‰åº¦é‡æ˜ å°„çš„åŸºæœ¬å‡ºå‘ç‚¹æ˜¯ï¼šé«˜ç»´ç©ºé—´ä¸­çš„ç›´çº¿è·ç¦»å…·æœ‰è¯¯å¯¼æ€§ï¼Œå› ä¸ºæœ‰æ—¶é«˜ç»´ç©ºé—´ä¸­çš„ç›´çº¿è·ç¦»åœ¨ä½ç»´ç©ºé—´ä¸­æ˜¯ä¸å¯è¾¾çš„ã€‚<strong>å› æ­¤åˆ©ç”¨æµå½¢åœ¨å±€éƒ¨ä¸Šä¸æ¬§å¼ç©ºé—´åŒèƒšçš„æ€§è´¨ï¼Œå¯ä»¥ä½¿ç”¨è¿‘é‚»è·ç¦»æ¥é€¼è¿‘æµ‹åœ°çº¿è·ç¦»</strong>ï¼Œå³å¯¹äºä¸€ä¸ªæ ·æœ¬ç‚¹ï¼Œå®ƒä¸è¿‘é‚»å†…çš„æ ·æœ¬ç‚¹ä¹‹é—´æ˜¯å¯è¾¾çš„ï¼Œä¸”è·ç¦»ä½¿ç”¨æ¬§å¼è·ç¦»è®¡ç®—ï¼Œè¿™æ ·æ•´ä¸ªæ ·æœ¬ç©ºé—´å°±å½¢æˆäº†ä¸€å¼ è¿‘é‚»å›¾ï¼Œé«˜ç»´ç©ºé—´ä¸­ä¸¤ä¸ªæ ·æœ¬ä¹‹é—´çš„è·ç¦»å°±è½¬ä¸ºæœ€çŸ­è·¯å¾„é—®é¢˜ã€‚å¯é‡‡ç”¨è‘—åçš„<strong>Dijkstraç®—æ³•</strong>æˆ–<strong>Floydç®—æ³•</strong>è®¡ç®—æœ€çŸ­è·ç¦»ï¼Œå¾—åˆ°é«˜ç»´ç©ºé—´ä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»åä¾¿å¯ä»¥ä½¿ç”¨MDSç®—æ³•æ¥å…¶è®¡ç®—ä½ç»´ç©ºé—´ä¸­çš„åæ ‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b731a1e.png" alt="13.png" /></p>
<p>ä»MDSç®—æ³•çš„æè¿°ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼šMDSå…ˆæ±‚å‡ºäº†ä½ç»´ç©ºé—´çš„å†…ç§¯çŸ©é˜µBï¼Œæ¥ç€ä½¿ç”¨ç‰¹å¾å€¼åˆ†è§£è®¡ç®—å‡ºäº†æ ·æœ¬åœ¨ä½ç»´ç©ºé—´ä¸­çš„åæ ‡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç»™å‡ºé€šç”¨çš„æŠ•å½±å‘é‡wï¼Œå› æ­¤å¯¹äºéœ€è¦é™ç»´çš„æ–°æ ·æœ¬æ— ä»ä¸‹æ‰‹ï¼Œä¹¦ä¸­ç»™å‡ºçš„æƒå®œä¹‹è®¡æ˜¯åˆ©ç”¨å·²çŸ¥é«˜/ä½ç»´åæ ‡çš„æ ·æœ¬ä½œä¸ºè®­ç»ƒé›†å­¦ä¹ å‡ºä¸€ä¸ªâ€œæŠ•å½±å™¨â€ï¼Œä¾¿å¯ä»¥ç”¨é«˜ç»´åæ ‡é¢„æµ‹å‡ºä½ç»´åæ ‡ã€‚Isomapç®—æ³•æµç¨‹å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b6c7e37.png" alt="14.png" /></p>
<p>å¯¹äºè¿‘é‚»å›¾çš„æ„å»ºï¼Œå¸¸ç”¨çš„æœ‰ä¸¤ç§æ–¹æ³•ï¼š<strong>ä¸€ç§æ˜¯æŒ‡å®šè¿‘é‚»ç‚¹ä¸ªæ•°</strong>ï¼ŒåƒkNNä¸€æ ·é€‰å–kä¸ªæœ€è¿‘çš„é‚»å±…ï¼›<strong>å¦ä¸€ç§æ˜¯æŒ‡å®šé‚»åŸŸåŠå¾„</strong>ï¼Œè·ç¦»å°äºè¯¥é˜ˆå€¼çš„è¢«è®¤ä¸ºæ˜¯å®ƒçš„è¿‘é‚»ç‚¹ã€‚ä½†ä¸¤ç§æ–¹æ³•å‡ä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼š</p>
<blockquote>
<p>è‹¥<strong>é‚»åŸŸèŒƒå›´æŒ‡å®šè¿‡å¤§ï¼Œåˆ™ä¼šé€ æˆâ€œçŸ­è·¯é—®é¢˜â€</strong>ï¼Œå³æœ¬èº«è·ç¦»å¾ˆè¿œå´æˆäº†è¿‘é‚»ï¼Œå°†è·ç¦»è¿‘çš„é‚£äº›æ ·æœ¬æ‰¼æ€åœ¨æ‘‡ç¯®ã€‚
è‹¥<strong>é‚»åŸŸèŒƒå›´æŒ‡å®šè¿‡å°ï¼Œåˆ™ä¼šé€ æˆâ€œæ–­è·¯é—®é¢˜â€</strong>ï¼Œå³æœ‰äº›æ ·æœ¬ç‚¹æ— æ³•å¯è¾¾äº†ï¼Œæ•´ä¸ªä¸–ç•Œæ‘è¢«åˆ’åˆ†ä¸ºäº’ä¸å¯è¾¾çš„å°éƒ¨è½ã€‚</p>
</blockquote>
<h4 id="1152-å±€éƒ¨çº¿æ€§åµŒå…¥lle"><a class="header" href="#1152-å±€éƒ¨çº¿æ€§åµŒå…¥lle"><strong>11.5.2 å±€éƒ¨çº¿æ€§åµŒå…¥(LLE)</strong></a></h4>
<p>ä¸åŒäºIsomapç®—æ³•å»ä¿æŒé‚»åŸŸè·ç¦»ï¼ŒLLEç®—æ³•è¯•å›¾å»ä¿æŒé‚»åŸŸå†…çš„çº¿æ€§å…³ç³»ï¼Œå‡å®šæ ·æœ¬xiçš„åæ ‡å¯ä»¥é€šè¿‡å®ƒçš„é‚»åŸŸæ ·æœ¬çº¿æ€§è¡¨å‡ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b64236f.png" alt="15.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b6a7b9a.png" alt="16.png" /></p>
<p>LLEç®—æ³•åˆ†ä¸ºä¸¤æ­¥èµ°ï¼Œ<strong>é¦–å…ˆç¬¬ä¸€æ­¥æ ¹æ®è¿‘é‚»å…³ç³»è®¡ç®—å‡ºæ‰€æœ‰æ ·æœ¬çš„é‚»åŸŸé‡æ„ç³»æ•°w</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b662815.png" alt="17.png" /></p>
<p><strong>æ¥ç€æ ¹æ®é‚»åŸŸé‡æ„ç³»æ•°ä¸å˜ï¼Œå»æ±‚è§£ä½ç»´åæ ‡</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b648b98.png" alt="18.png" /></p>
<p>è¿™æ ·åˆ©ç”¨çŸ©é˜µMï¼Œä¼˜åŒ–é—®é¢˜å¯ä»¥é‡å†™ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b6948d7.png" alt="19.png" /></p>
<p>Mç‰¹å¾å€¼åˆ†è§£åæœ€å°çš„d'ä¸ªç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆZï¼ŒLLEç®—æ³•çš„å…·ä½“æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851b757d8c.png" alt="20.png" /></p>
<h3 id="116-åº¦é‡å­¦ä¹ "><a class="header" href="#116-åº¦é‡å­¦ä¹ "><strong>11.6 åº¦é‡å­¦ä¹ </strong></a></h3>
<p>æœ¬ç¯‡ä¸€å¼€å§‹å°±æåˆ°ç»´æ•°ç¾éš¾ï¼Œå³åœ¨é«˜ç»´ç©ºé—´è¿›è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡é‡åˆ°æ ·æœ¬ç¨€ç–ã€è·ç¦»éš¾è®¡ç®—ç­‰è¯¸å¤šçš„é—®é¢˜ï¼Œå› æ­¤å‰é¢è®¨è®ºçš„é™ç»´æ–¹æ³•éƒ½è¯•å›¾å°†åŸç©ºé—´æŠ•å½±åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç»´ç©ºé—´ä¸­ï¼Œæ¥ç€åœ¨ä½ç»´ç©ºé—´è¿›è¡Œå­¦ä¹ ä»»åŠ¡ä»è€Œäº§ç”Ÿè¾ƒå¥½çš„æ€§èƒ½ã€‚äº‹å®ä¸Šï¼Œä¸ç®¡é«˜ç»´ç©ºé—´è¿˜æ˜¯ä½ç»´ç©ºé—´éƒ½æ½œåœ¨å¯¹åº”ç€ä¸€ä¸ªè·ç¦»åº¦é‡ï¼Œé‚£å¯ä¸å¯ä»¥ç›´æ¥å­¦ä¹ å‡ºä¸€ä¸ªè·ç¦»åº¦é‡æ¥ç­‰æ•ˆé™ç»´å‘¢ï¼Ÿä¾‹å¦‚ï¼š<strong>å’‹ä»¬å°±æŒ‰ç…§é™ç»´åçš„æ–¹å¼æ¥è¿›è¡Œè·ç¦»çš„è®¡ç®—ï¼Œè¿™ä¾¿æ˜¯åº¦é‡å­¦ä¹ çš„åˆè¡·</strong>ã€‚</p>
<p><strong>é¦–å…ˆè¦å­¦ä¹ å‡ºè·ç¦»åº¦é‡å¿…é¡»å…ˆå®šä¹‰ä¸€ä¸ªåˆé€‚çš„è·ç¦»åº¦é‡å½¢å¼</strong>ã€‚å¯¹ä¸¤ä¸ªæ ·æœ¬xiä¸xjï¼Œå®ƒä»¬ä¹‹é—´çš„å¹³æ–¹æ¬§å¼è·ç¦»ä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851d3ca3d5.png" alt="21.png" /></p>
<p>è‹¥å„ä¸ªå±æ€§é‡è¦ç¨‹åº¦ä¸ä¸€æ ·å³éƒ½æœ‰ä¸€ä¸ªæƒé‡ï¼Œåˆ™å¾—åˆ°åŠ æƒçš„å¹³æ–¹æ¬§å¼è·ç¦»ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851d3d82c5.png" alt="22.png" /></p>
<p>æ­¤æ—¶å„ä¸ªå±æ€§ä¹‹é—´éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹æ— å…³çš„ï¼Œä½†ç°å®ä¸­å¾€å¾€ä¼šå­˜åœ¨å±æ€§ä¹‹é—´æœ‰å…³è”çš„æƒ…å½¢ï¼Œä¾‹å¦‚ï¼šèº«é«˜å’Œä½“é‡ï¼Œä¸€èˆ¬äººè¶Šé«˜ï¼Œä½“é‡ä¹Ÿä¼šé‡ä¸€äº›ï¼Œä»–ä»¬ä¹‹é—´å­˜åœ¨è¾ƒå¤§çš„ç›¸å…³æ€§ã€‚è¿™æ ·è®¡ç®—è·ç¦»å°±ä¸èƒ½åˆ†å±æ€§å•ç‹¬è®¡ç®—ï¼Œäºæ˜¯å°±å¼•å…¥ç»å…¸çš„<strong>é©¬æ°è·ç¦»(Mahalanobis distance)</strong>:</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851d3dc303.png" alt="23.png" /></p>
<p><strong>æ ‡å‡†çš„é©¬æ°è·ç¦»ä¸­Mæ˜¯åæ–¹å·®çŸ©é˜µçš„é€†ï¼Œé©¬æ°è·ç¦»æ˜¯ä¸€ç§è€ƒè™‘å±æ€§ä¹‹é—´ç›¸å…³æ€§ä¸”å°ºåº¦æ— å…³ï¼ˆå³æ— é¡»å»é‡çº²ï¼‰çš„è·ç¦»åº¦é‡</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc851d3e17c0.png" alt="24.png" /></p>
<p><strong>çŸ©é˜µMä¹Ÿç§°ä¸ºâ€œåº¦é‡çŸ©é˜µâ€ï¼Œä¸ºä¿è¯è·ç¦»åº¦é‡çš„éè´Ÿæ€§ä¸å¯¹ç§°æ€§ï¼ŒMå¿…é¡»ä¸º(åŠ)æ­£å®šå¯¹ç§°çŸ©é˜µ</strong>ï¼Œè¿™æ ·å°±ä¸ºåº¦é‡å­¦ä¹ å®šä¹‰å¥½äº†è·ç¦»åº¦é‡çš„å½¢å¼ï¼Œæ¢å¥è¯è¯´ï¼š<strong>åº¦é‡å­¦ä¹ ä¾¿æ˜¯å¯¹åº¦é‡çŸ©é˜µè¿›è¡Œå­¦ä¹ </strong>ã€‚ç°åœ¨æ¥å›æƒ³ä¸€ä¸‹å‰é¢æˆ‘ä»¬æ¥è§¦çš„æœºå™¨å­¦ä¹ ä¸éš¾å‘ç°ï¼š<strong>æœºå™¨å­¦ä¹ ç®—æ³•å‡ ä¹éƒ½æ˜¯åœ¨ä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼Œä»è€Œæ±‚è§£ç›®æ ‡å‡½æ•°ä¸­çš„å‚æ•°</strong>ã€‚åŒæ ·å¯¹äºåº¦é‡å­¦ä¹ ï¼Œä¹Ÿéœ€è¦è®¾ç½®ä¸€ä¸ªä¼˜åŒ–ç›®æ ‡ï¼Œä¹¦ä¸­ç®€è¦ä»‹ç»äº†é”™è¯¯ç‡å’Œç›¸ä¼¼æ€§ä¸¤ç§ä¼˜åŒ–ç›®æ ‡ï¼Œæ­¤å¤„é™äºç¯‡å¹…ä¸è¿›è¡Œå±•å¼€ã€‚</p>
<p>åœ¨æ­¤ï¼Œé™ç»´å’Œåº¦é‡å­¦ä¹ å°±ä»‹ç»å®Œæ¯•ã€‚<strong>é™ç»´æ˜¯å°†åŸé«˜ç»´ç©ºé—´åµŒå…¥åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç»´å­ç©ºé—´ä¸­ï¼Œæ¥ç€åœ¨ä½ç»´ç©ºé—´ä¸­è¿›è¡Œå­¦ä¹ ä»»åŠ¡ï¼›åº¦é‡å­¦ä¹ åˆ™æ˜¯è¯•å›¾å»å­¦ä¹ å‡ºä¸€ä¸ªè·ç¦»åº¦é‡æ¥ç­‰æ•ˆé™ç»´çš„æ•ˆæœ</strong>ï¼Œä¸¤è€…éƒ½æ˜¯ä¸ºäº†è§£å†³ç»´æ•°ç¾éš¾å¸¦æ¥çš„è¯¸å¤šé—®é¢˜ã€‚ä¹Ÿè®¸å¤§å®¶æœ€åå¿ƒå­˜ç–‘æƒ‘ï¼Œé‚£kNNå‘¢ï¼Œä¸ºä»€ä¹ˆä¸€å¼€å¤´å°±è¯´äº†kNNç®—æ³•ï¼Œä½†æ˜¯å¥½åƒå’Œåé¢æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Ÿæ­£æ˜¯å› ä¸ºåœ¨é™ç»´ç®—æ³•ä¸­ï¼Œä½ç»´å­ç©ºé—´çš„ç»´æ•°d'é€šå¸¸éƒ½ç”±äººä¸ºæŒ‡å®šï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›ä½å¼€é”€çš„å­¦ä¹ å™¨æ¥é€‰å–åˆé€‚çš„d'ï¼Œ<strong>kNNè¿™å®¶ä¼™æ‡’åˆ°å®¶äº†æ ¹æœ¬æ— å¿ƒå­¦ä¹ ï¼Œåœ¨è®­ç»ƒé˜¶æ®µå¼€é”€ä¸ºé›¶ï¼Œæµ‹è¯•é˜¶æ®µä¹Ÿåªæ˜¯éå†è®¡ç®—äº†è·ç¦»ï¼Œå› æ­¤æ‹¿kNNæ¥è¿›è¡Œäº¤å‰éªŒè¯å°±ååˆ†æœ‰ä¼˜åŠ¿äº†~åŒæ—¶é™ç»´åæ ·æœ¬å¯†åº¦å¢å¤§åŒæ—¶è·ç¦»è®¡ç®—å˜æ˜“ï¼Œæ›´ä¸ºkNNæ¥å±•ç¤ºå®ƒç‹¬ç‰¹çš„åå…«èˆ¬æ‰‹è‰ºæä¾›äº†ç”¨æ­¦ä¹‹åœ°ã€‚</strong></p>
<h2 id="åäºŒ-ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ "><a class="header" href="#åäºŒ-ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ "><strong>åäºŒï¼ ç‰¹å¾é€‰æ‹©ä¸ç¨€ç–å­¦ä¹ </strong></a></h2>
<p>æœ€è¿‘åœ¨çœ‹è®ºæ–‡çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å¯¹äºæ•°æ®é›†è¡Œå’Œåˆ—çš„å«æ³•é¢‡æœ‰ä¸åŒï¼Œæ•…åœ¨ä»‹ç»æœ¬ç¯‡ä¹‹å‰ï¼Œå†³å®šå…ˆå°†æœ€å¸¸ç”¨çš„æœ¯è¯­ç½—åˆ—ä¸€äºŒï¼Œä»¥åå†è§åˆ°äº†ä¸ç®¡å®ƒè„šæ‰‘æœ”è¿˜æ˜¯çœ¼è¿·ç¦»å°±èƒ½ä¸€çœ¼è¯†ç ´çœŸèº«äº†~å¯¹äºæ•°æ®é›†ä¸­çš„ä¸€ä¸ªå¯¹è±¡åŠç»„æˆå¯¹è±¡çš„é›¶ä»¶å…ƒç´ ï¼š</p>
<blockquote>
<p>ç»Ÿè®¡å­¦å®¶å¸¸ç§°å®ƒä»¬ä¸º<strong>è§‚æµ‹</strong>ï¼ˆ<strong>observation</strong>ï¼‰å’Œ<strong>å˜é‡</strong>ï¼ˆ<strong>variable</strong>ï¼‰ï¼›
æ•°æ®åº“åˆ†æå¸ˆåˆ™ç§°å…¶ä¸º<strong>è®°å½•</strong>ï¼ˆ<strong>record</strong>ï¼‰å’Œ<strong>å­—æ®µ</strong>ï¼ˆ<strong>field</strong>ï¼‰ï¼›
æ•°æ®æŒ–æ˜/æœºå™¨å­¦ä¹ å­¦ç§‘çš„ç ”ç©¶è€…åˆ™ä¹ æƒ¯æŠŠå®ƒä»¬å«åš<strong>æ ·æœ¬</strong>/<strong>ç¤ºä¾‹</strong>ï¼ˆ<strong>example</strong>/<strong>instance</strong>ï¼‰å’Œ<strong>å±æ€§</strong>/<strong>ç‰¹å¾</strong>ï¼ˆ<strong>attribute</strong>/<strong>feature</strong>ï¼‰ã€‚</p>
</blockquote>
<p>å›å½’æ­£é¢˜ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ç‰¹å¾é€‰æ‹©æ˜¯ä¸€ä¸ªé‡è¦çš„â€œ<strong>æ•°æ®é¢„å¤„ç†</strong>â€ï¼ˆ<strong>data</strong> <strong>preprocessing</strong>ï¼‰è¿‡ç¨‹ï¼Œå³è¯•å›¾ä»æ•°æ®é›†çš„æ‰€æœ‰ç‰¹å¾ä¸­æŒ‘é€‰å‡ºä¸å½“å‰å­¦ä¹ ä»»åŠ¡ç›¸å…³çš„ç‰¹å¾å­é›†ï¼Œæ¥ç€å†åˆ©ç”¨æ•°æ®å­é›†æ¥è®­ç»ƒå­¦ä¹ å™¨ï¼›ç¨€ç–å­¦ä¹ åˆ™æ˜¯å›´ç»•ç€ç¨€ç–çŸ©é˜µçš„ä¼˜è‰¯æ€§è´¨ï¼Œæ¥å®Œæˆç›¸åº”çš„å­¦ä¹ ä»»åŠ¡ã€‚</p>
<h3 id="121-å­é›†æœç´¢ä¸è¯„ä»·"><a class="header" href="#121-å­é›†æœç´¢ä¸è¯„ä»·"><strong>12.1 å­é›†æœç´¢ä¸è¯„ä»·</strong></a></h3>
<p>ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¾ˆå¤šå±æ€§/ç‰¹å¾æ¥æè¿°ä¸€ä¸ªç¤ºä¾‹ï¼Œä¾‹å¦‚å¯¹äºä¸€ä¸ªäººå¯ä»¥ç”¨æ€§åˆ«ã€èº«é«˜ã€ä½“é‡ã€å¹´é¾„ã€å­¦å†ã€ä¸“ä¸šã€æ˜¯å¦åƒè´§ç­‰å±æ€§æ¥æè¿°ï¼Œé‚£ç°åœ¨æƒ³è¦è®­ç»ƒå‡ºä¸€ä¸ªå­¦ä¹ å™¨æ¥é¢„æµ‹äººçš„æ”¶å…¥ã€‚æ ¹æ®ç”Ÿæ´»ç»éªŒæ˜“çŸ¥ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç‰¹å¾éƒ½ä¸å­¦ä¹ ä»»åŠ¡ç›¸å…³ï¼Œä¾‹å¦‚å¹´é¾„/å­¦å†/ä¸“ä¸šå¯èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“äº†æ”¶å…¥ï¼Œèº«é«˜/ä½“é‡è¿™äº›å¤–è²Œå±æ€§ä¹Ÿæœ‰è¾ƒå°çš„å¯èƒ½æ€§å½±å“æ”¶å…¥ï¼Œä½†åƒæ˜¯å¦æ˜¯ä¸€ä¸ªåœ°åœ°é“é“çš„åƒè´§è¿™ç§å±æ€§å°±å…«æ†å­æ‰“ä¸ç€äº†ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦é‚£äº›ä¸å­¦ä¹ ä»»åŠ¡ç´§å¯†ç›¸å…³çš„ç‰¹å¾ï¼Œ<strong>ç‰¹å¾é€‰æ‹©ä¾¿æ˜¯ä»ç»™å®šçš„ç‰¹å¾é›†åˆä¸­é€‰å‡ºç›¸å…³ç‰¹å¾å­é›†çš„è¿‡ç¨‹</strong>ã€‚</p>
<p>ä¸ä¸Šç¯‡ä¸­é™ç»´æŠ€æœ¯æœ‰ç€å¼‚æ›²åŒå·¥ä¹‹å¤„çš„æ˜¯ï¼Œç‰¹å¾é€‰æ‹©ä¹Ÿå¯ä»¥æœ‰æ•ˆåœ°è§£å†³ç»´æ•°ç¾éš¾çš„éš¾é¢˜ã€‚å…·ä½“è€Œè¨€ï¼š<strong>é™ç»´ä»ä¸€å®šç¨‹åº¦èµ·åˆ°äº†æç‚¼ä¼˜è´¨ä½ç»´å±æ€§å’Œé™å™ªçš„æ•ˆæœï¼Œç‰¹å¾é€‰æ‹©åˆ™æ˜¯ç›´æ¥å‰”é™¤é‚£äº›ä¸å­¦ä¹ ä»»åŠ¡æ— å…³çš„å±æ€§è€Œé€‰æ‹©å‡ºæœ€ä½³ç‰¹å¾å­é›†</strong>ã€‚è‹¥ç›´æ¥éå†æ‰€æœ‰ç‰¹å¾å­é›†ï¼Œæ˜¾ç„¶å½“ç»´æ•°è¿‡å¤šæ—¶é­é‡æŒ‡æ•°çˆ†ç‚¸å°±è¡Œä¸é€šäº†ï¼›è‹¥é‡‡å–ä»å€™é€‰ç‰¹å¾å­é›†ä¸­ä¸æ–­è¿­ä»£ç”Ÿæˆæ›´ä¼˜å€™é€‰å­é›†çš„æ–¹æ³•ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦å¤§å¤§å‡å°ã€‚è¿™æ—¶å°±æ¶‰åŠåˆ°äº†ä¸¤ä¸ªå…³é”®ç¯èŠ‚ï¼š<strong>1.å¦‚ä½•ç”Ÿæˆå€™é€‰å­é›†ï¼›2.å¦‚ä½•è¯„ä»·å€™é€‰å­é›†çš„å¥½å</strong>ï¼Œè¿™ä¾¿æ˜¯æ—©æœŸç‰¹å¾é€‰æ‹©çš„å¸¸ç”¨æ–¹æ³•ã€‚ä¹¦æœ¬ä¸Šä»‹ç»äº†è´ªå¿ƒç®—æ³•ï¼Œåˆ†ä¸ºä¸‰ç§ç­–ç•¥ï¼š</p>
<blockquote>
<p><strong>å‰å‘æœç´¢</strong>ï¼šåˆå§‹å°†æ¯ä¸ªç‰¹å¾å½“åšä¸€ä¸ªå€™é€‰ç‰¹å¾å­é›†ï¼Œç„¶åä»å½“å‰æ‰€æœ‰çš„å€™é€‰å­é›†ä¸­é€‰æ‹©å‡ºæœ€ä½³çš„ç‰¹å¾å­é›†ï¼›æ¥ç€åœ¨ä¸Šä¸€è½®é€‰å‡ºçš„ç‰¹å¾å­é›†ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼ŒåŒæ ·åœ°é€‰å‡ºæœ€ä½³ç‰¹å¾å­é›†ï¼›æœ€åç›´è‡³é€‰ä¸å‡ºæ¯”ä¸Šä¸€è½®æ›´å¥½çš„ç‰¹å¾å­é›†ã€‚
<strong>åå‘æœç´¢</strong>ï¼šåˆå§‹å°†æ‰€æœ‰ç‰¹å¾ä½œä¸ºä¸€ä¸ªå€™é€‰ç‰¹å¾å­é›†ï¼›æ¥ç€å°è¯•å»æ‰ä¸Šä¸€è½®ç‰¹å¾å­é›†ä¸­çš„ä¸€ä¸ªç‰¹å¾å¹¶é€‰å‡ºå½“å‰æœ€ä¼˜çš„ç‰¹å¾å­é›†ï¼›æœ€åç›´åˆ°é€‰ä¸å‡ºæ¯”ä¸Šä¸€è½®æ›´å¥½çš„ç‰¹å¾å­é›†ã€‚
<strong>åŒå‘æœç´¢</strong>ï¼šå°†å‰å‘æœç´¢ä¸åå‘æœç´¢ç»“åˆèµ·æ¥ï¼Œå³åœ¨æ¯ä¸€è½®ä¸­æ—¢æœ‰æ·»åŠ æ“ä½œä¹Ÿæœ‰å‰”é™¤æ“ä½œã€‚</p>
</blockquote>
<p>å¯¹äºç‰¹å¾å­é›†çš„è¯„ä»·ï¼Œä¹¦ä¸­ç»™å‡ºäº†ä¸€äº›æƒ³æ³•åŠåŸºäºä¿¡æ¯ç†µçš„æ–¹æ³•ã€‚å‡è®¾æ•°æ®é›†çš„å±æ€§çš†ä¸ºç¦»æ•£å±æ€§ï¼Œè¿™æ ·ç»™å®šä¸€ä¸ªç‰¹å¾å­é›†ï¼Œä¾¿å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹å¾å­é›†çš„å–å€¼å°†æ•°æ®é›†åˆåˆ’åˆ†ä¸ºVä¸ªå­é›†ã€‚ä¾‹å¦‚ï¼šA1={ç”·,å¥³}ï¼ŒA2={æœ¬ç§‘,ç¡•å£«}å°±å¯ä»¥å°†åŸæ•°æ®é›†åˆ’åˆ†ä¸º2*2=4ä¸ªå­é›†ï¼Œå…¶ä¸­æ¯ä¸ªå­é›†çš„å–å€¼å®Œå…¨ç›¸åŒã€‚è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åƒå†³ç­–æ ‘é€‰æ‹©åˆ’åˆ†å±æ€§é‚£æ ·ï¼Œé€šè¿‡è®¡ç®—ä¿¡æ¯å¢ç›Šæ¥è¯„ä»·è¯¥å±æ€§å­é›†çš„å¥½åã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853eca1a43.png" alt="1.png" /></p>
<p>æ­¤æ—¶ï¼Œä¿¡æ¯å¢ç›Šè¶Šå¤§è¡¨ç¤ºè¯¥å±æ€§å­é›†åŒ…å«æœ‰åŠ©äºåˆ†ç±»çš„ç‰¹å¾è¶Šå¤šï¼Œä½¿ç”¨ä¸Šè¿°è¿™ç§<strong>å­é›†æœç´¢ä¸å­é›†è¯„ä»·ç›¸ç»“åˆçš„æœºåˆ¶ï¼Œä¾¿å¯ä»¥å¾—åˆ°ç‰¹å¾é€‰æ‹©æ–¹æ³•</strong>ã€‚å€¼å¾—ä¸€æçš„æ˜¯è‹¥å°†å‰å‘æœç´¢ç­–ç•¥ä¸ä¿¡æ¯å¢ç›Šç»“åˆåœ¨ä¸€èµ·ï¼Œä¸å‰é¢æˆ‘ä»¬è®²åˆ°çš„ID3å†³ç­–æ ‘ååˆ†åœ°ç›¸ä¼¼ã€‚äº‹å®ä¸Šï¼Œå†³ç­–æ ‘ä¹Ÿå¯ä»¥ç”¨äºç‰¹å¾é€‰æ‹©ï¼Œæ ‘èŠ‚ç‚¹åˆ’åˆ†å±æ€§ç»„æˆçš„é›†åˆä¾¿æ˜¯é€‰æ‹©å‡ºçš„ç‰¹å¾å­é›†ã€‚</p>
<h3 id="122-è¿‡æ»¤å¼é€‰æ‹©relief"><a class="header" href="#122-è¿‡æ»¤å¼é€‰æ‹©relief"><strong>12.2 è¿‡æ»¤å¼é€‰æ‹©ï¼ˆReliefï¼‰</strong></a></h3>
<p>è¿‡æ»¤å¼æ–¹æ³•æ˜¯ä¸€ç§å°†ç‰¹å¾é€‰æ‹©ä¸å­¦ä¹ å™¨è®­ç»ƒç›¸åˆ†ç¦»çš„ç‰¹å¾é€‰æ‹©æŠ€æœ¯ï¼Œå³é¦–å…ˆå°†ç›¸å…³ç‰¹å¾æŒ‘é€‰å‡ºæ¥ï¼Œå†ä½¿ç”¨é€‰æ‹©å‡ºçš„æ•°æ®å­é›†æ¥è®­ç»ƒå­¦ä¹ å™¨ã€‚Reliefæ˜¯å…¶ä¸­è‘—åçš„ä»£è¡¨æ€§ç®—æ³•ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªâ€œ<strong>ç›¸å…³ç»Ÿè®¡é‡</strong>â€æ¥åº¦é‡ç‰¹å¾çš„é‡è¦æ€§ï¼Œè¯¥ç»Ÿè®¡é‡æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªåˆ†é‡ä»£è¡¨ç€ç›¸åº”ç‰¹å¾çš„é‡è¦æ€§ï¼Œå› æ­¤æˆ‘ä»¬æœ€ç»ˆå¯ä»¥æ ¹æ®è¿™ä¸ªç»Ÿè®¡é‡å„ä¸ªåˆ†é‡çš„å¤§å°æ¥é€‰æ‹©å‡ºåˆé€‚çš„ç‰¹å¾å­é›†ã€‚</p>
<p>æ˜“çŸ¥Reliefç®—æ³•çš„æ ¸å¿ƒåœ¨äºå¦‚ä½•è®¡ç®—å‡ºè¯¥ç›¸å…³ç»Ÿè®¡é‡ã€‚å¯¹äºæ•°æ®é›†ä¸­çš„æ¯ä¸ªæ ·ä¾‹xiï¼ŒReliefé¦–å…ˆæ‰¾å‡ºä¸xiåŒç±»åˆ«çš„æœ€è¿‘é‚»ä¸ä¸åŒç±»åˆ«çš„æœ€è¿‘é‚»ï¼Œåˆ†åˆ«ç§°ä¸º<strong>çŒœä¸­è¿‘é‚»ï¼ˆnear-hitï¼‰<strong>ä¸</strong>çŒœé”™è¿‘é‚»ï¼ˆnear-missï¼‰</strong>ï¼Œæ¥ç€ä¾¿å¯ä»¥åˆ†åˆ«è®¡ç®—å‡ºç›¸å…³ç»Ÿè®¡é‡ä¸­çš„æ¯ä¸ªåˆ†é‡ã€‚å¯¹äºjåˆ†é‡ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ec70c88.png" alt="2.png" /></p>
<p>ç›´è§‚ä¸Šç†è§£ï¼šå¯¹äºçŒœä¸­è¿‘é‚»ï¼Œä¸¤è€…jå±æ€§çš„è·ç¦»è¶Šå°è¶Šå¥½ï¼Œå¯¹äºçŒœé”™è¿‘é‚»ï¼Œjå±æ€§è·ç¦»è¶Šå¤§è¶Šå¥½ã€‚æ›´ä¸€èˆ¬åœ°ï¼Œè‹¥xiä¸ºç¦»æ•£å±æ€§ï¼Œdiffå–æµ·æ˜è·ç¦»ï¼Œå³ç›¸åŒå–0ï¼Œä¸åŒå–1ï¼›è‹¥xiä¸ºè¿ç»­å±æ€§ï¼Œåˆ™diffä¸ºæ›¼å“ˆé¡¿è·ç¦»ï¼Œå³å–å·®çš„ç»å¯¹å€¼ã€‚åˆ†åˆ«è®¡ç®—æ¯ä¸ªåˆ†é‡ï¼Œæœ€ç»ˆå–å¹³å‡ä¾¿å¾—åˆ°äº†æ•´ä¸ªç›¸å…³ç»Ÿè®¡é‡ã€‚</p>
<p>æ ‡å‡†çš„Reliefç®—æ³•åªç”¨äºäºŒåˆ†ç±»é—®é¢˜ï¼Œåç»­äº§ç”Ÿçš„æ‹“å±•å˜ä½“Relief-Fåˆ™è§£å†³äº†å¤šåˆ†ç±»é—®é¢˜ã€‚å¯¹äºjåˆ†é‡ï¼Œæ–°çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ec93042.png" alt="3.png" /></p>
<p>å…¶ä¸­plè¡¨ç¤ºç¬¬lç±»æ ·æœ¬åœ¨æ•°æ®é›†ä¸­æ‰€å çš„æ¯”ä¾‹ï¼Œæ˜“çŸ¥ä¸¤è€…çš„ä¸åŒä¹‹å¤„åœ¨äºï¼š<strong>æ ‡å‡†Relief åªæœ‰ä¸€ä¸ªçŒœé”™è¿‘é‚»ï¼Œè€ŒRelief-Fæœ‰å¤šä¸ªçŒœé”™è¿‘é‚»</strong>ã€‚</p>
<h3 id="123-åŒ…è£¹å¼é€‰æ‹©lvw"><a class="header" href="#123-åŒ…è£¹å¼é€‰æ‹©lvw"><strong>12.3 åŒ…è£¹å¼é€‰æ‹©ï¼ˆLVWï¼‰</strong></a></h3>
<p>ä¸è¿‡æ»¤å¼é€‰æ‹©ä¸åŒçš„æ˜¯ï¼ŒåŒ…è£¹å¼é€‰æ‹©å°†åç»­çš„å­¦ä¹ å™¨ä¹Ÿè€ƒè™‘è¿›æ¥ä½œä¸ºç‰¹å¾é€‰æ‹©çš„è¯„ä»·å‡†åˆ™ã€‚å› æ­¤åŒ…è£¹å¼é€‰æ‹©å¯ä»¥çœ‹ä½œæ˜¯ä¸ºæŸç§å­¦ä¹ å™¨<strong>é‡èº«å®šåš</strong>çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œç”±äºåœ¨æ¯ä¸€è½®è¿­ä»£ä¸­ï¼ŒåŒ…è£¹å¼é€‰æ‹©éƒ½éœ€è¦è®­ç»ƒå­¦ä¹ å™¨ï¼Œå› æ­¤åœ¨è·å¾—è¾ƒå¥½æ€§èƒ½çš„åŒæ—¶ä¹Ÿäº§ç”Ÿäº†è¾ƒå¤§çš„å¼€é”€ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ç§ç»å…¸çš„åŒ…è£¹å¼ç‰¹å¾é€‰æ‹©æ–¹æ³• --LVWï¼ˆLas Vegas Wrapperï¼‰ï¼Œå®ƒåœ¨æ‹‰æ–¯ç»´åŠ æ–¯æ¡†æ¶ä¸‹ä½¿ç”¨éšæœºç­–ç•¥æ¥è¿›è¡Œç‰¹å¾å­é›†çš„æœç´¢ã€‚æ‹‰æ–¯ç»´åŠ æ–¯ï¼Ÿæ€ä¹ˆå¬èµ·æ¥é‚£ä¹ˆè€³ç†Ÿï¼Œä¸æ˜¯é‚£ä¸ªå£°åæ˜¾èµ«çš„èµŒåœºå—ï¼Ÿæ­ªæœä»çœŸä¼šç©ã€‚æ€€ç€å¥½å¥‡ç§‘æ™®ä¸€ä¸‹ï¼Œç»“æœåˆé¡ºå¸¦äº†ä¸€ä¸ªèµŒåœºï¼š</p>
<blockquote>
<p><strong>è’™ç‰¹å¡ç½—ç®—æ³•</strong>ï¼šé‡‡æ ·è¶Šå¤šï¼Œè¶Šè¿‘ä¼¼æœ€ä¼˜è§£ï¼Œä¸€å®šä¼šç»™å‡ºè§£ï¼Œä½†ç»™å‡ºçš„è§£ä¸ä¸€å®šæ˜¯æ­£ç¡®è§£ï¼›
<strong>æ‹‰æ–¯ç»´åŠ æ–¯ç®—æ³•</strong>ï¼šé‡‡æ ·è¶Šå¤šï¼Œè¶Šæœ‰æœºä¼šæ‰¾åˆ°æœ€ä¼˜è§£ï¼Œä¸ä¸€å®šä¼šç»™å‡ºè§£ï¼Œä¸”ç»™å‡ºçš„è§£ä¸€å®šæ˜¯æ­£ç¡®è§£ã€‚</p>
</blockquote>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚ç­é‡Œæœ‰100ä¸ªè‹¹æœï¼Œè®©æˆ‘æ¯æ¬¡é—­çœ¼æ‹¿1ä¸ªï¼ŒæŒ‘å‡ºæœ€å¤§çš„ã€‚äºæ˜¯æˆ‘éšæœºæ‹¿1ä¸ªï¼Œå†éšæœºæ‹¿1ä¸ªè·Ÿå®ƒæ¯”ï¼Œç•™ä¸‹å¤§çš„ï¼Œå†éšæœºæ‹¿1ä¸ªâ€¦â€¦æˆ‘æ¯æ‹¿ä¸€æ¬¡ï¼Œç•™ä¸‹çš„è‹¹æœéƒ½è‡³å°‘ä¸æ¯”ä¸Šæ¬¡çš„å°ã€‚æ‹¿çš„æ¬¡æ•°è¶Šå¤šï¼ŒæŒ‘å‡ºçš„è‹¹æœå°±è¶Šå¤§ï¼Œä½†æˆ‘é™¤éæ‹¿100æ¬¡ï¼Œå¦åˆ™æ— æ³•è‚¯å®šæŒ‘å‡ºäº†æœ€å¤§çš„ã€‚è¿™ä¸ªæŒ‘è‹¹æœçš„ç®—æ³•ï¼Œå°±å±äºè’™ç‰¹å¡ç½—ç®—æ³•â€”â€”å°½é‡æ‰¾è¾ƒå¥½çš„ï¼Œä½†ä¸ä¿è¯æ˜¯æœ€å¥½çš„ã€‚</p>
<p>è€Œæ‹‰æ–¯ç»´åŠ æ–¯ç®—æ³•ï¼Œåˆ™æ˜¯å¦ä¸€ç§æƒ…å†µã€‚å‡å¦‚æœ‰ä¸€æŠŠé”ï¼Œç»™æˆ‘100æŠŠé’¥åŒ™ï¼Œåªæœ‰1æŠŠæ˜¯å¯¹çš„ã€‚äºæ˜¯æˆ‘æ¯æ¬¡éšæœºæ‹¿1æŠŠé’¥åŒ™å»è¯•ï¼Œæ‰“ä¸å¼€å°±å†æ¢1æŠŠã€‚æˆ‘è¯•çš„æ¬¡æ•°è¶Šå¤šï¼Œæ‰“å¼€ï¼ˆæ­£ç¡®è§£ï¼‰çš„æœºä¼šå°±è¶Šå¤§ï¼Œä½†åœ¨æ‰“å¼€ä¹‹å‰ï¼Œé‚£äº›é”™çš„é’¥åŒ™éƒ½æ˜¯æ²¡æœ‰ç”¨çš„ã€‚è¿™ä¸ªè¯•é’¥åŒ™çš„ç®—æ³•ï¼Œå°±æ˜¯æ‹‰æ–¯ç»´åŠ æ–¯çš„â€”â€”å°½é‡æ‰¾æœ€å¥½çš„ï¼Œä½†ä¸ä¿è¯èƒ½æ‰¾åˆ°ã€‚</p>
<p>LVWç®—æ³•çš„å…·ä½“æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯åœæ­¢æ¡ä»¶å‚æ•°Tçš„è®¾ç½®ï¼Œå³åœ¨æ¯ä¸€è½®å¯»æ‰¾æœ€ä¼˜ç‰¹å¾å­é›†çš„è¿‡ç¨‹ä¸­ï¼Œè‹¥éšæœºTæ¬¡ä»æ²¡æ‰¾åˆ°ï¼Œç®—æ³•å°±ä¼šåœæ­¢ï¼Œä»è€Œä¿è¯äº†ç®—æ³•è¿è¡Œæ—¶é—´çš„å¯è¡Œæ€§ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ed5e08e.png" alt="4.png" /></p>
<h3 id="124-åµŒå…¥å¼é€‰æ‹©ä¸æ­£åˆ™åŒ–"><a class="header" href="#124-åµŒå…¥å¼é€‰æ‹©ä¸æ­£åˆ™åŒ–"><strong>12.4 åµŒå…¥å¼é€‰æ‹©ä¸æ­£åˆ™åŒ–</strong></a></h3>
<p>å‰é¢æåˆ°äº†çš„ä¸¤ç§ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼š<strong>è¿‡æ»¤å¼ä¸­ç‰¹å¾é€‰æ‹©ä¸åç»­å­¦ä¹ å™¨å®Œå…¨åˆ†ç¦»ï¼ŒåŒ…è£¹å¼åˆ™æ˜¯ä½¿ç”¨å­¦ä¹ å™¨ä½œä¸ºç‰¹å¾é€‰æ‹©çš„è¯„ä»·å‡†åˆ™ï¼›åµŒå…¥å¼æ˜¯ä¸€ç§å°†ç‰¹å¾é€‰æ‹©ä¸å­¦ä¹ å™¨è®­ç»ƒå®Œå…¨èåˆçš„ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œå³å°†ç‰¹å¾é€‰æ‹©èå…¥å­¦ä¹ å™¨çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­</strong>ã€‚åœ¨ä¹‹å‰ã€Šç»éªŒé£é™©ä¸ç»“æ„é£é™©ã€‹ä¸­å·²ç»æåˆ°ï¼šç»éªŒé£é™©æŒ‡çš„æ˜¯æ¨¡å‹ä¸è®­ç»ƒæ•°æ®çš„å¥‘åˆåº¦ï¼Œç»“æ„é£é™©åˆ™æ˜¯æ¨¡å‹çš„å¤æ‚ç¨‹åº¦ï¼Œæœºå™¨å­¦ä¹ çš„æ ¸å¿ƒä»»åŠ¡å°±æ˜¯ï¼š<strong>åœ¨æ¨¡å‹ç®€å•çš„åŸºç¡€ä¸Šä¿è¯æ¨¡å‹çš„å¥‘åˆåº¦</strong>ã€‚ä¾‹å¦‚ï¼šå²­å›å½’å°±æ˜¯åŠ ä¸Šäº†L2èŒƒæ•°çš„æœ€å°äºŒä¹˜æ³•ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†å¥‡å¼‚çŸ©é˜µã€è¿‡æ‹Ÿåˆç­‰è¯¸å¤šé—®é¢˜ï¼Œä¸‹é¢çš„åµŒå…¥å¼ç‰¹å¾é€‰æ‹©åˆ™æ˜¯åœ¨æŸå¤±å‡½æ•°ååŠ ä¸Šäº†L1èŒƒæ•°ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ec8b203.png" alt="5.png" /></p>
<p>L1èŒƒæ•°ç¾ååˆçº¦<strong>Lasso Regularization</strong>ï¼ŒæŒ‡çš„æ˜¯å‘é‡ä¸­æ¯ä¸ªå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œï¼Œè¿™æ ·åœ¨ä¼˜åŒ–ç›®æ ‡å‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œå°±ä¼šä½¿å¾—wå°½å¯èƒ½åœ°å°ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šèµ·åˆ°äº†é˜²æ­¢è¿‡æ‹Ÿåˆçš„ä½œç”¨ï¼ŒåŒæ—¶ä¸L2èŒƒæ•°ï¼ˆRidge Regularization ï¼‰ä¸åŒçš„æ˜¯ï¼ŒL1èŒƒæ•°ä¼šä½¿å¾—éƒ¨åˆ†wå˜ä¸º0ï¼Œ ä»è€Œè¾¾åˆ°äº†ç‰¹å¾é€‰æ‹©çš„æ•ˆæœã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼š<strong>L1èŒƒæ•°ä¼šè¶‹å‘äº§ç”Ÿå°‘é‡çš„ç‰¹å¾ï¼Œå…¶ä»–ç‰¹å¾çš„æƒå€¼éƒ½æ˜¯0ï¼›L2ä¼šé€‰æ‹©æ›´å¤šçš„ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾çš„æƒå€¼éƒ½ä¼šæ¥è¿‘äº0</strong>ã€‚è¿™æ ·L1èŒƒæ•°åœ¨ç‰¹å¾é€‰æ‹©ä¸Šå°±ååˆ†æœ‰ç”¨ï¼Œè€ŒL2èŒƒæ•°åˆ™å…·å¤‡è¾ƒå¼ºçš„æ§åˆ¶è¿‡æ‹Ÿåˆèƒ½åŠ›ã€‚å¯ä»¥ä»ä¸‹é¢ä¸¤ä¸ªæ–¹é¢æ¥ç†è§£ï¼š</p>
<p>ï¼ˆ1ï¼‰<strong>ä¸‹é™é€Ÿåº¦</strong>ï¼šL1èŒƒæ•°æŒ‰ç…§ç»å¯¹å€¼å‡½æ•°æ¥ä¸‹é™ï¼ŒL2èŒƒæ•°æŒ‰ç…§äºŒæ¬¡å‡½æ•°æ¥ä¸‹é™ã€‚å› æ­¤åœ¨0é™„è¿‘ï¼ŒL1èŒƒæ•°çš„ä¸‹é™é€Ÿåº¦å¤§äºL2èŒƒæ•°ï¼Œæ•…L1èŒƒæ•°èƒ½å¾ˆå¿«åœ°ä¸‹é™åˆ°0ï¼Œè€ŒL2èŒƒæ•°åœ¨0é™„è¿‘çš„ä¸‹é™é€Ÿåº¦éå¸¸æ…¢ï¼Œå› æ­¤è¾ƒå¤§å¯èƒ½æ”¶æ•›åœ¨0çš„é™„è¿‘ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ed0aaf5.png" alt="6.png" /></p>
<p>ï¼ˆ2ï¼‰<strong>ç©ºé—´é™åˆ¶</strong>ï¼šL1èŒƒæ•°ä¸L2èŒƒæ•°éƒ½è¯•å›¾åœ¨æœ€å°åŒ–æŸå¤±å‡½æ•°çš„åŒæ—¶ï¼Œè®©æƒå€¼Wä¹Ÿå°½å¯èƒ½åœ°å°ã€‚æˆ‘ä»¬å¯ä»¥å°†åŸä¼˜åŒ–é—®é¢˜çœ‹åšä¸ºä¸‹é¢çš„é—®é¢˜ï¼Œå³è®©åé¢çš„è§„åˆ™åˆ™éƒ½å°äºæŸä¸ªé˜ˆå€¼ã€‚è¿™æ ·ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼šL1èŒƒæ•°ç›¸æ¯”L2èŒƒæ•°æ›´å®¹æ˜“å¾—åˆ°ç¨€ç–è§£ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ecc223e.png" alt="7.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ed51aa1.png" alt="8.png" /></p>
<h3 id="125-ç¨€ç–è¡¨ç¤ºä¸å­—å…¸å­¦ä¹ "><a class="header" href="#125-ç¨€ç–è¡¨ç¤ºä¸å­—å…¸å­¦ä¹ "><strong>12.5 ç¨€ç–è¡¨ç¤ºä¸å­—å…¸å­¦ä¹ </strong></a></h3>
<p>å½“æ ·æœ¬æ•°æ®æ˜¯ä¸€ä¸ªç¨€ç–çŸ©é˜µæ—¶ï¼Œå¯¹å­¦ä¹ ä»»åŠ¡æ¥è¯´ä¼šæœ‰ä¸å°‘çš„å¥½å¤„ï¼Œä¾‹å¦‚å¾ˆå¤šé—®é¢˜å˜å¾—çº¿æ€§å¯åˆ†ï¼Œå‚¨å­˜æ›´ä¸ºé«˜æ•ˆç­‰ã€‚è¿™ä¾¿æ˜¯ç¨€ç–è¡¨ç¤ºä¸å­—å…¸å­¦ä¹ çš„åŸºæœ¬å‡ºå‘ç‚¹ã€‚ç¨€ç–çŸ©é˜µå³çŸ©é˜µçš„æ¯ä¸€è¡Œ/åˆ—ä¸­éƒ½åŒ…å«äº†å¤§é‡çš„é›¶å…ƒç´ ï¼Œä¸”è¿™äº›é›¶å…ƒç´ æ²¡æœ‰å‡ºç°åœ¨åŒä¸€è¡Œ/åˆ—ï¼Œå¯¹äºä¸€ä¸ªç»™å®šçš„ç¨ å¯†çŸ©é˜µï¼Œè‹¥æˆ‘ä»¬èƒ½<strong>é€šè¿‡æŸç§æ–¹æ³•æ‰¾åˆ°å…¶åˆé€‚çš„ç¨€ç–è¡¨ç¤º</strong>ï¼Œåˆ™å¯ä»¥ä½¿å¾—å­¦ä¹ ä»»åŠ¡æ›´åŠ ç®€å•é«˜æ•ˆï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>ç¨€ç–ç¼–ç ï¼ˆsparse codingï¼‰<strong>æˆ–</strong>å­—å…¸å­¦ä¹ ï¼ˆdictionary learningï¼‰</strong>ã€‚</p>
<p>ç»™å®šä¸€ä¸ªæ•°æ®é›†ï¼Œå­—å…¸å­¦ä¹ /ç¨€ç–ç¼–ç æŒ‡çš„ä¾¿æ˜¯é€šè¿‡ä¸€ä¸ªå­—å…¸å°†åŸæ•°æ®è½¬åŒ–ä¸ºç¨€ç–è¡¨ç¤ºï¼Œå› æ­¤æœ€ç»ˆçš„ç›®æ ‡å°±æ˜¯æ±‚å¾—å­—å…¸çŸ©é˜µBåŠç¨€ç–è¡¨ç¤ºÎ±ï¼Œä¹¦ä¸­ä½¿ç”¨å˜é‡äº¤æ›¿ä¼˜åŒ–çš„ç­–ç•¥èƒ½è¾ƒå¥½åœ°æ±‚å¾—è§£ï¼Œæ·±æ„Ÿé™·è¿›å»çŸ­æ—¶é—´æ— æ³•è‡ªæ‹”ï¼Œæ•…å…ˆä¸è¿›è¡Œæ·±å…¥...</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ed0ca43.png" alt="9.png" /></p>
<h3 id="126-å‹ç¼©æ„ŸçŸ¥"><a class="header" href="#126-å‹ç¼©æ„ŸçŸ¥"><strong>12.6 å‹ç¼©æ„ŸçŸ¥</strong></a></h3>
<p>å‹ç¼©æ„ŸçŸ¥åœ¨å‰äº›å¹´ä¹Ÿæ˜¯é£é£ç«ç«ï¼Œä¸ç‰¹å¾é€‰æ‹©ã€ç¨€ç–è¡¨ç¤ºä¸åŒçš„æ˜¯ï¼šå®ƒå…³æ³¨çš„æ˜¯é€šè¿‡æ¬ é‡‡æ ·ä¿¡æ¯æ¥æ¢å¤å…¨éƒ¨ä¿¡æ¯ã€‚åœ¨å®é™…é—®é¢˜ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ä¼ è¾“å’Œå­˜å‚¨ï¼Œæˆ‘ä»¬ä¸€èˆ¬å°†æ•°å­—ä¿¡æ¯è¿›è¡Œå‹ç¼©ï¼Œè¿™æ ·å°±æœ‰å¯èƒ½æŸå¤±éƒ¨åˆ†ä¿¡æ¯ï¼Œå¦‚ä½•æ ¹æ®å·²æœ‰çš„ä¿¡æ¯æ¥é‡æ„å‡ºå…¨éƒ¨ä¿¡å·ï¼Œè¿™ä¾¿æ˜¯å‹ç¼©æ„ŸçŸ¥çš„æ¥å†ï¼Œå‹ç¼©æ„ŸçŸ¥çš„å‰ææ˜¯å·²çŸ¥çš„ä¿¡æ¯å…·æœ‰ç¨€ç–è¡¨ç¤ºã€‚ä¸‹é¢æ˜¯å…³äºå‹ç¼©æ„ŸçŸ¥çš„ä¸€äº›èƒŒæ™¯ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc853ed431c6.png" alt="10.png" /></p>
<h2 id="åä¸‰-è®¡ç®—å­¦ä¹ ç†è®º"><a class="header" href="#åä¸‰-è®¡ç®—å­¦ä¹ ç†è®º"><strong>åä¸‰ï¼ è®¡ç®—å­¦ä¹ ç†è®º</strong></a></h2>
<p>è®¡ç®—å­¦ä¹ ç†è®ºï¼ˆcomputational learning theoryï¼‰æ˜¯é€šè¿‡â€œè®¡ç®—â€æ¥ç ”ç©¶æœºå™¨å­¦ä¹ çš„ç†è®ºï¼Œç®€è€Œè¨€ä¹‹ï¼Œå…¶ç›®çš„æ˜¯åˆ†æå­¦ä¹ ä»»åŠ¡çš„æœ¬è´¨ï¼Œä¾‹å¦‚ï¼š<strong>åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹å¯è¿›è¡Œæœ‰æ•ˆçš„å­¦ä¹ ï¼Œéœ€è¦å¤šå°‘è®­ç»ƒæ ·æœ¬èƒ½è·å¾—è¾ƒå¥½çš„ç²¾åº¦ç­‰ï¼Œä»è€Œä¸ºæœºå™¨å­¦ä¹ ç®—æ³•æä¾›ç†è®ºä¿è¯</strong>ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å›å½’åˆå¿ƒï¼Œå†æ¥è°ˆè°ˆç»éªŒè¯¯å·®å’Œæ³›åŒ–è¯¯å·®ã€‚å‡è®¾ç»™å®šè®­ç»ƒé›†Dï¼Œå…¶ä¸­æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬éƒ½æœä»ä¸€ä¸ªæœªçŸ¥çš„åˆ†å¸ƒTï¼Œä¸”å®ƒä»¬éƒ½æ˜¯åœ¨æ€»ä½“åˆ†å¸ƒTä¸­ç‹¬ç«‹é‡‡æ ·å¾—åˆ°ï¼Œå³<strong>ç‹¬ç«‹åŒåˆ†å¸ƒ</strong>ï¼ˆindependent and identically distributedï¼Œi.i.d.ï¼‰ï¼Œåœ¨ã€Šè´å¶æ–¯åˆ†ç±»å™¨ã€‹ä¸­æˆ‘ä»¬å·²ç»æåˆ°ï¼šç‹¬ç«‹åŒåˆ†å¸ƒæ˜¯å¾ˆå¤šç»Ÿè®¡å­¦ä¹ ç®—æ³•çš„åŸºç¡€å‡è®¾ï¼Œä¾‹å¦‚æœ€å¤§ä¼¼ç„¶æ³•ï¼Œè´å¶æ–¯åˆ†ç±»å™¨ï¼Œé«˜æ–¯æ··åˆèšç±»ç­‰ï¼Œç®€å•æ¥ç†è§£ç‹¬ç«‹åŒåˆ†å¸ƒï¼šæ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä»æ€»ä½“åˆ†å¸ƒä¸­ç‹¬ç«‹é‡‡æ ·å¾—åˆ°ï¼Œè€Œæ²¡æœ‰æ‹–æ³¥å¸¦æ°´ã€‚ä¾‹å¦‚ç°åœ¨è¦è¿›è¡Œé—®å·è°ƒæŸ¥ï¼Œè¦ä»æ€»ä½“äººç¾¤ä¸­éšæœºé‡‡æ ·ï¼Œçœ‹åˆ°ä¸€ä¸ªç¾å¥³ä½ é«˜å…´åœ°èµ°è¿‡å»ï¼Œç»“æœå¥¹ç”·ç¥¨çªç„¶å†’äº†å‡ºæ¥ï¼Œè¯´é“ï¼šyou jumpï¼Œi jumpï¼Œäºæ˜¯ä½ æœ¬æ¥åªæƒ³è°ƒæŸ¥ä¸€ä¸ªäººç»“æœè¢«å¼ºè¡Œæ’’äº†ä¸€æŠŠç‹—ç²®å¾—åˆ°ä¸¤ä»½é—®å·ï¼Œè¿™æ ·è¿™ä¸¤ä»½é—®å·å°±ä¸èƒ½ç§°ä¸ºç‹¬ç«‹åŒåˆ†å¸ƒäº†ï¼Œå› ä¸ºå®ƒä»¬çš„å‡ºç°å…·æœ‰å¼ºç›¸å…³æ€§ã€‚</p>
<p>å›å½’æ­£é¢˜ï¼Œ<strong>æ³›åŒ–è¯¯å·®æŒ‡çš„æ˜¯å­¦ä¹ å™¨åœ¨æ€»ä½“ä¸Šçš„é¢„æµ‹è¯¯å·®ï¼Œç»éªŒè¯¯å·®åˆ™æ˜¯å­¦ä¹ å™¨åœ¨æŸä¸ªç‰¹å®šæ•°æ®é›†Dä¸Šçš„é¢„æµ‹è¯¯å·®</strong>ã€‚åœ¨å®é™…é—®é¢˜ä¸­ï¼Œå¾€å¾€æˆ‘ä»¬å¹¶ä¸èƒ½å¾—åˆ°æ€»ä½“ä¸”æ•°æ®é›†Dæ˜¯é€šè¿‡ç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·å¾—åˆ°çš„ï¼Œå› æ­¤æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨ç»éªŒè¯¯å·®ä½œä¸ºæ³›åŒ–è¯¯å·®çš„è¿‘ä¼¼ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f38d4fe.png" alt="1.png" /></p>
<h3 id="131-pacå­¦ä¹ "><a class="header" href="#131-pacå­¦ä¹ "><strong>13.1 PACå­¦ä¹ </strong></a></h3>
<p>åœ¨é«˜ä¸­è¯¾æœ¬ä¸­ï¼Œæˆ‘ä»¬å°†<strong>å‡½æ•°å®šä¹‰ä¸ºï¼šä»è‡ªå˜é‡åˆ°å› å˜é‡çš„ä¸€ç§æ˜ å°„ï¼›å¯¹äºæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå­¦ä¹ å™¨ä¹Ÿæ­£æ˜¯ä¸ºäº†å¯»æ‰¾åˆé€‚çš„æ˜ å°„è§„åˆ™</strong>ï¼Œå³å¦‚ä½•ä»æ¡ä»¶å±æ€§å¾—åˆ°ç›®æ ‡å±æ€§ã€‚ä»æ ·æœ¬ç©ºé—´åˆ°æ ‡è®°ç©ºé—´å­˜åœ¨ç€å¾ˆå¤šçš„æ˜ å°„ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªæ˜ å°„ç§°ä¹‹ä¸º<strong>æ¦‚å¿µ</strong>ï¼ˆconceptï¼‰ï¼Œå®šä¹‰ï¼š</p>
<blockquote>
<p>è‹¥æ¦‚å¿µcå¯¹ä»»ä½•æ ·æœ¬xæ»¡è¶³c(x)=yï¼Œåˆ™ç§°cä¸º<strong>ç›®æ ‡æ¦‚å¿µ</strong>ï¼Œå³æœ€ç†æƒ³çš„æ˜ å°„ï¼Œæ‰€æœ‰çš„ç›®æ ‡æ¦‚å¿µæ„æˆçš„é›†åˆç§°ä¸º**â€œæ¦‚å¿µç±»â€<strong>ï¼›
ç»™å®šå­¦ä¹ ç®—æ³•ï¼Œå®ƒæ‰€æœ‰å¯èƒ½æ˜ å°„/æ¦‚å¿µçš„é›†åˆç§°ä¸º</strong>â€œå‡è®¾ç©ºé—´â€<strong>ï¼Œå…¶ä¸­å•ä¸ªçš„æ¦‚å¿µç§°ä¸º</strong>â€œå‡è®¾â€<strong>ï¼ˆhypothesisï¼‰ï¼›
è‹¥ä¸€ä¸ªç®—æ³•çš„å‡è®¾ç©ºé—´åŒ…å«ç›®æ ‡æ¦‚å¿µï¼Œåˆ™ç§°è¯¥æ•°æ®é›†å¯¹è¯¥ç®—æ³•æ˜¯</strong>å¯åˆ†**ï¼ˆseparableï¼‰çš„ï¼Œäº¦ç§°<strong>ä¸€è‡´</strong>ï¼ˆconsistentï¼‰çš„ï¼›
è‹¥ä¸€ä¸ªç®—æ³•çš„å‡è®¾ç©ºé—´ä¸åŒ…å«ç›®æ ‡æ¦‚å¿µï¼Œåˆ™ç§°è¯¥æ•°æ®é›†å¯¹è¯¥ç®—æ³•æ˜¯<strong>ä¸å¯åˆ†</strong>ï¼ˆnon-separableï¼‰çš„ï¼Œæˆ–ç§°<strong>ä¸ä¸€è‡´</strong>ï¼ˆnon-consistentï¼‰çš„ã€‚</p>
</blockquote>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šå¯¹äºéçº¿æ€§åˆ†å¸ƒçš„æ•°æ®é›†ï¼Œè‹¥ä½¿ç”¨ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œåˆ™è¯¥çº¿æ€§åˆ†ç±»å™¨å¯¹åº”çš„å‡è®¾ç©ºé—´å°±æ˜¯ç©ºé—´ä¸­æ‰€æœ‰å¯èƒ½çš„è¶…å¹³é¢ï¼Œæ˜¾ç„¶å‡è®¾ç©ºé—´ä¸åŒ…å«è¯¥æ•°æ®é›†çš„ç›®æ ‡æ¦‚å¿µï¼Œæ‰€ä»¥ç§°æ•°æ®é›†å¯¹è¯¥å­¦ä¹ å™¨æ˜¯ä¸å¯åˆ†çš„ã€‚ç»™å®šä¸€ä¸ªæ•°æ®é›†Dï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹å­¦å¾—çš„å‡è®¾hå°½å¯èƒ½åœ°ä¸ç›®æ ‡æ¦‚å¿µä¸€è‡´ï¼Œè¿™ä¾¿æ˜¯<strong>æ¦‚ç‡è¿‘ä¼¼æ­£ç¡®</strong> (Probably Approximately Correctï¼Œç®€ç§°PAC)çš„æ¥æºï¼Œå³ä»¥è¾ƒå¤§çš„æ¦‚ç‡å­¦å¾—æ¨¡å‹æ»¡è¶³è¯¯å·®çš„é¢„è®¾ä¸Šé™ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f446f97.png" alt="2.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f482d0b.png" alt="3.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f47d006.png" alt="4.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f46ad91.png" alt="5.png" /></p>
<p>ä¸Šè¿°å…³äºPACçš„å‡ ä¸ªå®šä¹‰å±‚å±‚ç›¸æ‰£ï¼šå®šä¹‰12.1è¡¨è¾¾çš„æ˜¯å¯¹äºæŸç§å­¦ä¹ ç®—æ³•ï¼Œå¦‚æœèƒ½ä»¥ä¸€ä¸ªç½®ä¿¡åº¦å­¦å¾—å‡è®¾æ»¡è¶³æ³›åŒ–è¯¯å·®çš„é¢„è®¾ä¸Šé™ï¼Œåˆ™ç§°è¯¥ç®—æ³•èƒ½PACè¾¨è¯†æ¦‚å¿µç±»ï¼Œå³è¯¥ç®—æ³•çš„è¾“å‡ºå‡è®¾å·²ç»ååˆ†åœ°é€¼è¿‘ç›®æ ‡æ¦‚å¿µã€‚å®šä¹‰12.2åˆ™å°†æ ·æœ¬æ•°é‡è€ƒè™‘è¿›æ¥ï¼Œå½“æ ·æœ¬è¶…è¿‡ä¸€å®šæ•°é‡æ—¶ï¼Œå­¦ä¹ ç®—æ³•æ€»æ˜¯èƒ½PACè¾¨è¯†æ¦‚å¿µç±»ï¼Œåˆ™ç§°æ¦‚å¿µç±»ä¸ºPACå¯å­¦ä¹ çš„ã€‚å®šä¹‰12.3å°†å­¦ä¹ å™¨è¿è¡Œæ—¶é—´ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œè‹¥è¿è¡Œæ—¶é—´ä¸ºå¤šé¡¹å¼æ—¶é—´ï¼Œåˆ™ç§°PACå­¦ä¹ ç®—æ³•ã€‚</p>
<p>æ˜¾ç„¶ï¼ŒPACå­¦ä¹ ä¸­çš„ä¸€ä¸ªå…³é”®å› ç´ å°±æ˜¯<strong>å‡è®¾ç©ºé—´çš„å¤æ‚åº¦</strong>ï¼Œå¯¹äºæŸä¸ªå­¦ä¹ ç®—æ³•ï¼Œ<strong>è‹¥å‡è®¾ç©ºé—´è¶Šå¤§ï¼Œåˆ™å…¶ä¸­åŒ…å«ç›®æ ‡æ¦‚å¿µçš„å¯èƒ½æ€§ä¹Ÿè¶Šå¤§ï¼Œä½†åŒæ—¶æ‰¾åˆ°æŸä¸ªå…·ä½“æ¦‚å¿µçš„éš¾åº¦ä¹Ÿè¶Šå¤§</strong>ï¼Œä¸€èˆ¬å‡è®¾ç©ºé—´åˆ†ä¸ºæœ‰é™å‡è®¾ç©ºé—´ä¸æ— é™å‡è®¾ç©ºé—´ã€‚</p>
<h3 id="132-æœ‰é™å‡è®¾ç©ºé—´"><a class="header" href="#132-æœ‰é™å‡è®¾ç©ºé—´"><strong>13.2 æœ‰é™å‡è®¾ç©ºé—´</strong></a></h3>
<h4 id="1321-å¯åˆ†æƒ…å½¢"><a class="header" href="#1321-å¯åˆ†æƒ…å½¢"><strong>13.2.1 å¯åˆ†æƒ…å½¢</strong></a></h4>
<p>å¯åˆ†æˆ–ä¸€è‡´çš„æƒ…å½¢æŒ‡çš„æ˜¯ï¼š<strong>ç›®æ ‡æ¦‚å¿µåŒ…å«åœ¨ç®—æ³•çš„å‡è®¾ç©ºé—´ä¸­</strong>ã€‚å¯¹äºç›®æ ‡æ¦‚å¿µï¼Œåœ¨è®­ç»ƒé›†Dä¸­çš„ç»éªŒè¯¯å·®ä¸€å®šä¸º0ï¼Œå› æ­¤é¦–å…ˆæˆ‘ä»¬å¯ä»¥æƒ³åˆ°çš„æ˜¯ï¼šä¸æ–­åœ°å‰”é™¤é‚£äº›å‡ºç°é¢„æµ‹é”™è¯¯çš„å‡è®¾ï¼Œç›´åˆ°æ‰¾åˆ°ç»éªŒè¯¯å·®ä¸º0çš„å‡è®¾å³ä¸ºç›®æ ‡æ¦‚å¿µã€‚ä½†<strong>ç”±äºæ ·æœ¬é›†æœ‰é™ï¼Œå¯èƒ½ä¼šå‡ºç°å¤šä¸ªå‡è®¾åœ¨Dä¸Šçš„ç»éªŒè¯¯å·®éƒ½ä¸º0ï¼Œå› æ­¤é—®é¢˜è½¬åŒ–ä¸ºï¼šéœ€è¦å¤šå¤§è§„æ¨¡çš„æ•°æ®é›†Dæ‰èƒ½è®©å­¦ä¹ ç®—æ³•ä»¥ç½®ä¿¡åº¦çš„æ¦‚ç‡ä»è¿™äº›ç»éªŒè¯¯å·®éƒ½ä¸º0çš„å‡è®¾ä¸­æ‰¾åˆ°ç›®æ ‡æ¦‚å¿µçš„æœ‰æ•ˆè¿‘ä¼¼</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f484f30.png" alt="6.png" /></p>
<p>é€šè¿‡ä¸Šå¼å¯ä»¥å¾—çŸ¥ï¼š<strong>å¯¹äºå¯åˆ†æƒ…å½¢çš„æœ‰é™å‡è®¾ç©ºé—´ï¼Œç›®æ ‡æ¦‚å¿µéƒ½æ˜¯PACå¯å­¦ä¹ çš„ï¼Œå³å½“æ ·æœ¬æ•°é‡æ»¡è¶³ä¸Šè¿°æ¡ä»¶ä¹‹åï¼Œåœ¨ä¸è®­ç»ƒé›†ä¸€è‡´çš„å‡è®¾ä¸­æ€»æ˜¯å¯ä»¥åœ¨1-Ïƒæ¦‚ç‡ä¸‹æ‰¾åˆ°ç›®æ ‡æ¦‚å¿µçš„æœ‰æ•ˆè¿‘ä¼¼ã€‚</strong></p>
<h4 id="1322-ä¸å¯åˆ†æƒ…å½¢"><a class="header" href="#1322-ä¸å¯åˆ†æƒ…å½¢"><strong>13.2.2 ä¸å¯åˆ†æƒ…å½¢</strong></a></h4>
<p>ä¸å¯åˆ†æˆ–ä¸ä¸€è‡´çš„æƒ…å½¢æŒ‡çš„æ˜¯ï¼š<strong>ç›®æ ‡æ¦‚å¿µä¸å­˜åœ¨äºå‡è®¾ç©ºé—´ä¸­</strong>ï¼Œè¿™æ—¶æˆ‘ä»¬å°±ä¸èƒ½åƒå¯åˆ†æƒ…å½¢æ—¶é‚£æ ·ä»å‡è®¾ç©ºé—´ä¸­å¯»æ‰¾ç›®æ ‡æ¦‚å¿µçš„è¿‘ä¼¼ã€‚ä½†<strong>å½“å‡è®¾ç©ºé—´ç»™å®šæ—¶ï¼Œå¿…ç„¶å­˜ä¸€ä¸ªå‡è®¾çš„æ³›åŒ–è¯¯å·®æœ€å°ï¼Œè‹¥èƒ½æ‰¾å‡ºæ­¤å‡è®¾çš„æœ‰æ•ˆè¿‘ä¼¼ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªå¥½çš„ç›®æ ‡ï¼Œè¿™ä¾¿æ˜¯ä¸å¯çŸ¥å­¦ä¹ (agnostic learning)çš„æ¥æºã€‚</strong></p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f485f2e.png" alt="7.png" /></p>
<p>è¿™æ—¶å€™ä¾¿è¦ç”¨åˆ°<strong>Hoeffdingä¸ç­‰å¼</strong>ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f46970a.png" alt="8.png" /></p>
<p>å¯¹äºå‡è®¾ç©ºé—´ä¸­çš„æ‰€æœ‰å‡è®¾ï¼Œå‡ºç°æ³›åŒ–è¯¯å·®ä¸ç»éªŒè¯¯å·®ä¹‹å·®å¤§äºeçš„æ¦‚ç‡å’Œä¸ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f4114fd.png" alt="9.png" /></p>
<p>å› æ­¤ï¼Œå¯ä»¤ä¸ç­‰å¼çš„å³è¾¹å°äºï¼ˆç­‰äºï¼‰Ïƒï¼Œä¾¿å¯ä»¥æ±‚å‡ºæ»¡è¶³æ³›åŒ–è¯¯å·®ä¸ç»éªŒè¯¯å·®ç›¸å·®å°äºeæ‰€éœ€çš„æœ€å°‘æ ·æœ¬æ•°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ±‚å‡ºæ³›åŒ–è¯¯å·®ç•Œã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc854f440a02.png" alt="10.png" /></p>
<h3 id="133-vcç»´"><a class="header" href="#133-vcç»´"><strong>13.3 VCç»´</strong></a></h3>
<p>ç°å®ä¸­çš„å­¦ä¹ ä»»åŠ¡é€šå¸¸éƒ½æ˜¯æ— é™å‡è®¾ç©ºé—´ï¼Œä¾‹å¦‚dç»´å®æ•°åŸŸç©ºé—´ä¸­æ‰€æœ‰çš„è¶…å¹³é¢ç­‰ï¼Œå› æ­¤è¦å¯¹æ­¤ç§æƒ…å½¢è¿›è¡Œå¯å­¦ä¹ ç ”ç©¶ï¼Œéœ€è¦åº¦é‡<strong>å‡è®¾ç©ºé—´çš„å¤æ‚åº¦</strong>ã€‚è¿™ä¾¿æ˜¯<strong>VCç»´</strong>ï¼ˆVapnik-Chervonenkis dimensionï¼‰çš„æ¥æºã€‚åœ¨ä»‹ç»VCç»´ä¹‹å‰ï¼Œéœ€è¦å¼•å…¥ä¸¤ä¸ªæ¦‚å¿µï¼š</p>
<blockquote>
<p><strong>å¢é•¿å‡½æ•°</strong>ï¼šå¯¹äºç»™å®šæ•°æ®é›†Dï¼Œå‡è®¾ç©ºé—´ä¸­çš„æ¯ä¸ªå‡è®¾éƒ½èƒ½å¯¹æ•°æ®é›†çš„æ ·æœ¬èµ‹äºˆæ ‡è®°ï¼Œå› æ­¤ä¸€ä¸ªå‡è®¾å¯¹åº”ç€ä¸€ç§æ‰“æ ‡ç»“æœï¼Œä¸åŒå‡è®¾å¯¹Dçš„æ‰“æ ‡ç»“æœå¯èƒ½æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„ã€‚éšç€æ ·æœ¬æ•°é‡mçš„å¢å¤§ï¼Œå‡è®¾ç©ºé—´å¯¹æ ·æœ¬é›†Dçš„æ‰“æ ‡ç»“æœä¹Ÿä¼šå¢å¤šï¼Œå¢é•¿å‡½æ•°åˆ™è¡¨ç¤ºå‡è®¾ç©ºé—´å¯¹mä¸ªæ ·æœ¬çš„æ•°æ®é›†Dæ‰“æ ‡çš„æœ€å¤§å¯èƒ½ç»“æœæ•°ï¼Œå› æ­¤<strong>å¢é•¿å‡½æ•°æè¿°äº†å‡è®¾ç©ºé—´çš„è¡¨ç¤ºèƒ½åŠ›ä¸å¤æ‚åº¦ã€‚</strong></p>
<p><img src="https://i.loli.net/2018/10/18/5bc855ba970cd.png" alt="11.png" />
<strong>æ‰“æ•£</strong>ï¼šä¾‹å¦‚å¯¹äºŒåˆ†ç±»é—®é¢˜æ¥è¯´ï¼Œmä¸ªæ ·æœ¬æœ€å¤šæœ‰2^mä¸ªå¯èƒ½ç»“æœï¼Œæ¯ç§å¯èƒ½ç»“æœç§°ä¸ºä¸€ç§**â€œå¯¹åˆ†â€**ï¼Œè‹¥å‡è®¾ç©ºé—´èƒ½å®ç°æ•°æ®é›†Dçš„æ‰€æœ‰å¯¹åˆ†ï¼Œåˆ™ç§°æ•°æ®é›†èƒ½è¢«è¯¥å‡è®¾ç©ºé—´æ‰“æ•£ã€‚</p>
</blockquote>
<p><strong>å› æ­¤å°½ç®¡å‡è®¾ç©ºé—´æ˜¯æ— é™çš„ï¼Œä½†å®ƒå¯¹ç‰¹å®šæ•°æ®é›†æ‰“æ ‡çš„ä¸åŒç»“æœæ•°æ˜¯æœ‰é™çš„ï¼Œå‡è®¾ç©ºé—´çš„VCç»´æ­£æ˜¯å®ƒèƒ½æ‰“æ•£çš„æœ€å¤§æ•°æ®é›†å¤§å°</strong>ã€‚é€šå¸¸è¿™æ ·æ¥è®¡ç®—å‡è®¾ç©ºé—´çš„VCç»´ï¼šè‹¥å­˜åœ¨å¤§å°ä¸ºdçš„æ•°æ®é›†èƒ½è¢«å‡è®¾ç©ºé—´æ‰“æ•£ï¼Œä½†ä¸å­˜åœ¨ä»»ä½•å¤§å°ä¸ºd+1çš„æ•°æ®é›†èƒ½è¢«å‡è®¾ç©ºé—´æ‰“æ•£ï¼Œåˆ™å…¶VCç»´ä¸ºdã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855bb20c1e.png" alt="12.png" /></p>
<p>åŒæ—¶ä¹¦ä¸­ç»™å‡ºäº†å‡è®¾ç©ºé—´VCç»´ä¸å¢é•¿å‡½æ•°çš„ä¸¤ä¸ªå…³ç³»ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855ba83eb8.png" alt="13.png" /></p>
<p>ç›´è§‚æ¥ç†è§£ï¼ˆ1ï¼‰å¼ä¹Ÿååˆ†å®¹æ˜“ï¼š é¦–å…ˆå‡è®¾ç©ºé—´çš„VCç»´æ˜¯dï¼Œè¯´æ˜å½“m&lt;=dæ—¶ï¼Œå¢é•¿å‡½æ•°ä¸2^mç›¸ç­‰ï¼Œä¾‹å¦‚ï¼šå½“m=dæ—¶ï¼Œå³è¾¹çš„ç»„åˆæ•°æ±‚å’Œåˆšå¥½ç­‰äº2^dï¼›è€Œå½“m=d+1æ—¶ï¼Œå³è¾¹ç­‰äº2^(d+1)-1ï¼Œååˆ†ç¬¦åˆVCç»´çš„å®šä¹‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­¦å½’çº³æ³•è¯æ˜ï¼›ï¼ˆ2ï¼‰å¼åˆ™æ˜¯ç”±ï¼ˆ1ï¼‰å¼ç›´æ¥æ¨å¯¼å¾—å‡ºã€‚</p>
<p>åœ¨æœ‰é™å‡è®¾ç©ºé—´ä¸­ï¼Œæ ¹æ®Hoeffdingä¸ç­‰å¼ä¾¿å¯ä»¥æ¨å¯¼å¾—å‡ºå­¦ä¹ ç®—æ³•çš„æ³›åŒ–è¯¯å·®ç•Œï¼›ä½†åœ¨æ— é™å‡è®¾ç©ºé—´ä¸­ï¼Œç”±äºå‡è®¾ç©ºé—´çš„å¤§å°æ— æ³•è®¡ç®—ï¼Œåªèƒ½é€šè¿‡å¢é•¿å‡½æ•°æ¥æè¿°å…¶å¤æ‚åº¦ï¼Œå› æ­¤æ— é™å‡è®¾ç©ºé—´ä¸­çš„æ³›åŒ–è¯¯å·®ç•Œéœ€è¦å¼•å…¥å¢é•¿å‡½æ•°ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855babc890.png" alt="14.png" /></p>
<p><img src="https://i.loli.net/2018/10/18/5bc855ba5b2c3.png" alt="15.png" /></p>
<p>ä¸Šå¼ç»™å‡ºäº†åŸºäºVCç»´çš„æ³›åŒ–è¯¯å·®ç•Œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è®¡ç®—å‡ºæ»¡è¶³æ¡ä»¶éœ€è¦çš„æ ·æœ¬æ•°ï¼ˆæ ·æœ¬å¤æ‚åº¦ï¼‰ã€‚è‹¥å­¦ä¹ ç®—æ³•æ»¡è¶³<strong>ç»éªŒé£é™©æœ€å°åŒ–åŸåˆ™ï¼ˆERMï¼‰</strong>ï¼Œå³å­¦ä¹ ç®—æ³•çš„è¾“å‡ºå‡è®¾håœ¨æ•°æ®é›†Dä¸Šçš„ç»éªŒè¯¯å·®æœ€å°ï¼Œå¯è¯æ˜ï¼š<strong>ä»»ä½•VCç»´æœ‰é™çš„å‡è®¾ç©ºé—´éƒ½æ˜¯ï¼ˆä¸å¯çŸ¥ï¼‰PACå¯å­¦ä¹ çš„ï¼Œæ¢è€Œè¨€ä¹‹ï¼šè‹¥å‡è®¾ç©ºé—´çš„æœ€å°æ³›åŒ–è¯¯å·®ä¸º0å³ç›®æ ‡æ¦‚å¿µåŒ…å«åœ¨å‡è®¾ç©ºé—´ä¸­ï¼Œåˆ™æ˜¯PACå¯å­¦ä¹ ï¼Œè‹¥æœ€å°æ³›åŒ–è¯¯å·®ä¸ä¸º0ï¼Œåˆ™ç§°ä¸ºä¸å¯çŸ¥PACå¯å­¦ä¹ ã€‚</strong></p>
<h3 id="134-ç¨³å®šæ€§"><a class="header" href="#134-ç¨³å®šæ€§"><strong>13.4 ç¨³å®šæ€§</strong></a></h3>
<p>ç¨³å®šæ€§è€ƒå¯Ÿçš„æ˜¯å½“ç®—æ³•çš„è¾“å…¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¾“å‡ºæ˜¯å¦ä¼šéšä¹‹å‘ç”Ÿè¾ƒå¤§çš„å˜åŒ–ï¼Œè¾“å…¥çš„æ•°æ®é›†Dæœ‰ä»¥ä¸‹ä¸¤ç§å˜åŒ–ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855badc5a8.png" alt="16.png" /></p>
<p>è‹¥å¯¹æ•°æ®é›†ä¸­çš„ä»»ä½•æ ·æœ¬zï¼Œæ»¡è¶³ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855ba59b06.png" alt="17.png" /></p>
<p>å³åŸå­¦ä¹ å™¨å’Œå‰”é™¤ä¸€ä¸ªæ ·æœ¬åç”Ÿæˆçš„å­¦ä¹ å™¨å¯¹zçš„æŸå¤±ä¹‹å·®ä¿æŒÎ²ç¨³å®šï¼Œç§°å­¦ä¹ å™¨å…³äºæŸå¤±å‡½æ•°æ»¡è¶³<strong>Î²-å‡åŒ€ç¨³å®šæ€§</strong>ã€‚åŒæ—¶è‹¥æŸå¤±å‡½æ•°æœ‰ä¸Šç•Œï¼Œå³åŸå­¦ä¹ å™¨å¯¹ä»»ä½•æ ·æœ¬çš„æŸå¤±å‡½æ•°ä¸è¶…è¿‡Mï¼Œåˆ™æœ‰å¦‚ä¸‹å®šç†ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc855babe7c3.png" alt="18.png" /></p>
<p>äº‹å®ä¸Šï¼Œ<strong>è‹¥å­¦ä¹ ç®—æ³•ç¬¦åˆç»éªŒé£é™©æœ€å°åŒ–åŸåˆ™ï¼ˆERMï¼‰ä¸”æ»¡è¶³Î²-å‡åŒ€ç¨³å®šæ€§ï¼Œåˆ™å‡è®¾ç©ºé—´æ˜¯å¯å­¦ä¹ çš„</strong>ã€‚ç¨³å®šæ€§é€šè¿‡æŸå¤±å‡½æ•°ä¸å‡è®¾ç©ºé—´çš„å¯å­¦ä¹ è”ç³»åœ¨äº†ä¸€èµ·ï¼ŒåŒºåˆ«åœ¨äºï¼šå‡è®¾ç©ºé—´å…³æ³¨çš„æ˜¯ç»éªŒè¯¯å·®ä¸æ³›åŒ–è¯¯å·®ï¼Œéœ€è¦è€ƒè™‘åˆ°æ‰€æœ‰å¯èƒ½çš„å‡è®¾ï¼›è€Œç¨³å®šæ€§åªå…³æ³¨å½“å‰çš„è¾“å‡ºå‡è®¾ã€‚</p>
<h2 id="åå››-åŠç›‘ç£å­¦ä¹ "><a class="header" href="#åå››-åŠç›‘ç£å­¦ä¹ "><strong>åå››ï¼ åŠç›‘ç£å­¦ä¹ </strong></a></h2>
<p>å‰é¢æˆ‘ä»¬ä¸€ç›´å›´ç»•çš„éƒ½æ˜¯ç›‘ç£å­¦ä¹ ä¸æ— ç›‘ç£å­¦ä¹ ï¼Œç›‘ç£å­¦ä¹ æŒ‡çš„æ˜¯è®­ç»ƒæ ·æœ¬åŒ…å«æ ‡è®°ä¿¡æ¯çš„å­¦ä¹ ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šå¸¸è§çš„åˆ†ç±»ä¸å›å½’ç®—æ³•ï¼›æ— ç›‘ç£å­¦ä¹ åˆ™æ˜¯è®­ç»ƒæ ·æœ¬ä¸åŒ…å«æ ‡è®°ä¿¡æ¯çš„å­¦ä¹ ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šèšç±»ç®—æ³•ã€‚åœ¨å®é™…ç”Ÿæ´»ä¸­ï¼Œå¸¸å¸¸ä¼šå‡ºç°ä¸€éƒ¨åˆ†æ ·æœ¬æœ‰æ ‡è®°å’Œè¾ƒå¤šæ ·æœ¬æ— æ ‡è®°çš„æƒ…å½¢ï¼Œä¾‹å¦‚ï¼šåšç½‘é¡µæ¨èæ—¶éœ€è¦è®©ç”¨æˆ·æ ‡è®°å‡ºæ„Ÿå…´è¶£çš„ç½‘é¡µï¼Œä½†æ˜¯å°‘æœ‰ç”¨æˆ·æ„¿æ„èŠ±æ—¶é—´æ¥æä¾›æ ‡è®°ã€‚è‹¥ç›´æ¥ä¸¢å¼ƒæ‰æ— æ ‡è®°æ ·æœ¬é›†ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œå¸¸å¸¸ä¼šç”±äºè®­ç»ƒæ ·æœ¬çš„ä¸å……è¶³ï¼Œä½¿å¾—å…¶åˆ»ç”»æ€»ä½“åˆ†å¸ƒçš„èƒ½åŠ›å‡å¼±ï¼Œä»è€Œå½±å“äº†å­¦ä¹ å™¨æ³›åŒ–æ€§èƒ½ã€‚é‚£å¦‚ä½•åˆ©ç”¨æœªæ ‡è®°çš„æ ·æœ¬æ•°æ®å‘¢ï¼Ÿ</p>
<p>ä¸€ç§ç®€å•çš„åšæ³•æ˜¯é€šè¿‡ä¸“å®¶çŸ¥è¯†å¯¹è¿™äº›æœªæ ‡è®°çš„æ ·æœ¬è¿›è¡Œæ‰“æ ‡ï¼Œä½†éšä¹‹è€Œæ¥çš„å°±æ˜¯å·¨å¤§çš„äººåŠ›è€—è´¹ã€‚è‹¥æˆ‘ä»¬å…ˆä½¿ç”¨æœ‰æ ‡è®°çš„æ ·æœ¬æ•°æ®é›†è®­ç»ƒå‡ºä¸€ä¸ªå­¦ä¹ å™¨ï¼Œå†åŸºäºè¯¥å­¦ä¹ å™¨å¯¹æœªæ ‡è®°çš„æ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œä»ä¸­<strong>æŒ‘é€‰å‡ºä¸ç¡®å®šæ€§é«˜æˆ–åˆ†ç±»ç½®ä¿¡åº¦ä½çš„æ ·æœ¬æ¥å’¨è¯¢ä¸“å®¶å¹¶è¿›è¡Œæ‰“æ ‡</strong>ï¼Œæœ€åä½¿ç”¨æ‰©å……åçš„è®­ç»ƒé›†é‡æ–°è®­ç»ƒå­¦ä¹ å™¨ï¼Œè¿™æ ·ä¾¿èƒ½å¤§å¹…åº¦é™ä½æ ‡è®°æˆæœ¬ï¼Œè¿™ä¾¿æ˜¯<strong>ä¸»åŠ¨å­¦ä¹ </strong>ï¼ˆactive learningï¼‰ï¼Œå…¶ç›®æ ‡æ˜¯<strong>ä½¿ç”¨å°½é‡å°‘çš„/æœ‰ä»·å€¼çš„å’¨è¯¢æ¥è·å¾—æ›´å¥½çš„æ€§èƒ½</strong>ã€‚</p>
<p>æ˜¾ç„¶ï¼Œ<strong>ä¸»åŠ¨å­¦ä¹ éœ€è¦ä¸å¤–ç•Œè¿›è¡Œäº¤äº’/æŸ¥è¯¢/æ‰“æ ‡ï¼Œå…¶æœ¬è´¨ä¸Šä»ç„¶å±äºä¸€ç§ç›‘ç£å­¦ä¹ </strong>ã€‚äº‹å®ä¸Šï¼Œæ— æ ‡è®°æ ·æœ¬è™½æœªåŒ…å«æ ‡è®°ä¿¡æ¯ï¼Œä½†å®ƒä»¬ä¸æœ‰æ ‡è®°æ ·æœ¬ä¸€æ ·éƒ½æ˜¯ä»æ€»ä½“ä¸­ç‹¬ç«‹åŒåˆ†å¸ƒé‡‡æ ·å¾—åˆ°ï¼Œå› æ­¤<strong>å®ƒä»¬æ‰€åŒ…å«çš„æ•°æ®åˆ†å¸ƒä¿¡æ¯å¯¹å­¦ä¹ å™¨çš„è®­ç»ƒå¤§æœ‰è£¨ç›Š</strong>ã€‚å¦‚ä½•è®©å­¦ä¹ è¿‡ç¨‹ä¸ä¾èµ–å¤–ç•Œçš„å’¨è¯¢äº¤äº’ï¼Œè‡ªåŠ¨åˆ©ç”¨æœªæ ‡è®°æ ·æœ¬æ‰€åŒ…å«çš„åˆ†å¸ƒä¿¡æ¯çš„æ–¹æ³•ä¾¿æ˜¯<strong>åŠç›‘ç£å­¦ä¹ </strong>ï¼ˆsemi-supervised learningï¼‰ï¼Œ<strong>å³è®­ç»ƒé›†åŒæ—¶åŒ…å«æœ‰æ ‡è®°æ ·æœ¬æ•°æ®å’Œæœªæ ‡è®°æ ·æœ¬æ•°æ®</strong>ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e39801d.png" alt="1.png" /></p>
<p>æ­¤å¤–ï¼ŒåŠç›‘ç£å­¦ä¹ è¿˜å¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†ä¸º<strong>çº¯åŠç›‘ç£å­¦ä¹ </strong>å’Œ<strong>ç›´æ¨å­¦ä¹ </strong>ï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äºï¼šå‰è€…å‡å®šè®­ç»ƒæ•°æ®é›†ä¸­çš„æœªæ ‡è®°æ•°æ®å¹¶éå¾…é¢„æµ‹æ•°æ®ï¼Œè€Œåè€…å‡å®šå­¦ä¹ è¿‡ç¨‹ä¸­çš„æœªæ ‡è®°æ•°æ®å°±æ˜¯å¾…é¢„æµ‹æ•°æ®ã€‚ä¸»åŠ¨å­¦ä¹ ã€çº¯åŠç›‘ç£å­¦ä¹ ä»¥åŠç›´æ¨å­¦ä¹ ä¸‰è€…çš„æ¦‚å¿µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwJFJS.png" alt="iwJFJS.png" /></p>
<h3 id="141-ç”Ÿæˆå¼æ–¹æ³•"><a class="header" href="#141-ç”Ÿæˆå¼æ–¹æ³•"><strong>14.1 ç”Ÿæˆå¼æ–¹æ³•</strong></a></h3>
<p><strong>ç”Ÿæˆå¼æ–¹æ³•</strong>ï¼ˆgenerative methodsï¼‰æ˜¯åŸºäºç”Ÿæˆå¼æ¨¡å‹çš„æ–¹æ³•ï¼Œå³å…ˆå¯¹è”åˆåˆ†å¸ƒPï¼ˆx,cï¼‰å»ºæ¨¡ï¼Œä»è€Œè¿›ä¸€æ­¥æ±‚è§£ Pï¼ˆc | xï¼‰ï¼Œ<strong>æ­¤ç±»æ–¹æ³•å‡å®šæ ·æœ¬æ•°æ®æœä»ä¸€ä¸ªæ½œåœ¨çš„åˆ†å¸ƒï¼Œå› æ­¤éœ€è¦å……åˆ†å¯é çš„å…ˆéªŒçŸ¥è¯†</strong>ã€‚ä¾‹å¦‚ï¼šå‰é¢å·²ç»æ¥è§¦åˆ°çš„è´å¶æ–¯åˆ†ç±»å™¨ä¸é«˜æ–¯æ··åˆèšç±»ï¼Œéƒ½å±äºç”Ÿæˆå¼æ¨¡å‹ã€‚ç°å‡å®šæ€»ä½“æ˜¯ä¸€ä¸ªé«˜æ–¯æ··åˆåˆ†å¸ƒï¼Œå³ç”±å¤šä¸ªé«˜æ–¯åˆ†å¸ƒç»„åˆå½¢æˆï¼Œä»è€Œä¸€ä¸ªå­é«˜æ–¯åˆ†å¸ƒå°±ä»£è¡¨ä¸€ä¸ªç±»ç°‡ï¼ˆç±»åˆ«ï¼‰ã€‚é«˜æ–¯æ··åˆåˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e3b82dc.png" alt="3.png" /></p>
<p>ä¸å¤±ä¸€èˆ¬æ€§ï¼Œå‡è®¾ç±»ç°‡ä¸çœŸå®çš„ç±»åˆ«æŒ‰ç…§é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œå³ç¬¬iä¸ªç±»ç°‡å¯¹åº”ç¬¬iä¸ªé«˜æ–¯æ··åˆæˆåˆ†ã€‚ä¸é«˜æ–¯æ··åˆèšç±»ç±»ä¼¼åœ°ï¼Œè¿™é‡Œçš„ä¸»è¦ä»»åŠ¡ä¹Ÿæ˜¯ä¼°è®¡å‡ºå„ä¸ªé«˜æ–¯æ··åˆæˆåˆ†çš„å‚æ•°ä»¥åŠæ··åˆç³»æ•°ï¼Œä¸åŒçš„æ˜¯ï¼šå¯¹äºæœ‰æ ‡è®°æ ·æœ¬ï¼Œä¸å†æ˜¯å¯èƒ½å±äºæ¯ä¸€ä¸ªç±»ç°‡ï¼Œè€Œæ˜¯åªèƒ½å±äºçœŸå®ç±»æ ‡å¯¹åº”çš„ç‰¹å®šç±»ç°‡ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e431d30.png" alt="4.png" /></p>
<p>ç›´è§‚ä¸Šæ¥çœ‹ï¼Œ<strong>åŸºäºåŠç›‘ç£çš„é«˜æ–¯æ··åˆæ¨¡å‹æœ‰æœºåœ°æ•´åˆäº†è´å¶æ–¯åˆ†ç±»å™¨ä¸é«˜æ–¯æ··åˆèšç±»çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼Œæœ‰æ•ˆåœ°åˆ©ç”¨äº†æœªæ ‡è®°æ ·æœ¬æ•°æ®éšå«çš„åˆ†å¸ƒä¿¡æ¯ï¼Œä»è€Œä½¿å¾—å‚æ•°çš„ä¼°è®¡æ›´åŠ å‡†ç¡®ã€‚åŒæ ·åœ°ï¼Œè¿™é‡Œä¹Ÿè¦å¬å”¤å‡ºä¹‹å‰çš„EMå¤§æ³•è¿›è¡Œæ±‚è§£ï¼Œé¦–å…ˆå¯¹å„ä¸ªé«˜æ–¯æ··åˆæˆåˆ†çš„å‚æ•°åŠæ··åˆç³»æ•°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼Œè®¡ç®—å‡ºå„ä¸ªPMï¼ˆå³Î³jiï¼Œç¬¬iä¸ªæ ·æœ¬å±äºjç±»ï¼Œæœ‰æ ‡è®°æ ·æœ¬åˆ™ç›´æ¥å±äºç‰¹å®šç±»ï¼‰ï¼Œå†æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼ˆå³LLï¼ˆDï¼‰åˆ†åˆ«å¯¹Î±ã€uå’Œâˆ‘æ±‚åå¯¼ ï¼‰ï¼Œå¯¹å‚æ•°è¿›è¡Œè¿­ä»£æ›´æ–°ã€‚</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e43ff08.png" alt="5.png" /></p>
<p>å½“å‚æ•°è¿­ä»£æ›´æ–°æ”¶æ•›åï¼Œå¯¹äºå¾…é¢„æµ‹æ ·æœ¬xï¼Œä¾¿å¯ä»¥åƒè´å¶æ–¯åˆ†ç±»å™¨é‚£æ ·è®¡ç®—å‡ºæ ·æœ¬å±äºæ¯ä¸ªç±»ç°‡çš„åéªŒæ¦‚ç‡ï¼Œæ¥ç€æ‰¾å‡ºæ¦‚ç‡æœ€å¤§çš„å³å¯ï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e3dfb1c.png" alt="6.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼šåŸºäºç”Ÿæˆå¼æ¨¡å‹çš„æ–¹æ³•ååˆ†ä¾èµ–äºå¯¹æ½œåœ¨æ•°æ®åˆ†å¸ƒçš„å‡è®¾ï¼Œå³å‡è®¾çš„åˆ†å¸ƒè¦èƒ½å’ŒçœŸå®åˆ†å¸ƒç›¸å»åˆï¼Œå¦åˆ™åˆ©ç”¨æœªæ ‡è®°çš„æ ·æœ¬æ•°æ®åå€’ä¼šåœ¨é”™è¯¯çš„é“è·¯ä¸Šæ¸è¡Œæ¸è¿œï¼Œä»è€Œé™ä½å­¦ä¹ å™¨çš„æ³›åŒ–æ€§èƒ½ã€‚å› æ­¤ï¼Œ<strong>æ­¤ç±»æ–¹æ³•è¦æ±‚æå¼ºçš„é¢†åŸŸçŸ¥è¯†å’ŒææŒ‡è§‚å¤©çš„æœ¬é¢†</strong>ã€‚</p>
<h3 id="142-åŠç›‘ç£svm"><a class="header" href="#142-åŠç›‘ç£svm"><strong>14.2 åŠç›‘ç£SVM</strong></a></h3>
<p>ç›‘ç£å­¦ä¹ ä¸­çš„SVMè¯•å›¾æ‰¾åˆ°ä¸€ä¸ªåˆ’åˆ†è¶…å¹³é¢ï¼Œä½¿å¾—ä¸¤ä¾§æ”¯æŒå‘é‡ä¹‹é—´çš„é—´éš”æœ€å¤§ï¼Œå³â€œ<strong>æœ€å¤§åˆ’åˆ†é—´éš”</strong>â€æ€æƒ³ã€‚å¯¹äºåŠç›‘ç£å­¦ä¹ ï¼ŒS3VMåˆ™è€ƒè™‘è¶…å¹³é¢éœ€ç©¿è¿‡æ•°æ®ä½å¯†åº¦çš„åŒºåŸŸã€‚TSVMæ˜¯åŠç›‘ç£æ”¯æŒå‘é‡æœºä¸­çš„æœ€è‘—åä»£è¡¨ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå°è¯•ä¸ºæœªæ ‡è®°æ ·æœ¬æ‰¾åˆ°åˆé€‚çš„æ ‡è®°æŒ‡æ´¾ï¼Œä½¿å¾—è¶…å¹³é¢åˆ’åˆ†åçš„é—´éš”æœ€å¤§åŒ–ã€‚TSVMé‡‡ç”¨å±€éƒ¨æœç´¢çš„ç­–ç•¥æ¥è¿›è¡Œè¿­ä»£æ±‚è§£ï¼Œå³é¦–å…ˆä½¿ç”¨æœ‰æ ‡è®°æ ·æœ¬é›†è®­ç»ƒå‡ºä¸€ä¸ªåˆå§‹SVMï¼Œæ¥ç€ä½¿ç”¨è¯¥å­¦ä¹ å™¨å¯¹æœªæ ‡è®°æ ·æœ¬è¿›è¡Œæ‰“æ ‡ï¼Œè¿™æ ·æ‰€æœ‰æ ·æœ¬éƒ½æœ‰äº†æ ‡è®°ï¼Œå¹¶åŸºäºè¿™äº›æœ‰æ ‡è®°çš„æ ·æœ¬é‡æ–°è®­ç»ƒSVMï¼Œä¹‹åå†å¯»æ‰¾æ˜“å‡ºé”™æ ·æœ¬ä¸æ–­è°ƒæ•´ã€‚æ•´ä¸ªç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2018/10/18/5bc856e427830.png" alt="7.png" /></p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwJZss.png" alt="iwJZss.png" /></p>
<h3 id="143-åŸºäºåˆ†æ­§çš„æ–¹æ³•"><a class="header" href="#143-åŸºäºåˆ†æ­§çš„æ–¹æ³•"><strong>14.3 åŸºäºåˆ†æ­§çš„æ–¹æ³•</strong></a></h3>
<p>åŸºäºåˆ†æ­§çš„æ–¹æ³•é€šè¿‡å¤šä¸ªå­¦ä¹ å™¨ä¹‹é—´çš„**åˆ†æ­§ï¼ˆdisagreementï¼‰/å¤šæ ·æ€§ï¼ˆdiversityï¼‰**æ¥åˆ©ç”¨æœªæ ‡è®°æ ·æœ¬æ•°æ®ï¼ŒååŒè®­ç»ƒå°±æ˜¯å…¶ä¸­çš„ä¸€ç§ç»å…¸æ–¹æ³•ã€‚<strong>ååŒè®­ç»ƒæœ€åˆæ˜¯é’ˆå¯¹äºå¤šè§†å›¾ï¼ˆmulti-viewï¼‰æ•°æ®è€Œè®¾è®¡çš„ï¼Œå¤šè§†å›¾æ•°æ®æŒ‡çš„æ˜¯æ ·æœ¬å¯¹è±¡å…·æœ‰å¤šä¸ªå±æ€§é›†ï¼Œæ¯ä¸ªå±æ€§é›†åˆ™å¯¹åº”ä¸€ä¸ªè¯•å›¾</strong>ã€‚ä¾‹å¦‚ï¼šç”µå½±æ•°æ®ä¸­å°±åŒ…å«ç”»é¢ç±»å±æ€§å’Œå£°éŸ³ç±»å±æ€§ï¼Œè¿™æ ·ç”»é¢ç±»å±æ€§çš„é›†åˆå°±å¯¹åº”ç€ä¸€ä¸ªè§†å›¾ã€‚é¦–å…ˆå¼•å…¥ä¸¤ä¸ªå…³äºè§†å›¾çš„é‡è¦æ€§è´¨ï¼š</p>
<blockquote>
<p><strong>ç›¸å®¹æ€§</strong>ï¼šå³ä½¿ç”¨å•ä¸ªè§†å›¾æ•°æ®è®­ç»ƒå‡ºçš„å­¦ä¹ å™¨çš„è¾“å‡ºç©ºé—´æ˜¯ä¸€è‡´çš„ã€‚ä¾‹å¦‚éƒ½æ˜¯{å¥½ï¼Œå}ã€{+1,-1}ç­‰ã€‚
<strong>äº’è¡¥æ€§</strong>ï¼šå³ä¸åŒè§†å›¾æ‰€æä¾›çš„ä¿¡æ¯æ˜¯äº’è¡¥/ç›¸è¾…ç›¸æˆçš„ï¼Œå®è´¨ä¸Šè¿™é‡Œä½“ç°çš„å°±æ˜¯é›†æˆå­¦ä¹ çš„æ€æƒ³ã€‚</p>
</blockquote>
<p>ååŒè®­ç»ƒæ­£æ˜¯å¾ˆå¥½åœ°åˆ©ç”¨äº†å¤šè§†å›¾æ•°æ®çš„â€œ<strong>ç›¸å®¹äº’è¡¥æ€§</strong>â€ï¼Œå…¶åŸºæœ¬çš„æ€æƒ³æ˜¯ï¼šé¦–å…ˆåŸºäºæœ‰æ ‡è®°æ ·æœ¬æ•°æ®åœ¨æ¯ä¸ªè§†å›¾ä¸Šéƒ½è®­ç»ƒä¸€ä¸ªåˆå§‹åˆ†ç±»å™¨ï¼Œç„¶åè®©æ¯ä¸ªåˆ†ç±»å™¨å»æŒ‘é€‰åˆ†ç±»ç½®ä¿¡åº¦æœ€é«˜çš„æ ·æœ¬å¹¶èµ‹äºˆæ ‡è®°ï¼Œå¹¶å°†å¸¦æœ‰ä¼ªæ ‡è®°çš„æ ·æœ¬æ•°æ®ä¼ ç»™å¦ä¸€ä¸ªåˆ†ç±»å™¨å»å­¦ä¹ ï¼Œä»è€Œ<strong>ä½ ä¾æˆ‘ä¾¬/å…±åŒè¿›æ­¥</strong>ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwJVMj.png" alt="iwJVMj.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwJeLn.png" alt="iwJeLn.png" /></p>
<h3 id="144-åŠç›‘ç£èšç±»"><a class="header" href="#144-åŠç›‘ç£èšç±»"><strong>14.4 åŠç›‘ç£èšç±»</strong></a></h3>
<p>å‰é¢æåˆ°çš„å‡ ç§æ–¹æ³•éƒ½æ˜¯å€ŸåŠ©æ— æ ‡è®°æ ·æœ¬æ•°æ®æ¥è¾…åŠ©ç›‘ç£å­¦ä¹ çš„è®­ç»ƒè¿‡ç¨‹ï¼Œä»è€Œä½¿å¾—å­¦ä¹ æ›´åŠ å……åˆ†/æ³›åŒ–æ€§èƒ½å¾—åˆ°æå‡ï¼›åŠç›‘ç£èšç±»åˆ™æ˜¯å€ŸåŠ©å·²æœ‰çš„ç›‘ç£ä¿¡æ¯æ¥è¾…åŠ©èšç±»çš„è¿‡ç¨‹ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œç›‘ç£ä¿¡æ¯å¤§è‡´æœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<blockquote>
<p><strong>å¿…è¿ä¸å‹¿è¿çº¦æŸ</strong>ï¼šå¿…è¿æŒ‡çš„æ˜¯ä¸¤ä¸ªæ ·æœ¬å¿…é¡»åœ¨åŒä¸€ä¸ªç±»ç°‡ï¼Œå‹¿è¿åˆ™æ˜¯å¿…ä¸åœ¨åŒä¸€ä¸ªç±»ç°‡ã€‚
<strong>æ ‡è®°ä¿¡æ¯</strong>ï¼šå°‘é‡çš„æ ·æœ¬å¸¦æœ‰çœŸå®çš„æ ‡è®°ã€‚</p>
</blockquote>
<p>ä¸‹é¢ä¸»è¦ä»‹ç»ä¸¤ç§åŸºäºåŠç›‘ç£çš„K-Meansèšç±»ç®—æ³•ï¼šç¬¬ä¸€ç§æ˜¯æ•°æ®é›†åŒ…å«ä¸€äº›å¿…è¿ä¸å‹¿è¿å…³ç³»ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯åŒ…å«å°‘é‡å¸¦æœ‰æ ‡è®°çš„æ ·æœ¬ã€‚ä¸¤ç§ç®—æ³•çš„åŸºæœ¬æ€æƒ³éƒ½ååˆ†çš„ç®€å•ï¼šå¯¹äºå¸¦æœ‰çº¦æŸå…³ç³»çš„k-å‡å€¼ç®—æ³•ï¼Œåœ¨è¿­ä»£è¿‡ç¨‹ä¸­å¯¹æ¯ä¸ªæ ·æœ¬åˆ’åˆ†ç±»ç°‡æ—¶ï¼Œéœ€è¦<strong>æ£€æµ‹å½“å‰åˆ’åˆ†æ˜¯å¦æ»¡è¶³çº¦æŸå…³ç³»</strong>ï¼Œè‹¥ä¸æ»¡è¶³åˆ™ä¼šå°†è¯¥æ ·æœ¬åˆ’åˆ†åˆ°è·ç¦»æ¬¡å°å¯¹åº”çš„ç±»ç°‡ä¸­ï¼Œå†ç»§ç»­æ£€æµ‹æ˜¯å¦æ»¡è¶³çº¦æŸå…³ç³»ï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰æ ·æœ¬çš„åˆ’åˆ†ã€‚ç®—æ³•æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwJAzQ.png" alt="iwJAzQ.png" /></p>
<p>å¯¹äºå¸¦æœ‰å°‘é‡æ ‡è®°æ ·æœ¬çš„k-å‡å€¼ç®—æ³•ï¼Œåˆ™å¯ä»¥<strong>åˆ©ç”¨è¿™äº›æœ‰æ ‡è®°æ ·æœ¬è¿›è¡Œç±»ä¸­å¿ƒçš„æŒ‡å®šï¼ŒåŒæ—¶åœ¨å¯¹æ ·æœ¬è¿›è¡Œåˆ’åˆ†æ—¶ï¼Œä¸éœ€è¦æ”¹å˜è¿™äº›æœ‰æ ‡è®°æ ·æœ¬çš„ç°‡éš¶å±å…³ç³»</strong>ï¼Œç›´æ¥å°†å…¶åˆ’åˆ†åˆ°å¯¹åº”ç±»ç°‡å³å¯ã€‚ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwJkRg.png" alt="iwJkRg.png" /></p>
<h2 id="åäº”-æ¦‚ç‡å›¾æ¨¡å‹"><a class="header" href="#åäº”-æ¦‚ç‡å›¾æ¨¡å‹"><strong>åäº”ï¼ æ¦‚ç‡å›¾æ¨¡å‹</strong></a></h2>
<p>ç°åœ¨å†æ¥è°ˆè°ˆæœºå™¨å­¦ä¹ çš„æ ¸å¿ƒä»·å€¼è§‚ï¼Œå¯ä»¥æ›´é€šä¿—åœ°ç†è§£ä¸ºï¼š<strong>æ ¹æ®ä¸€äº›å·²è§‚å¯Ÿåˆ°çš„è¯æ®æ¥æ¨æ–­æœªçŸ¥</strong>ï¼Œæ›´å…·å“²å­¦æ€§åœ°å¯ä»¥é˜è¿°ä¸ºï¼šæœªæ¥çš„å‘å±•æ€»æ˜¯éµå¾ªç€å†å²çš„è§„å¾‹ã€‚å…¶ä¸­<strong>åŸºäºæ¦‚ç‡çš„æ¨¡å‹å°†å­¦ä¹ ä»»åŠ¡å½’ç»“ä¸ºè®¡ç®—å˜é‡çš„æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼Œæ­£å¦‚ä¹‹å‰å·²ç»æåˆ°çš„ï¼šç”Ÿæˆå¼æ¨¡å‹å…ˆå¯¹è”åˆåˆ†å¸ƒè¿›è¡Œå»ºæ¨¡ï¼Œä»è€Œå†æ¥æ±‚è§£åéªŒæ¦‚ç‡ï¼Œä¾‹å¦‚ï¼šè´å¶æ–¯åˆ†ç±»å™¨å…ˆå¯¹è”åˆåˆ†å¸ƒè¿›è¡Œæœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œä»è€Œä¾¿å¯ä»¥è®¡ç®—ç±»æ¡ä»¶æ¦‚ç‡ï¼›åˆ¤åˆ«å¼æ¨¡å‹åˆ™æ˜¯ç›´æ¥å¯¹æ¡ä»¶åˆ†å¸ƒè¿›è¡Œå»ºæ¨¡ã€‚</p>
<p><strong>æ¦‚ç‡å›¾æ¨¡å‹</strong>ï¼ˆprobabilistic graphical modelï¼‰æ˜¯ä¸€ç±»ç”¨<strong>å›¾ç»“æ„</strong>æ¥è¡¨è¾¾å„å±æ€§ä¹‹é—´ç›¸å…³å…³ç³»çš„æ¦‚ç‡æ¨¡å‹ï¼Œä¸€èˆ¬è€Œè¨€ï¼š<strong>å›¾ä¸­çš„ä¸€ä¸ªç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªæˆ–ä¸€ç»„éšæœºå˜é‡ï¼Œç»“ç‚¹ä¹‹é—´çš„è¾¹åˆ™è¡¨ç¤ºå˜é‡é—´çš„ç›¸å…³å…³ç³»</strong>ï¼Œä»è€Œå½¢æˆäº†ä¸€å¼ â€œ<strong>å˜é‡å…³ç³»å›¾</strong>â€ã€‚è‹¥ä½¿ç”¨æœ‰å‘çš„è¾¹æ¥è¡¨è¾¾å˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œè¿™æ ·çš„æœ‰å‘å…³ç³»å›¾ç§°ä¸º<strong>è´å¶æ–¯ç½‘</strong>ï¼ˆBayesian nerworkï¼‰æˆ–æœ‰å‘å›¾æ¨¡å‹ï¼›è‹¥ä½¿ç”¨æ— å‘è¾¹ï¼Œåˆ™ç§°ä¸º<strong>é©¬å°”å¯å¤«ç½‘</strong>ï¼ˆMarkov networkï¼‰æˆ–æ— å‘å›¾æ¨¡å‹ã€‚</p>
<h3 id="151-éšé©¬å°”å¯å¤«æ¨¡å‹hmm"><a class="header" href="#151-éšé©¬å°”å¯å¤«æ¨¡å‹hmm"><strong>15.1 éšé©¬å°”å¯å¤«æ¨¡å‹(HMM)</strong></a></h3>
<p>éšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆHidden Markov Modelï¼Œç®€ç§°HMMï¼‰æ˜¯ç»“æ„æœ€ç®€å•çš„ä¸€ç§è´å¶æ–¯ç½‘ï¼Œåœ¨è¯­éŸ³è¯†åˆ«ä¸è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸä¸Šæœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚HMMä¸­çš„å˜é‡åˆ†ä¸ºä¸¤ç»„ï¼š<strong>çŠ¶æ€å˜é‡</strong>ä¸<strong>è§‚æµ‹å˜é‡</strong>ï¼Œå…¶ä¸­çŠ¶æ€å˜é‡ä¸€èˆ¬æ˜¯æœªçŸ¥çš„ï¼Œå› æ­¤åˆç§°ä¸ºâ€œ<strong>éšå˜é‡</strong>â€ï¼Œè§‚æµ‹å˜é‡åˆ™æ˜¯å·²çŸ¥çš„è¾“å‡ºå€¼ã€‚åœ¨éšé©¬å°”å¯å¤«æ¨¡å‹ä¸­ï¼Œå˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»éµå¾ªå¦‚ä¸‹ä¸¤ä¸ªè§„åˆ™ï¼š</p>
<blockquote>
<p><strong>1. è§‚æµ‹å˜é‡çš„å–å€¼ä»…ä¾èµ–äºçŠ¶æ€å˜é‡</strong>ï¼›
<strong>2. ä¸‹ä¸€ä¸ªçŠ¶æ€çš„å–å€¼ä»…ä¾èµ–äºå½“å‰çŠ¶æ€</strong>ï¼Œé€šä¿—æ¥è®²ï¼š<strong>ç°åœ¨å†³å®šæœªæ¥ï¼Œæœªæ¥ä¸è¿‡å»æ— å…³</strong>ï¼Œè¿™å°±æ˜¯è‘—åçš„<strong>é©¬å°”å¯å¤«æ€§</strong>ã€‚</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYPmR.png" alt="iwYPmR.png" /></p>
<p>åŸºäºä¸Šè¿°å˜é‡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å†™å‡ºéšé©¬å°”å¯å¤«æ¨¡å‹ä¸­æ‰€æœ‰å˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwY9X9.png" alt="iwY9X9.png" /></p>
<p>æ˜“çŸ¥ï¼š<strong>æ¬²ç¡®å®šä¸€ä¸ªHMMæ¨¡å‹éœ€è¦ä»¥ä¸‹ä¸‰ç»„å‚æ•°</strong>ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYi01.png" alt="iwYi01.png" /></p>
<p>å½“ç¡®å®šäº†ä¸€ä¸ªHMMæ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°åï¼Œä¾¿æŒ‰ç…§ä¸‹é¢çš„è§„åˆ™æ¥ç”Ÿæˆè§‚æµ‹å€¼åºåˆ—ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYFTx.png" alt="iwYFTx.png" /></p>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒHMMæ¨¡å‹çš„å‘åŠ›ç‚¹ä¸»è¦ä½“ç°åœ¨ä¸‹è¿°ä¸‰ä¸ªé—®é¢˜ä¸Šï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYEtK.png" alt="iwYEtK.png" /></p>
<h4 id="1511-hmmè¯„ä¼°é—®é¢˜"><a class="header" href="#1511-hmmè¯„ä¼°é—®é¢˜"><strong>15.1.1 HMMè¯„ä¼°é—®é¢˜</strong></a></h4>
<p>HMMè¯„ä¼°é—®é¢˜æŒ‡çš„æ˜¯ï¼š<strong>ç»™å®šäº†æ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°ä¸è§‚æµ‹å€¼åºåˆ—ï¼Œæ±‚è¯¥è§‚æµ‹å€¼åºåˆ—å‡ºç°çš„æ¦‚ç‡</strong>ã€‚ä¾‹å¦‚ï¼šå¯¹äºèµŒåœºé—®é¢˜ï¼Œä¾¿å¯ä»¥ä¾æ®éª°å­æ·å‡ºçš„ç»“æœåºåˆ—æ¥è®¡ç®—è¯¥ç»“æœåºåˆ—å‡ºç°çš„å¯èƒ½æ€§ï¼Œè‹¥å°æ¦‚ç‡çš„äº‹ä»¶å‘ç”Ÿäº†åˆ™å¯è®¤ä¸ºèµŒåœºçš„éª°å­æœ‰ä½œå¼Šçš„å¯èƒ½ã€‚è§£å†³è¯¥é—®é¢˜ä½¿ç”¨çš„æ˜¯<strong>å‰å‘ç®—æ³•</strong>ï¼Œå³æ­¥æ­¥ä¸ºè¥ï¼Œè‡ªåº•å‘ä¸Šçš„æ–¹å¼é€æ­¥å¢åŠ åºåˆ—çš„é•¿åº¦ï¼Œç›´åˆ°è·å¾—ç›®æ ‡æ¦‚ç‡å€¼ã€‚åœ¨å‰å‘ç®—æ³•ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª<strong>å‰å‘å˜é‡</strong>ï¼Œå³ç»™å®šè§‚å¯Ÿå€¼åºåˆ—ä¸”tæ—¶åˆ»çš„çŠ¶æ€ä¸ºSiçš„æ¦‚ç‡ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYVfO.png" alt="iwYVfO.png" /></p>
<p>åŸºäºå‰å‘å˜é‡ï¼Œå¾ˆå®¹æ˜“å¾—åˆ°è¯¥é—®é¢˜çš„é€’æ¨å…³ç³»åŠç»ˆæ­¢æ¡ä»¶ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYAk6.png" alt="iwYAk6.png" /></p>
<p>å› æ­¤å¯ä½¿ç”¨åŠ¨æ€è§„åˆ’æ³•ï¼Œä»æœ€å°çš„å­é—®é¢˜å¼€å§‹ï¼Œé€šè¿‡å¡«è¡¨æ ¼çš„å½¢å¼ä¸€æ­¥ä¸€æ­¥è®¡ç®—å‡ºç›®æ ‡ç»“æœã€‚</p>
<h4 id="1512-hmmè§£ç é—®é¢˜"><a class="header" href="#1512-hmmè§£ç é—®é¢˜"><strong>15.1.2 HMMè§£ç é—®é¢˜</strong></a></h4>
<p>HMMè§£ç é—®é¢˜æŒ‡çš„æ˜¯ï¼š<strong>ç»™å®šäº†æ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°ä¸è§‚æµ‹å€¼åºåˆ—ï¼Œæ±‚å¯èƒ½æ€§æœ€å¤§çš„çŠ¶æ€åºåˆ—</strong>ã€‚ä¾‹å¦‚ï¼šåœ¨è¯­éŸ³è¯†åˆ«é—®é¢˜ä¸­ï¼Œäººè¯´è¯å½¢æˆçš„æ•°å­—ä¿¡å·å¯¹åº”ç€è§‚æµ‹å€¼åºåˆ—ï¼Œå¯¹åº”çš„å…·ä½“æ–‡å­—åˆ™æ˜¯çŠ¶æ€åºåˆ—ï¼Œä»æ•°å­—ä¿¡å·è½¬åŒ–ä¸ºæ–‡å­—æ­£æ˜¯å¯¹åº”ç€æ ¹æ®è§‚æµ‹å€¼åºåˆ—æ¨æ–­æœ€æœ‰å¯èƒ½çš„çŠ¶æ€å€¼åºåˆ—ã€‚è§£å†³è¯¥é—®é¢˜ä½¿ç”¨çš„æ˜¯<strong>Viterbiç®—æ³•</strong>ï¼Œä¸å‰å‘ç®—æ³•ååˆ†ç±»ä¼¼åœ°ï¼ŒViterbiç®—æ³•å®šä¹‰äº†ä¸€ä¸ª<strong>Viterbiå˜é‡</strong>ï¼Œä¹Ÿæ˜¯é‡‡ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œè‡ªåº•å‘ä¸Šé€æ­¥æ±‚è§£ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYepD.png" alt="iwYepD.png" /></p>
<h4 id="1513-hmmå­¦ä¹ é—®é¢˜"><a class="header" href="#1513-hmmå­¦ä¹ é—®é¢˜"><strong>15.1.3 HMMå­¦ä¹ é—®é¢˜</strong></a></h4>
<p>HMMå­¦ä¹ é—®é¢˜æŒ‡çš„æ˜¯ï¼š<strong>ç»™å®šè§‚æµ‹å€¼åºåˆ—ï¼Œå¦‚ä½•è°ƒæ•´æ¨¡å‹çš„å‚æ•°ä½¿å¾—è¯¥åºåˆ—å‡ºç°çš„æ¦‚ç‡æœ€å¤§</strong>ã€‚è¿™ä¾¿è½¬åŒ–æˆäº†æœºå™¨å­¦ä¹ é—®é¢˜ï¼Œå³ä»ç»™å®šçš„è§‚æµ‹å€¼åºåˆ—ä¸­å­¦ä¹ å‡ºä¸€ä¸ªHMMæ¨¡å‹ï¼Œ<strong>è¯¥é—®é¢˜æ­£æ˜¯EMç®—æ³•çš„ç»å…¸æ¡ˆä¾‹ä¹‹ä¸€</strong>ã€‚å…¶æ€æƒ³ä¹Ÿååˆ†ç®€å•ï¼šå¯¹äºç»™å®šçš„è§‚æµ‹å€¼åºåˆ—ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤ŸæŒ‰ç…§è¯¥åºåˆ—æ½œåœ¨çš„è§„å¾‹æ¥è°ƒæ•´æ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°ï¼Œåˆ™å¯ä»¥ä½¿å¾—è¯¥åºåˆ—å‡ºç°çš„å¯èƒ½æ€§æœ€å¤§ã€‚å‡è®¾çŠ¶æ€å€¼åºåˆ—ä¹Ÿå·²çŸ¥ï¼Œåˆ™å¾ˆå®¹æ˜“è®¡ç®—å‡ºä¸è¯¥åºåˆ—æœ€å¥‘åˆçš„æ¨¡å‹å‚æ•°ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYm1e.png" alt="iwYm1e.png" /></p>
<p>ä½†ä¸€èˆ¬çŠ¶æ€å€¼åºåˆ—éƒ½æ˜¯ä¸å¯è§‚æµ‹çš„ï¼Œä¸”<strong>å³ä½¿ç»™å®šè§‚æµ‹å€¼åºåˆ—ä¸æ¨¡å‹å‚æ•°ï¼ŒçŠ¶æ€åºåˆ—ä»ç„¶é­é‡ç»„åˆçˆ†ç‚¸</strong>ã€‚å› æ­¤ä¸Šé¢è¿™ç§ç®€å•çš„ç»Ÿè®¡æ–¹æ³•å°±è¡Œä¸é€šäº†ï¼Œè‹¥å°†çŠ¶æ€å€¼åºåˆ—çœ‹ä½œä¸ºéšå˜é‡ï¼Œè¿™æ—¶ä¾¿å¯ä»¥è€ƒè™‘ä½¿ç”¨EMç®—æ³•æ¥å¯¹è¯¥é—®é¢˜è¿›è¡Œæ±‚è§£ï¼š</p>
<p>ã€1ã€‘é¦–å…ˆå¯¹HMMæ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°è¿›è¡Œéšæœºåˆå§‹åŒ–ï¼›<br />
ã€2ã€‘æ ¹æ®æ¨¡å‹çš„å‚æ•°ä¸è§‚æµ‹å€¼åºåˆ—ï¼Œè®¡ç®—tæ—¶åˆ»çŠ¶æ€ä¸ºiä¸”t+1æ—¶åˆ»çŠ¶æ€ä¸ºjçš„æ¦‚ç‡ä»¥åŠtæ—¶åˆ»çŠ¶æ€ä¸ºiçš„æ¦‚ç‡ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYn6H.png" alt="iwYn6H.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwYdns.png" alt="iwYdns.png" /></p>
<p>ã€3ã€‘æ¥ç€ä¾¿å¯ä»¥å¯¹æ¨¡å‹çš„ä¸‰ä¸ªå‚æ•°è¿›è¡Œé‡æ–°ä¼°è®¡ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYY9S.png" alt="iwYY9S.png" /></p>
<p>ã€4ã€‘é‡å¤æ­¥éª¤2-3ï¼Œç›´è‡³ä¸‰ä¸ªå‚æ•°å€¼æ”¶æ•›ï¼Œä¾¿å¾—åˆ°äº†æœ€ç»ˆçš„HMMæ¨¡å‹ã€‚</p>
<h3 id="152-é©¬å°”å¯å¤«éšæœºåœºmrf"><a class="header" href="#152-é©¬å°”å¯å¤«éšæœºåœºmrf"><strong>15.2 é©¬å°”å¯å¤«éšæœºåœºï¼ˆMRFï¼‰</strong></a></h3>
<p>é©¬å°”å¯å¤«éšæœºåœºï¼ˆMarkov Random Fieldï¼‰æ˜¯ä¸€ç§å…¸å‹çš„é©¬å°”å¯å¤«ç½‘ï¼Œå³ä½¿ç”¨æ— å‘è¾¹æ¥è¡¨è¾¾å˜é‡é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨é©¬å°”å¯å¤«éšæœºåœºä¸­ï¼Œå¯¹äºå…³ç³»å›¾ä¸­çš„ä¸€ä¸ªå­é›†ï¼Œ<strong>è‹¥ä»»æ„ä¸¤ç»“ç‚¹é—´éƒ½æœ‰è¾¹è¿æ¥ï¼Œåˆ™ç§°è¯¥å­é›†ä¸ºä¸€ä¸ªå›¢ï¼›è‹¥å†åŠ ä¸€ä¸ªç»“ç‚¹ä¾¿ä¸èƒ½å½¢æˆå›¢ï¼Œåˆ™ç§°è¯¥å­é›†ä¸ºæå¤§å›¢</strong>ã€‚MRFä½¿ç”¨<strong>åŠ¿å‡½æ•°</strong>æ¥å®šä¹‰å¤šä¸ªå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ï¼Œå…¶ä¸­<strong>æ¯ä¸ªï¼ˆæå¤§ï¼‰å›¢å¯¹åº”ä¸€ä¸ªåŠ¿å‡½æ•°</strong>ï¼Œä¸€èˆ¬å›¢ä¸­çš„å˜é‡å…³ç³»ä¹Ÿä½“ç°åœ¨å®ƒæ‰€å¯¹åº”çš„æå¤§å›¢ä¸­ï¼Œå› æ­¤å¸¸å¸¸åŸºäºæå¤§å›¢æ¥å®šä¹‰å˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒå‡½æ•°ã€‚å…·ä½“è€Œè¨€ï¼Œè‹¥æ‰€æœ‰å˜é‡æ„æˆçš„æå¤§å›¢çš„é›†åˆä¸ºCï¼Œåˆ™MRFçš„è”åˆæ¦‚ç‡å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYGh8.png" alt="iwYGh8.png" /></p>
<p>å¯¹äºæ¡ä»¶ç‹¬ç«‹æ€§ï¼Œ<strong>é©¬å°”å¯å¤«éšæœºåœºé€šè¿‡åˆ†ç¦»é›†æ¥å®ç°æ¡ä»¶ç‹¬ç«‹</strong>ï¼Œè‹¥Aç»“ç‚¹é›†å¿…é¡»ç»è¿‡Cç»“ç‚¹é›†æ‰èƒ½åˆ°è¾¾Bç»“ç‚¹é›†ï¼Œåˆ™ç§°Cä¸ºåˆ†ç¦»é›†ã€‚ä¹¦ä¸Šç»™å‡ºäº†ä¸€ä¸ªç®€å•æƒ…å½¢ä¸‹çš„æ¡ä»¶ç‹¬ç«‹è¯æ˜è¿‡ç¨‹ï¼Œååˆ†è´´åˆ‡æ˜“æ‡‚ï¼Œæ­¤å¤„ä¸å†å±•å¼€ã€‚åŸºäºåˆ†ç¦»é›†çš„æ¦‚å¿µï¼Œå¾—åˆ°äº†MRFçš„ä¸‰ä¸ªæ€§è´¨ï¼š</p>
<blockquote>
<p><strong>å…¨å±€é©¬å°”å¯å¤«æ€§</strong>ï¼šç»™å®šä¸¤ä¸ªå˜é‡å­é›†çš„åˆ†ç¦»é›†ï¼Œåˆ™è¿™ä¸¤ä¸ªå˜é‡å­é›†æ¡ä»¶ç‹¬ç«‹ã€‚
<strong>å±€éƒ¨é©¬å°”å¯å¤«æ€§</strong>ï¼šç»™å®šæŸå˜é‡çš„é‚»æ¥å˜é‡ï¼Œåˆ™è¯¥å˜é‡ä¸å…¶å®ƒå˜é‡æ¡ä»¶ç‹¬ç«‹ã€‚
<strong>æˆå¯¹é©¬å°”å¯å¤«æ€§</strong>ï¼šç»™å®šæ‰€æœ‰å…¶ä»–å˜é‡ï¼Œä¸¤ä¸ªéé‚»æ¥å˜é‡æ¡ä»¶ç‹¬ç«‹ã€‚</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2018/10/18/iwY07q.png" alt="iwY07q.png" /></p>
<p>å¯¹äºMRFä¸­çš„åŠ¿å‡½æ•°ï¼ŒåŠ¿å‡½æ•°ä¸»è¦ç”¨äºæè¿°å›¢ä¸­å˜é‡ä¹‹é—´çš„ç›¸å…³å…³ç³»ï¼Œä¸”è¦æ±‚ä¸ºéè´Ÿå‡½æ•°ï¼Œç›´è§‚æ¥çœ‹ï¼šåŠ¿å‡½æ•°éœ€è¦åœ¨åå¥½çš„å˜é‡å–å€¼ä¸Šå‡½æ•°å€¼è¾ƒå¤§ï¼Œä¾‹å¦‚ï¼šè‹¥x1ä¸x2æˆæ­£ç›¸å…³ï¼Œåˆ™éœ€è¦å°†è¿™ç§å…³ç³»åæ˜ åœ¨åŠ¿å‡½æ•°çš„å‡½æ•°å€¼ä¸­ã€‚ä¸€èˆ¬æˆ‘ä»¬å¸¸ä½¿ç”¨æŒ‡æ•°å‡½æ•°æ¥å®šä¹‰åŠ¿å‡½æ•°ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwY8tf.png" alt="iwY8tf.png" /></p>
<h3 id="153-æ¡ä»¶éšæœºåœºcrf"><a class="header" href="#153-æ¡ä»¶éšæœºåœºcrf"><strong>15.3 æ¡ä»¶éšæœºåœºï¼ˆCRFï¼‰</strong></a></h3>
<p>å‰é¢æ‰€è®²åˆ°çš„<strong>éšé©¬å°”å¯å¤«æ¨¡å‹å’Œé©¬å°”å¯å¤«éšæœºåœºéƒ½å±äºç”Ÿæˆå¼æ¨¡å‹ï¼Œå³å¯¹è”åˆæ¦‚ç‡è¿›è¡Œå»ºæ¨¡ï¼Œæ¡ä»¶éšæœºåœºåˆ™æ˜¯å¯¹æ¡ä»¶åˆ†å¸ƒè¿›è¡Œå»ºæ¨¡</strong>ã€‚CRFè¯•å›¾åœ¨ç»™å®šè§‚æµ‹å€¼åºåˆ—åï¼Œå¯¹çŠ¶æ€åºåˆ—çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œå»ºæ¨¡ï¼Œå³P(y | x)ã€‚ç›´è§‚ä¸Šçœ‹ï¼šCRFä¸HMMçš„è§£ç é—®é¢˜ååˆ†ç±»ä¼¼ï¼Œéƒ½æ˜¯åœ¨ç»™å®šè§‚æµ‹å€¼åºåˆ—åï¼Œç ”ç©¶çŠ¶æ€åºåˆ—å¯èƒ½çš„å–å€¼ã€‚CRFå¯ä»¥æœ‰å¤šç§ç»“æ„ï¼Œåªéœ€ä¿è¯çŠ¶æ€åºåˆ—æ»¡è¶³é©¬å°”å¯å¤«æ€§å³å¯ï¼Œä¸€èˆ¬æˆ‘ä»¬å¸¸ä½¿ç”¨çš„æ˜¯<strong>é“¾å¼æ¡ä»¶éšæœºåœº</strong>ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYt1g.png" alt="iwYt1g.png" /></p>
<p>ä¸é©¬å°”å¯å¤«éšæœºåœºå®šä¹‰è”åˆæ¦‚ç‡ç±»ä¼¼åœ°ï¼ŒCRFä¹Ÿé€šè¿‡å›¢ä»¥åŠåŠ¿å‡½æ•°çš„æ¦‚å¿µæ¥å®šä¹‰æ¡ä»¶æ¦‚ç‡P(y | x)ã€‚åœ¨ç»™å®šè§‚æµ‹å€¼åºåˆ—çš„æ¡ä»¶ä¸‹ï¼Œé“¾å¼æ¡ä»¶éšæœºåœºä¸»è¦åŒ…å«ä¸¤ç§å›¢ç»“æ„ï¼šå•ä¸ªçŠ¶æ€å›¢åŠç›¸é‚»çŠ¶æ€å›¢ï¼Œé€šè¿‡å¼•å…¥ä¸¤ç±»ç‰¹å¾å‡½æ•°ä¾¿å¯ä»¥å®šä¹‰å‡ºç›®æ ‡æ¡ä»¶æ¦‚ç‡ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYNcQ.png" alt="iwYNcQ.png" /></p>
<p>ä»¥è¯æ€§æ ‡æ³¨ä¸ºä¾‹ï¼Œå¦‚ä½•åˆ¤æ–­ç»™å‡ºçš„ä¸€ä¸ªæ ‡æ³¨åºåˆ—é è°±ä¸é è°±å‘¢ï¼Ÿ<strong>è½¬ç§»ç‰¹å¾å‡½æ•°ä¸»è¦åˆ¤å®šä¸¤ä¸ªç›¸é‚»çš„æ ‡æ³¨æ˜¯å¦åˆç†</strong>ï¼Œä¾‹å¦‚ï¼šåŠ¨è¯+åŠ¨è¯æ˜¾ç„¶è¯­æ³•ä¸é€šï¼›<strong>çŠ¶æ€ç‰¹å¾å‡½æ•°åˆ™åˆ¤å®šè§‚æµ‹å€¼ä¸å¯¹åº”çš„æ ‡æ³¨æ˜¯å¦åˆç†</strong>ï¼Œä¾‹å¦‚ï¼š lyç»“å°¾çš„è¯--&gt;å‰¯è¯è¾ƒåˆç†ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªç‰¹å¾å‡½æ•°é›†åˆï¼Œç”¨è¿™ä¸ªç‰¹å¾å‡½æ•°é›†åˆæ¥ä¸ºä¸€ä¸ªæ ‡æ³¨åºåˆ—æ‰“åˆ†ï¼Œå¹¶æ®æ­¤é€‰å‡ºæœ€é è°±çš„æ ‡æ³¨åºåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ªç‰¹å¾å‡½æ•°ï¼ˆå¯¹åº”ä¸€ç§è§„åˆ™ï¼‰éƒ½å¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ªæ ‡æ³¨åºåˆ—è¯„åˆ†ï¼ŒæŠŠé›†åˆä¸­æ‰€æœ‰ç‰¹å¾å‡½æ•°å¯¹åŒä¸€ä¸ªæ ‡æ³¨åºåˆ—çš„è¯„åˆ†ç»¼åˆèµ·æ¥ï¼Œå°±æ˜¯è¿™ä¸ªæ ‡æ³¨åºåˆ—æœ€ç»ˆçš„è¯„åˆ†å€¼ã€‚å¯ä»¥çœ‹å‡ºï¼š<strong>ç‰¹å¾å‡½æ•°æ˜¯ä¸€äº›ç»éªŒçš„ç‰¹æ€§</strong>ã€‚</p>
<h3 id="154-å­¦ä¹ ä¸æ¨æ–­"><a class="header" href="#154-å­¦ä¹ ä¸æ¨æ–­"><strong>15.4 å­¦ä¹ ä¸æ¨æ–­</strong></a></h3>
<p>å¯¹äºç”Ÿæˆå¼æ¨¡å‹ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯å…ˆå¯¹å˜é‡çš„è”åˆæ¦‚ç‡åˆ†å¸ƒè¿›è¡Œå»ºæ¨¡ï¼Œæ¥ç€å†æ±‚å‡ºç›®æ ‡å˜é‡çš„<strong>è¾¹é™…åˆ†å¸ƒ</strong>ï¼ˆmarginal distributionï¼‰ï¼Œé‚£å¦‚ä½•ä»è”åˆæ¦‚ç‡å¾—åˆ°è¾¹é™…åˆ†å¸ƒå‘¢ï¼Ÿè¿™ä¾¿æ˜¯å­¦ä¹ ä¸æ¨æ–­ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»ä¸¤ç§ç²¾ç¡®æ¨æ–­çš„æ–¹æ³•ï¼š<strong>å˜é‡æ¶ˆå»</strong>ä¸<strong>ä¿¡å¿µä¼ æ’­</strong>ã€‚</p>
<h4 id="1541-å˜é‡æ¶ˆå»"><a class="header" href="#1541-å˜é‡æ¶ˆå»"><strong>15.4.1 å˜é‡æ¶ˆå»</strong></a></h4>
<p>å˜é‡æ¶ˆå»åˆ©ç”¨æ¡ä»¶ç‹¬ç«‹æ€§æ¥æ¶ˆå‡è®¡ç®—ç›®æ ‡æ¦‚ç‡å€¼æ‰€éœ€çš„è®¡ç®—é‡ï¼Œå®ƒé€šè¿‡è¿ç”¨<strong>ä¹˜æ³•ä¸åŠ æ³•çš„åˆ†é…ç‡</strong>ï¼Œå°†å¯¹å˜é‡çš„ç§¯çš„æ±‚å’Œé—®é¢˜è½¬åŒ–ä¸ºå¯¹éƒ¨åˆ†å˜é‡äº¤æ›¿è¿›è¡Œæ±‚ç§¯ä¸æ±‚å’Œçš„é—®é¢˜ï¼Œä»è€Œå°†æ¯æ¬¡çš„<strong>è¿ç®—æ§åˆ¶åœ¨å±€éƒ¨</strong>ï¼Œè¾¾åˆ°ç®€åŒ–è¿ç®—çš„ç›®çš„ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYUXj.png" alt="iwYUXj.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwYwBn.png" alt="iwYwBn.png" /></p>
<h4 id="1542-ä¿¡å¿µä¼ æ’­"><a class="header" href="#1542-ä¿¡å¿µä¼ æ’­"><strong>15.4.2 ä¿¡å¿µä¼ æ’­</strong></a></h4>
<p>è‹¥å°†å˜é‡æ±‚å’Œæ“ä½œçœ‹ä½œæ˜¯ä¸€ç§æ¶ˆæ¯çš„ä¼ é€’è¿‡ç¨‹ï¼Œä¿¡å¿µä¼ æ’­å¯ä»¥ç†è§£æˆï¼š<strong>ä¸€ä¸ªèŠ‚ç‚¹åœ¨æ¥æ”¶åˆ°æ‰€æœ‰å…¶å®ƒèŠ‚ç‚¹çš„æ¶ˆæ¯åæ‰å‘å¦ä¸€ä¸ªèŠ‚ç‚¹å‘é€æ¶ˆæ¯</strong>ï¼ŒåŒæ—¶å½“å‰èŠ‚ç‚¹çš„è¾¹é™…æ¦‚ç‡æ­£æ¯”äºä»–æ‰€æ¥æ”¶çš„æ¶ˆæ¯çš„ä¹˜ç§¯ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYDA0.png" alt="iwYDA0.png" /></p>
<p>å› æ­¤åªéœ€è¦ç»è¿‡ä¸‹é¢ä¸¤ä¸ªæ­¥éª¤ï¼Œä¾¿å¯ä»¥å®Œæˆæ‰€æœ‰çš„æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ã€‚åˆ©ç”¨åŠ¨æ€è§„åˆ’æ³•çš„æ€æƒ³è®°å½•ä¼ é€’è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ¶ˆæ¯ï¼Œå½“è®¡ç®—æŸä¸ªç»“ç‚¹çš„è¾¹é™…æ¦‚ç‡åˆ†å¸ƒæ—¶ï¼Œåªéœ€ç›´æ¥å–å‡ºä¼ åˆ°è¯¥ç»“ç‚¹çš„æ¶ˆæ¯å³å¯ï¼Œä»è€Œé¿å…äº†è®¡ç®—å¤šä¸ªè¾¹é™…åˆ†å¸ƒæ—¶çš„å†—ä½™è®¡ç®—é—®é¢˜ã€‚</p>
<blockquote>
<p>1.æŒ‡å®šä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œä»æ‰€æœ‰çš„å¶èŠ‚ç‚¹å¼€å§‹å‘æ ¹èŠ‚ç‚¹ä¼ é€’æ¶ˆæ¯ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹æ”¶åˆ°æ‰€æœ‰é‚»æ¥ç»“ç‚¹çš„æ¶ˆæ¯**ï¼ˆä»å¶åˆ°æ ¹ï¼‰<strong>ï¼›
2.ä»æ ¹èŠ‚ç‚¹å¼€å§‹å‘å¶èŠ‚ç‚¹ä¼ é€’æ¶ˆæ¯ï¼Œç›´åˆ°æ‰€æœ‰å¶èŠ‚ç‚¹å‡æ”¶åˆ°æ¶ˆæ¯</strong>ï¼ˆä»æ ¹åˆ°å¶ï¼‰**ã€‚</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYgc4.png" alt="iwYgc4.png" /></p>
<h3 id="155-ldaè¯é¢˜æ¨¡å‹"><a class="header" href="#155-ldaè¯é¢˜æ¨¡å‹"><strong>15.5 LDAè¯é¢˜æ¨¡å‹</strong></a></h3>
<p>è¯é¢˜æ¨¡å‹ä¸»è¦ç”¨äºå¤„ç†æ–‡æœ¬ç±»æ•°æ®ï¼Œå…¶ä¸­<strong>éšç‹„åˆ©å…‹é›·åˆ†é…æ¨¡å‹</strong>ï¼ˆLatent Dirichlet Allocationï¼Œç®€ç§°LDAï¼‰æ˜¯è¯é¢˜æ¨¡å‹çš„æ°å‡ºä»£è¡¨ã€‚åœ¨è¯é¢˜æ¨¡å‹ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼šè¯ï¼ˆwordï¼‰ã€æ–‡æ¡£ï¼ˆdocumentï¼‰ã€è¯é¢˜ï¼ˆtopicï¼‰ã€‚</p>
<blockquote>
<p><strong>è¯</strong>ï¼šæœ€åŸºæœ¬çš„ç¦»æ•£å•å…ƒï¼›
<strong>æ–‡æ¡£</strong>ï¼šç”±ä¸€ç»„è¯ç»„æˆï¼Œè¯åœ¨æ–‡æ¡£ä¸­ä¸è®¡é¡ºåºï¼›
<strong>è¯é¢˜</strong>ï¼šç”±ä¸€ç»„ç‰¹å®šçš„è¯ç»„æˆï¼Œè¿™ç»„è¯å…·æœ‰è¾ƒå¼ºçš„ç›¸å…³å…³ç³»ã€‚</p>
</blockquote>
<p>åœ¨ç°å®ä»»åŠ¡ä¸­ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæ–‡æ¡£çš„è¯é¢‘åˆ†å¸ƒï¼Œä½†ä¸çŸ¥é“è¯¥æ–‡æ¡£å¯¹åº”ç€å“ªäº›è¯é¢˜ï¼ŒLDAè¯é¢˜æ¨¡å‹æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼š<strong>LDAè®¤ä¸ºæ¯ç¯‡æ–‡æ¡£åŒ…å«å¤šä¸ªè¯é¢˜ï¼Œä¸”å…¶ä¸­æ¯ä¸€ä¸ªè¯éƒ½å¯¹åº”ç€ä¸€ä¸ªè¯é¢˜</strong>ã€‚å› æ­¤å¯ä»¥å‡è®¾æ–‡æ¡£æ˜¯é€šè¿‡å¦‚ä¸‹æ–¹å¼ç”Ÿæˆï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwY2jJ.png" alt="iwY2jJ.png" /></p>
<p>è¿™æ ·ä¸€ä¸ªæ–‡æ¡£ä¸­çš„æ‰€æœ‰è¯éƒ½å¯ä»¥è®¤ä¸ºæ˜¯é€šè¿‡è¯é¢˜æ¨¡å‹æ¥ç”Ÿæˆçš„ï¼Œå½“å·²çŸ¥ä¸€ä¸ªæ–‡æ¡£çš„è¯é¢‘åˆ†å¸ƒåï¼ˆå³ä¸€ä¸ªNç»´å‘é‡ï¼ŒNä¸ºè¯åº“å¤§å°ï¼‰ï¼Œåˆ™å¯ä»¥è®¤ä¸ºï¼š<strong>æ¯ä¸€ä¸ªè¯é¢‘å…ƒç´ éƒ½å¯¹åº”ç€ä¸€ä¸ªè¯é¢˜ï¼Œè€Œè¯é¢˜å¯¹åº”çš„è¯é¢‘åˆ†å¸ƒåˆ™å½±å“ç€è¯¥è¯é¢‘å…ƒç´ çš„å¤§å°</strong>ã€‚å› æ­¤å¾ˆå®¹æ˜“å†™å‡ºLDAæ¨¡å‹å¯¹åº”çš„è”åˆæ¦‚ç‡å‡½æ•°ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYc3F.png" alt="iwYc3F.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwYWu9.png" alt="iwYWu9.png" /></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒLDAçš„ä¸‰ä¸ªè¡¨ç¤ºå±‚è¢«ä¸‰ç§é¢œè‰²è¡¨ç¤ºå‡ºæ¥ï¼š</p>
<blockquote>
<p><strong>corpus-levelï¼ˆçº¢è‰²ï¼‰ï¼š</strong> Î±å’ŒÎ²è¡¨ç¤ºè¯­æ–™çº§åˆ«çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ–‡æ¡£éƒ½ä¸€æ ·ï¼Œå› æ­¤ç”Ÿæˆè¿‡ç¨‹åªé‡‡æ ·ä¸€æ¬¡ã€‚
<strong>document-levelï¼ˆæ©™è‰²ï¼‰ï¼š</strong> Î¸æ˜¯æ–‡æ¡£çº§åˆ«çš„å˜é‡ï¼Œæ¯ä¸ªæ–‡æ¡£å¯¹åº”ä¸€ä¸ªÎ¸ã€‚
<strong>word-levelï¼ˆç»¿è‰²ï¼‰ï¼š</strong> zå’Œwéƒ½æ˜¯å•è¯çº§åˆ«å˜é‡ï¼Œzç”±Î¸ç”Ÿæˆï¼Œwç”±zå’ŒÎ²å…±åŒç”Ÿæˆï¼Œä¸€ä¸ªå•è¯wå¯¹åº”ä¸€ä¸ªä¸»é¢˜zã€‚</p>
</blockquote>
<p>é€šè¿‡ä¸Šé¢å¯¹LDAç”Ÿæˆæ¨¡å‹çš„è®¨è®ºï¼Œå¯ä»¥çŸ¥é“<strong>LDAæ¨¡å‹ä¸»è¦æ˜¯æƒ³ä»ç»™å®šçš„è¾“å…¥è¯­æ–™ä¸­å­¦ä¹ è®­ç»ƒå‡ºä¸¤ä¸ªæ§åˆ¶å‚æ•°Î±å’ŒÎ²</strong>ï¼Œå½“å­¦ä¹ å‡ºäº†è¿™ä¸¤ä¸ªæ§åˆ¶å‚æ•°å°±ç¡®å®šäº†æ¨¡å‹ï¼Œä¾¿å¯ä»¥ç”¨æ¥ç”Ÿæˆæ–‡æ¡£ã€‚å…¶ä¸­Î±å’ŒÎ²åˆ†åˆ«å¯¹åº”ä»¥ä¸‹å„ä¸ªä¿¡æ¯ï¼š</p>
<blockquote>
<p><strong>Î±</strong>ï¼šåˆ†å¸ƒp(Î¸)éœ€è¦ä¸€ä¸ªå‘é‡å‚æ•°ï¼Œå³Dirichletåˆ†å¸ƒçš„å‚æ•°ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªä¸»é¢˜Î¸å‘é‡ï¼›
<strong>Î²</strong>ï¼šå„ä¸ªä¸»é¢˜å¯¹åº”çš„å•è¯æ¦‚ç‡åˆ†å¸ƒçŸ©é˜µp(w|z)ã€‚</p>
</blockquote>
<p>æŠŠwå½“åšè§‚å¯Ÿå˜é‡ï¼ŒÎ¸å’Œzå½“åšéšè—å˜é‡ï¼Œå°±å¯ä»¥é€šè¿‡EMç®—æ³•å­¦ä¹ å‡ºÎ±å’ŒÎ²ï¼Œæ±‚è§£è¿‡ç¨‹ä¸­é‡åˆ°åéªŒæ¦‚ç‡p(Î¸,z|w)æ— æ³•ç›´æ¥æ±‚è§£ï¼Œéœ€è¦æ‰¾ä¸€ä¸ªä¼¼ç„¶å‡½æ•°ä¸‹ç•Œæ¥è¿‘ä¼¼æ±‚è§£ï¼ŒåŸä½œè€…ä½¿ç”¨åŸºäºåˆ†è§£ï¼ˆfactorizationï¼‰å‡è®¾çš„å˜åˆ†æ³•ï¼ˆvarialtional inferenceï¼‰è¿›è¡Œè®¡ç®—ï¼Œç”¨åˆ°äº†EMç®—æ³•ã€‚æ¯æ¬¡E-stepè¾“å…¥Î±å’ŒÎ²ï¼Œè®¡ç®—ä¼¼ç„¶å‡½æ•°ï¼ŒM-stepæœ€å¤§åŒ–è¿™ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œç®—å‡ºÎ±å’ŒÎ²ï¼Œä¸æ–­è¿­ä»£ç›´åˆ°æ”¶æ•›ã€‚</p>
<h2 id="åå…­-å¼ºåŒ–å­¦ä¹ "><a class="header" href="#åå…­-å¼ºåŒ–å­¦ä¹ "><strong>åå…­ï¼ å¼ºåŒ–å­¦ä¹ </strong></a></h2>
<p><strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼ˆReinforcement Learningï¼Œç®€ç§°<strong>RL</strong>ï¼‰æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªé‡è¦åˆ†æ”¯ï¼Œå‰æ®µæ—¶é—´äººæœºå¤§æˆ˜çš„ä¸»è§’AlphaGoæ­£æ˜¯ä»¥å¼ºåŒ–å­¦ä¹ ä¸ºæ ¸å¿ƒæŠ€æœ¯ã€‚åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼ŒåŒ…å«ä¸¤ç§åŸºæœ¬çš„å…ƒç´ ï¼š<strong>çŠ¶æ€</strong>ä¸<strong>åŠ¨ä½œ</strong>ï¼Œ<strong>åœ¨æŸä¸ªçŠ¶æ€ä¸‹æ‰§è¡ŒæŸç§åŠ¨ä½œï¼Œè¿™ä¾¿æ˜¯ä¸€ç§ç­–ç•¥</strong>ï¼Œå­¦ä¹ å™¨è¦åšçš„å°±æ˜¯é€šè¿‡ä¸æ–­åœ°æ¢ç´¢å­¦ä¹ ï¼Œä»è€Œè·å¾—ä¸€ä¸ªå¥½çš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼šåœ¨å›´æ£‹ä¸­ï¼Œä¸€ç§è½æ£‹çš„å±€é¢å°±æ˜¯ä¸€ç§çŠ¶æ€ï¼Œè‹¥èƒ½çŸ¥é“æ¯ç§å±€é¢ä¸‹çš„æœ€ä¼˜è½å­åŠ¨ä½œï¼Œé‚£å°±æ”»æ— ä¸å…‹/ç™¾æˆ˜ä¸æ®†äº†~</p>
<p>è‹¥å°†çŠ¶æ€çœ‹ä½œä¸ºå±æ€§ï¼ŒåŠ¨ä½œçœ‹ä½œä¸ºæ ‡è®°ï¼Œæ˜“çŸ¥ï¼š<strong>ç›‘ç£å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ éƒ½æ˜¯åœ¨è¯•å›¾å¯»æ‰¾ä¸€ä¸ªæ˜ å°„ï¼Œä»å·²çŸ¥å±æ€§/çŠ¶æ€æ¨æ–­å‡ºæ ‡è®°/åŠ¨ä½œ</strong>ï¼Œè¿™æ ·å¼ºåŒ–å­¦ä¹ ä¸­çš„ç­–ç•¥ç›¸å½“äºç›‘ç£å­¦ä¹ ä¸­çš„åˆ†ç±»/å›å½’å™¨ã€‚ä½†åœ¨å®é™…é—®é¢˜ä¸­ï¼Œ<strong>å¼ºåŒ–å­¦ä¹ å¹¶æ²¡æœ‰ç›‘ç£å­¦ä¹ é‚£æ ·çš„æ ‡è®°ä¿¡æ¯</strong>ï¼Œé€šå¸¸éƒ½æ˜¯åœ¨<strong>å°è¯•åŠ¨ä½œåæ‰èƒ½è·å¾—ç»“æœ</strong>ï¼Œå› æ­¤å¼ºåŒ–å­¦ä¹ æ˜¯é€šè¿‡åé¦ˆçš„ç»“æœä¿¡æ¯ä¸æ–­è°ƒæ•´ä¹‹å‰çš„ç­–ç•¥ï¼Œä»è€Œç®—æ³•èƒ½å¤Ÿå­¦ä¹ åˆ°ï¼šåœ¨ä»€ä¹ˆæ ·çš„çŠ¶æ€ä¸‹é€‰æ‹©ä»€ä¹ˆæ ·çš„åŠ¨ä½œå¯ä»¥è·å¾—æœ€å¥½çš„ç»“æœã€‚</p>
<h3 id="161-åŸºæœ¬è¦ç´ "><a class="header" href="#161-åŸºæœ¬è¦ç´ "><strong>16.1 åŸºæœ¬è¦ç´ </strong></a></h3>
<p>å¼ºåŒ–å­¦ä¹ ä»»åŠ¡é€šå¸¸ä½¿ç”¨<strong>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹</strong>ï¼ˆMarkov Decision Processï¼Œç®€ç§°<strong>MDP</strong>ï¼‰æ¥æè¿°ï¼Œå…·ä½“è€Œè¨€ï¼šæœºå™¨å¤„åœ¨ä¸€ä¸ªç¯å¢ƒä¸­ï¼Œæ¯ä¸ªçŠ¶æ€ä¸ºæœºå™¨å¯¹å½“å‰ç¯å¢ƒçš„æ„ŸçŸ¥ï¼›æœºå™¨åªèƒ½é€šè¿‡åŠ¨ä½œæ¥å½±å“ç¯å¢ƒï¼Œå½“æœºå™¨æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œåï¼Œä¼šä½¿å¾—ç¯å¢ƒæŒ‰æŸç§æ¦‚ç‡è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼›åŒæ—¶ï¼Œç¯å¢ƒä¼šæ ¹æ®æ½œåœ¨çš„å¥–èµå‡½æ•°åé¦ˆç»™æœºå™¨ä¸€ä¸ªå¥–èµã€‚ç»¼åˆè€Œè¨€ï¼Œå¼ºåŒ–å­¦ä¹ ä¸»è¦åŒ…å«å››ä¸ªè¦ç´ ï¼šçŠ¶æ€ã€åŠ¨ä½œã€è½¬ç§»æ¦‚ç‡ä»¥åŠå¥–èµå‡½æ•°ã€‚</p>
<blockquote>
<p><strong>çŠ¶æ€ï¼ˆXï¼‰</strong>ï¼šæœºå™¨å¯¹ç¯å¢ƒçš„æ„ŸçŸ¥ï¼Œæ‰€æœ‰å¯èƒ½çš„çŠ¶æ€ç§°ä¸ºçŠ¶æ€ç©ºé—´ï¼›
<strong>åŠ¨ä½œï¼ˆAï¼‰</strong>ï¼šæœºå™¨æ‰€é‡‡å–çš„åŠ¨ä½œï¼Œæ‰€æœ‰èƒ½é‡‡å–çš„åŠ¨ä½œæ„æˆåŠ¨ä½œç©ºé—´ï¼›
<strong>è½¬ç§»æ¦‚ç‡ï¼ˆPï¼‰</strong>ï¼šå½“æ‰§è¡ŒæŸä¸ªåŠ¨ä½œåï¼Œå½“å‰çŠ¶æ€ä¼šä»¥æŸç§æ¦‚ç‡è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼›
<strong>å¥–èµå‡½æ•°ï¼ˆRï¼‰</strong>ï¼šåœ¨çŠ¶æ€è½¬ç§»çš„åŒæ—¶ï¼Œç¯å¢ƒç»™åé¦ˆç»™æœºå™¨ä¸€ä¸ªå¥–èµã€‚</p>
</blockquote>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYOud.png" alt="iwYOud.png" /></p>
<p>å› æ­¤ï¼Œ<strong>å¼ºåŒ–å­¦ä¹ çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯é€šè¿‡åœ¨ç¯å¢ƒä¸­ä¸æ–­åœ°å°è¯•ï¼Œæ ¹æ®å°è¯•è·å¾—çš„åé¦ˆä¿¡æ¯è°ƒæ•´ç­–ç•¥ï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªè¾ƒå¥½çš„ç­–ç•¥Ï€ï¼Œæœºå™¨æ ¹æ®è¿™ä¸ªç­–ç•¥ä¾¿èƒ½çŸ¥é“åœ¨ä»€ä¹ˆçŠ¶æ€ä¸‹åº”è¯¥æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œ</strong>ã€‚å¸¸è§çš„ç­–ç•¥è¡¨ç¤ºæ–¹æ³•æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p>
<blockquote>
<p><strong>ç¡®å®šæ€§ç­–ç•¥</strong>ï¼šÏ€ï¼ˆxï¼‰=aï¼Œå³åœ¨çŠ¶æ€xä¸‹æ‰§è¡ŒaåŠ¨ä½œï¼›
<strong>éšæœºæ€§ç­–ç•¥</strong>ï¼šP=Ï€ï¼ˆx,aï¼‰ï¼Œå³åœ¨çŠ¶æ€xä¸‹æ‰§è¡ŒaåŠ¨ä½œçš„æ¦‚ç‡ã€‚</p>
</blockquote>
<p><strong>ä¸€ä¸ªç­–ç•¥çš„ä¼˜åŠ£å–å†³äºé•¿æœŸæ‰§è¡Œè¿™ä¸€ç­–ç•¥åçš„ç´¯ç§¯å¥–èµ</strong>ï¼Œæ¢å¥è¯è¯´ï¼šå¯ä»¥ä½¿ç”¨ç´¯ç§¯å¥–èµæ¥è¯„ä¼°ç­–ç•¥çš„å¥½åï¼Œæœ€ä¼˜ç­–ç•¥åˆ™è¡¨ç¤ºåœ¨åˆå§‹çŠ¶æ€ä¸‹ä¸€ç›´æ‰§è¡Œè¯¥ç­–ç•¥åï¼Œæœ€åçš„ç´¯ç§¯å¥–èµå€¼æœ€é«˜ã€‚é•¿æœŸç´¯ç§¯å¥–èµé€šå¸¸ä½¿ç”¨ä¸‹è¿°ä¸¤ç§è®¡ç®—æ–¹æ³•ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYH3D.png" alt="iwYH3D.png" /></p>
<h3 id="162-kæ‘‡æ‘†èµŒåšæœº"><a class="header" href="#162-kæ‘‡æ‘†èµŒåšæœº"><strong>16.2 Kæ‘‡æ‘†èµŒåšæœº</strong></a></h3>
<p>é¦–å…ˆæˆ‘ä»¬è€ƒè™‘å¼ºåŒ–å­¦ä¹ æœ€ç®€å•çš„æƒ…å½¢ï¼šä»…è€ƒè™‘ä¸€æ­¥æ“ä½œï¼Œå³åœ¨çŠ¶æ€xä¸‹åªéœ€æ‰§è¡Œä¸€æ¬¡åŠ¨ä½œaä¾¿èƒ½è§‚å¯Ÿåˆ°å¥–èµç»“æœã€‚æ˜“çŸ¥ï¼šæ¬²æœ€å¤§åŒ–å•æ­¥å¥–èµï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ¯ä¸ªåŠ¨ä½œå¸¦æ¥çš„æœŸæœ›å¥–èµå€¼ï¼Œè¿™æ ·ä¾¿èƒ½é€‰æ‹©å¥–èµå€¼æœ€å¤§çš„åŠ¨ä½œæ¥æ‰§è¡Œã€‚è‹¥æ¯ä¸ªåŠ¨ä½œçš„å¥–èµå€¼ä¸ºç¡®å®šå€¼ï¼Œåˆ™åªéœ€è¦å°†æ¯ä¸ªåŠ¨ä½œå°è¯•ä¸€éå³å¯ï¼Œä½†å¤§å¤šæ•°æƒ…å½¢ä¸‹ï¼Œä¸€ä¸ªåŠ¨ä½œçš„å¥–èµå€¼æ¥æºäºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå› æ­¤éœ€è¦è¿›è¡Œå¤šæ¬¡çš„å°è¯•ã€‚</p>
<p>å•æ­¥å¼ºåŒ–å­¦ä¹ å®è´¨ä¸Šæ˜¯<strong>K-æ‘‡è‡‚èµŒåšæœº</strong>ï¼ˆK-armed banditï¼‰çš„åŸå‹ï¼Œä¸€èˆ¬æˆ‘ä»¬<strong>å°è¯•åŠ¨ä½œçš„æ¬¡æ•°æ˜¯æœ‰é™çš„</strong>ï¼Œé‚£å¦‚ä½•åˆ©ç”¨æœ‰é™çš„æ¬¡æ•°è¿›è¡Œæœ‰æ•ˆåœ°æ¢ç´¢å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸¤ç§åŸºæœ¬çš„æƒ³æ³•ï¼š</p>
<blockquote>
<p><strong>ä»…æ¢ç´¢æ³•</strong>ï¼šå°†å°è¯•çš„æœºä¼šå¹³å‡åˆ†ç»™æ¯ä¸€ä¸ªåŠ¨ä½œï¼Œå³è½®æµæ‰§è¡Œï¼Œæœ€ç»ˆå°†æ¯ä¸ªåŠ¨ä½œçš„å¹³å‡å¥–èµä½œä¸ºæœŸæœ›å¥–èµçš„è¿‘ä¼¼å€¼ã€‚
<strong>ä»…åˆ©ç”¨æ³•</strong>ï¼šå°†å°è¯•çš„æœºä¼šåˆ†ç»™å½“å‰å¹³å‡å¥–èµå€¼æœ€å¤§çš„åŠ¨ä½œï¼Œéšå«ç€è®©ä¸€éƒ¨åˆ†äººå…ˆå¯Œèµ·æ¥çš„æ€æƒ³ã€‚</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡ºï¼šä¸Šè¿°<strong>ä¸¤ç§æ–¹æ³•æ˜¯ç›¸äº’çŸ›ç›¾çš„</strong>ï¼Œä»…æ¢ç´¢æ³•èƒ½è¾ƒå¥½åœ°ä¼°ç®—æ¯ä¸ªåŠ¨ä½œçš„æœŸæœ›å¥–èµï¼Œä½†æ˜¯æ²¡èƒ½æ ¹æ®å½“å‰çš„åé¦ˆç»“æœè°ƒæ•´å°è¯•ç­–ç•¥ï¼›ä»…åˆ©ç”¨æ³•åœ¨æ¯æ¬¡å°è¯•ä¹‹åéƒ½æ›´æ–°å°è¯•ç­–ç•¥ï¼Œç¬¦åˆå¼ºåŒ–å­¦ä¹ çš„æ€ï¼ˆtaoï¼‰ç»´ï¼ˆluï¼‰ï¼Œä½†å®¹æ˜“æ‰¾ä¸åˆ°æœ€ä¼˜åŠ¨ä½œã€‚å› æ­¤éœ€è¦åœ¨è¿™ä¸¤è€…ä¹‹é—´è¿›è¡ŒæŠ˜ä¸­ã€‚</p>
<h4 id="1621-Îµ-è´ªå¿ƒ"><a class="header" href="#1621-Îµ-è´ªå¿ƒ"><strong>16.2.1 Îµ-è´ªå¿ƒ</strong></a></h4>
<p><strong>Îµ-è´ªå¿ƒæ³•åŸºäºä¸€ä¸ªæ¦‚ç‡æ¥å¯¹æ¢ç´¢å’Œåˆ©ç”¨è¿›è¡ŒæŠ˜ä¸­</strong>ï¼Œå…·ä½“è€Œè¨€ï¼šåœ¨æ¯æ¬¡å°è¯•æ—¶ï¼Œä»¥Îµçš„æ¦‚ç‡è¿›è¡Œæ¢ç´¢ï¼Œå³ä»¥å‡åŒ€æ¦‚ç‡éšæœºé€‰æ‹©ä¸€ä¸ªåŠ¨ä½œï¼›ä»¥1-Îµçš„æ¦‚ç‡è¿›è¡Œåˆ©ç”¨ï¼Œå³é€‰æ‹©å½“å‰æœ€ä¼˜çš„åŠ¨ä½œã€‚Îµ-è´ªå¿ƒæ³•åªéœ€è®°å½•æ¯ä¸ªåŠ¨ä½œçš„å½“å‰å¹³å‡å¥–èµå€¼ä¸è¢«é€‰ä¸­çš„æ¬¡æ•°ï¼Œä¾¿å¯ä»¥å¢é‡å¼æ›´æ–°ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYzUP.png" alt="iwYzUP.png" /></p>
<h4 id="1622-softmax"><a class="header" href="#1622-softmax"><strong>16.2.2 Softmax</strong></a></h4>
<p><strong>Softmaxç®—æ³•åˆ™åŸºäºå½“å‰æ¯ä¸ªåŠ¨ä½œçš„å¹³å‡å¥–èµå€¼æ¥å¯¹æ¢ç´¢å’Œåˆ©ç”¨è¿›è¡ŒæŠ˜ä¸­ï¼ŒSoftmaxå‡½æ•°å°†ä¸€ç»„å€¼è½¬åŒ–ä¸ºä¸€ç»„æ¦‚ç‡</strong>ï¼Œå€¼è¶Šå¤§å¯¹åº”çš„æ¦‚ç‡ä¹Ÿè¶Šé«˜ï¼Œå› æ­¤å½“å‰å¹³å‡å¥–èµå€¼è¶Šé«˜çš„åŠ¨ä½œè¢«é€‰ä¸­çš„å‡ ç‡ä¹Ÿè¶Šå¤§ã€‚Softmaxå‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYbge.png" alt="iwYbge.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwYqjH.png" alt="iwYqjH.png" /></p>
<h3 id="163-æœ‰æ¨¡å‹å­¦ä¹ "><a class="header" href="#163-æœ‰æ¨¡å‹å­¦ä¹ "><strong>16.3 æœ‰æ¨¡å‹å­¦ä¹ </strong></a></h3>
<p>è‹¥å­¦ä¹ ä»»åŠ¡ä¸­çš„å››ä¸ªè¦ç´ éƒ½å·²çŸ¥ï¼Œå³çŠ¶æ€ç©ºé—´ã€åŠ¨ä½œç©ºé—´ã€è½¬ç§»æ¦‚ç‡ä»¥åŠå¥–èµå‡½æ•°éƒ½å·²ç»ç»™å‡ºï¼Œè¿™æ ·çš„æƒ…å½¢ç§°ä¸ºâ€œ<strong>æœ‰æ¨¡å‹å­¦ä¹ </strong>â€ã€‚å‡è®¾çŠ¶æ€ç©ºé—´å’ŒåŠ¨ä½œç©ºé—´å‡ä¸ºæœ‰é™ï¼Œå³å‡ä¸ºç¦»æ•£å€¼ï¼Œè¿™æ ·æˆ‘ä»¬ä¸ç”¨é€šè¿‡å°è¯•ä¾¿å¯ä»¥å¯¹æŸä¸ªç­–ç•¥è¿›è¡Œè¯„ä¼°ã€‚</p>
<h4 id="1631-ç­–ç•¥è¯„ä¼°"><a class="header" href="#1631-ç­–ç•¥è¯„ä¼°"><strong>16.3.1 ç­–ç•¥è¯„ä¼°</strong></a></h4>
<p>å‰é¢æåˆ°ï¼š<strong>åœ¨æ¨¡å‹å·²çŸ¥çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä»»æ„ç­–ç•¥çš„è¿›è¡Œè¯„ä¼°</strong>ï¼ˆåç»­ä¼šç»™å‡ºæ¼”ç®—è¿‡ç¨‹ï¼‰ã€‚ä¸€èˆ¬å¸¸ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§å€¼å‡½æ•°æ¥è¯„ä¼°æŸä¸ªç­–ç•¥çš„ä¼˜åŠ£ï¼š</p>
<blockquote>
<p><strong>çŠ¶æ€å€¼å‡½æ•°ï¼ˆVï¼‰</strong>ï¼šVï¼ˆxï¼‰ï¼Œå³ä»çŠ¶æ€xå‡ºå‘ï¼Œä½¿ç”¨Ï€ç­–ç•¥æ‰€å¸¦æ¥çš„ç´¯ç§¯å¥–èµï¼›
<strong>çŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°ï¼ˆQï¼‰</strong>ï¼šQï¼ˆx,aï¼‰ï¼Œå³ä»çŠ¶æ€xå‡ºå‘ï¼Œæ‰§è¡ŒåŠ¨ä½œaåå†ä½¿ç”¨Ï€ç­–ç•¥æ‰€å¸¦æ¥çš„ç´¯ç§¯å¥–èµã€‚</p>
</blockquote>
<p>æ ¹æ®ç´¯ç§¯å¥–èµçš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥Tæ­¥ç´¯ç§¯å¥–èµä¸ræŠ˜æ‰£ç´¯ç§¯å¥–èµï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYjHI.png" alt="iwYjHI.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwYXDA.png" alt="iwYXDA.png" /></p>
<p>ç”±äºMDPå…·æœ‰é©¬å°”å¯å¤«æ€§ï¼Œå³ç°åœ¨å†³å®šæœªæ¥ï¼Œå°†æ¥å’Œè¿‡å»æ— å…³ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æ‰¾åˆ°å€¼å‡½æ•°çš„é€’å½’å…³ç³»ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtS4f.png" alt="iwtS4f.png" /></p>
<p>ç±»ä¼¼åœ°ï¼Œå¯¹äºræŠ˜æ‰£ç´¯ç§¯å¥–èµå¯ä»¥å¾—åˆ°ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwYxEt.png" alt="iwYxEt.png" /></p>
<p>æ˜“çŸ¥ï¼š<strong>å½“æ¨¡å‹å·²çŸ¥æ—¶ï¼Œç­–ç•¥çš„è¯„ä¼°é—®é¢˜è½¬åŒ–ä¸ºä¸€ç§åŠ¨æ€è§„åˆ’é—®é¢˜</strong>ï¼Œå³ä»¥å¡«è¡¨æ ¼çš„å½¢å¼è‡ªåº•å‘ä¸Šï¼Œå…ˆæ±‚è§£æ¯ä¸ªçŠ¶æ€çš„å•æ­¥ç´¯ç§¯å¥–èµï¼Œå†æ±‚è§£æ¯ä¸ªçŠ¶æ€çš„ä¸¤æ­¥ç´¯ç§¯å¥–èµï¼Œä¸€ç›´è¿­ä»£é€æ­¥æ±‚è§£å‡ºæ¯ä¸ªçŠ¶æ€çš„Tæ­¥ç´¯ç§¯å¥–èµã€‚ç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwt9C8.png" alt="iwt9C8.png" /></p>
<p>å¯¹äºçŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°ï¼Œåªéœ€é€šè¿‡ç®€å•çš„è½¬åŒ–ä¾¿å¯å¾—åˆ°ï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwt3r9.png" alt="iwt3r9.png" /></p>
<h4 id="1632-ç­–ç•¥æ”¹è¿›"><a class="header" href="#1632-ç­–ç•¥æ”¹è¿›"><strong>16.3.2 ç­–ç•¥æ”¹è¿›</strong></a></h4>
<p>ç†æƒ³çš„ç­–ç•¥åº”èƒ½ä½¿å¾—æ¯ä¸ªçŠ¶æ€çš„ç´¯ç§¯å¥–èµä¹‹å’Œæœ€å¤§ï¼Œç®€å•æ¥ç†è§£å°±æ˜¯ï¼šä¸ç®¡å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œåªè¦é€šè¿‡è¯¥ç­–ç•¥æ‰§è¡ŒåŠ¨ä½œï¼Œæ€»èƒ½å¾—åˆ°è¾ƒå¥½çš„ç»“æœã€‚å› æ­¤å¯¹äºç»™å®šçš„æŸä¸ªç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œæ”¹è¿›ï¼Œä»è€Œå¾—åˆ°<strong>æœ€ä¼˜çš„å€¼å‡½æ•°</strong>ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtm5V.png" alt="iwtm5V.png" />
<img src="https://s1.ax1x.com/2018/10/18/iwtZEq.png" alt="iwtZEq.png" /></p>
<p>æœ€ä¼˜Bellmanç­‰å¼æ”¹è¿›ç­–ç•¥çš„æ–¹å¼ä¸ºï¼š<strong>å°†ç­–ç•¥é€‰æ‹©çš„åŠ¨ä½œæ”¹ä¸ºå½“å‰æœ€ä¼˜çš„åŠ¨ä½œ</strong>ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰é‚£æ ·å¯¹æ¯ç§å¯èƒ½çš„åŠ¨ä½œè¿›è¡Œæ±‚å’Œã€‚æ˜“çŸ¥ï¼šé€‰æ‹©å½“å‰æœ€ä¼˜åŠ¨ä½œç›¸å½“äºå°†æ‰€æœ‰çš„æ¦‚ç‡éƒ½èµ‹ç»™ç´¯ç§¯å¥–èµå€¼æœ€å¤§çš„åŠ¨ä½œï¼Œå› æ­¤æ¯æ¬¡æ”¹è¿›éƒ½ä¼šä½¿å¾—å€¼å‡½æ•°å•è°ƒé€’å¢ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtEbn.png" alt="iwtEbn.png" /></p>
<p>å°†ç­–ç•¥è¯„ä¼°ä¸ç­–ç•¥æ”¹è¿›ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬ä¾¿å¾—åˆ°äº†ç”Ÿæˆæœ€ä¼˜ç­–ç•¥çš„æ–¹æ³•ï¼šå…ˆç»™å®šä¸€ä¸ªéšæœºç­–ç•¥ï¼Œç°å¯¹è¯¥ç­–ç•¥è¿›è¡Œè¯„ä¼°ï¼Œç„¶åå†æ”¹è¿›ï¼Œæ¥ç€å†è¯„ä¼°/æ”¹è¿›ä¸€ç›´åˆ°ç­–ç•¥æ”¶æ•›ã€ä¸å†å‘ç”Ÿæ”¹å˜ã€‚è¿™ä¾¿æ˜¯ç­–ç•¥è¿­ä»£ç®—æ³•ï¼Œç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwteU0.png" alt="iwteU0.png" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼šç­–ç•¥è¿­ä»£æ³•åœ¨æ¯æ¬¡æ”¹è¿›ç­–ç•¥åéƒ½è¦å¯¹ç­–ç•¥è¿›è¡Œé‡æ–°è¯„ä¼°ï¼Œå› æ­¤æ¯”è¾ƒè€—æ—¶ã€‚è‹¥ä»æœ€ä¼˜åŒ–å€¼å‡½æ•°çš„è§’åº¦å‡ºå‘ï¼Œå³å…ˆè¿­ä»£å¾—åˆ°æœ€ä¼˜çš„å€¼å‡½æ•°ï¼Œå†æ¥è®¡ç®—å¦‚ä½•æ”¹å˜ç­–ç•¥ï¼Œè¿™ä¾¿æ˜¯å€¼è¿­ä»£ç®—æ³•ï¼Œç®—æ³•æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtuCT.png" alt="iwtuCT.png" /></p>
<h3 id="164-è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ "><a class="header" href="#164-è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ "><strong>16.4 è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ </strong></a></h3>
<p>åœ¨ç°å®çš„å¼ºåŒ–å­¦ä¹ ä»»åŠ¡ä¸­ï¼Œ<strong>ç¯å¢ƒçš„è½¬ç§»å‡½æ•°ä¸å¥–èµå‡½æ•°å¾€å¾€å¾ˆéš¾å¾—çŸ¥</strong>ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è€ƒè™‘åœ¨ä¸ä¾èµ–äºç¯å¢ƒå‚æ•°çš„æ¡ä»¶ä¸‹å»ºç«‹å¼ºåŒ–å­¦ä¹ æ¨¡å‹ï¼Œè¿™ä¾¿æ˜¯<strong>å…æ¨¡å‹å­¦ä¹ </strong>ã€‚è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ ä¾¿æ˜¯å…¶ä¸­çš„ä¸€ç§ç»å…¸æ–¹æ³•ã€‚</p>
<p>ç”±äºæ¨¡å‹å‚æ•°æœªçŸ¥ï¼ŒçŠ¶æ€å€¼å‡½æ•°ä¸èƒ½åƒä¹‹å‰é‚£æ ·è¿›è¡Œå…¨æ¦‚ç‡å±•å¼€ï¼Œä»è€Œè¿ç”¨åŠ¨æ€è§„åˆ’æ³•æ±‚è§£ã€‚ä¸€ç§ç›´æ¥çš„æ–¹æ³•ä¾¿æ˜¯é€šè¿‡é‡‡æ ·æ¥å¯¹ç­–ç•¥è¿›è¡Œè¯„ä¼°/ä¼°ç®—å…¶å€¼å‡½æ•°ï¼Œ<strong>è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ æ­£æ˜¯åŸºäºé‡‡æ ·æ¥ä¼°è®¡çŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°</strong>ï¼šå¯¹é‡‡æ ·è½¨è¿¹ä¸­çš„æ¯ä¸€å¯¹çŠ¶æ€-åŠ¨ä½œï¼Œè®°å½•å…¶åçš„å¥–èµå€¼ä¹‹å’Œï¼Œä½œä¸ºè¯¥çŠ¶æ€-åŠ¨ä½œçš„ä¸€æ¬¡ç´¯ç§¯å¥–èµï¼Œé€šè¿‡å¤šæ¬¡é‡‡æ ·åï¼Œä½¿ç”¨ç´¯ç§¯å¥–èµçš„å¹³å‡ä½œä¸ºçŠ¶æ€-åŠ¨ä½œå€¼çš„ä¼°è®¡ï¼Œå¹¶<strong>å¼•å…¥Îµ-è´ªå¿ƒç­–ç•¥ä¿è¯é‡‡æ ·çš„å¤šæ ·æ€§</strong>ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwt1KJ.png" alt="iwt1KJ.png" /></p>
<p>åœ¨ä¸Šé¢çš„ç®—æ³•æµç¨‹ä¸­ï¼Œè¢«è¯„ä¼°å’Œè¢«æ”¹è¿›çš„éƒ½æ˜¯åŒä¸€ä¸ªç­–ç•¥ï¼Œå› æ­¤ç§°ä¸º<strong>åŒç­–ç•¥è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ ç®—æ³•</strong>ã€‚å¼•å…¥Îµ-è´ªå¿ƒä»…æ˜¯ä¸ºäº†ä¾¿äºé‡‡æ ·è¯„ä¼°ï¼Œè€Œåœ¨ä½¿ç”¨ç­–ç•¥æ—¶å¹¶ä¸éœ€è¦Îµ-è´ªå¿ƒï¼Œé‚£èƒ½å¦ä»…åœ¨è¯„ä¼°æ—¶ä½¿ç”¨Îµ-è´ªå¿ƒç­–ç•¥ï¼Œè€Œåœ¨æ”¹è¿›æ—¶ä½¿ç”¨åŸå§‹ç­–ç•¥å‘¢ï¼Ÿè¿™ä¾¿æ˜¯<strong>å¼‚ç­–ç•¥è’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ ç®—æ³•</strong>ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtK8U.png" alt="iwtK8U.png" /></p>
<h3 id="165-alphagoåŸç†æµ…æ"><a class="header" href="#165-alphagoåŸç†æµ…æ"><strong>16.5 AlphaGoåŸç†æµ…æ</strong></a></h3>
<p>æœ¬ç¯‡ä¸€å¼€å§‹ä¾¿æåˆ°å¼ºåŒ–å­¦ä¹ æ˜¯AlphaGoçš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œåˆšå¥½å€Ÿç€è¿™ä¸ªä¸œé£å°†AlphaGoçš„å·¥ä½œåŸç†äº†è§£ä¸€ç•ªã€‚æ­£å¦‚äººç±»ä¸‹æ£‹é‚£èˆ¬â€œ<strong>æ‰‹ä¸‹ä¸€æ­¥æ£‹ï¼Œå¿ƒæƒ³ä¸‰æ­¥æ£‹</strong>â€ï¼ŒAlphagoä¹Ÿæ­£æ˜¯è¿™ä¸ªæ€æƒ³ï¼Œ<strong>å½“å¤„äºä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œæœºå™¨ä¼šæš—åœ°é‡Œè¿›è¡Œå¤šæ¬¡çš„å°è¯•/é‡‡æ ·ï¼Œå¹¶åŸºäºåé¦ˆå›æ¥çš„ç»“æœä¿¡æ¯æ”¹è¿›ä¼°å€¼å‡½æ•°ï¼Œä»è€Œæœ€ç»ˆé€šè¿‡å¢å¼ºç‰ˆçš„ä¼°å€¼å‡½æ•°æ¥é€‰æ‹©æœ€ä¼˜çš„è½å­åŠ¨ä½œã€‚</strong></p>
<p>å…¶ä¸­ä¾¿æ¶‰åŠåˆ°äº†ä¸‰ä¸ªä¸»è¦çš„é—®é¢˜ï¼š<strong>ï¼ˆ1ï¼‰å¦‚ä½•ç¡®å®šä¼°å€¼å‡½æ•°ï¼ˆ2ï¼‰å¦‚ä½•è¿›è¡Œé‡‡æ ·ï¼ˆ3ï¼‰å¦‚ä½•åŸºäºåé¦ˆä¿¡æ¯æ”¹è¿›ä¼°å€¼å‡½æ•°</strong>ï¼Œè¿™æ­£å¯¹åº”ç€AlphaGoçš„ä¸‰å¤§æ ¸å¿ƒæ¨¡å—ï¼š<strong>æ·±åº¦å­¦ä¹ </strong>ã€<strong>è’™ç‰¹å¡ç½—æœç´¢æ ‘</strong>ã€<strong>å¼ºåŒ–å­¦ä¹ </strong>ã€‚</p>
<blockquote>
<p><strong>1.æ·±åº¦å­¦ä¹ ï¼ˆæ‹Ÿåˆä¼°å€¼å‡½æ•°ï¼‰</strong></p>
</blockquote>
<p>ç”±äºå›´æ£‹çš„çŠ¶æ€ç©ºé—´å·¨å¤§ï¼Œåƒè’™ç‰¹å¡ç½—å¼ºåŒ–å­¦ä¹ é‚£æ ·é€šè¿‡é‡‡æ ·æ¥ç¡®å®šå€¼å‡½æ•°å°±è¡Œä¸é€šäº†ã€‚åœ¨å›´æ£‹ä¸­ï¼Œ<strong>çŠ¶æ€å€¼å‡½æ•°å¯ä»¥çœ‹ä½œä¸ºä¸€ç§å±€é¢å‡½æ•°ï¼ŒçŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°å¯ä»¥çœ‹ä½œä¸€ç§ç­–ç•¥å‡½æ•°</strong>ï¼Œè‹¥æˆ‘ä»¬èƒ½è·å¾—è¿™ä¸¤ä¸ªä¼°å€¼å‡½æ•°ï¼Œä¾¿å¯ä»¥æ ¹æ®è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆï¼š(1)è¡¡é‡å½“å‰å±€é¢çš„ä»·å€¼ï¼›(2)é€‰æ‹©å½“å‰æœ€ä¼˜çš„åŠ¨ä½œã€‚é‚£å¦‚ä½•ç²¾ç¡®åœ°ä¼°è®¡è¿™ä¸¤ä¸ªä¼°å€¼å‡½æ•°å‘¢ï¼Ÿ<strong>è¿™å°±ç”¨åˆ°äº†æ·±åº¦å­¦ä¹ ï¼Œé€šè¿‡å¤§é‡çš„å¯¹å¼ˆæ•°æ®è‡ªåŠ¨å­¦ä¹ å‡ºç‰¹å¾ï¼Œä»è€Œæ‹Ÿåˆå‡ºä¼°å€¼å‡½æ•°ã€‚</strong></p>
<blockquote>
<p><strong>2.è’™ç‰¹å¡ç½—æœç´¢æ ‘ï¼ˆé‡‡æ ·ï¼‰</strong></p>
</blockquote>
<p>è’™ç‰¹å¡ç½—æ ‘æ˜¯ä¸€ç§ç»å…¸çš„æœç´¢æ¡†æ¶ï¼Œå®ƒé€šè¿‡åå¤åœ°é‡‡æ ·æ¨¡æ‹Ÿå¯¹å±€æ¥æ¢ç´¢çŠ¶æ€ç©ºé—´ã€‚å…·ä½“è¡¨ç°åœ¨ï¼šä»å½“å‰çŠ¶æ€å¼€å§‹ï¼Œåˆ©ç”¨ç­–ç•¥å‡½æ•°å°½å¯èƒ½é€‰æ‹©å½“å‰æœ€ä¼˜çš„åŠ¨ä½œï¼ŒåŒæ—¶ä¹Ÿå¼•å…¥éšæœºæ€§æ¥å‡å°ä¼°å€¼é”™è¯¯å¸¦æ¥çš„è´Ÿé¢å½±å“ï¼Œä»è€Œæ¨¡æ‹Ÿæ£‹å±€è¿è¡Œï¼Œä½¿å¾—æ£‹ç›˜è¾¾åˆ°ç»ˆå±€æˆ–ä¸€å®šæ­¥æ•°ååœæ­¢ã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtM2F.png" alt="iwtM2F.png" /></p>
<blockquote>
<p><strong>3.å¼ºåŒ–å­¦ä¹ ï¼ˆè°ƒæ•´ä¼°å€¼å‡½æ•°ï¼‰</strong></p>
</blockquote>
<p>åœ¨ä½¿ç”¨è’™ç‰¹å¡ç½—æœç´¢æ ‘è¿›è¡Œå¤šæ¬¡é‡‡æ ·åï¼Œæ¯æ¬¡é‡‡æ ·éƒ½ä¼šåé¦ˆåç»­çš„å±€é¢ä¿¡æ¯ï¼ˆåˆ©ç”¨å±€é¢å‡½æ•°è¿›è¡Œè¯„ä»·ï¼‰ï¼Œæ ¹æ®åé¦ˆå›æ¥çš„ç»“æœä¿¡æ¯è‡ªåŠ¨è°ƒæ•´ä¸¤ä¸ªä¼°å€¼å‡½æ•°çš„å‚æ•°ï¼Œè¿™ä¾¿æ˜¯å¼ºåŒ–å­¦ä¹ çš„æ ¸å¿ƒæ€æƒ³ï¼Œæœ€ååŸºäºæ”¹è¿›åçš„ç­–ç•¥å‡½æ•°é€‰æ‹©å‡ºå½“å‰æœ€ä¼˜çš„è½å­åŠ¨ä½œã€‚</p>
<p><img src="https://s1.ax1x.com/2018/10/18/iwtQv4.png" alt="iwtQv4.png" /></p>
<h2 id="ç†µäº¤å‰ç†µå’Œklæ•£åº¦"><a class="header" href="#ç†µäº¤å‰ç†µå’Œklæ•£åº¦">ç†µã€äº¤å‰ç†µå’ŒKLæ•£åº¦</a></h2>
<p><strong>ç†µ</strong>(Entropy)çš„ä»‹ç»<br />
æˆ‘ä»¬ä»¥å¤©æ°”é¢„æŠ¥ä¸ºä¾‹å­ï¼Œè¿›è¡Œç†µçš„ä»‹ç»ï¼</p>
<ul>
<li>
<p>å‡å¦‚åªæœ‰ <strong>2 ç§</strong>å¤©æ°”ï¼Œsunny å’Œ rainy ï¼Œé‚£ä¹ˆæ˜å¤©å¯¹äºæ¯ä¸€ç§å¤©æ°”æ¥è¯´ï¼Œå„æœ‰ 50% çš„å¯èƒ½æ€§ï¼</p>
</li>
<li>
<p>æ­¤æ—¶æ°”è±¡éƒ¨é—¨å‘Šè¯‰ä½ æ˜å¤©æ˜¯rainyï¼Œä»–å…¶å®å‡å°‘äº†ä½ çš„<strong>ä¸ç¡®å®šä¿¡æ¯</strong>ï¼</p>
</li>
<li>
<p>æ‰€ä»¥ï¼Œå¤©æ°”éƒ¨é—¨ç»™äº†ä½  <strong>1 bit</strong>çš„<strong>æœ‰æ•ˆä¿¡æ¯</strong>(å› ä¸ºæ­¤æ—¶åªæœ‰ä¸¤ç§å¯èƒ½æ€§)ï¼</p>
</li>
<li>
<p>å‡å¦‚åªæœ‰8ç§å¤©æ°”ï¼Œæ¯ä¸€ç§å¤©æ°”å‡ºç°æ˜¯<strong>ç­‰å¯èƒ½çš„</strong>ï¼</p>
</li>
<li>
<p>æ­¤æ—¶æ°”è±¡éƒ¨é—¨å‘Šè¯‰ä½ æ˜å¤©æ˜¯ Rainy ï¼Œä»–å…¶å®å‡å°‘äº†ä½ çš„ä¸ç¡®å®šä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰äº†ä½ æœ‰æ•ˆä¿¡æ¯ï¼</p>
</li>
<li>
<p>æ‰€ä»¥ï¼Œå¤©æ°”éƒ¨é—¨ç»™äº†ä½  <strong>3 bit</strong>çš„æœ‰æ•ˆä¿¡æ¯(å› ä¸º8ç§çŠ¶æ€éœ€è¦ 2^3=8 ï¼Œéœ€è¦ 3 bitæ¥è¡¨ç¤ºï¼</p>
</li>
<li>
<p>æ‰€ä»¥ï¼Œæœ‰æ•ˆä¿¡æ¯çš„è®¡ç®—å¯ä»¥ä½¿ç”¨ log æ¥è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹
$$
\begin{array}{l}
2^{3}=8 \
\log _{2}(8)=3
\end{array}
$$</p>
</li>
<li>
<p>ä¸Šé¢æ‰€æœ‰çš„æƒ…å†µéƒ½æ˜¯ç­‰æ¦‚ç‡å‡ºç°çš„ï¼Œå‡è®¾å„ç§æƒ…å†µå‡ºç°çš„<strong>æ¦‚ç‡ä¸æ˜¯ç›¸ç­‰</strong>çš„ï¼</p>
</li>
<li>
<p>ä¾‹å¦‚æœ‰75%çš„å¯èƒ½æ€§æ˜¯Sunnyï¼Œ25%çš„å¯èƒ½æ€§æ˜¯Rainyï¼</p>
</li>
<li>
<p>å¦‚æœæ°”è±¡éƒ¨é—¨å‘Šè¯‰ä½ æ˜å¤©æ˜¯Rainy</p>
<ul>
<li>æˆ‘ä»¬ä¼šä½¿ç”¨<strong>æ¦‚ç‡çš„å€’æ•°</strong>ï¼Œ $1 / 0.25=4$ (æ¦‚ç‡è¶Šå°ï¼Œæœ‰æ•ˆä¿¡æ¯è¶Šå¤š)</li>
<li>æ¥ç€è®¡ç®—æœ‰æ•ˆä¿¡æ¯ï¼Œ $\log 2(1 / 0.25)=2=(-\log 2(0.25)$ ï¼Œlogçš„ç­‰ä»·è®¡ç®—)</li>
<li>å› ä¸ºå’Œæœ¬æ¥çš„æ¦‚ç‡ç›¸å·®æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥è·å¾—çš„æœ‰æ•ˆä¿¡æ¯æ¯”è¾ƒå¤š(æœ¬æ¥æ˜¯ Rainy çš„å¯èƒ½æ€§å°)</li>
</ul>
</li>
<li>
<p>å¦‚æœæ°”è±¡éƒ¨é—¨å‘Šè¯‰ä½ æ˜å¤©æ˜¯ Sunny</p>
<ul>
<li>åŒæ ·è®¡ç®—æ­¤æ—¶çš„æœ‰æ•ˆä¿¡æ¯ï¼Œ $\log 2(1 / 0.75)=-\log 2(0.75)=0.41$</li>
<li>å› ä¸ºå’Œæœ¬æ¥çš„æ¦‚ç‡ç›¸å·®æ¯”è¾ƒå°ï¼Œæ‰€ä»¥è·å¾—çš„ä¿¡æ¯æ¯”è¾ƒå°‘(æœ¬æ¥æ˜¯ Sunny çš„å¯èƒ½æ€§å¤§)</li>
</ul>
</li>
<li>
<p>ä»æ°”è±¡éƒ¨é—¨è·å¾—çš„ä¿¡æ¯çš„å¹³å‡å€¼(è¿™ä¸ªå°±æ˜¯<strong>ç†µ</strong></p>
<ul>
<li>ç®€å•è§£é‡Š: æœ‰ 75% çš„å¯èƒ½æ€§æ˜¯Sunny ï¼Œå¾—åˆ°æ™´å¤©çš„æœ‰æ•ˆä¿¡æ¯æ˜¯ 0.41 ï¼Œæ‰€ä»¥æ˜¯
$$
0.75* 0.41
$$</li>
</ul>
</li>
<li>
<p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†<strong>ç†µçš„è®¡ç®—å…¬å¼</strong>.</p>
<ul>
<li>ç†µæ˜¯ç”¨æ¥è¡¡é‡è·å–çš„ä¿¡æ¯çš„å¹³å‡å€¼ï¼Œæ²¡æœ‰è·å–ä»€ä¹ˆä¿¡æ¯é‡ï¼Œåˆ™ Entropy æ¥è¿‘ 0 ï¼</li>
<li>ä¸‹é¢æ˜¯ç†µçš„è®¡ç®—å…¬å¼
$$
\mathrm{H}(\mathbf{p})=-\Sigma_{i} p_{i} \log <em>{2}\left(p</em>{i}\right)
$$</li>
</ul>
</li>
</ul>
<p><strong>äº¤å‰ç†µ</strong>(Cross-Entropy)çš„ä»‹ç»<br />
å¯¹äºäº¤å‰ç†µçš„ä»‹ç»ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥å¤©æ°”é¢„æŠ¥ä½œä¸ºä¾‹å­æ¥è¿›è¡Œè®²è§£ï¼</p>
<ul>
<li>äº¤å‰ç†µ(Cross-Entropy)å¯ä»¥ç†è§£ä¸ºå¹³å‡çš„ message length ï¼Œå³<strong>å¹³å‡ä¿¡æ¯é•¿åº¦</strong>ï¼</li>
<li>ç°åœ¨æœ‰ 8 ç§å¤©æ°”ï¼Œäºæ˜¯æ¯ä¸€ç§å¤©æ°”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ 3 bit æ¥è¿›è¡Œè¡¨ç¤ºï¼ˆ000ï¼Œ001ï¼Œ010ï¼Œ011...ï¼‰</li>
<li>æ­¤æ—¶ average message length = 3 ï¼Œæ‰€ä»¥æ­¤æ—¶Cross-Entropy $=3$</li>
</ul>
<p>ç°åœ¨å‡è®¾ä½ ä½åœ¨ä¸€ä¸ª sunny region ï¼Œå‡ºç°æ™´å¤©çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§(<strong>å³æ¯ä¸€ç§å¤©æ°”ä¸æ˜¯ç­‰å¯èƒ½å‡ºç°çš„</strong>)ï¼Œä¸‹å›¾æ˜¯æ¯ä¸€ç§å¤©æ°”çš„æ¦‚ç‡ï¼</p>
<p><img src="ml/img/1.PNG" alt="1" /></p>
<p>æˆ‘ä»¬æ¥è®¡ç®—ä¸€ä¸‹æ­¤æ—¶çš„ç†µ(ntropy) ï¼Œè®¡ç®—çš„å¼å­å¦‚ä¸‹æ‰€ç¤ºï¼š
$$
\begin{array}{l}
Entropy\
=-0.35 \log <em>{2}(0.35)-\ldots-0.01 \log</em>{2}(0.01) \
=2.23 \mathrm{bits}
\end{array}
$$</p>
<ul>
<li>æ­¤æ—¶æœ‰æ•ˆçš„ä¿¡æ¯æ˜¯ 2.23 bitï¼</li>
<li>æ‰€ä»¥å†ä½¿ç”¨ä¸Šé¢çš„ç¼–ç æ–¹å¼(éƒ½ä½¿ç”¨ 3 $\mathrm{bit})$ ä¼šæœ‰å’’ä½™ï¼</li>
<li>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ¯æ¬¡å‘å‡º 3 bit ï¼Œæ¥æ”¶è€…æœ‰æ•ˆä¿¡æ¯ä¸º2.23 bitï¼</li>
<li>è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å¤©æ°”çš„ <strong>encode çš„æ–¹å¼</strong>ï¼Œå¯ä»¥ç»™ç»å¸¸å‡ºç°çš„å¤©æ°”æ¯”è¾ƒå°çš„ code æ¥è¿›è¡Œè¡¨ç¤ºï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹å›¾å¯¹æ¯ä¸€ç§å¤©æ°”è¿›è¡Œ encode ï¼</li>
</ul>
<p><img src="ml/img/2.PNG" alt="2" /></p>
<p>æ­¤æ—¶çš„å¹³å‡é•¿åº¦çš„è®¡ç®—å¦‚ä¸‹æ‰€ç¤º(æ¯ä¸€ç§å¤©æ°”çš„æ¦‚ç‡è¯¥å¤©æ°”codeçš„é•¿åº¦)ï¼š
$$
\begin{array}{l}
35 % \times 2+35 % \times 2+10 % \times 3 \
+10 % \times 3+4 % \times 4+4 % \times 4 \
+1 % \times 5+1 % \times 5\
=2.42 \text { bits }
\end{array}
$$
æ­¤æ—¶çš„å¹³å‡é•¿åº¦ä¸º 2.42 bitï¼Œå¯ä»¥çœ‹åˆ°æ¯”ä¸€å¼€å§‹çš„ 3 bitæœ‰æ‰€å‡å°‘ï¼</p>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ code ï¼Œä½†æ˜¯æ­¤æ—¶å¯¹åº”çš„å¤©æ°”çš„æ¦‚ç‡æ˜¯ä¸ç›¸åŒçš„ï¼Œæ­¤æ—¶è®¡ç®—å‡ºçš„å¹³å‡é•¿åº¦å°±ä¼šå‘ç”Ÿæ”¹å˜ï¼æ­¤æ—¶æ¯ä¸€ç§å¤©æ°”çš„æ¦‚ç‡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="ml/img/3.PNG" alt="3" /></p>
<p>äºæ˜¯æ­¤æ—¶çš„ä¿¡æ¯çš„å¹³å‡é•¿åº¦å°±æ˜¯ 4.58 bit ï¼Œæ¯” Entropy å¤§å¾ˆå¤š (å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ç»™äº†æ¦‚ç‡å¾ˆå°çš„å¤© æ°”çš„ code ä¹Ÿå¾ˆå°ï¼Œæ¦‚ç‡å¾ˆå¤§çš„å¤©æ°”çš„ code ä¹Ÿå¾ˆå¤§ï¼Œæ­¤æ—¶å°±ä¼šå¯¼è‡´è®¡ç®—å‡ºçš„å¹³å‡é•¿åº¦å¾ˆå¤§)ï¼Œä¸‹é¢æ˜¯å¹³å‡é•¿åº¦çš„è®¡ç®—çš„å¼å­ï¼
$$
\begin{array}{l}
1 % \times 2+1 % \times 2+4 % \times 3+ \
4 % \times 3+10 % \times 4+10 % \times 4 \
+35 % \times 5+35 % \times 5\
=4.58 \mathrm{bits}
\end{array}
$$
æˆ‘ä»¬å¦‚ä½•æ¥ç†è§£æˆ‘ä»¬ç»™æ¯ä¸€ç§å¤©æ°”çš„ code å‘¢ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºè¿™å°±æ˜¯æˆ‘ä»¬å¯¹æ¯ä¸€ç§å¤©æ°”å‘ç”Ÿçš„å¯èƒ½æ€§çš„é¢„æµ‹ï¼Œæˆ‘ä»¬ä¼šç»™å‡ºç°æ¦‚ç‡æ¯”è¾ƒå¤§çš„å¤©æ°”æ¯”è¾ƒçŸ­çš„ code ï¼Œè¿™é‡Œçš„æ¦‚ç‡æ˜¯æˆ‘ä»¬å‡è®¾çš„ï¼Œå³<strong>æˆ‘ä»¬æœ‰ä¸€ä¸ªä¼°è®¡çš„æ¦‚ç‡</strong>ï¼Œæˆ‘ä»¬ä¼°è®¡è¿™ä¸ªå¤©æ°”çš„æ¦‚ç‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ç»™è¿™ä¸ªå¤©æ°”æ¯”è¾ƒçŸ­çš„ codeï¼</p>
<p>ä¸‹å›¾ä¸­å¯ä»¥è¡¨ç¤ºå‡ºæˆ‘ä»¬<strong>é¢„æµ‹çš„q</strong>(predicted distribution)å’Œ<strong>çœŸå®åˆ†å¸ƒp</strong>(true distribution)ï¼å¯ä»¥çœ‹åˆ°æ­¤æ—¶æˆ‘ä»¬çš„é¢„æµ‹æ¦‚ç‡ $q$ ä¸çœŸå®åˆ†å¸ƒ $p$ ä¹‹é—´ç›¸å·®å¾ˆå¤§(æ­¤æ—¶è®¡ç®—å‡ºçš„äº¤å‰ç†µå°±ä¼šæ¯”è¾ƒå¤§)</p>
<p><img src="ml/img/4.PNG" alt="4" /></p>
<p>å…³äºä¸Šé¢ code é•¿åº¦ä¸æ¦‚ç‡çš„è½¬æ¢ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ¥è¿›è¡Œç†è§£ï¼Œå¯¹äºæ¦‚ç‡ä¸º $p$ çš„ä¿¡æ¯ï¼Œä»–çš„æœ‰æ•ˆä¿¡æ¯ä¸º $-log2(p)$ ï¼è‹¥æ­¤æ—¶ code é•¿åº¦ä¸º $n$ ï¼Œæˆ‘ä»¬é—®æ¦‚ç‡ä¸ºå¤šå°‘çš„ä¿¡æ¯çš„æœ‰æ•ˆä¿¡æ¯ä¸º n ï¼Œå³æ±‚è§£ $-log2(p)=n$ ï¼Œåˆ™ $\mathrm{p}=1 / 2^{\wedge} \mathrm{n}$ ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡º $\mathrm{code}$ é•¿åº¦ä¸æ¦‚ç‡çš„è½¬æ¢ï¼æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰<strong>äº¤å‰ç†µ</strong>(Cross-Entropy)ï¼Œè¿™é‡Œä¼šæœ‰ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯p(çœŸå®çš„åˆ†å¸ƒ)å’Œ
q(é¢„æµ‹çš„æ¦‚ç‡):
$$
\mathrm{H}(\mathrm{p}, \mathrm{q})=-\Sigma_{\mathrm{i}} p_{i} \log <em>{2}\left(q</em>{i}\right)
$$
è¿™ä¸ªäº¤å‰ç†µå…¬å¼çš„æ„æ€å°±æ˜¯åœ¨è®¡ç®—æ¶ˆæ¯çš„å¹³å‡é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥è¿›è¡Œç†è§£ï¼</p>
<ul>
<li>$-\log 2(\mathrm{q})$ æ˜¯å°†é¢„æµ‹æ¦‚ç‡è½¬æ¢ä¸º code çš„é•¿åº¦(è¿™é‡Œçœ‹ä¸Šé¢ code é•¿åº¦ä¸æ¦‚ç‡çš„è½¬æ¢)</li>
<li>æ¥ç€æˆ‘ä»¬å†å°† code çš„é•¿åº¦ $(-log2(q))$ ä¹˜ä¸Šå‡ºç°çš„æ¦‚ç‡ $\mathrm{p}($ çœŸå®çš„æ¦‚ç‡ $)$</li>
</ul>
<p>æˆ‘ä»¬ç®€å•è¯´æ˜ä¸€ä¸‹ç†µ(Entropy),å’Œäº¤å‰ç†µ(Cross-Entropy)çš„æ€§è´¨ï¼š</p>
<ul>
<li>å¦‚æœé¢„æµ‹ç»“æœæ˜¯å¥½çš„,ï¼Œé‚£ä¹ˆ p å’Œ q çš„åˆ†å¸ƒæ˜¯ç›¸ä¼¼çš„ï¼Œæ­¤æ—¶ Cross-Entropy ä¸ Entropy æ˜¯ç›¸ä¼¼
çš„ï¼</li>
<li>å¦‚æœ p å’Œ q æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œé‚£ä¹ˆ Cross-Entropy ä¼šæ¯” Entropy å¤§ï¼</li>
<li>å…¶ä¸­ Cross-Entropy æ¯” Entropy å¤§çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ç§°ä¸º relative entropy ï¼Œæˆ–æ˜¯Kullback-
Leibler Divergence(KL Divergence)ï¼Œè¿™ä¸ªå°±æ˜¯<strong>KL-æ•£åº¦</strong>ï¼Œæˆ‘ä»¬ä¼šåœ¨åé¢è¿›è¡Œè¯¦ç»†çš„ä»‹
ç»ï¼</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‰è€…çš„å…³ç³»ä¸ºï¼š<strong>Cross-Entropy=Entropy+ KL Divergence</strong></li>
</ul>
<p>åœ¨è¿›è¡Œ<strong>åˆ†ç±»</strong>é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°† loss å‡½æ•°è®¾ç½®ä¸ºäº¤å‰ç†µ(Cross-Entropy)ï¼Œå…¶å®ç°åœ¨æ¥çœ‹è¿™ä¸ªä¹Ÿæ˜¯å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä¼šæœ‰æˆ‘ä»¬é¢„æµ‹çš„æ¦‚ç‡ q å’Œå®é™…çš„æ¦‚ç‡ p ï¼Œè‹¥ p å’Œ q ç›¸ä¼¼ï¼Œåˆ™äº¤å‰ç†µå°ï¼Œè‹¥ p å’Œ q ä¸ç›¸ä¼¼ï¼Œåˆ™äº¤å‰ç†µå¤§ï¼</p>
<p>æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šä½¿ç”¨ 10 ä¸ºåº•çš„ log ï¼Œä½†æ˜¯è¿™ä¸ªä¸å½±å“ ï¼Œå› ä¸º $log2(x)=log10(x)/log(2)$ ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¬å¼è¿›è¡Œè½¬æ¢ï¼</p>
<p>åœ¨ PyTorch ä¸­ï¼ŒCrossEntropyLoss ä¸æ˜¯ç›´æ¥æŒ‰ç…§ä¸Šé¢è¿›è¡Œè®¡ç®—çš„ï¼Œä»–æ˜¯åŒ…å«äº† Softmax çš„æ­¥éª¤çš„ï¼å…³äºåœ¨ PyTorch ä¸­ CrossEntropyLoss çš„å®é™…è®¡ç®—ï¼š<br />
<a href="https://mathpretty.com/12068.html">è¯¦ç»†ä»‹ç»:PyTorchä¸­äº¤å‰ç†µçš„è®¡ç®—CrossEntropyLoss</a></p>
<h3 id="äº¤å‰ç†µæŸå¤±å‡½æ•°"><a class="header" href="#äº¤å‰ç†µæŸå¤±å‡½æ•°">äº¤å‰ç†µæŸå¤±å‡½æ•°</a></h3>
<p>äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆCross-Entropy Loss Functionï¼‰ä¸€èˆ¬ç”¨äºåˆ†ç±»é—®é¢˜ï¼å‡è®¾æ ·æœ¬çš„æ ‡ç­¾ ğ‘¦ âˆˆ {1,â‹¯,ğ¶} ä¸ºç¦»æ•£çš„ç±»åˆ«ï¼Œæ¨¡å‹ $f(x;\theta) \in[0,1]^ğ¶$çš„è¾“å‡ºä¸ºç±»åˆ«æ ‡ç­¾çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒï¼Œå³
$$p(y = c|x;\theta) = f_c(x;\theta),$$<br />
å¹¶æ»¡è¶³
$$f_c(x;\theta) \in [0,1],\qquad \sum_{c=1}^C f_c(x;\theta) = 1.$$<br />
æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª $C$ ç»´çš„one-hotå‘é‡ $y$ æ¥è¡¨ç¤ºæ ·æœ¬æ ‡ç­¾ï¼å‡è®¾æ ·æœ¬çš„æ ‡ç­¾ä¸º $k$ ï¼Œé‚£ä¹ˆæ ‡ç­¾å‘é‡åªæœ‰ç¬¬ $k$ ç»´çš„å€¼ä¸º 1 ï¼Œå…¶ä½™å…ƒç´ çš„å€¼éƒ½ä¸º 0 ï¼æ ‡ç­¾å‘é‡ $y$ å¯ä»¥çœ‹ä½œæ ·æœ¬æ ‡ç­¾çš„çœŸå®æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $p_r(ğ’š|ğ’™)$ ï¼Œå³ç¬¬ $c$ ç»´ï¼ˆè®°ä¸º $y_c, 1\leq c\leq C$ï¼‰ æ˜¯ç±»åˆ«ä¸º $c$ çš„çœŸå®æ¡ä»¶æ¦‚ç‡ï¼å‡è®¾æ ·æœ¬çš„ç±»åˆ«ä¸º $k$ ï¼Œé‚£ä¹ˆå®ƒå±äºç¬¬ $k$ ç±»çš„æ¦‚ç‡ä¸º 1 ï¼Œå±äºå…¶ä»–ç±»çš„æ¦‚ç‡ä¸º 0 .<br />
å¯¹äºä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œä¸€èˆ¬å¯ä»¥ç”¨äº¤å‰ç†µæ¥è¡¡é‡å®ƒä»¬çš„å·®å¼‚ï¼æ ‡ç­¾çš„çœŸå®åˆ†å¸ƒ $y$ å’Œæ¨¡å‹é¢„æµ‹åˆ†å¸ƒ $f(x;\theta)$ ä¹‹é—´çš„äº¤å‰ç†µä¸º<br />
$$
\begin{aligned}
L(y,f(x;\theta)) &amp;= -y^T \log f(x;\theta)\
&amp;=-\sum_{c=1}^C y_c \log f_c(x;\theta)
\end{aligned}
$$
æ¯”å¦‚å¯¹äºä¸‰åˆ†ç±»é—®é¢˜ï¼Œä¸€ä¸ªæ ·æœ¬çš„æ ‡ç­¾å‘é‡ä¸º$y = [0,0,1]^T$ï¼Œæ¨¡å‹é¢„æµ‹çš„æ ‡ç­¾åˆ†å¸ƒä¸º$f(x;\theta) = [0.3,0.3,0.4]^T$ï¼Œåˆ™å®ƒä»¬çš„äº¤å‰ç†µä¸º$-(0 \times \log (0.3)+0\times \log(0.3) + 1\times \log(0.4)) = -\log(0.4)$.<br />
å› ä¸º $y$ ä¸ºone-hotå‘é‡ï¼Œä¸Šå¼ä¹Ÿå¯ä»¥å†™ä¸º<br />
$$
L(y,f(x;\theta)) = -\log f_y(x;\theta),
$$
å…¶ä¸­ $f_y(x;\theta)$ å¯ä»¥çœ‹ä½œçœŸå®ç±»åˆ« $y$ çš„ä¼¼ç„¶å‡½æ•°ï¼å› æ­¤ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°ä¹Ÿå°±æ˜¯<strong>è´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°</strong>ï¼ˆNegative Log-Likelihoodï¼‰ï¼</p>
<h4 id="äº¤å‰ç†µæœ€å°å€¼è¯æ˜"><a class="header" href="#äº¤å‰ç†µæœ€å°å€¼è¯æ˜">äº¤å‰ç†µæœ€å°å€¼è¯æ˜</a></h4>
<p>$H(p, q)=-\sum_{i} p_{i} \ln q_{i}$ ä¸ºä»€ä¹ˆå½“ $p$ ä¸ $q$ çš„åˆ†å¸ƒä¸€è‡´æ—¶, $H(p, q)$ æœ‰æœ€å°å€¼:</p>
<p>è¯æ˜å¦‚ä¸‹:
$$
H(p, p)-H(p, q)=\sum_{i} p_{i} \ln q_{i}-\sum_{i} p_{i} \ln p_{i}=\sum_{i} p_{i} \ln \frac{q_{i}}{p_{i}}
$$
å› ä¸º $\ln (x)$ ä¸ºå®šä¹‰åŸŸä¸Šçš„å‡¸å‡½æ•°
æ ¹æ®ç´ç”Ÿä¸ç­‰å¼æœ‰
$$
a_{1} \ln \left(x_{1}\right)+a_{2} \ln \left(x_{2}\right)+a_{3} \ln \left(x_{3}\right)+\ldots+a_{n} \ln \left(x_{n}\right)&lt;=\ln \left(a_{1} x_{1}+a_{2} x_{2}+\ldots+a_{n} x_{n}\right)
$$
å…¶ä¸­$\left(\sum_{i} a_{i}=1\right)$</p>
<p>å°† $\sum_{i} p_{i} \ln \frac{q_{i}}{p_{i}}$ ä»£å…¥åˆ™æœ‰:
$$
\begin{aligned}
p_{1} l n\left(\frac{p_{1}}{q_{1}}\right)+p_{2} \ln \left(\frac{p_{2}}{q_{2}}\right)+\ldots+p_{n} \ln \left(\frac{p_{n}}{q_{n}}\right)&amp;\leq\ln \left(p_{1} \frac{q_{1}}{p_{1}}+p_{2} \frac{q_{2}}{p_{2}}+\ldots+p_{n} \frac{q_{n}}{p_{n}}\right)\
\sum_{i} p_{i} \ln \frac{q_{i}}{p_{i}}&amp;\leq \ln \left(q_{1}+q_{2}+\ldots+q_{n}\right)\
&amp;=0
\end{aligned}
$$
æ‰€ä»¥
$$
H(p, p)-H(p, q)&lt;=0
$$
å½“ $p=q$ æ—¶, ç­‰å·æˆç«‹.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å¼ºåŒ–å­¦ä¹ åŸºç¡€"><a class="header" href="#å¼ºåŒ–å­¦ä¹ åŸºç¡€">å¼ºåŒ–å­¦ä¹ åŸºç¡€</a></h1>
<h2 id="ä¸€-æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£"><a class="header" href="#ä¸€-æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£">ä¸€ï¼ æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£</a></h2>
<h3 id="11-åº¦é‡ç©ºé—´ä¸å‹ç¼©æ˜ å°„"><a class="header" href="#11-åº¦é‡ç©ºé—´ä¸å‹ç¼©æ˜ å°„">1.1 åº¦é‡ç©ºé—´ä¸å‹ç¼©æ˜ å°„</a></h3>
<h4 id="111-åº¦é‡ç©ºé—´åŠå…¶å®Œå¤‡æ€§"><a class="header" href="#111-åº¦é‡ç©ºé—´åŠå…¶å®Œå¤‡æ€§">1.1.1 åº¦é‡ç©ºé—´åŠå…¶å®Œå¤‡æ€§</a></h4>
<p><strong>åº¦é‡</strong> ( metricï¼Œåˆç§°è·ç¦» )ï¼Œæ˜¯å®šä¹‰åœ¨é›†åˆä¸Šçš„äºŒå…ƒå‡½æ•°ï¼å¯¹äºé›†åˆ $\mathcal{X}$ ï¼Œå…¶ä¸Šçš„åº¦é‡
$d: \mathcal{X} \times \mathcal{X} \rightarrow \mathbb{R}$ ï¼Œéœ€è¦æ»¡è¶³ $:$</p>
<ol>
<li>éè´Ÿæ€§ï¼šå¯¹ä»»æ„çš„ $x^{\prime}, x^{\prime \prime} \in \mathcal{X}$, æœ‰ $d\left(x^{\prime}, x^{\prime \prime}\right) \geqslant 0 ;$</li>
<li>åŒä¸€æ€§ï¼šå¯¹ä»»æ„çš„ $x^{\prime}, x^{\prime \prime} \in \mathcal{X}$, å¦‚æœ $d\left(x^{\prime}, x^{\prime \prime}\right)=0$, åˆ™ $x^{\prime}=x^{\prime \prime} ;$</li>
<li>å¯¹ç§°æ€§ï¼šå¯¹ä»»æ„çš„ $x^{\prime}, x^{\prime \prime} \in \mathcal{X}$, æœ‰ $d\left(x^{\prime}, x^{\prime \prime}\right)=d\left(x^{\prime \prime}, x^{\prime}\right) ;$</li>
<li>ä¸‰è§’ä¸ç­‰å¼: å¯¹ä»»æ„çš„ $x^{\prime}, x^{\prime \prime}, x^{\prime \prime \prime} \in \mathcal{X}$, æœ‰ $d\left(x^{\prime}, x^{\prime \prime \prime}\right) \leqslant d\left(x^{\prime}, x^{\prime \prime}\right)+d\left(x^{\prime \prime}, x^{\prime \prime \prime}\right)$ ï¼</li>
</ol>
<p>æœ‰åºå¯¹ $(\mathcal{X}, d)$ åˆç§°ä¸º<strong>åº¦é‡ç©ºé—´</strong> (metric space)ï¼æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªåº¦é‡ç©ºé—´çš„ä¾‹å­ï¼è€ƒè™‘æœ‰é™ Markov å†³ç­–è¿‡ç¨‹çŠ¶æ€å‡½æ•° $v(s)(s \in \mathcal{S})$ ï¼Œå…¶æ‰€æœ‰å¯èƒ½çš„å–å€¼ç»„æˆé›†åˆ $\mathcal{V}=\mathbb{R}^{|\mathcal{S}|}$ ï¼Œå®šä¹‰ $d_{\infty}$ å¦‚ä¸‹:
$$
d_{\infty}\left(v^{\prime}, v^{\prime \prime}\right)=\max <em>{s \in S}\left|v^{\prime}(s)-v^{\prime \prime}(s)\right|, v^{\prime}, v^{\prime \prime} \in \mathcal{V}
$$
å¯ä»¥è¯æ˜, $d</em>{\infty}$ æ˜¯ $\mathcal{V}$ ä¸Šçš„ä¸€ä¸ªåº¦é‡ï¼ï¼ˆè¯æ˜: éè´Ÿæ€§ã€åŒä¸€æ€§ã€å¯¹ç§°æ€§æ˜¯æ˜¾ç„¶çš„ï¼ç”±äº $\forall s \in \mathcal{S}$ æœ‰
$$
\begin{array}{l}
\left|v^{\prime}(s)-v^{\prime \prime \prime}(s)\right| \
\quad=\left|\left[v^{\prime}(s)-v^{\prime \prime}(s)\right]+\left[v^{\prime \prime}(s)-v^{\prime \prime}(s)\right]\right| \
\quad \leqslant\left|v^{\prime}(s)-v^{\prime \prime}(s)\right|+\left|v^{\prime \prime}(s)-v^{\prime \prime \prime}(s)\right| \
\quad \leqslant \max <em>{s \in S}\left|v^{\prime}(s)-v^{\prime \prime}(s)\right|+\max</em>{s \in S}\left|v^{\prime \prime}(s)-v^{\prime \prime}(s)\right| \
\end{array}
$$
å¯å¾—ä¸‰è§’ä¸ç­‰å¼ï¼ï¼‰æ‰€ä»¥ï¼Œ $\left(\mathcal{V}, d_{\infty}\right)$ æ˜¯ä¸€ä¸ªåº¦é‡ç©ºé—´ï¼å¯¹äºä¸€ä¸ªåº¦é‡ç©ºé—´ï¼Œå¦‚æœ Cauchy åºåˆ—éƒ½æ”¶æ•›åœ¨è¯¥ç©ºé—´å†…ï¼Œåˆ™ç§°è¿™ä¸ªåº¦é‡ç©ºé—´æ˜¯<strong>å®Œå¤‡</strong>çš„(complete)ï¼å¯¹äºåº¦é‡ç©ºé—´ $\left(\mathcal{V}, d_{\infty}\right)$ ä¹Ÿæ˜¯å®Œå¤‡çš„ï¼(è¯æ˜: è€ƒè™‘å…¶ä¸­ä»»æ„ Cauchy åˆ— $\left{v_{k}: k=0,1,2, \ldots\right}$ ï¼Œå³å¯¹ä»»æ„çš„æ­£å®æ•° $\varepsilon&gt;0$ ï¼Œå­˜åœ¨æ­£æ•´æ•° $\kappa$ ä½¿å¾—ä»»æ„çš„ $k^{\prime}, k^{\prime \prime}&gt;\kappa$ ï¼Œå‡æœ‰ $d_{\infty}\left(v_{k^{\prime}}, v_{k^{\prime}}\right)&lt;\varepsilon_{0}$ å¯¹äº $\forall s \in \mathcal{S},\left|v_{k^{\prime}}(s)-v_{k^{\prime}}(s)\right| \leqslant d_{\infty}\left(v_{k^{\prime}}, v_{k^{\prime}}\right)&lt;\varepsilon$ ï¼Œæ‰€ä»¥ $\left{v_{k}(s): k=0,1,2, \ldots\right}$ æ˜¯ Cauchy åˆ—ï¼ç”±å®æ•°é›†çš„å®Œå¤‡æ€§ï¼Œå¯ä»¥çŸ¥é“ $\left{v_{k}(s): k=0,1,2, \ldots\right}$ æ”¶æ•›äºæŸä¸ªå®æ•°ï¼Œè®°è¿™ä¸ªå®æ•°ä¸º $v_{\infty}(s)$ ï¼æ‰€ä»¥ï¼Œå¯¹äº $\forall \varepsilon&gt;0$ ï¼Œå­˜åœ¨æ­£æ•´æ•° $\kappa(s)$ ï¼Œå¯¹äºä»»æ„ $k&gt;\kappa(s)$ ï¼Œæœ‰ $\left|v_{k}(s)-v_{\infty}(s)\right|&lt;\varepsilon_{0}$ å– $\kappa(\mathcal{S})=\max <em>{s \in S} \kappa(s)$ ï¼Œæœ‰ $d</em>{\infty}\left(v_{k}, v_{\infty}\right)&lt;\varepsilon$ ï¼Œæ‰€ä»¥ $\left{v_{k}: k=0,1,2, \ldots\right}$ æ”¶æ•›äº
$v_{\infty}$ ï¼Œè€Œ $v_{\infty} \in \mathcal{V}$ ï¼Œå®Œå¤‡æ€§å¾—è¯)ï¼</p>
<h4 id="112-å‹ç¼©æ˜ å°„ä¸bellmanç®—å­"><a class="header" href="#112-å‹ç¼©æ˜ å°„ä¸bellmanç®—å­">1.1.2 å‹ç¼©æ˜ å°„ä¸Bellmanç®—å­</a></h4>
<p>æœ¬èŠ‚ä»‹ç»å‹ç¼©æ˜ å°„çš„å®šä¹‰ï¼Œå¹¶è¯æ˜ Bellman æœŸæœ›ç®—å­å’Œ Bellman æœ€ä¼˜ç®—å­æ˜¯åº¦é‡ç©ºé—´ $\left(\mathcal{V}, d_{\infty}\right)$ ä¸Šçš„å‹ç¼©æ˜ å°„ï¼</p>
<p>å¯¹äºä¸€ä¸ªåº¦é‡ç©ºé—´ $(\mathcal{X}, d)$ å’Œå…¶ä¸Šçš„ä¸€ä¸ªæ˜ å°„ $t: \mathcal{X} \rightarrow \mathcal{X}$ ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªå®æ•° $\gamma \in(0,1)$ ï¼Œä½¿å¾—å¯¹äºä»»æ„çš„ $x^{\prime}, x^{\prime \prime} \in \mathcal{X}$ ï¼Œéƒ½æœ‰
$$
d\left(t\left(x^{\prime}\right), t\left(x^{\prime \prime}\right)\right)&lt;\gamma d\left(x^{\prime}, x^{\prime \prime}\right)
$$
åˆ™ç§°æ˜ å°„ $t$ æ˜¯<strong>å‹ç¼©æ˜ å°„</strong> ( contraction mapping, æˆ– Lipschitzian mapping)ï¼å…¶ä¸­çš„å®æ•° $\gamma$ è¢«ç§°ä¸º Lipschitz å¸¸æ•°ï¼</p>
<h4 id="-bellmanæœŸæœ›æ–¹ç¨‹"><a class="header" href="#-bellmanæœŸæœ›æ–¹ç¨‹">â€» BellmanæœŸæœ›æ–¹ç¨‹</a></h4>
<p>ç”¨çŠ¶æ€ä»·å€¼å‡½æ•°è¡¨ç¤ºçŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
v_{\pi}(s)=\sum_{a} \pi(a|s)\left[r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{\pi}\left(s^{\prime}\right)\right], \quad s \in \mathcal{S}
$$
ç”¨åŠ¨ä½œä»·å€¼å‡½æ•°è¡¨ç¤ºåŠ¨ä½œä»·å€¼å‡½æ•°ï¼š
$$
q_{\pi}(s, a)=\sum_{s^{\prime}, r} p\left(s^{\prime}, r|s, a\right)\left[r+\gamma \sum_{a^{\prime}} \pi\left(a^{\prime}|s^{\prime}\right) q_{\pi}\left(s^{\prime}, a^{\prime}\right)\right], \quad s \in \mathcal{S}, a \in \mathcal{A}
$$</p>
<h4 id="-bellmanæœ€ä¼˜æ–¹ç¨‹"><a class="header" href="#-bellmanæœ€ä¼˜æ–¹ç¨‹">â€» Bellmanæœ€ä¼˜æ–¹ç¨‹</a></h4>
<p>ç”¨æœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°è¡¨ç¤ºæœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°ï¼š
$$
v_{<em>}(s)=\max_{a \in \mathcal{A}}\left[r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{</em>}\left(s^{\prime}\right)\right], \quad s \in \mathcal{S}
$$
ç”¨æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•°è¡¨ç¤ºæœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•°ï¼š
$$
q_{<em>}(s, a)=r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) \max <em>{a^{\prime}} q</em>{</em>}\left(s^{\prime}, a^{\prime}\right), \quad s \in \mathcal{S}, a \in \mathcal{A}
$$</p>
<p>è¿™ä¸¤ä¸ªæ–¹ç¨‹éƒ½æœ‰ç”¨çŠ¶æ€ä»·å€¼è¡¨ç¤ºçŠ¶æ€ä»·å€¼çš„å½¢å¼ï¼æ ¹æ®è¿™ä¸ªå½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºåº¦é‡ç©ºé—´ $\left(\mathcal{V}, d_{\infty}\right)$ å®šä¹‰ Bellman æœŸæœ›ç®—å­ å’Œ Bellman æœ€ä¼˜ç®—å­ï¼</p>
<p>ç»™å®šç­–ç•¥ $\pi(a|s)(s \in \mathcal{S}, a \in \mathcal{A}(s))$ çš„ <strong>Bellman æœŸæœ›ç®—å­</strong> $t_{\pi}: \mathcal{V} \rightarrow \mathcal{V}:$
$$
t_{n}(v)(s)=\sum_{a} \pi(a|s)\left[r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v\left(s^{\prime}\right)\right], \quad s \in \mathcal{S}
$$
<strong>Bellman æœ€ä¼˜ç®—å­</strong> $t_{.}: \mathcal{V} \rightarrow \mathcal{V}$ :
$$
t_*(v)(s)=\max_{\operatorname{ces} A}\left[r(s, a)+\gamma \sum_{\text {ses }} p\left(s^{\prime}|s, a\right) v_{\cdot}\left(s^{\prime}\right)\right], \quad s \in \mathcal{S}
$$
ä¸‹é¢æˆ‘ä»¬å°±æ¥è¯æ˜ï¼Œè¿™ä¸¤ä¸ªç®—å­éƒ½æ˜¯å‹ç¼©æ˜ å°„ï¼</p>
<p>é¦–å…ˆæ¥çœ‹ $\mathrm{Bellman}$ æœŸæœ›ç®—å­ $t_{\pi}$ ï¼ç”± $t_{\pi}$ çš„å®šä¹‰å¯çŸ¥ï¼Œå¯¹ä»»æ„çš„ $v^{\prime}, v^{\prime \prime} \in \mathcal{V}$ ï¼Œæœ‰
$$
t_{\pi}\left(v^{\prime}\right)(s)-t_{\pi}\left(v^{\prime \prime}\right)(s)=\gamma \sum_{a} \pi(a|s) \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right)\left[v^{\prime}\left(s^{\prime}\right)-v^{\prime \prime}\left(s^{\prime}\right)\right]
$$
æ‰€ä»¥
$$
\left|t_{\pi}\left(v^{\prime}\right)(s)-t_{\pi}\left(v^{\prime \prime}\right)(s)\right| \leqslant \gamma \sum_{a} \pi(a|s) \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) \max <em>{s^{\prime}}\left|v^{\prime}\left(s^{\prime}\right)-v^{\prime \prime}\left(s^{\prime}\right)\right|=\gamma d</em>{\infty}\left(v^{\prime}, v^{\prime \prime}\right)
$$
è€ƒè™‘åˆ° $s$ æ˜¯ä»»å–çš„ï¼Œæ‰€ä»¥æœ‰
$$
d_{\infty}\left(t_{\pi}\left(v^{\prime}\right), t_{\pi}\left(v^{\prime \prime}\right)\right) \leqslant \gamma d_{\infty}\left(v^{\prime}, v^{\prime \prime}\right)
$$
å½“ $\gamma&lt;1$ æ—¶ï¼Œ $t_{n}$ å°±æ˜¯å‹ç¼©æ˜ å°„ï¼æ¥ä¸‹æ¥çœ‹ Bellman æœ€ä¼˜ç®—å­ $t_{<em>}$ ï¼è¦è¯æ˜ $t_{</em>}$ æ˜¯å‹ç¼©æ˜ å°„ï¼Œéœ€è¦ç”¨åˆ°ä¸‹åˆ—ä¸ç­‰å¼:
$$
\left|\max_{a} f^{\prime}(a)-\max_{a} f^{\prime \prime}(a)\right| \leqslant \max_{a}\left|f^{\prime}(a)-f^{\prime \prime}(a)\right|
$$
å…¶ä¸­ $f^{\prime}$ å’Œ $f^{\prime \prime}$ æ˜¯ä»»æ„çš„ä»¥ $a$ ä¸ºè‡ªå˜é‡çš„å‡½æ•°ã€‚(è¯æ˜: è®¾ $a^{\prime}=\arg \max_{a} f^{\prime}(a)$, åˆ™
$$
\max <em>{a} f^{\prime}(a)-\max</em>{a} f^{\prime \prime}(a)=f^{\prime}\left(a^{\prime}\right)-\max <em>{a} f^{\prime \prime}(a) \leqslant f^{\prime}\left(a^{\prime}\right)-f^{\prime \prime}\left(a^{\prime}\right) \leqslant \max</em>{a}\left|f^{\prime}(a)-f^{\prime \prime}(a)\right|
$$
åŒç†å¯è¯ $\max <em>{a} f^{\prime \prime}(a)-\max</em>{a} f^{\prime}(a) \leqslant \max <em>{a}\left|f^{\prime}(a)-f^{\prime \prime}(a)\right|$ ï¼Œäºæ˜¯ä¸ç­‰å¼å¾—è¯ï¼ $)$ åˆ©ç”¨è¿™ä¸ªä¸ç­‰
å¼ï¼Œå¯¹ä»»æ„çš„ $v^{\prime}, v^{\prime \prime} \in \mathcal{V}$ ï¼Œæœ‰
$$
\begin{aligned}
\qquad t</em>{<em>}\left(v^{\prime}\right)(s)&amp;-t_{</em>}\left(v^{\prime \prime}\right)(s) \
&amp;=\max _{a \in A}\left[r(s, a)+\gamma \sum_{s^{\prime} \in \mathcal{S}} p\left(s^{\prime}|s, a\right) v^{\prime}\left(s^{\prime}\right)\right]-\max_{a \in \mathcal{A}}\left[r(s, a)+\gamma \sum_{s^{\prime} \in S} p\left(s^{\prime}|s, a\right) v^{\prime \prime}\left(s^{\prime}\right)\right] \
&amp;\leqslant \max <em>{a^{\prime} \in \mathcal{A}}\left|\gamma \sum</em>{s^{\prime} \in \mathcal{S}} p\left(s^{\prime}|s, a^{\prime}\right)\left(v^{\prime}\left(s^{\prime}\right)-v^{\prime \prime}\left(s^{\prime}\right)\right)\right| \
&amp;\leqslant \gamma \max <em>{a^{\prime} \in A}\left|\sum</em>{s^{\prime} \in S} p\left(s^{\prime}|s, a^{\prime}\right)\right| \max <em>{s^{\prime} \in S}\left|v^{\prime}\left(s^{\prime}\right)-v^{\prime \prime}\left(s^{\prime}\right)\right| \
&amp;\leqslant \gamma d</em>{\infty}\left(v^{\prime}, v^{\prime \prime}\right)
\end{aligned}
$$
è¿›è€Œæ˜“çŸ¥ $\left|t_{<em>}\left(v^{\prime}\right)(s)-t_{</em>}\left(v^{\prime \prime}\right)(s)\right| \leqslant \gamma d_{\infty}\left(v^{\prime}, v^{\prime \prime}\right)$ ï¼Œæ‰€ä»¥ $t_*$ æ˜¯å‹ç¼©æ˜ å°„ï¼</p>
<h4 id="113-banachä¸åŠ¨ç‚¹å®šç†"><a class="header" href="#113-banachä¸åŠ¨ç‚¹å®šç†">1.1.3 Banachä¸åŠ¨ç‚¹å®šç†</a></h4>
<p>å¯¹äºåº¦é‡ç©ºé—´ $(\mathcal{X}, d)$ ä¸Šçš„æ˜ å°„ $t: \mathcal{X} \rightarrow \mathcal{X}$ ï¼Œå¦‚æœ $x \in \mathcal{X}$ ä½¿å¾— $t(x)=x$ ï¼Œåˆ™ç§° $x$ æ˜¯æ˜ å°„ $t$ çš„<strong>ä¸åŠ¨ç‚¹</strong> (fix point)ï¼</p>
<p>ä¾‹å¦‚ï¼Œç­–ç•¥ $\pi$ çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi}(s)(s \in \mathcal{S})$ æ»¡è¶³ Bellman æœŸæœ›æ–¹ç¨‹ï¼Œæ˜¯ Bellman æœŸæœ›ç®—å­ $t_{\pi}$ çš„ä¸åŠ¨ç‚¹ï¼æœ€ä¼˜çŠ¶æ€ä»·å€¼ $v_{<em>}(s)(s \in \mathcal{S})$ æ»¡è¶³ Bellman æœ€ä¼˜æ–¹ç¨‹ï¼Œæ˜¯ Bellman æœ€ä¼˜ç®—å­ $t_</em>$ çš„ä¸åŠ¨ç‚¹ï¼</p>
<p>å®Œå¤‡åº¦é‡ç©ºé—´ä¸Šçš„å‹ç¼©æ˜ å°„æœ‰éå¸¸é‡è¦çš„ç»“è®º: Banach ä¸åŠ¨ç‚¹å®šç†ï¼ <strong>Banach ä¸åŠ¨ç‚¹å®šç†</strong>ï¼ˆBanach fixed-point theorem, åˆç§°å‹ç¼©æ˜ å°„å®šç†ï¼Œ compressed mapping theorem) çš„å†…å®¹æ˜¯: $(\mathcal{X}, d)$ æ˜¯éç©ºçš„å®Œå¤‡åº¦é‡ç©ºé—´, $t: \mathcal{X} \rightarrow \mathcal{X}$ æ˜¯ä¸€ä¸ªå‹ç¼©æ˜ å°„ï¼Œåˆ™æ˜ å°„ $t$ åœ¨ $\mathcal{X}$ å†…æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªä¸åŠ¨ç‚¹ $x_{+\infty}$ ï¼æ›´è¿›ä¸€æ­¥ï¼Œè¿™ä¸ªä¸åŠ¨ç‚¹å¯ä»¥é€šè¿‡ä¸‹åˆ—æ–¹æ³•æ±‚å‡ºï¼šä» $\mathcal{X}$ å†…çš„ä»»æ„ä¸€ä¸ªå…ƒç´  $x_{0}$ å¼€å§‹ï¼Œå®šä¹‰è¿­ä»£åºåˆ— $x_{k}=t\left(x_{k-1}\right)(k=1,2,3, \ldots)$ ï¼Œè¿™ä¸ªåºåˆ—æ”¶æ•›ï¼Œä¸”æé™ä¸º $x_{+\infty}$ ï¼</p>
<p>è¯æ˜ï¼šè€ƒè™‘ä»»å–çš„ $x_{0}$ åŠå…¶ç¡®å®šçš„åˆ— $\left{x_{k}: k=0,1, \ldots\right}$ ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜å®ƒæ˜¯ Cauchy åºåˆ—ï¼å¯¹äºä»»æ„çš„ $k^{\prime}, k^{\prime \prime}$ ä¸” $k^{\prime}&lt;k^{n}$ ï¼Œç”¨è·ç¦»çš„ä¸‰è§’ä¸ç­‰å¼å’Œéè´Ÿæ€§å¯çŸ¥ï¼Œ
$$
d\left(x_{k}, x_{k^{\prime}}\right) \leqslant d\left(x_{k^{\prime}}, x_{k^{\prime}+1}\right)+d\left(x_{k^{\prime}+1}, x_{k^{\prime}+2}\right)+\cdots+d\left(x_{k^{\prime\prime}-1}, x_{k^{\prime\prime}}\right) \leqslant \sum_{k=k^{\prime}}^{+\infty} d\left(x_{k+1}, x_{k}\right)
$$
å†åå¤åˆ©ç”¨å‹ç¼©æ˜ å°„å¯çŸ¥ï¼Œå¯¹äºä»»æ„çš„æ­£æ•´æ•° $k$ æœ‰ $d\left(x_{k+1}, x_{k}\right) \leqslant \gamma^{k} d\left(x_{1}, x_{0}\right)$ ï¼Œä»£äººå¾—ï¼š
$$
d\left(x_{k^{\prime}}, x_{k^{\prime\prime}}\right) \leqslant \sum_{k=k^{\prime}}^{+\infty} d\left(x_{k+1}, x_{k}\right) \leqslant \sum_{k=k^{\prime}}^{+\infty} \gamma^{k} d\left(x_{1}, x_{0}\right)=\frac{\gamma^{k^{\prime}}}{1-\gamma} d\left(x_{1}, x_{0}\right)
$$
ç”±äº $\gamma \in(0,1)$ ï¼Œæ‰€ä»¥ä¸Šè¿°ä¸ç­‰å¼å³ç«¯å¯ä»¥ä»»æ„å°ï¼Œå¾—è¯ï¼</p>
<p>Banach ä¸åŠ¨ç‚¹å®šç†ç»™å‡ºäº†æ±‚å®Œå¤‡åº¦é‡ç©ºé—´ä¸­å‹ç¼©æ˜ å°„ä¸åŠ¨ç‚¹çš„æ–¹æ³•ï¼šä»ä»»æ„çš„èµ·ç‚¹å¼€å§‹ï¼Œä¸æ–­è¿­ä»£ä½¿ç”¨å‹ç¼©æ˜ å°„ï¼Œæœ€ç»ˆå°±èƒ½æ”¶æ•›åˆ°ä¸åŠ¨ç‚¹ï¼å¹¶ä¸”åœ¨è¯æ˜çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜ç»™å‡ºäº†æ”¶æ•›é€Ÿåº¦ï¼Œå³è¿­ä»£æ­£æ¯”äº $\gamma^{k}$ çš„é€Ÿåº¦æ”¶æ•› $($ å…¶ä¸­ $k$ æ˜¯è¿­ä»£æ¬¡æ•°)ï¼åœ¨ $1.1.1$ èŠ‚æˆ‘ä»¬å·²ç»è¯æ˜ $\left(\mathcal{V}, d_{\infty}\right)$ æ˜¯å®Œå¤‡çš„åº¦é‡ç©ºé—´ï¼Œè€Œ $1.1.2$ èŠ‚åˆè¯æ˜äº† Bellman æœŸæœ›ç®—å­å’Œ $\mathrm{Bellman}$ æœ€ä¼˜ç®—å­æ˜¯å‹ç¼©æ˜ å°„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨è¿­ä»£çš„æ–¹æ³•æ±‚ Bellman æœŸæœ›ç®—å­å’Œ Bellman æœ€ä¼˜ç®—å­çš„ä¸åŠ¨ç‚¹ï¼äº $\mathrm{Bellman}$ æœŸæœ›ç®—å­çš„ä¸åŠ¨ç‚¹å°±æ˜¯ç­–ç•¥ä»·å€¼ï¼ŒBellman æœ€ä¼˜ç®—å­çš„ä¸åŠ¨ç‚¹å°±æ˜¯æœ€ä¼˜ä»·å€¼ï¼Œæ‰€ä»¥è¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç”¨è¿­ä»£çš„æ–¹æ³•æ±‚å¾—ç­–ç•¥çš„ä»·å€¼æˆ–æœ€ä¼˜ä»·å€¼ï¼åœ¨åé¢çš„å°èŠ‚ä¸­ï¼Œå°±æ¥å…·ä½“çœ‹çœ‹æ±‚è§£çš„ç®—æ³•ï¼</p>
<h3 id="12-æœ‰æ¨¡å‹ç­–ç•¥è¿­ä»£"><a class="header" href="#12-æœ‰æ¨¡å‹ç­–ç•¥è¿­ä»£">1.2 æœ‰æ¨¡å‹ç­–ç•¥è¿­ä»£</a></h3>
<p>æœ¬èŠ‚ä»‹ç»åœ¨ç»™å®šåŠ¨åŠ›ç³»ç»Ÿ $p$ çš„æƒ…å†µä¸‹çš„ç­–ç•¥è¯„ä¼°ã€ç­–ç•¥æ”¹è¿›å’Œç­–ç•¥è¿­ä»£ï¼ç­–ç•¥è¯„ä¼°ã€ç­–ç•¥æ”¹è¿›å’Œç­–ç•¥è¿­ä»£åˆ†åˆ«æŒ‡ä»¥ä¸‹æ“ä½œï¼</p>
<ul>
<li><strong>ç­–ç•¥è¯„ä¼°</strong>ï¼ˆpolicy evaluation): å¯¹äºç»™å®šçš„ç­–ç•¥ $\pi$ ï¼Œä¼°è®¡ç­–ç•¥çš„ä»·å€¼, åŒ…æ‹¬åŠ¨ä½œä»·å€¼å’ŒçŠ¶æ€ä»·å€¼</li>
<li><strong>ç­–ç•¥æ”¹è¿›</strong>ï¼ˆpolicy improvement): å¯¹äºç»™å®šçš„ç­–ç•¥ $\pi$ ï¼Œåœ¨å·²çŸ¥å…¶ä»·å€¼å‡½æ•°çš„æƒ…å†µ
æ‰¾åˆ°ä¸€ä¸ªæ›´ä¼˜çš„ç­–ç•¥</li>
<li><strong>ç­–ç•¥è¿­ä»£</strong>ï¼ˆpolicy iteration): ç»¼åˆåˆ©ç”¨ç­–ç•¥è¯„ä¼°å’Œç­–ç•¥æ”¹è¿›ï¼Œæ‰¾åˆ°æœ€ä¼˜ç­–ç•¥</li>
</ul>
<h4 id="121-ç­–ç•¥è¯„ä¼°"><a class="header" href="#121-ç­–ç•¥è¯„ä¼°">1.2.1 ç­–ç•¥è¯„ä¼°</a></h4>
<p>æœ¬èŠ‚ä»‹ç»å¦‚ä½•ç”¨è¿­ä»£æ–¹æ³•è¯„ä¼°ç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼å¦‚æœèƒ½æ±‚å¾—çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œé‚£ä¹ˆå°±èƒ½å¾ˆå®¹æ˜“åœ°æ±‚å‡ºåŠ¨ä½œä»·å€¼å‡½æ•°ï¼ç”±äºçŠ¶æ€ä»·å€¼å‡½æ•°åªæœ‰ $|S|$ ä¸ªè‡ªå˜é‡ï¼Œè€ŒåŠ¨ä½œä»·å€¼å‡½æ•°æœ‰
$|\mathcal{S}| \times|\mathcal{A}|$ ä¸ªè‡ªå˜é‡ï¼Œæ‰€ä»¥å­˜å‚¨çŠ¶æ€ä»·å€¼å‡½æ•°æ¯”è¾ƒèŠ‚çº¦ç©ºé—´ï¼</p>
<p>ç”¨è¿­ä»£çš„æ–¹æ³•è¯„ä¼°ç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°çš„ç®—æ³•å¦‚ç®—æ³• 1-1 æ‰€ç¤ºï¼ç®—æ³• 1-1 ä¸€å¼€å§‹åˆå§‹åŒ–çŠ¶æ€ä»·å€¼å‡½æ•° $v_{0}$ ï¼Œå¹¶åœ¨åç»­çš„è¿­ä»£ä¸­ç”¨ $\mathrm{Bellman}$ æœŸæœ›æ–¹ç¨‹çš„è¡¨è¾¾å¼æ›´æ–°ä¸€è½®æ‰€æœ‰çŠ¶æ€çš„çŠ¶æ€ä»·å€¼å‡½æ•°ï¼è¿™æ ·å¯¹æ‰€æœ‰çŠ¶æ€ä»·å€¼å‡½æ•°çš„ä¸€æ¬¡æ›´æ–°åˆç§°ä¸ºä¸€æ¬¡<strong>æ‰«æ</strong>ï¼ˆsweep)ï¼åœ¨ç¬¬ $k$ æ¬¡æ‰«ææ—¶ï¼Œç”¨ $v_{k-1}$ çš„å€¼æ¥æ›´æ–° $v_{k}$ çš„å€¼ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ç³»åˆ—çš„ $v_{0}, v_{1}, \nu_{2}, \ldots$ ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 1-1</strong>ï¼š$\quad$æœ‰æ¨¡å‹ç­–ç•¥è¯„ä¼°è¿­ä»£ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥: åŠ¨åŠ›ç³»ç»Ÿ $p$, ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi}$ çš„ä¼°è®¡å€¼<br />
å‚æ•°: æ§åˆ¶è¿­ä»£æ¬¡æ•°çš„å‚æ•°ï¼ˆå¦‚è¯¯å·®å®¹å¿åº¦ $\vartheta_{\max }$ æˆ–æœ€å¤§è¿­ä»£æ¬¡æ•° $\left.k_{\max }\right)$</p>
<ol>
<li>(åˆå§‹åŒ–) å¯¹äº $s \in \mathcal{S}$ ï¼Œå°† $v_{0}(s)$ åˆå§‹åŒ–ä¸ºä»»æ„å€¼ (æ¯”å¦‚ 0 )ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œå°†ç»ˆæ­¢çŠ¶æ€åˆå§‹åŒ–ä¸º 0ï¼Œå³ $v_{0}\left(S_{\text {ç»ˆæ­¢}}\right) \leftarrow 0$</li>
<li>(è¿­ä»£) å¯¹äº $k \leftarrow 0,1,2,3, \ldots$ ï¼Œè¿­ä»£æ‰§è¡Œä»¥ä¸‹æ­¥éª¤<br />
2.1 å¯¹äº $s \in \mathcal{S}$, é€ä¸€æ›´æ–° $v_{k+1}(s) \leftarrow \sum_{a} \pi(a|s) q_{k}(s, a)$ ï¼Œå…¶ä¸­$q_{k}(s, a) \leftarrow r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{k}\left(s^{\prime}\right)$ï¼<br />
2.2 å¦‚æœæ»¡è¶³è¿­ä»£ç»ˆæ­¢æ¡ä»¶ (å¦‚å¯¹ $s \in \mathcal{S}$ å‡æœ‰ $\left|v_{k+1}(s)-v_{k}(s)\right|&lt;\vartheta_{\max }$ ï¼Œæˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°
$\left.k=k_{\max }\right)$ ï¼Œåˆ™è·³å‡ºå¾ªç¯</li>
</ol>
<hr />
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç®—æ³• 1-1 æ²¡å¿…è¦ä¸ºæ¯æ¬¡æ‰æéƒ½é‡æ–°åˆ†é…ä¸€å¥—ç©ºé—´æ¥å­˜å‚¨ï¼ä¸€ç§ä¼˜åŒ–çš„æ–¹æ³•æ˜¯ï¼Œè®¾ç½®å¥‡æ•°æ¬¡è¿­ä»£çš„å­˜å‚¨ç©ºé—´å’Œå¶æ•°æ¬¡è¿­ä»£çš„å­˜å‚¨ç©ºé—´ï¼Œä¸€å¼€å§‹åˆå§‹åŒ–å¶æ•°æ¬¡å­˜å‚¨ç©ºé—´ï¼Œå½“ $k$ æ˜¯å¥‡æ•°æ—¶ï¼Œç”¨å¶æ•°æ¬¡å­˜å‚¨ç©ºé—´æ¥æ›´æ–°å¥‡æ•°æ¬¡å­˜å‚¨ç©ºé—´; å½“ $k$ æ˜¯å¶æ•°æ—¶, ç”¨å¥‡æ•°æ¬¡å­˜å‚¨ç©ºé—´æ¥æ›´æ–°å¶æ•°æ¬¡å­˜å‚¨ç©ºé—´ï¼è¿™æ ·ï¼Œä¸€å…±åªéœ€è¦ä¸¤å¥—å­˜å‚¨ç©ºé—´å°±å¯ä»¥å®Œæˆç®—æ³•ï¼</p>
<h4 id="122-ç­–ç•¥æ”¹è¿›"><a class="header" href="#122-ç­–ç•¥æ”¹è¿›">1.2.2 ç­–ç•¥æ”¹è¿›</a></h4>
<p>å¯¹äºç»™å®šçš„ç­–ç•¥ $\pi$ ï¼Œå¦‚æœå¾—åˆ°è¯¥ç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼Œåˆ™å¯ä»¥ç”¨ç­–ç•¥æ”¹è¿›å®šç†å¾—åˆ°ä¸€ä¸ªæ”¹è¿›çš„ç­–ç•¥ï¼</p>
<p>ç­–ç•¥æ”¹è¿›å®šç†çš„å†…å®¹å¦‚ä¸‹ï¼šå¯¹äºç­–ç•¥ $\pi$ å’Œ $\pi^{\prime}$ ï¼Œå¦‚æœ
$$
v_{\pi}(s) \leqslant \sum_{a} \pi^{\prime}(a|s) q_{\pi}(s, a), \quad s \in \mathcal{S}
$$
åˆ™ $\pi \leqslant \pi^{\prime}$ ï¼Œå³
$$
v_{\pi}(s) \leqslant v_{\pi^{\prime}}(s), \quad s \in \mathcal{S}
$$
åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¦‚æœå­˜åœ¨çŠ¶æ€ä½¿å¾—ç¬¬ä¸€å¼çš„ä¸ç­‰å·æ˜¯ä¸¥æ ¼å°äºå·ï¼Œé‚£ä¹ˆå°±å­˜åœ¨çŠ¶æ€ä½¿å¾—ç¬¬äºŒå¼ä¸­çš„ä¸ç­‰å·ä¹Ÿæ˜¯ä¸¥æ ¼å°äºå·ï¼</p>
<p><strong>è¯æ˜</strong>: è€ƒè™‘åˆ°ç¬¬ä¸€ä¸ªä¸ç­‰å¼ç­‰ä»·äº
$$
v_{\pi}(s)=\mathrm{E}<em>{\pi^{\prime}}\left[v</em>{\pi}\left(S_{t}\right)|S_{t}=s\right] \leqslant \mathrm{E}<em>{\pi^{\prime}}\left[q</em>{\pi}\left(S_{t}, A_{t}\right)|S_{t}=s\right], \quad s \in \mathcal{S}
$$
å…¶ä¸­çš„æœŸæœ›æ˜¯é’ˆå¯¹ç”¨ç­–ç•¥ $\pi^{\prime}$ ç”Ÿæˆçš„è½¨è¿¹ä¸­ï¼Œé€‰å– $S_{t}=s$ çš„é‚£äº›è½¨è¿¹è€Œè¨€çš„ï¼è¿›è€Œæœ‰
$$
\begin{array}{l}
\mathrm{E}<em>{\pi^{\prime}}\left[\nu</em>{\pi}\left(S_{t+\tau}\right)|S_{t}=s\right] \
\quad=\mathrm{E}<em>{\pi^{\prime}}\left[\mathrm{E}</em>{\pi^{\prime}}\left[v_{\pi}\left(S_{t+\tau}\right)|S_{t+\tau}\right]|S_{t}=s\right] \
\quad \leqslant \mathrm{E}<em>{\pi^{\prime}}\left[\mathrm{E}</em>{\pi^{\prime}}\left[q_{\pi}\left(S_{t+\tau}, A_{t+\tau}\right)|S_{t+\tau}\right]|S_{t}=s\right] \
\quad=\mathrm{E}<em>{\pi^{\prime}}\left[q</em>{\pi}\left(S_{t+\tau}, A_{t+\tau}\right)|S_{t}=s\right], \quad s \in \mathcal{S}, \tau=0,1,2, \ldots
\end{array}
$$
è€ƒè™‘åˆ°
$$
\mathrm{E}<em>{\pi^{\prime}}\left[q</em>{\pi}\left(S_{t+\tau}, A_{t+\tau}\right)|S_{t}=s\right]=\mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+\tau+1}+\gamma v_{\pi}\left(S_{t+\tau+1}\right)|S_{t}=s\right], \quad s \in \mathcal{S}, \tau=0,1,2, \ldots
$$
æ‰€ä»¥
$$
\mathrm{E}<em>{\pi^{\prime}}\left[v</em>{\pi}\left(S_{t+\tau}\right)|S_{t}=s\right] \leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+\tau+1}+\gamma v_{\pi}\left(S_{t+\tau+1}\right)|S_{t}=s\right], \quad s \in \mathcal{S}, \tau=0,1,2, \ldots
$$
è¿›è€Œæœ‰
$$
\begin{array}{l}
v_{\pi}(s)=\mathrm{E}<em>{\pi^{\prime}}\left[v</em>{\pi}\left(S_{t}\right)|S_{t}=s\right] \
\leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+1}+\gamma v_{\pi}\left(S_{t+1}\right)|S_{t}=s\right] \
\leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+1}+\gamma \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+2}+\gamma v_{\pi}\left(S_{t+2}\right)|S_{t}=s\right]|S_{t}=s\right] \
\leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+1}+\gamma R_{t+2}+\gamma^{2} v_{\pi}\left(S_{t+2}\right)|S_{t}=s\right] \
\leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+1}+\gamma R_{t+2}+\gamma^{2} R_{t+3}+\gamma^{3} v_{\pi}\left(S_{t+4}\right)|S_{t}=s\right] \
\ldots \
\leqslant \mathrm{E}<em>{\pi^{\prime}}\left[R</em>{t+1}+\gamma R_{t+2}+\gamma^{2} R_{t+3}+\gamma^{3} R_{t+4}+\cdots|S_{t}=s\right] \
=\mathrm{E}<em>{\pi^{\prime}}\left[G</em>{t}|S_{t}=s\right] \
=v_{\pi^{\prime}}(s), \quad s \in \mathcal{S}
\end{array}
$$
ä¸¥æ ¼ä¸ç­‰å·çš„è¯æ˜ç±»ä¼¼ï¼</p>
<p>å¯¹äºä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ $\pi$ ï¼Œå¦‚æœå­˜åœ¨ç€ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼Œä½¿å¾— $q_{\pi}(s, a)&gt;v_{\pi}(s)$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ–°çš„ç¡®å®šç­–ç•¥ $\pi^{\prime}$ ï¼Œå®ƒåœ¨çŠ¶æ€ $s$ åšåŠ¨ä½œ $a$ ï¼Œè€Œåœ¨é™¤çŠ¶æ€ $s$ ä»¥å¤–çš„çŠ¶æ€çš„åŠ¨ä½œéƒ½å’Œç­–ç•¥ä¸€æ ·ï¼å¯ä»¥éªŒè¯ï¼Œç­–ç•¥ $\pi$ å’Œ $\pi^{\prime}$ æ»¡è¶³ç­–ç•¥æ”¹è¿›å®šç†çš„æ¡ä»¶ï¼è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæ¯”ç­–ç•¥ $\pi$ æ›´å¥½çš„ç­–ç•¥ $\pi^{\prime}$ ï¼è¿™æ ·çš„ç­–ç•¥æ›´æ–°ç®—æ³•å¯ä»¥ç”¨ç®—æ³• 1-2 æ¥è¡¨ç¤ºï¼</p>
<blockquote>
<p><strong>ç®—æ³• 1-2</strong>ï¼š$\quad$æœ‰æ¨¡å‹ç­–ç•¥æ”¹è¿›ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥: åŠ¨åŠ›ç³»ç»Ÿ $p$ ï¼Œç­–ç•¥ $\pi$ åŠå…¶çŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi}$<br />
è¾“å‡ºï¼šæ”¹è¿›çš„ç­–ç•¥ $\pi^{\prime}$ ï¼Œæˆ–ç­–ç•¥ $\pi$ å·²ç»è¾¾åˆ°æœ€ä¼˜çš„æ ‡å¿—</p>
<ol>
<li>å¯¹äºæ¯ä¸ªçŠ¶æ€ $s \in \mathcal{S}$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤:<br />
1.1 ä¸ºæ¯ä¸ªåŠ¨ä½œ $a \in \mathcal{A}$ ï¼Œæ±‚å¾—åŠ¨ä½œä»·å€¼å‡½æ•° $q_{\pi}(s, a) \leftarrow r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{\pi}\left(s^{\prime}\right)$<br />
1.2 æ‰¾åˆ°ä½¿å¾— $q_{\pi}(s, a)$ æœ€å¤§çš„åŠ¨ä½œ $a$ ï¼Œå³ $\pi^{\prime}(s)=\arg\max_{a}q(s, a)$</li>
<li>å¦‚æœæ–°ç­–ç•¥ $\pi^{\prime}$ å’Œæ—§ç­–ç•¥ $\pi$ ç›¸åŒï¼Œåˆ™è¯´æ˜æ—§ç­–ç•¥å·³æ˜¯æœ€ä¼˜; å¦åˆ™ï¼Œè¾“å‡ºæ”¹è¿›çš„æ–°ç­–ç•¥ $\pi^{\prime}$</li>
</ol>
<hr />
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ç®—æ³• 1-2 ä¸­ï¼Œæ—§ç­–ç•¥ $\pi$ å’Œæ–°ç­–ç•¥ $\pi^{\prime}$ åªåœ¨æŸäº›çŠ¶æ€ä¸Šæœ‰ä¸åŒçš„åŠ¨ä½œå€¼, æ–°ç­–ç•¥ $\pi^{\prime}$ å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æ—§ç­–ç•¥ $\pi$ çš„åŸºç¡€ä¸Šä¿®æ”¹å¾—åˆ°ï¼æ‰€ä»¥ï¼Œå¦‚æœåœ¨åç»­ä¸éœ€è¦ä½¿ç”¨æ—§ç­–ç•¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ä¸ºæ–°ç­–ç•¥åˆ†é…ç©ºé—´ï¼</p>
<h4 id="123-ç­–ç•¥è¿­ä»£"><a class="header" href="#123-ç­–ç•¥è¿­ä»£">1.2.3 ç­–ç•¥è¿­ä»£</a></h4>
<p>ç­–ç•¥è¿­ä»£æ˜¯ä¸€ç§ç»¼åˆåˆ©ç”¨ç­–ç•¥è¯„ä¼°å’Œç­–ç•¥æ”¹è¿›æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„è¿­ä»£æ–¹æ³•ï¼</p>
<p>è§ç®—æ³• 1-3 ï¼Œç­–ç•¥è¿­ä»£ä»ä¸€ä¸ªä»»æ„çš„ç¡®å®šæ€§ç­–ç•¥ $\pi_{0}$ å¼€å§‹ï¼Œäº¤æ›¿è¿›è¡Œç­–ç•¥è¯„ä¼°å’Œç­–ç•¥æ”¹è¿›ï¼è¿™é‡Œçš„ç­–ç•¥æ”¹è¿›æ˜¯ä¸¥æ ¼çš„ç­–ç•¥æ”¹è¿›ï¼Œå³æ”¹è¿›åçš„ç­–ç•¥å’Œæ”¹è¿›å‰çš„ç­–ç•¥æ˜¯ä¸åŒçš„ å¯¹äºçŠ¶æ€ç©ºé—´å’ŒåŠ¨ä½œç©ºé—´å‡æœ‰é™çš„ Markov å†³ç­–è¿‡ç¨‹ï¼Œå…¶å¯èƒ½çš„ç¡®å®šæ€§ç­–ç•¥æ•°æ˜¯æœ‰é™çš„ï¼ç”±äºç¡®å®šæ€§ç­–ç•¥æ€»æ•°æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å¾—åˆ°çš„ç­–ç•¥åºåˆ— $\pi_{0}, \pi_{1}, \pi_{2}, \ldots$ ä¸€å®šèƒ½æ”¶æ•›ï¼Œä½¿å¾—åˆ°æŸä¸ª $k$ ï¼Œæœ‰ $\pi_{k}=\pi_{k+1}$ (å³å¯¹ä»»æ„çš„ $s \in \mathcal{S}$ å‡æœ‰ $\left.\pi_{k+1}(s)=\pi_{k}(s)\right)$ ï¼ç”±äºåœ¨ $\pi_{k}=\pi_{k+1}$ çš„æƒ…å†µä¸‹ï¼Œ $\pi_{k}(s)=\pi_{k+1}(s)=\arg \max <em>{a} q</em>{\pi_{k}}(s, a)$ ï¼Œè¿›è€Œ $v_{\pi_{k}}(s)=\max_{a} q_{\pi_{k}}(s, a)$ ï¼Œæ»¡è¶³ Bellman æœ€ä¼˜æ–¹ç¨‹ï¼å› æ­¤ï¼Œ $\pi_{k}$ å°±æ˜¯æœ€ä¼˜ç­–ç•¥ï¼è¿™æ ·å°±è¯æ˜äº†ç­–ç•¥è¿­ä»£èƒ½å¤Ÿæ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 1-3</strong>ï¼š$\quad$æœ‰æ¨¡å‹ç­–ç•¥è¿­ä»£</p>
</blockquote>
<hr />
<p>è¾“å…¥: åŠ¨åŠ›ç³»ç»Ÿ $p$<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥</p>
<ol>
<li>(åˆå§‹åŒ–ï¼‰å°†ç­–ç•¥ $\pi_{0}$ åˆå§‹åŒ–ä¸ºä¸€ä¸ªä»»æ„çš„ç¡®å®šæ€§ç­–ç•¥ï¼</li>
<li>(è¿­ä»£) å¯¹äº $k \leftarrow 0,1,2,3, \ldots$, æ‰§è¡Œä»¥ä¸‹æ­¥éª¤<br />
2.1 ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰ä½¿ç”¨ç­–ç•¥è¯„ä¼°ç®—æ³•ï¼Œè®¡ç®—ç­–ç•¥ $\pi_{k}$ çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi_{k}}$<br />
2.2 ï¼ˆç­–ç•¥æ›´æ–°ï¼‰åˆ©ç”¨çŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi_{k}}$ æ”¹è¿›ç¡®å®šæ€§ç­–ç•¥ $\pi_{k}$ ï¼Œå¾—åˆ°æ”¹è¿›çš„ç¡®å®šæ€§ç­–ç•¥ $\pi_{k+1}$ ï¼å¦‚æœ $\pi_{k+1}=\pi_{k}$ ï¼ï¼ˆå³å¯¹ä»»æ„çš„ $s \in \mathcal{S}$ å‡æœ‰ $\pi_{k+1}(s)=\pi_{k}(s)$ï¼‰ï¼Œåˆ™è¿­ä»£å®Œæˆï¼Œè¿”å›ç­–ç•¥ $\pi_{k}$ ä¸ºæœ€ç»ˆçš„æœ€ä¼˜ç­–ç•¥ï¼</li>
</ol>
<hr />
<p>ç­–ç•¥è¿­ä»£ä¹Ÿå¯ä»¥é€šè¿‡é‡å¤åˆ©ç”¨ç©ºé—´æ¥èŠ‚çº¦ç©ºé—´ï¼ä¸ºäº†èŠ‚çº¦ç©ºé—´ï¼Œåœ¨å„æ¬¡è¿­ä»£ä¸­ç”¨ç›¸åŒçš„ç©ºé—´ $v(s)(s \in \mathcal{S})$ æ¥å­˜å‚¨çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œç”¨ç©ºé—´ $\pi(s)(s \in \mathcal{S})$ æ¥å­˜å‚¨ç¡®å®šæ€§ç­–ç•¥ï¼</p>
<h3 id="13-æœ‰æ¨¡å‹ä»·å€¼è¿­ä»£"><a class="header" href="#13-æœ‰æ¨¡å‹ä»·å€¼è¿­ä»£">1.3 æœ‰æ¨¡å‹ä»·å€¼è¿­ä»£</a></h3>
<p>ä»·å€¼è¿­ä»£æ˜¯ä¸€ç§åˆ©ç”¨è¿­ä»£æ±‚è§£æœ€ä¼˜ä»·å€¼å‡½æ•°è¿›è€Œæ±‚è§£æœ€ä¼˜ç­–ç•¥çš„æ–¹æ³•ï¼åœ¨ $1.2.1$ èŠ‚ä»‹ç»çš„ç­–ç•¥è¯„ä¼°ä¸­ï¼Œè¿­ä»£ç®—æ³•åˆ©ç”¨ Bellman æœŸæœ›æ–¹ç¨‹è¿­ä»£æ±‚è§£ç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼ä¸ä¹‹ç›¸å¯¹ï¼Œæœ¬èŠ‚å°†åˆ©ç”¨ Bellman æœ€ä¼˜æ–¹ç¨‹è¿­ä»£æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼Œå¹¶è¿›è€Œæ±‚å¾—æœ€ä¼˜ç­–ç•¥ï¼</p>
<p>ä¸ç­–ç•¥è¯„ä¼°çš„æƒ…å½¢ç±»ä¼¼ï¼Œä»·å€¼è¿­ä»£ç®—æ³•æœ‰å‚æ•°æ¥æ§åˆ¶è¿­ä»£çš„ç»ˆæ­¢æ¡ä»¶ï¼Œå¯ä»¥æ˜¯è¯¯å·®å®¹å¿åº¦ $\vartheta_{\max }$ æˆ–æ˜¯æœ€å¤§è¿­ä»£æ¬¡æ•° $k_{\max }$ ï¼</p>
<p>ç®—æ³• 1-4 ç»™å‡ºäº†ä¸€ä¸ªä»·å€¼è¿­ä»£ç®—æ³•ï¼è¿™ä¸ªä»·å€¼è¿­ä»£ç®—æ³•ä¸­å…ˆåˆå§‹åŒ–çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œç„¶åç”¨ Bellman æœ€ä¼˜æ–¹ç¨‹æ¥æ›´æ–°çŠ¶æ€ä»·å€¼å‡½æ•°ï¼æ ¹æ®ç¬¬ 1.1 èŠ‚çš„è¯æ˜ï¼Œåªè¦è¿­ä»£æ¬¡æ•°è¶³å¤Ÿå¤šï¼Œæœ€ç»ˆä¼šæ”¶æ•˜åˆ°æœ€ä¼˜ä»·å€¼å‡½æ•°ï¼å¾—åˆ°æœ€ä¼˜ä»·å€¼å‡½æ•°åï¼Œå°±èƒ½å¾ˆè½»æ˜“åœ°ç»™å‡ºç¡®å®šæ€§çš„æœ€ä¼˜ç­–ç•¥ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 1-4</strong>ï¼š$\quad$ æœ‰æ¨¡å‹ä»·å€¼è¿­ä»£ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šåŠ¨åŠ›ç³»ç»Ÿ $p$<br />
æ„‰å‡ºï¼šæœ€ä¼˜ç­–ç•¥ä¼°è®¡ $\pi$<br />
å‚æ•°ï¼šç­–ç•¥è¯„ä¼°éœ€è¦çš„å‚æ•°</p>
<ol>
<li>(åˆå§‹åŒ–) $v_{0}(s) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œ $v_{0}\left(s_{\text {ç»ˆæ­¢ }}\right) \leftarrow 0$</li>
<li>(è¿­ä»£) å¯¹äº $k \leftarrow 0,1,2,3, \ldots$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤<br />
2.1 å¯¹äº $s \in \mathcal{S}$ ï¼Œé€ä¸€æ›´æ–° $v_{k+1}(s) \leftarrow \max_{a}\left{r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{k}\left(s^{\prime}\right)\right}$<br />
2.2 å¦‚æœæ»¡è¶³è¯¯å·®å®¹å¿åº¦ (å³å¯¹äº $s \in \mathcal{S}$ å‡æœ‰ $\left.\left|v_{k+1}(s)-v_{k}(s)\right|&lt;\vartheta\right)$ æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•° (å³
$\left.k=k_{\max }\right)$ ï¼Œåˆ™è·³å‡ºå¾ªç¯</li>
<li>(ç­–ç•¥) æ ¹æ®ä»·å€¼å‡½æ•°è¾“å‡ºç¡®å®šæ€§ç­–ç•¥ $\pi_{<em>}$ ï¼Œä½¿å¾—$\pi_{</em>}(s) \leftarrow \underset{a}{\arg \max }\left{r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{k+1}\left(s^{\prime}\right)\right}, \quad s \in \mathcal{S}_{0}$</li>
</ol>
<hr />
<p>ä¸ç­–ç•¥è¯„ä¼°çš„è¿­ä»£æ±‚è§£ç±»ä¼¼ï¼Œä»·å€¼è¿­ä»£ä¹Ÿå¯ä»¥åœ¨å­˜å‚¨çŠ¶æ€ä»·å€¼å‡½æ•°æ—¶é‡å¤ä½¿ç”¨ç©ºé—´ï¼ç®—æ³• 1-5 ç»™å‡ºäº†é‡å¤ä½¿ç”¨ç©ºé—´ä»¥èŠ‚çº¦ç©ºé—´çš„ç‰ˆæœ¬ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 1-5</strong>ï¼š$\quad$æœ‰æ¨¡å‹ä»·å€¼è¿­ä»£ (èŠ‚çº¦ç©ºé—´çš„ç‰ˆæœ¬ )</p>
</blockquote>
<hr />
<p>è¾“å…¥: åŠ¨åŠ›ç³»ç»Ÿ $p$<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥<br />
å‚æ•°ï¼šç­–ç•¥è¯„ä¼°éœ€è¦çš„å‚æ•°</p>
<ol>
<li>(åˆå§‹åŒ–) $v_{0}(s) \leftarrow$ ä»»æ„å€¼, $s \in \mathcal{S}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œ $v_{0}\left(s_{\text {ç»ˆæ­¢ }}\right) \leftarrow 0$</li>
<li>(è¿­ä»£) å¯¹äº $k \leftarrow 0,1,2,3, \ldots$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤<br />
2.1 å¯¹äºä½¿ç”¨è¯¯å·®å®¹å¿åº¦çš„æƒ…å†µï¼Œåˆå§‹åŒ–æœ¬æ¬¡è¿­ä»£è§‚æµ‹åˆ°çš„æœ€å¤§è¯¯å·® $\vartheta \leftarrow 0$<br />
2.2 å¯¹äº $s \in \mathcal{S}$ æ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>è®¡ç®—æ–°çŠ¶æ€ä»·å€¼ $v_{\text {æ–°}}\leftarrow\max_{a}\left{r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v\left(s^{\prime}\right)\right}$</li>
<li>å¯¹äºä½¿ç”¨è¯¯å·®å®¹å¿åº¦çš„æƒ…å†µï¼Œæ›´æ–°æœ¬æ¬¡è¿­ä»£è§‚æµ‹åˆ°çš„æœ€å¤§è¯¯å·® $\vartheta \leftarrow \max \left{\vartheta,\left|v_{\text {æ–°}}-v(s)\right|\right}$</li>
<li>æ›´æ–°çŠ¶æ€ä»·å€¼å‡½æ•° $v(s) \leftarrow v_{\text {æ–°}}$<br />
2.3 å¦‚æœæ»¡è¶³è¯¯å·®å®¹å¿åº¦ï¼ˆå³ $\left.\vartheta&lt;\vartheta_{\max }\right)$ æˆ–è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•° $\left(\right.$ å³ $\left.k=k_{\max }\right)$ ï¼Œåˆ™è·³å‡ºå¾ªç¯</li>
</ol>
</li>
<li>(ç­–ç•¥) æ ¹æ®ä»·å€¼å‡½æ•°è¾“å‡ºç¡®å®šæ€§ç­–ç•¥:
$$
\pi(s)=\underset{a}{\arg \max }\left{r(s, a)+\gamma \sum_{s} p\left(s^{\prime}|s, a\right) v\left(s^{\prime}\right)\right}ï¼
$$</li>
</ol>
<hr />
<h2 id="äºŒ-å›åˆæ›´æ–°ä»·å€¼è¿­ä»£"><a class="header" href="#äºŒ-å›åˆæ›´æ–°ä»·å€¼è¿­ä»£">äºŒï¼ å›åˆæ›´æ–°ä»·å€¼è¿­ä»£</a></h2>
<p>æœ¬ç« å¼€å§‹ä»‹ç»æ— æ¨¡å‹çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼æ— æ¨¡å‹çš„æœºå™¨å­¦ä¹ ç®—æ³•åœ¨æ²¡æœ‰ç¯å¢ƒçš„æ•°å­¦æè¿°çš„æƒ…å†µä¸‹ï¼Œåªä¾é ç»éªŒï¼ˆä¾‹å¦‚è½¨è¿¹çš„æ ·æœ¬) å­¦ä¹ å‡ºç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°å’Œæœ€ä¼˜ç­–ç•¥ï¼åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œä¸ºç¯å¢ƒå»ºç«‹ç²¾ç¡®çš„æ•°å­¦æ¨¡å‹å¾€å¾€éå¸¸å›°éš¾ï¼å› æ­¤ï¼Œæ— æ¨¡å‹çš„å¼ºåŒ–å­¦ä¹ æ˜¯å¼ºåŒ–å­¦ä¹ çš„ä¸»è¦å½¢å¼ï¼</p>
<p>æ ¹æ®ä»·å€¼å‡½æ•°çš„æ›´æ–°æ—¶æœºï¼Œå¼ºåŒ–å­¦ä¹ å¯ä»¥åˆ†ä¸ºå›åˆæ›´æ–°ç®—æ³•å’Œæ—¶åºå·®åˆ†æ›´æ–°ç®—æ³•è¿™ä¸¤ç±»ï¼å›åˆæ›´æ–°ç®—æ³•åªèƒ½ç”¨äºå›åˆåˆ¶ä»»åŠ¡ï¼Œå®ƒåœ¨æ¯ä¸ªå›åˆç»“æŸåæ›´æ–°ä»·å€¼å‡½æ•°ï¼æœ¬ç« å°†ä»‹ç»å›åˆæ›´æ–°ç®—æ³•ï¼ŒåŒ…æ‹¬åŒç­–å›åˆæ›´æ–°ç®—æ³•å’Œå¼‚ç­–å›åˆæ›´æ–°ç®—æ³•ï¼</p>
<h3 id="21-åŒç­–å›åˆæ›´æ–°"><a class="header" href="#21-åŒç­–å›åˆæ›´æ–°">2.1 åŒç­–å›åˆæ›´æ–°</a></h3>
<p>æœ¬èŠ‚ä»‹ç»åŒç­–å›åˆæ›´æ–°ç®—æ³•ï¼ä¸æœ‰æ¨¡å‹è¿­ä»£æ›´æ–°çš„æƒ…å†µç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å…ˆå­¦ä¹ åŒç­–ç­–ç•¥è¯„ä¼°ï¼Œå†å­¦ä¹ æœ€ä¼˜ç­–ç•¥æ±‚è§£ï¼</p>
<h4 id="211-åŒç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°"><a class="header" href="#211-åŒç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°">2.1.1 åŒç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°</a></h4>
<p>æœ¬èŠ‚è€ƒè™‘ç”¨å›åˆæ›´æ–°çš„æ–¹æ³•å­¦ä¹ ç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼æˆ‘ä»¬çŸ¥é“ï¼ŒçŠ¶æ€ä»·å€¼å’ŒåŠ¨ä½œä»·å€¼åˆ†åˆ«æ˜¯åœ¨ç»™å®šçŠ¶æ€å’ŒçŠ¶æ€åŠ¨ä½œå¯¹çš„æƒ…å†µä¸‹å›æŠ¥çš„æœŸæœ›å€¼ï¼å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°çš„åŸºæœ¬æ€è·¯ä½¿ç”¨ Monte Carlo æ–¹æ³•æ¥ä¼°è®¡è¿™ä¸ªæœŸæœ›å€¼ï¼å…·ä½“è€Œè¨€ï¼Œåœ¨è®¸å¤šè½¨è¿¹æ ·æœ¬ä¸­ï¼Œå¦‚æœæŸä¸ªçŠ¶æ€(æˆ–çŠ¶æ€åŠ¨ä½œå¯¹) å‡ºç°äº† $c$ æ¬¡ï¼Œå…¶å¯¹åº”çš„å›æŠ¥å€¼åˆ†åˆ«ä¸º $g_{1}, g_{2}, \ldots, g_{c}$ ï¼Œé‚£ä¹ˆå¯ä»¥ä¼°è®¡å…¶çŠ¶æ€ä»· (æˆ–åŠ¨ä½œä»·å€¼) ä¸º $\frac{1}{c} \sum_{i=1}^{c} g_{i}$ï¼</p>
<p>æ— æ¨¡å‹ç­–ç•¥è¯„ä¼°ç®—æ³•æœ‰<strong>è¯„ä¼°çŠ¶æ€ä»·å€¼å‡½æ•°</strong>å’Œ<strong>è¯„ä¼°åŠ¨ä½œä»·å€¼å‡½æ•°</strong>ä¸¤ç§ç‰ˆæœ¬ï¼åœ¨æœ‰æ¨¡å‹æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ä»·å€¼å’ŒåŠ¨ä½œä»·å€¼å¯ä»¥äº’ç›¸è¡¨ç¤ºï¼›ä½†æ˜¯åœ¨æ— æ¨¡å‹çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ä»·å€¼å’ŒåŠ¨ä½œä»·å€¼å¹¶ä¸èƒ½äº’ç›¸è¡¨ç¤ºï¼æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œä»»æ„ç­–ç•¥çš„ä»·å€¼å‡½æ•°æ»¡è¶³ Bellman æœŸæœ›æ–¹ç¨‹ï¼å€ŸåŠ©äºåŠ¨åŠ› $p$ï¼ˆæŸä¸ªçŠ¶æ€è½¬ç§»åˆ†å¸ƒï¼‰çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çŠ¶æ€ä»·å€¼å‡½æ•°è¡¨ç¤ºåŠ¨ä½œä»·å€¼å‡½æ•°ï¼›å€ŸåŠ©äºç­–ç•¥ $\pi$ çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŠ¨ä½œä»·å€¼å‡½æ•°è¡¨ç¤ºçŠ¶æ€ä»·å€¼å‡½æ•°ï¼æ‰€ä»¥ï¼Œå¯¹äºæ— æ¨¡å‹çš„ç­–ç•¥è¯„ä¼°ï¼Œ $p$ çš„è¡¨è¾¾å¼æœªçŸ¥ï¼Œåªèƒ½ç”¨åŠ¨ä½œä»·å€¼è¡¨ç¤ºçŠ¶æ€ä»·å€¼ï¼Œè€Œä¸èƒ½ç”¨çŠ¶æ€ä»·å€¼è¡¨ç¤ºåŠ¨ä½œä»·å€¼ï¼å¦å¤–ï¼Œç”±äºç­–ç•¥æ”¹è¿›å¯ä»¥ä»…ç”±åŠ¨ä½œä»·å€¼å‡½æ•°ç¡®å®šï¼Œå› æ­¤åœ¨å­¦ä¹ é—®é¢˜ä¸­ï¼ŒåŠ¨ä½œä»·å€¼å‡½æ•°å¾€å¾€æ›´åŠ é‡è¦ï¼</p>
<p>åœ¨åŒä¸€ä¸ªå›åˆä¸­ï¼Œå¤šä¸ªæ­¥éª¤å¯èƒ½ä¼šåˆ°è¾¾åŒä¸€ä¸ªçŠ¶æ€ (æˆ–çŠ¶æ€åŠ¨ä½œå¯¹)ï¼Œå³åŒä¸€çŠ¶æ€ï¼ˆæˆ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰å¯èƒ½ä¼šè¢«å¤šæ¬¡è®¿é—®ï¼å¯¹äºä¸åŒæ¬¡çš„è®¿é—®ï¼Œè®¡ç®—å¾—åˆ°çš„å›æŠ¥æ ·æœ¬å€¼å¾ˆå¯èƒ½ä¸ç›¸ åŒï¼å¦‚æœé‡‡ç”¨å›åˆå†…å…¨éƒ¨çš„å›æŠ¥æ ·æœ¬å€¼æ›´æ–°ä»·å€¼å‡½æ•°, åˆ™ç§°ä¸º<strong>æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°</strong>ï¼ˆevery visit Monte Carlo update); å¦‚æœæ¯ä¸ªå›åˆåªé‡‡ç”¨ç¬¬ä¸€æ¬¡è®¿é—®çš„å›æŠ¥æ ·æœ¬æ›´æ–°ä»·å€¼å‡½æ•°ï¼Œåˆ™ç§°ä¸º<strong>é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°</strong>ï¼ˆ first visit Monte Carlo update)ï¼æ¯æ¬¡è®¿é—®å’Œé¦–æ¬¡è®¿é—®åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¸­é—´å€¼å¹¶ä¸ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬éƒ½èƒ½æ”¶æ•›åˆ°çœŸå®çš„ä»·å€¼å‡½æ•°ï¼</p>
<p>é¦–å…ˆæ¥çœ‹æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°ç®—æ³•ï¼ç®—æ³• 2-1 ç»™å‡ºäº†æ¯æ¬¡è®¿é—®æ›´æ–°æ±‚åŠ¨ä½œä»·å€¼çš„ç®—æ³•ï¼æˆ‘ä»¬æ¥é€æ­¥çœ‹ä¸€ä¸‹ç®—æ³• 2-1 ï¼ç®—æ³• 2-1 é¦–å…ˆå¯¹åŠ¨ä½œä»·å€¼ $q(s, a)$ è¿›è¡Œåˆå§‹åŒ–ï¼ $q(s, a)$ å¯ä»¥åˆå§‹åŒ–ä¸ºä»»æ„çš„å€¼ï¼Œå› ä¸ºåœ¨ç¬¬ä¸€æ¬¡æ›´æ–°å $q(s, a)$ çš„å€¼å°±å’Œåˆå§‹åŒ–çš„å€¼æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å°† $q(s, a)$ åˆå§‹åŒ–ä¸ºä»€ä¹ˆæ•°æ— å…³ç´§è¦ï¼æ¥ç€ï¼Œç®—æ³• 2-1 è¿›è¡Œå›åˆæ›´æ–°ï¼ä¸æœ‰æ¨¡å‹è¿­ä»£æ›´æ–°çš„æƒ…å½¢ç±»ä¼¼ï¼Œè¿™é‡Œå¯ä»¥ç”¨å‚æ•°æ¥æ§åˆ¶å›åˆæ›´æ–°çš„å›åˆæ•°ï¼ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æœ€å¤§å›åˆæ•° $k_{\max }$ æˆ–è€…ç²¾åº¦æŒ‡æ ‡ $\vartheta_{\max }$ ï¼åœ¨ç”Ÿæˆå¥½è½¨è¿¹åï¼Œç®—æ³• 2-1 é‡‡ç”¨é€†åºçš„æ–¹å¼æ›´æ–° $q(s, a)$ ï¼è¿™é‡Œé‡‡ç”¨é€†åºæ˜¯ä¸ºäº†ä½¿ç”¨ $G_{t}=R_{t+1}+\gamma G_{t+1}$ è¿™ä¸€å…³ç³»æ¥æ›´æ–° $G$ å€¼ï¼Œä»¥å‡å°è®¡ç®—å¤æ‚åº¦ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 2-1</strong>ï¼š$\quad$æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°)ï¼Œç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼å‡½æ•° $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}$</p>
<ol>
<li>(åˆå§‹åŒ–) åˆå§‹åŒ–åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a)\leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼Œè‹¥æ›´æ–°ä»·å€¼éœ€è¦ä½¿ç”¨è®¡æ•° å™¨ï¼Œåˆ™åˆå§‹åŒ–è®¡æ•°å™¨ $c(s, a) \leftarrow 0, s \in \mathcal{S}, a \in \mathcal{A}$ ã€‚</li>
<li>(å›åˆæ›´æ–°) å¯¹äºæ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ
2.1 (é‡‡æ ·) ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$
2.2 (åˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$
2.3 (é€æ­¥æ›´æ–°ï¼‰å¯¹ $t \leftarrow T-1, T-2, \ldots, 0$ æ‰§è¡Œä»¥ä¸‹æ­¥éª¤
1. ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$
2. ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼ï¼‰æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\left[G-q\left(S_{t}, A_{y}\right)\right]^{2}$ ï¼ˆå¦‚ $c\left(S_{t}, A_{t}\right) \leftarrow c\left(S_{t}, A_{t}\right)+1$ ï¼Œ $\left.q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\frac{1}{c\left(S_{t}, A_{t}\right)}\left[G-q\left(S_{t}, A_{t}\right)\right]\right)$ï¼</li>
</ol>
<hr />
<p>ç®—æ³• 2-1 åœ¨æ›´æ–°åŠ¨ä½œä»·å€¼æ—¶ï¼Œå¯ä»¥é‡‡ç”¨å¢é‡æ³•æ¥å®ç° Monte Carlo æ–¹æ³•ï¼å¢é‡æ³•çš„åŸç†å¦‚ä¸‹ï¼šå¦‚å‰ $c-1$ æ¬¡è§‚å¯Ÿåˆ°çš„å›æŠ¥æ ·æœ¬æ˜¯ $g_{1}, g_{2}, \ldots, g_{c-1}$ ï¼Œåˆ™å‰ $c-1$ æ¬¡ä»·å€¼å‡½æ•°çš„ä¼°è®¡å€¼ä¸º$\bar{g}<em>{c-1}=\frac{1}{c-1} \sum</em>{i=1}^{c-1} g_{i}$ ï¼›å¦‚æœç¬¬ $c$ æ¬¡çš„å›æŠ¥æ ·æœ¬æ˜¯ $g_{c}$ ï¼Œåˆ™å‰ $c$ æ¬¡ä»·å€¼å‡½æ•°çš„ä¼°è®¡å€¼ä¸º $\bar{g}<em>{c}=\frac{1}{c} \sum</em>{i=1}^{c}g_i$ å¯ä»¥è¯æ˜ï¼Œ $\bar{g}<em>{c}=\bar{g}</em>{c-1}+\frac{1}{c}\left(g_{c}-\bar{g}<em>{c-1}\right)$ ï¼æ‰€ä»¥ï¼Œåªè¦çŸ¥é“å‡ºç°çš„æ¬¡æ•° $c$ ï¼Œå°±å¯ä»¥ç”¨æ–°çš„è§‚æµ‹ $g</em>{c}$ æŠŠæ—§çš„å¹³å‡å€¼ $\bar{g}<em>{c-1}$ æ›´æ–°ä¸ºæ–°çš„å¹³å‡å€¼ $\bar{g}</em>{c}$ ï¼å› æ­¤ï¼Œå¢é‡æ³•ä¸ä»…éœ€è¦è®°å½•å½“å‰çš„ä»·å€¼ä¼°è®¡ $\bar{g}_{c-1}$ è¿˜éœ€è¦è®°å½•çŠ¶æ€åŠ¨ä½œå¯¹å‡ºç°çš„æ¬¡æ•° $c$ ï¼åœ¨ç®—æ³• 2-1 ä¸­ï¼ŒçŠ¶æ€åŠ¨ä½œå¯¹ $(s, a)$ çš„å‡ºç°æ¬¡æ•°è®°å½•åœ¨ $c(s, a)$ é‡Œï¼Œæ¯æ¬¡æ›´æ–°æ—¶å°†è®¡æ•°å€¼åŠ  1ï¼Œå†æ›´æ–°å¹³å‡å€¼ $q(s, a)$ ï¼Œè¿™æ ·å°±å®ç°äº†å¢é‡æ³•ï¼</p>
<p>æ±‚å¾—åŠ¨ä½œä»·å€¼åï¼Œå¯ä»¥ç”¨ Bellman æœŸæœ›æ–¹ç¨‹æ±‚å¾—çŠ¶æ€ä»·å€¼ï¼çŠ¶æ€ä»·å€¼ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å›åˆæ›´æ–°çš„æ–¹æ³•å¾—åˆ°ï¼ç®—æ³• 2-2 ç»™å‡ºäº†æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼çš„ç®—æ³•ï¼å®ƒä¸ç®—æ³• 2-1 çš„åŒºåˆ«åœ¨äºå°† $q(s, a)$ æ›¿æ¢ä¸ºäº† $v(s)$ ï¼Œè®¡æ•°ä¹Ÿç›¸åº”åšäº†ä¿®æ”¹ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 4-2</strong>ï¼š$\quad$ æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°)ï¼Œç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼å‡½æ•° $v(s), s \in \mathcal{S}$</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–çŠ¶æ€ä»·å€¼ä¼°è®¡ $v(s) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}$ ï¼Œè‹¥æ›´æ–°ä»·å€¼æ—¶éœ€è¦ä½¿ç”¨è®¡æ•°å™¨åˆ™æ›´æ–°åˆå§‹åŒ–è®¡æ•°å™¨ $c(s) \leftarrow 0, s \in \mathcal{S}$</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹äºæ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$ ã€‚
2.3 ï¼ˆé€æ­¥æ›´æ–°ï¼‰ å¯¹ $t \leftarrow T-1, T-2, \ldots, 0 ï¼Œ$ æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ :
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ä»·å€¼ï¼‰æ›´æ–° $v\left(S_{t}\right)$ ä»¥å‡å° $\left[G-v\left(S_{t}\right)\right]^{2}\left(\right.$ å¦‚ $c\left(S_{t}\right) \leftarrow c\left(S_{t}\right)+1, v\left(S_{t}\right) \leftarrow$ï¼Œ$\left.v\left(S_{t}\right)+\frac{1}{c\left(S_{t}\right)}\left[G-v\left(S_{t}\right)\right]\right)$</li>
</ol>
</li>
</ol>
<hr />
<p>é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°æ˜¯æ¯”æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°æ›´ä¸ºå†å²æ‚ ä¹…ã€æ›´ä¸ºå…¨é¢ç ”ç©¶çš„ç®—æ³•ï¼ç®—æ³• 2-3 ç»™å‡ºäº†é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°æ±‚åŠ¨ä½œä»·å€¼çš„ç®—æ³•ï¼è¿™ä¸ªç®—æ³•å’Œç®—æ³• 2-1 çš„åŒºåˆ«åœ¨äºï¼Œåœ¨æ¯æ¬¡å¾—åˆ°è½¨è¿¹æ ·æœ¬åï¼Œå…ˆæ‰¾å‡ºå„çŠ¶æ€åˆ†åˆ«åœ¨å“ªäº›æ­¥éª¤è¢«é¦–æ¬¡è®¿é—®ï¼åœ¨åç»­çš„æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œåªåœ¨é‚£äº›é¦–æ¬¡è®¿é—®çš„æ­¥éª¤æ›´æ–°ä»·å€¼å‡½æ•°çš„ä¼°è®¡å€¼ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 2-3</strong>ï¼š$\quad$é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ï¼Œç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼å‡½æ•° $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}$ ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼Œè‹¥æ›´æ–°åŠ¨ä½œä»·å€¼æ—¶éœ€è¦è®¡æ•°å™¨ï¼Œåˆ™åˆå§‹åŒ–è®¡æ•°å™¨ $c(s, a) \leftarrow 0, s \in \mathcal{S}, a \in \mathcal{A}$ ï¼</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹äºæ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1  ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰$G \leftarrow 0$<br />
2.3 ï¼ˆåˆå§‹åŒ–é¦–æ¬¡å‡ºç°çš„æ­¥éª¤æ•°ï¼‰$f(s, a) \leftarrow-1, s \in \mathcal{S}, a \in \mathcal{A}$<br />
2.4 ï¼ˆç»Ÿè®¡é¦–æ¬¡å‡ºç°çš„æ­¥éª¤æ•°ï¼‰å¯¹äº $t \leftarrow 0,1, \ldots, T-1$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼šå¦‚æœ $f\left(S_{t}, A_{t}\right)&lt;0$ ï¼Œåˆ™ $f\left(S_{t}, A_{t}\right) \leftarrow t$<br />
2.5 ï¼ˆé€æ­¥æ›´æ–°ï¼‰å¯¹ $t \leftarrow T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆé¦–æ¬¡å‡ºç°åˆ™æ›´æ–°ï¼‰å¦‚æœ $f\left(S_{t}, A_{t}\right)=t$ ï¼Œåˆ™æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\left[G-q\left(S_{t}, A_{t}\right)\right]^{2}$å¦‚$\left.c\left(S_{t}, A_{t}\right) \leftarrow c\left(S_{t}, A_{t}\right)+1, \quad q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\frac{1}{c\left(S_{t}, A_{t}\right)}\left[G-q\left(S_{t}, A_{t}\right)\right]\right)$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>ä¸æ¯æ¬¡è®¿é—®çš„æƒ…å½¢ç±»ä¼¼ï¼Œé¦–æ¬¡è®¿é—®ä¹Ÿå¯ä»¥ç›´æ¥ä¼°è®¡çŠ¶æ€ä»·å€¼ï¼Œè§ç®—æ³• 2-4 ï¼å½“ç„¶ä¹Ÿå¯å€ŸåŠ© Bellman æœŸæœ›æ–¹ç¨‹ç”¨åŠ¨ä½œä»·å€¼æ±‚å¾—çŠ¶æ€ä»·å€¼ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 2-4</strong>ï¼š$\quad$é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ï¼Œç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼å‡½æ•° $v(s), s \in \mathcal{S}$</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–çŠ¶æ€ä»·å€¼ä¼°è®¡ $v(s) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}$ ï¼Œè‹¥æ›´æ–°ä»·å€¼æ—¶éœ€è¦ä½¿ç”¨è®¡æ•°å™¨ï¼Œæ›´æ–°åˆå§‹åŒ–è®¡æ•°å™¨ $c(s) \leftarrow 0, s \in \mathcal{S}$</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹äºæ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$<br />
2.3 ï¼ˆåˆå§‹åŒ–é¦–æ¬¡å‡ºç°çš„æ­¥éª¤æ•°ï¼‰ $f(s) \leftarrow-1, s \in \mathcal{S}$<br />
2.4 ï¼ˆç»Ÿè®¡é¦–æ¬¡å‡ºç°çš„æ­¥éª¤æ•°ï¼‰å¯¹äº $t \leftarrow 0,1, \ldots, T-1$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼šå¦‚æœ $f\left(S_{t}\right)&lt;0$ ï¼Œåˆ™ $f\left(S_{t}\right) \leftarrow t$<br />
2.5 ï¼ˆé€æ­¥æ›´æ–°ï¼‰å¯¹ $t \leftarrow T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ :
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆé¦–æ¬¡å‡ºç°åˆ™æ›´æ–°ï¼‰å¦‚æœ $f\left(S_{t}\right)=t$ ï¼Œåˆ™æ›´æ–° $v\left(S_{t}\right)$ ä»¥å‡å° $\left[G-v\left(S_{t}\right)\right]^{2}\left(\right.$ å¦‚ $c\left(S_{t}\right) \leftarrow$ï¼Œ$\left.c\left(S_{t}\right)+1, \quad v\left(S_{t}\right) \leftarrow v\left(S_{t}\right)+\frac{1}{c\left(S_{t}\right)}\left[G-v\left(S_{t}\right)\right]\right)$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>TODO:èµ·å§‹æ¢ç´¢ä¸æŸ”æ€§ç­–ç•¥</p>
<h3 id="22-å¼‚ç­–å›åˆæ›´æ–°"><a class="header" href="#22-å¼‚ç­–å›åˆæ›´æ–°">2.2 å¼‚ç­–å›åˆæ›´æ–°</a></h3>
<p>æœ¬èŠ‚è€ƒè™‘å¼‚ç­–å›åˆæ›´æ–°ï¼å¼‚ç­–ç®—æ³•å…è®¸ç”Ÿæˆè½¨è¿¹çš„ç­–ç•¥å’Œæ­£åœ¨è¢«è¯„ä¼°æˆ–è¢«ä¼˜åŒ–çš„ç­–è·¯ä¸æ˜¯åŒä¸€ç­–ç•¥ï¼æˆ‘ä»¬å°†å¼•äººå¼‚ç­–ç®—æ³•ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µâ€”â€”é‡è¦æ€§é‡‡æ ·ï¼Œå¹¶ç”¨å…¶è¿›è¡Œ ç­–ç•¥è¯„ä¼°å’Œæ±‚è§£æœ€ä¼˜ç­–ç•¥ï¼</p>
<h4 id="221-é‡è¦æ€§é‡‡æ ·"><a class="header" href="#221-é‡è¦æ€§é‡‡æ ·">2.2.1 é‡è¦æ€§é‡‡æ ·</a></h4>
<p>åœ¨ç»Ÿè®¡å­¦ä¸Šï¼Œ<strong>é‡è¦æ€§é‡‡æ ·</strong>ï¼ˆimportance samplingï¼‰æ˜¯ä¸€ç§ç”¨ä¸€ä¸ªåˆ†å¸ƒç”Ÿæˆçš„æ ·æœ¬æ¥ä¼°è®¡å¦ä¸€ä¸ªåˆ†å¸ƒçš„ç»Ÿè®¡é‡çš„æ–¹æ³•ï¼åœ¨å¼‚ç­–å­¦ä¹ ä¸­ï¼Œå°†è¦å­¦ä¹ çš„ç­–ç•¥ $\pi$ ç§°ä¸º<strong>ç›®æ ‡ç­–ç•¥</strong>ï¼ˆtarget policyï¼‰ï¼Œå°†ç”¨æ¥ç”Ÿæˆè¡Œä¸ºçš„å¦ä¸€ç­–ç•¥ $b$ ç§°ä¸ºè¡Œä¸ºç­–ç•¥ï¼ˆbehavior policy )ï¼é‡è¦æ€§é‡‡æ ·å¯ä»¥ç”¨è¡Œä¸ºç­–ç•¥ç”Ÿæˆçš„è½¨è¿¹æ ·æœ¬ç”Ÿæˆç›®æ ‡ç­–ç•¥çš„ç»Ÿè®¡é‡ï¼</p>
<p>ç°åœ¨è€ƒè™‘ä» $t$ å¼€å§‹çš„è½¨è¿¹ $S_{t}, A_{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$ ï¼åœ¨ç»™å®š $S_{t}$ çš„æ¡ä»¶ä¸‹ï¼Œé‡‡ç”¨
ç­–ç•¥ $\pi$ å’Œç­–ç•¥ $b$ ç”Ÿæˆè¿™ä¸ªè½¨è¿¹çš„æ¦‚ç‡åˆ†åˆ«ä¸ºï¼š
$$
\begin{array}{l}
\operatorname{\mathbb{P}}<em>{\pi}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}\right] \
\quad=\pi\left(A_t|S_{t}\right) p\left(S_{t+1}, R_{t+1}|S_{t}, A_{t}\right) \pi\left(A_{t+1}|S_{t+1}\right) \cdots p\left(S_{T}, R_{T}|S_{T-1}, A_{T-1}\right) \
\quad=\prod_{\tau=t}^{T-1} \pi\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{T-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{r}, A_{r}\right), \
\operatorname{\mathbb{P}}<em>{b}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}\right] \
=b\left(A_{t}|S_{t}\right) p\left(S_{t+1}, R_{t+1}|S_{t}, A_{t}\right) b\left(A_{t+1}|S_{t+1}\right) \cdots p\left(S_{T}, R_{T}|S_{T-1}, A_{T-1}\right) \
=\prod_{\tau=t}^{T-1} b\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{T-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right)
\end{array}
$$
æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ªæ¦‚ç‡çš„æ¯”å€¼å®šä¹‰ä¸º<strong>é‡è¦æ€§é‡‡æ ·æ¯”ç‡</strong> (importance sample ratio)ï¼š
$$
\rho_{t:T-1}=\frac{\operatorname{\mathbb{P}}<em>{\pi}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}\right]}{\operatorname{\mathbb{P}}<em>{b}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}\right]}=\prod_{\tau=t}^{T-1} \frac{\pi\left(A_{\tau}|S_{\tau}\right)}{b\left(A_{\tau}|S_{\tau}\right)}
$$
è¿™ä¸ªæ¯”ç‡åªä¸è½¨è¿¹å’Œç­–ç•¥æœ‰å…³ï¼Œè€Œä¸åŠ¨åŠ›æ— å…³ï¼ä¸ºäº†è®©è¿™ä¸ªæ¯”ç‡å¯¹ä¸åŒçš„è½¨è¿¹æ€»æ˜¯æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿å¾—ä»»ä½•æ»¡è¶³ $\pi(a|s)&gt;0$ çš„ $s \in \mathcal{S}, a \in \mathcal{A}(s)$ ï¼Œå‡æœ‰ $b(a|s)&gt;0$ è¿™æ ·çš„å…³ç³»å¯ä»¥è®°ä¸º$\pi \ll b$.</p>
<p>å¯¹äºç»™å®šçŠ¶æ€åŠ¨ä½œå¯¹ $\left(S_{t}, A_{t}\right)$ çš„æ¡ä»¶æ¦‚ç‡ä¹Ÿæœ‰ç±»ä¼¼çš„åˆ†æï¼åœ¨ç»™å®š $\left(S_{t}, A_{t}\right)$ çš„æ¡ä»¶ä¸‹ï¼Œé‡‡ç”¨ç­–ç•¥ $\pi$ å’Œç­–ç•¥ $b$ ç”Ÿæˆè¿™ä¸ªè½¨è¿¹çš„æ¦‚ç‡åˆ†åˆ«ä¸ºï¼š
$$
\begin{array}{l}
\operatorname{\mathbb{P}}<em>{\pi}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}, A_{t}\right] \
\quad=p\left(S_{t+1}, R_{t+1}|S_{t}, A_{t}\right) \pi\left(A_{t+1}|S_{t+1}\right) \cdots p\left(S_{T}, R_{T}|S_{T-1}, A_{T-1}\right) \
\quad=\prod_{\tau=t+1}^{T-1} \pi\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{T-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right) \
\operatorname{\mathbb{P}}<em>{b}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}|S_{t}, A\right] \
\quad=p\left(S_{t+1}, R_{t+1}|S_{t}, A_t\right) b\left(A_{t+1}|S_{t+1}\right) \cdots p\left(S_{T}, R_{T}|S_{T-1}, A_{T-1}\right) \
\quad=\prod_{\tau=t+1}^{T-1} b\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{T-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right)
\end{array}
$$
å…¶æ¦‚ç‡çš„æ¯”å€¼ä¸º
$$
\rho_{t+1: T-1}=\prod_{\tau=t+1}^{T-1} \frac{\pi\left(A_{\tau}|S_{\tau}\right)}{b\left(A_{\tau}|S_{\tau}\right)}
$$
å›åˆæ›´æ–°æ€»æ˜¯ä½¿ç”¨ Monte Carlo ä¼°è®¡ä»·å€¼å‡½æ•°çš„å€¼ï¼åŒç­–å›åˆæ›´æ–°å¾—åˆ° $c$ ä¸ªå›æŠ¥ $g_{1}, g_{2}, \ldots, g_{c}$ åï¼Œç”¨å¹³å‡å€¼ $\frac{1}{c} \sum_{i=1}^{c} g_{i}$ æ¥ä½œä¸ºä»·å€¼å‡½æ•°çš„ä¼°è®¡ï¼è¿™æ ·çš„æ–¹æ³•å®é™…ä¸Šé»˜è®¤äº†è¿™ $c$ ä¸ªå›æŠ¥æ˜¯ç­‰æ¦‚ç‡å‡ºç°çš„ï¼ç±»ä¼¼çš„æ˜¯ï¼Œå¼‚ç­–å›åˆæ›´æ–°ç”¨è¡Œä¸ºç­–ç•¥ $b$ å¾—åˆ° $c$ ä¸ªå›æŠ¥ $g_{1}, g_{2}, \ldots, g_{c}$ ï¼Œè¿™ä¸ªå›æŠ¥å€¼å¯¹äºè¡Œä¸ºç­–ç•¥ $b$ æ˜¯ç­‰æ¦‚ç‡å‡ºç°çš„ï¼ä½†æ˜¯è¿™ $c$ ä¸ªå›æŠ¥å€¼å¯¹äºç›®æ ‡ç­–ç•¥ $\pi$ ä¸æ˜¯ç­‰æ¦‚ç‡å‡ºç°çš„ï¼å¯¹äºç›®æ ‡ç­–ç•¥ $\pi$ è€Œè¨€ï¼Œè¿™ $c$ ä¸ªå›æŠ¥å€¼å‡ºç°çš„æ¦‚ç‡æ­£æ˜¯å„è½¨è¿¹çš„é‡è¦æ€§é‡‡æ ·æ¯”ç‡ï¼è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŠ æƒå¹³å‡æ¥å®Œæˆ Monte Carlo ä¼°è®¡ï¼å…·ä½“è€Œè¨€ï¼Œè‹¥ $\rho_{i}(1 \leqslant i \leqslant c)$ æ˜¯å›æŠ¥æ ·æœ¬ $g_{i}$ å¯¹åº”çš„æƒé‡ï¼ˆå³è½¨è¿¹çš„é‡è¦æ€§é‡‡æ ·æ¯”ç‡)ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§åŠ æƒæ–¹æ³•ï¼</p>
<ul>
<li><strong>åŠ æƒé‡è¦æ€§é‡‡æ ·</strong>ï¼ˆweighted importance sampling ), å³ $\frac{\sum_{i=1}^{c} \rho_{i} g_{i}}{\sum_{i=1}^{c} \rho_{i}}$</li>
<li><strong>æ™®é€šé‡è¦æ€§é‡‡æ ·</strong>ï¼ˆordinary importance sampling), å³ $\frac{1}{c} \sum_{i=1}^{c} \rho_{i} g_{i}$</li>
</ul>
<p>è¿™ä¸¤ç§æ–¹æ³•çš„åŒºåˆ«åœ¨äºåˆ†æ¯éƒ¨åˆ†ï¼å¯¹äºåŠ æƒé‡è¦æ€§é‡‡æ ·ï¼Œå¦‚æœæŸä¸ªæƒé‡ $\rho_{i}=0$ ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šè®©å¯¹åº”çš„ $g_{i}$ å‚ä¸å¹³å‡ï¼Œå¹¶ä¸å½±å“æ•´ä½“çš„å¹³å‡å€¼ï¼›å¯¹äºæ™®é€šé‡è¦æ€§é‡‡æ ·ï¼Œå¦‚æœæŸä¸ªæƒé‡ $\rho_{i}=0$ ï¼Œé‚£ä¹ˆå®ƒä¼šè®© 0 å‚ä¸å¹³å‡ï¼Œä½¿å¾—å¹³å‡å€¼å˜å°ï¼æ— è®ºæ˜¯åŠ æƒé‡è¦æ€§é‡‡æ ·è¿˜æ˜¯æ™®é€šé‡è¦æ€§é‡‡æ ·ï¼Œå½“å›æŠ¥æ ·æœ¬æ•°å¢åŠ æ—¶ï¼Œä»ç„¶å¯ä»¥ç”¨å¢é‡æ³•å°†æ—§çš„åŠ æƒå¹³å‡å€¼æ›´æ–°ä¸ºæ–°çš„åŠ æƒå¹³å‡å€¼ï¼å¯¹äºåŠ æƒé‡è¦æ€§é‡‡æ ·ï¼Œéœ€è¦å°†è®¡æ•°å€¼æ›¿æ¢ä¸ºæƒé‡çš„å’Œï¼Œä»¥
$$
\begin{array}{l}
c \leftarrow c+\rho \
v \leftarrow v+\frac{\rho}{c}(g-v)
\end{array}
$$
çš„å½¢å¼ä½œæ›´æ–°ï¼å¯¹äºæ™®é€šé‡è¦æ€§é‡‡æ ·è€Œè¨€ï¼Œå®é™…ä¸Šå°±æ˜¯å¯¹ $\rho_{i} g_{i}(1 \leqslant i \leqslant c)$ åŠ ä»¥å¹³å‡ï¼Œä¸ç›´æ¥æ²¡æœ‰åŠ æƒæƒ…å†µä¸‹å¯¹ $g_{i}(1 \leqslant i \leqslant c)$ åŠ ä»¥å¹³å‡æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼å®ƒçš„æ›´æ–°å½¢å¼ä¸º :
$$
\begin{array}{l}
c \leftarrow c+1 \
v \leftarrow v+\frac{1}{c}(\rho g-v)
\end{array}
$$</p>
<h4 id="222-å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°"><a class="header" href="#222-å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°">2.2.2 å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°</a></h4>
<p>åŸºäº 2.2.1 èŠ‚ç»™å‡ºçš„é‡è¦æ€§é‡‡æ ·ï¼Œç®—æ³• 2-7 ç»™å‡ºäº†æ¯æ¬¡è®¿é—®åŠ æƒé‡è¦æ€§é‡‡æ ·å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°ç®—æ³•ï¼è¿™ä¸ªç®—æ³•åœ¨åˆå§‹åŒ–ç¯èŠ‚åˆå§‹åŒ–äº†æƒé‡å’Œ $c(s, a)$ ä¸åŠ¨ä½œä»·å€¼ $q(s, a)$ $(s \in \mathcal{S}, a \in \mathcal{A}(s))$ ï¼Œç„¶åè¿›è¡Œå›åˆæ›´æ–°ï¼å›åˆæ›´æ–°éœ€è¦å€ŸåŠ©è¡Œä¸ºç­–ç•¥ $b$ ï¼è¡Œä¸ºç­–ç•¥ $b$ å¯ä»¥æ¯ä¸ªå›åˆéƒ½å•ç‹¬è®¾è®¡ï¼Œä¹Ÿå¯ä»¥ä¸ºæ•´ä¸ªç®—æ³•è®¾è®¡ä¸€ä¸ªè¡Œä¸ºç­–ç•¥ï¼Œè€Œåœ¨æ‰€æœ‰å›åˆéƒ½ä½¿ç”¨åŒä¸€ä¸ªè¡Œä¸ºç­–ç•¥ï¼ç”¨è¡Œä¸ºç­–ç•¥ç”Ÿæˆè½¨è¿¹æ ·æœ¬åï¼Œé€†åºæ›´æ–°å›æŠ¥ã€ä»·å€¼å‡½æ•°å’Œæƒé‡å€¼ï¼ä¸€å¼€å§‹æƒé‡å€¼ $\rho$ è®¾ä¸º 1 ï¼Œä»¥åä¼šè¶Šæ¥è¶Šå°ï¼å¦‚æœæŸæ¬¡æƒé‡å€¼å˜ä¸º 0 (è¿™å¾€å¾€æ˜¯å› ä¸º $\left.\pi\left(A_{t}|S_{t}\right)=0\right)$ ï¼Œé‚£ä¹ˆä»¥ åçš„æƒé‡å€¼å°±éƒ½ä¸º 0 ï¼Œå†å¾ªç¯ä¸‹å»æ²¡æœ‰æ„ä¹‰ï¼æ‰€ä»¥è¿™é‡Œè®¾è®¡äº†ä¸€ä¸ªæ£€æŸ¥æœºåˆ¶ï¼äº‹å®ä¸Šï¼Œè¿™ä¸ªæ£€æŸ¥æœºåˆ¶ä¿è¯äº†åœ¨æ›´æ–° $q(s, a)$ æ—¶æƒé‡å’Œ $c(s, a)&gt;0$ æ˜¯å¿…éœ€çš„ï¼å¦‚æœæ²¡æœ‰æ£€æŸ¥æœºåˆ¶ï¼Œåˆ™å¯èƒ½åœ¨æ›´æ–° $c(s, a)$ æ—¶ï¼Œæ›´æ–°å‰å’Œæ›´æ–°åçš„ $c(s, a)$ å€¼éƒ½æ˜¯ 0 ï¼Œè¿›è€Œåœ¨æ›´æ–° $q(s, a)$ æ—¶å‡ºç°é™¤é›¶é”™è¯¯ï¼åŠ è¿™ä¸ªæ£€æŸ¥æœºåˆ¶é¿å…äº†è¿™æ ·çš„é”™è¯¯ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 2-7</strong>ï¼š$\quad$ æ¯æ¬¡è®¿é—®åŠ æƒé‡è¦æ€§é‡‡æ ·å¼‚ç­–å›åˆæ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨æƒé‡å’Œï¼Œåˆ™åˆå§‹åŒ–æƒé‡å’Œ $c(s, a) \leftarrow 0, s \in \mathcal{S}, a \in \mathcal{A}$</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆè¡Œä¸ºç­–ç•¥ï¼‰æŒ‡å®šè¡Œä¸ºç­–ç•¥ $b$ ï¼Œä½¿å¾— $\pi \ll b$<br />
2.2 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $b$ ç”Ÿæˆè½¨è¿¹: $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.3 ï¼ˆåˆå§‹åŒ–å›æŠ¥å’Œæƒé‡ï¼‰ $G \leftarrow 0, \rho \leftarrow 1$<br />
2.4 å¯¹äº $t \leftarrow T-1, T-2, \ldots, 0$ æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\rho\left[G-q\left(S_{t}, A_{t}\right)\right]^{2}\left(\right.$ å¦‚ $c\left(S_{t}, A_{t}\right) \leftarrow c\left(S_{t}, A_t\right)+\rho$ï¼Œ$\left.q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\frac{\rho}{c\left(S_{t}, A_{t}\right)}\left[G-q\left(S_{t}, A_{t}\right)\right]\right)$</li>
<li>ï¼ˆæ›´æ–°æƒé‡ï¼‰ $\rho \leftarrow \rho \frac{\pi\left(A_{t}|S_{t}\right)}{b\left(A_{t}|S_{t}\right)}$</li>
<li>ï¼ˆæå‰ç»ˆæ­¢ï¼‰å¦‚æœ $\rho=0$ ï¼Œåˆ™ç»“æ±æ­¥éª¤ 2.4 çš„å¾ªç¯</li>
</ol>
</li>
</ol>
<hr />
<p>åœ¨ç®—æ³• 2-7 çš„åŸºç¡€ä¸Šç•¥ä½œä¿®æ”¹ï¼Œå¯ä»¥å¾—åˆ°é¦–æ¬¡è®¿é—®çš„ç®—æ³•ã€æ™®é€šé‡è¦æ€§é‡‡æ ·çš„ç®—æ³•å’Œä¼°è®¡çŠ¶æ€ä»·å€¼çš„ç®—æ³•ï¼Œæ­¤å¤„ç•¥è¿‡ï¼</p>
<h4 id="423-å¼‚ç­–å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥æ±‚è§£"><a class="header" href="#423-å¼‚ç­–å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥æ±‚è§£">4.2.3 å¼‚ç­–å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥æ±‚è§£</a></h4>
<p>æ¥ä¸‹æ¥ä»‹ç»æœ€ä¼˜ç­–ç•¥çš„æ±‚è§£ï¼ç®—æ³• 2-8 ç»™å‡ºäº†æ¯æ¬¡è®¿é—®åŠ æƒé‡è¦æ€§é‡‡æ ·å¼‚ç­–å›åˆæœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•ï¼å®ƒå’Œå…¶ä»–æœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨ç­–ç•¥ä¼°è®¡ç®—æ³•çš„åŸºç¡€ä¸ŠåŠ ä¸Šç­–ç•¥æ”¹è¿›å¾—æ¥çš„ï¼ç®—æ³• 2-8 çš„è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œå§‹ç»ˆè®© $\pi$ æ˜¯ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ï¼æ‰€ä»¥ï¼Œåœ¨å›åˆæ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œä»»é€‰ä¸€ä¸ªç­–ç•¥ $b$ éƒ½æ»¡è¶³ $\pi \ll b$ ï¼è¿™ä¸ªæŸ”æ€§ç­–ç•¥å¯ä»¥æ¯ä¸ªå›åˆéƒ½åˆ†åˆ«é€‰å–ï¼Œä¹Ÿå¯ä»¥æ•´ä¸ªç¨‹åºå…±ç”¨ä¸€ä¸ªï¼ç”±äºé‡‡ç”¨äº†ç¡®å®šæ€§çš„ç­–ç•¥ï¼Œåˆ™å¯¹äºæ¯ä¸ªçŠ¶æ€ $s \in \mathcal{S}$ éƒ½æœ‰ä¸€ä¸ª $a \in \mathcal{A}(s)$ ä½¿å¾— $\pi(a|s)=1$ ï¼Œè€Œå…¶ä»– $\pi(\cdot|s)=0$ ï¼ç®—æ³• 2-8 åˆ©ç”¨è¿™ä¸€æ€§è´¨æ¥æ›´æ–°æƒé‡å¹¶åˆ¤æ–­æƒé‡æ˜¯å¦ä¸º 0 ï¼å¦‚æœ $A_{t} \neq \pi\left(S_{t}\right)$ ï¼Œåˆ™æ„å‘³ç€ $\pi\left(A_{t}|S_{t}\right)=0$ ï¼Œæ›´æ–°åçš„æƒé‡ä¸º 0 ï¼Œéœ€è¦é€€å‡ºå¾ªç¯ä»¥é¿å…é™¤é›¶é”™è¯¯ï¼›è‹¥ $A_{t}=\pi\left(S_{t}\right)$ ï¼Œåˆ™æ„å‘³ç€ $\pi\left(A_{t}|S_{t}\right)=1$ ï¼Œæ‰€ä»¥æƒé‡æ›´æ–°è¯­å¥ $\rho \leftarrow \rho \frac{\pi\left(A_{t}|S_{t}\right)}{b\left(A_{t}|S_{t}\right)}$ å°±å¯ä»¥ç®€åŒ–ä¸º
$\rho \leftarrow \rho \frac{1}{b\left(A_{t}|S_{t}\right)}$ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 4-8</strong>ï¼š$\quad$ æ¯æ¬¡è®¿é—®åŠ æƒé‡è¦æ€§é‡‡æ ·å¼‚ç­–å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥æ±‚è§£</p>
</blockquote>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨æƒé‡å’Œï¼Œåˆå§‹åŒ–æƒé‡å’Œ $c(s, a) \leftarrow 0, s \in \mathcal{S}, a \in \mathcal{A} ; \pi(s) \leftarrow \arg \max _{a} q(s, a), s \in \mathcal{S}$</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆæŸ”æ€§ç­–ç•¥ï¼‰æŒ‡å®š $b$ ä¸ºä»»æ„æŸ”æ€§ç­–ç•¥<br />
2.2 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $b$ ç”Ÿæˆè½¨è¿¹ï¼š $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{2}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.3 ï¼ˆåˆå§‹åŒ–å›æŠ¥å’Œæƒé‡ï¼‰ $G \leftarrow 0, \rho \leftarrow 1$<br />
2.4 å¯¹ $t \leftarrow T-1, T-2, \ldots, 0:$
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\rho\left[G-q\left(S_{t}, A_{t}\right)\right]^{2}\left(\right.$ å¦‚ $c\left(S_{t}, A_{t}\right) \leftarrow c\left(S_{t}, A_{t}\right)+\rho$ï¼Œ$\left.q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\frac{\rho}{c\left(S_{t}, A_{t}\right)}\left[G-q\left(S_{t}, A_{t}\right)\right]\right)$</li>
<li>ï¼ˆç­–ç•¥æ›´æ–°ï¼‰ $\pi\left(S_{t}\right) \leftarrow \arg \max_{a} q\left(S_{t}, a\right)$</li>
<li>ï¼ˆæå‰ç»ˆæ­¢ï¼‰è‹¥ $A_{t} \neq \pi\left(S_{t}\right)$ åˆ™é€€å‡ºæ­¥éª¤ 2.4</li>
<li>ï¼ˆæ›´æ–°æƒé‡ï¼‰ $\rho \leftarrow \rho \frac{1}{b\left(A_{t}|S_{t}\right)}$</li>
</ol>
</li>
</ol>
<hr />
<p>ç®—æ³• 2-8 ä¹Ÿå¯ä»¥ä¿®æ”¹å¾—åˆ°é¦–æ¬¡è®¿é—®çš„ç®—æ³•å’Œæ™®é€šé‡è¦æ€§é‡‡æ ·çš„ç®—æ³•ï¼Œæ­¤å¤„ç•¥è¿‡ï¼</p>
<h2 id="ä¸‰-æ—¶åºå·®åˆ†ä»·å€¼è¿­ä»£"><a class="header" href="#ä¸‰-æ—¶åºå·®åˆ†ä»·å€¼è¿­ä»£">ä¸‰ï¼ æ—¶åºå·®åˆ†ä»·å€¼è¿­ä»£</a></h2>
<p>æœ¬ç« ä»‹ç»å¦å¤–ä¸€ç§å­¦ä¹ æ–¹æ³•ä¸€æ—¶åºå·®åˆ†æ›´æ–°ï¼æ—¶åºå·®åˆ†æ›´æ–°å’Œå›åˆæ›´æ–°éƒ½æ˜¯ç›´æ¥é‡‡ç”¨ç»éªŒæ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œè€Œä¸éœ€è¦ç¯å¢ƒæ¨¡å‹ï¼æ—¶åºå·®åˆ†æ›´æ–°ä¸å›åˆæ›´æ–°çš„åŒºåˆ«åœ¨äºï¼Œæ—¶åºå·® åˆ†æ›´æ–°æ±²å–äº†åŠ¨æ€è§„åˆ’æ–¹æ³•ä¸­&quot;è‡ªç›Š&quot;çš„æ€æƒ³ï¼Œç”¨ç°æœ‰çš„ä»·å€¼ä¼°è®¡å€¼æ¥æ›´æ–°ä»·å€¼ä¼°è®¡ï¼Œä¸éœ€è¦ç­‰åˆ°å›åˆç»“æŸä¹Ÿå¯ä»¥æ›´æ–°ä»·å€¼ä¼°è®¡ï¼æ‰€ä»¥ï¼Œæ—¶åºå·®åˆ†æ›´æ–°æ—¢å¯ä»¥ç”¨äºå›åˆåˆ¶ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥ç”¨äºè¿ç»­æ€§ä»»åŠ¡ï¼</p>
<p>æœ¬ç« å°†ä»‹ç»æ—¶åºå·®åˆ†æ›´æ–°æ–¹æ³•ï¼ŒåŒ…æ‹¬åŒç­–æ—¶åºå·®åˆ†æ›´æ–°æ–¹æ³•å’Œå¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°æ–¹æ³•, æ¯ç§æ–¹æ³•éƒ½å…ˆä»‹ç»ç®€å•çš„å•æ­¥æ›´æ–°ï¼Œå†ä»‹ç»å¤šæ­¥æ›´æ–°ï¼æœ€åï¼Œæœ¬ç« ä¼šæ¶‰åŠåŸºäºèµ„æ ¼è¿¹çš„å­¦ä¹ ç®—æ³•ï¼</p>
<h3 id="31-åŒç­–æ—¶åºå·®åˆ†æ›´æ–°"><a class="header" href="#31-åŒç­–æ—¶åºå·®åˆ†æ›´æ–°">3.1 åŒç­–æ—¶åºå·®åˆ†æ›´æ–°</a></h3>
<p>æœ¬èŠ‚è€ƒè™‘æ— æ¨¡å‹åŒç­–æ—¶åºå·®åˆ†æ›´æ–°ï¼ä¸æ— æ¨¡å‹å›åˆæ›´æ–°çš„æƒ…å†µç›¸åŒï¼Œåœ¨æ— æ¨¡å‹çš„æƒ…å†µä¸‹åŠ¨ä½œä»·å€¼æ¯”çŠ¶æ€ä»·å€¼æ›´ä¸ºé‡è¦ï¼Œå› ä¸ºåŠ¨ä½œä»·å€¼èƒ½å¤Ÿå†³å®šç­–ç•¥å’ŒçŠ¶æ€ä»·å€¼ï¼Œä½†æ˜¯çŠ¶æ€ä»·å€¼å¾—ä¸åˆ°åŠ¨ä½œä»·å€¼ï¼</p>
<p>æœ¬èŠ‚è€ƒè™‘æ— æ¨¡å‹åŒç­–æ—¶åºå·®åˆ†æ›´æ–°ã€‚ä¸æ— æ¨¡å‹å›åˆæ›´æ–°çš„æƒ…å†µç›¸åŒï¼Œåœ¨æ— æ¨¡å‹çš„æƒ…å†µä¸‹åŠ¨ä½œä»·å€¼æ¯”çŠ¶æ€ä»·å€¼æ›´ä¸ºé‡è¦ï¼Œå› ä¸ºåŠ¨ä½œä»·å€¼èƒ½å¤Ÿå†³å®šç­–ç•¥å’ŒçŠ¶æ€ä»·å€¼ï¼Œä½†æ˜¯çŠ¶æ€ä»·å€¼å¾—ä¸åˆ°åŠ¨ä½œä»·å€¼ã€‚
ä»ç»™å®šç­–ç•¥ $\pi$ çš„æƒ…å†µä¸‹åŠ¨ä½œä»·å€¼çš„å®šä¹‰å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹å¼:
$$
\begin{aligned}
q_{\pi}(s, a) &amp;=\mathrm{E}<em>{\pi}\left[G</em>{t}|S_{t}=s, A_{t}=a\right] \
&amp;=\mathrm{E}<em>{\pi}\left[R</em>{t+1}+\gamma G_{t+1}|S_{t}=S, A_{t}=a\right] \
&amp;=\mathrm{E}<em>{\pi}\left[R</em>{t+1}+\gamma q_{\pi}\left(S_{t+1}, A_{t+1}\right)|S_{t}=s, A_{t}=a\right], \quad s \in \mathcal{S}, a \in \mathcal{A}(s)
\end{aligned}
$$
åœ¨ä¸Šä¸€ç« çš„å›åˆæ›´æ–°å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä¾æ® $q_{\pi}(s, a)=\mathrm{E}<em>{\pi}\left[G</em>{t}|S_{t}=s, A_{t}=a\right]$ ï¼Œç”¨ Monte Carlo æ–¹æ³•æ¥ä¼°è®¡ä»·å€¼å‡½æ•°ï¼ä¸ºäº†å¾—åˆ°å›æŠ¥æ ·æœ¬ï¼Œæˆ‘ä»¬è¦ä»çŠ¶æ€åŠ¨ä½œå¯¹ $(s, a)$ å‡ºå‘ä¸€ç›´é‡‡æ ·åˆ°å›åˆç»“æŸï¼å•æ­¥æ—¶åºå·®åˆ†æ›´æ–°å°†ä¾æ® $q_{\pi}(s, a)=\mathrm{E}<em>{\pi}\left[R</em>{t+1}+\gamma q_{\pi}\left(S_{t+1}, A_{t+1}\right)|S_{t}=S, A,=a\right]$ ï¼Œåªéœ€è¦é‡‡æ ·ä¸€æ­¥ï¼Œè¿›è€Œç”¨ $U_{t}=R_{t+1}+\gamma q_{\pi}\left(S_{t+1},\cdot \right)$ ï¼Œæ¥ä¼°è®¡å›æŠ¥æ ·æœ¬çš„å€¼ï¼ä¸ºäº†ä¸ç”±å¥–åŠ±ç›´æ¥è®¡ç®—å¾—åˆ°çš„æ— åå›æŠ¥æ ·æœ¬ $G_{t}$ è¿›è¡ŒåŒºåˆ«ï¼Œæœ¬ä¹¦ç”¨å­—æ¯ $U_{t}$ è¡¨ç¤ºä½¿ç”¨è‡ªç›Šå¾—åˆ°çš„æœ‰åå›æŠ¥æ ·æœ¬ï¼</p>
<p>åŸºäºä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ—¶åºå·®åˆ†ç›®æ ‡ï¼æ—¶åºå·®åˆ†ç›®æ ‡å¯ä»¥é’ˆå¯¹åŠ¨ä½œä»·å€¼å®šä¹‰ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹çŠ¶æ€ä»·å€¼å®šä¹‰ï¼å¯¹äºåŠ¨ä½œä»·å€¼ï¼Œå…¶å•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡å®šä¹‰ä¸º
$$
U_{t:t+1}^{(q)}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1}\right)
$$
å…¶ä¸­ $U_{t:t+1}^{(g)}$ çš„ä¸Šæ ‡ $(q)$ è¡¨ç¤ºæ˜¯å¯¹åŠ¨ä½œä»·å€¼å®šä¹‰çš„ï¼Œä¸‹æ ‡ $t:t+1$ è¡¨ç¤ºç”¨ $\left(S_{t+1}, A_{t+1}\right)$ çš„ä¼°è®¡å€¼æ¥ä¼°è®¡ $\left(S_{t}, A_{t}\right)$ ï¼å¦‚æœ $S_{t+1}$ æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œé»˜è®¤æœ‰ $q\left(S_{t+1}, \cdot\right)=0$ ï¼è¿™æ ·çš„æ—¶åºå·®åˆ†ç›®æ ‡å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•åˆ°å¤šæ­¥çš„æƒ…å†µï¼ n æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ $(n=1,2, \ldots)$ å®šä¹‰ä¸º
$$
U_{t:t+n}^{(q)}=R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} q\left(S_{t+n}, A_{t+n}\right)
$$
åœ¨ä¸å¼ºè°ƒæ­¥æ•°çš„æƒ…å†µä¸‹ï¼Œ $U_{t t+n}^{(q)}$ å¯ä»¥ç®€è®°ä¸º $U_{t}^{(q)}$ æˆ– $U_{t}$ ï¼å¯¹äºå›åˆåˆ¶ä»»åŠ¡ï¼Œå¦‚æœå›åˆçš„æ­¥æ•° $T \leqslant t+n$ ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¼ºåˆ¶è®©
$$
\begin{array}{ll}
R_{t}=0, &amp; t&gt;T \
S_{t}=S_{\text {ç»ˆæ­¢}}, &amp; t&gt;T
\end{array}
$$
è¿™æ ·ï¼Œä¸Šè¿°æ—¶åºå·®åˆ†ç›®æ ‡çš„å®šä¹‰å¼ä¾ç„¶æˆç«‹ï¼Œå®é™…ä¸Š
è¾¾åˆ°äº†
$$
U_{t:t+n}^{(q)}=\left{\begin{array}{ll}
R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} q\left(S_{t+n}, A_{t+n}\right), &amp; t+n&lt;T \
R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{T-t-1} R_{T}, &amp; t+n \geqslant T
\end{array}\right.
$$
çš„æ•ˆæœã€‚æœ¬ä¹¦åæ–‡éƒ½åšè¿™æ ·çš„å‡è®¾ã€‚ç±»ä¼¼çš„æ˜¯ï¼Œå¯¹äº çŠ¶æ€ä»·å€¼ï¼Œå®šä¹‰ $n$ æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ä¸º
$$
U_{t:t+n}^{(v)}=R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} v\left(S_{t+n}\right)
$$
å®ƒä¹Ÿå¯ä»¥ç®€è®°ä¸º $U_{t}^{(\nu)}$ æˆ– $U_{t}$ ï¼</p>
<h4 id="311-æ—¶åºå·®åˆ†æ›´æ–°ç­–ç•¥è¯„ä¼°"><a class="header" href="#311-æ—¶åºå·®åˆ†æ›´æ–°ç­–ç•¥è¯„ä¼°">3.1.1 æ—¶åºå·®åˆ†æ›´æ–°ç­–ç•¥è¯„ä¼°</a></h4>
<p>æœ¬èŠ‚è€ƒè™‘åˆ©ç”¨æ—¶åºå·®åˆ†ç›®æ ‡æ¥è¯„ä¼°ç»™å®šç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼å›é¡¾åœ¨åŒç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬ç”¨å½¢å¦‚
$$
q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\alpha\left[G_{t}-q\left(S_{t}, A_{t}\right)\right]
$$
çš„å¢é‡æ›´æ–°æ¥å­¦ä¹ åŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œè¯•å›¾å‡å° $\left[G_{t}-q\left(S_{t}, A_{t}\right)\right]^{2}$ ï¼åœ¨è¿™ä¸ªå¼å­ä¸­ï¼Œ $G_{t}$ æ˜¯å›æŠ¥æ ·æœ¬ï¼åœ¨æ—¶åºå·®åˆ†ä¸­ï¼Œè¿™ä¸ªé‡å°±å¯¹åº”ç€ $U_{t}$ ï¼å› æ­¤ï¼Œåªéœ€åœ¨å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œå°†è¿™ä¸ªå¢é‡æ›´æ–°å¼ä¸­çš„å›æŠ¥ $G_{t}$ æ›¿æ¢ä¸ºæ—¶åºå·®åˆ†ç›®æ ‡ $U_{t}$ ï¼Œå°±å¯ä»¥å¾—åˆ°æ—¶åºå·®åˆ†ç­–ç•¥è¯„ä¼°ç®—æ³•äº†ï¼</p>
<p>æ—¶åºå·®åˆ†ç›®æ ‡æ—¢å¯ä»¥æ˜¯å•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šæ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼æˆ‘ä»¬å…ˆæ¥çœ‹å•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼</p>
<p>ç®—æ³• 3-1 ç»™å‡ºäº†ç”¨å•æ­¥æ—¶åºå·®åˆ†æ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼çš„ç®—æ³•ï¼è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ª $\alpha$ ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ­£å®æ•°ï¼Œè¡¨ç¤ºå­¦ä¹ ç‡ï¼åœ¨ä¸Šä¸€ç« çš„å›åˆæ›´æ–°ä¸­ï¼Œè¿™ä¸ªå­¦ä¹ ç‡å¾€å¾€æ˜¯ $\frac{1}{c\left(S_{t}, A_t\right)}$ ï¼Œå®ƒå’ŒçŠ¶æ€åŠ¨ä½œå¯¹æœ‰å…³ï¼Œå¹¶ä¸”ä¸æ–­å‡å°ï¼åœ¨æ—¶åºå·®åˆ†æ›´æ–°ä¸­ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è¿™æ ·ä¸æ–­å‡å°çš„å­¦ä¹ ç‡ï¼ä¸è¿‡ï¼Œè€ƒè™‘åˆ°åœ¨æ—¶åºå·®åˆ†ç®—æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä»·å€¼å‡½æ•°ä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼Œè¿›è€ŒåŸºäºä»·å€¼å‡½æ•°ä¼°è®¡å¾—åˆ°çš„ä»·å€¼å‡½æ•°ä¹Ÿä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼Œå› æ­¤ä¼°è®¡å€¼çš„æƒé‡å¯ä»¥è¶Šæ¥è¶Šå¤§ï¼æ‰€ä»¥ï¼Œç®—æ³• 3-1 é‡‡ç”¨äº†ä¸€ä¸ªå›ºå®šçš„å­¦ä¹ ç‡ $\alpha$ ï¼è¿™ä¸ªå­¦ä¹ ç‡ä¸€èˆ¬åœ¨ $\alpha \in(0,1]$ ï¼å½“ç„¶ï¼Œå­¦ä¹ ç‡ä¹Ÿå¯ä»¥ä¸æ˜¯å¸¸æ•°ï¼åœ¨æœ‰äº›é—®é¢˜ä¸­ï¼Œè®©å­¦ä¹ ç‡å·§å¦™åœ°å˜åŒ–èƒ½å¾—åˆ°æ›´å¥½çš„æ•ˆæœï¼å¼•å…¥å­¦ä¹ ç‡ $\alpha$ åï¼Œæ›´æ–°å¼å¯ä»¥è¡¨ç¤ºä¸º:
$$
q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\alpha\left[U_{t}-q\left(S_{t}, A_{t}\right)\right] .
$$</p>
<blockquote>
<p><strong>ç®—æ³• 3-1</strong>ï¼š $\quad$ å•æ­¥æ—¶åºå·®åˆ†æ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼å‡½æ•° $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ï¼‰ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(S_{\text {ç»ˆæ­¢ }}, a\right) \leftarrow 0, a \in \mathcal{A}$ ï¼</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1  ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œå†æ ¹æ®è¾“å…¥ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A$
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼ˆä¾‹å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€Sä¸æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼‰, æ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ç”¨è¾“å…¥ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q(S, A)$ ä»¥å‡å° $[U-q(S, A)]^{2}($ å¦‚ $q(S, A) \leftarrow q(S, A)+\alpha[U-q(S,A)])$</li>
<li>$S\leftarrow S^{\prime},A\leftarrow A^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>åœ¨å…·ä½“çš„æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œé™¤äº†å­¦ä¹ ç‡ $\alpha$ å’ŒæŠ˜æ‰£å› å­ $\gamma$ å¤–ï¼Œè¿˜æœ‰æ§åˆ¶å›åˆæ•°å’Œæ¯ä¸ªå›åˆæ­¥æ•°çš„å‚æ•°ï¼æˆ‘ä»¬çŸ¥é“ï¼Œæ—¶åºå·®åˆ†æ›´æ–°ä¸ä»…å¯ä»¥ç”¨äºå›åˆåˆ¶ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥ç”¨äºéå›åˆåˆ¶ä»»åŠ¡ï¼å¯¹äºéå›åˆåˆ¶ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªè¡Œå°†æŸäº›æ—¶æ®µæŠ½å‡ºæ¥å½“ä½œå¤šä¸ªå›åˆï¼Œä¹Ÿå¯ä»¥ä¸åˆ’åˆ†å›åˆå½“ä½œåªæœ‰ä¸€ä¸ªå›åˆè¿›è¡Œæ›´æ–°ï¼ç±»ä¼¼åœ°ï¼Œç®—æ³• 3-2 ç»™å‡ºäº†ç”¨å•æ­¥æ—¶åºå·®åˆ†æ–¹æ³•è¯„ä¼°ç­–ç•¥çŠ¶æ€ä»·å€¼çš„ç®—æ³•ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-2</strong>$\quad$ å•æ­¥æ—¶åºå·®åˆ†æ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼å‡½æ•° $v(s), s \in \mathcal{S}$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ )ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $v(s)\leftarrow$ ä»»æ„å€¼ï¼Œ $s\in \mathcal(S)$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œ $v(s_{\text{ç»ˆæ­¢}})\leftarrow 0$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼ˆä¾‹å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€Sä¸æ˜¯ç»ˆæ­¢çŠ¶æ€)ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>æ ¹æ®è¾“å…¥ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma v\left(S^{\prime}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $v(S)$ ä»¥å‡å° $[U-v(S)]^{2}($ å¦‚ $v(S) \leftarrow v(S)+\alpha[U-v(S)])$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<p>åœ¨æ— æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œç”¨å›åˆæ›´æ–°å’Œæ—¶åºå·®åˆ†æ›´æ–°æ¥è¯„ä¼°ç­–ç•¥éƒ½èƒ½æ¸è¿‘å¾—åˆ°çœŸå®çš„ä»·å€¼å‡½æ•°.å®ƒä»¬å„æœ‰ä¼˜åŠ£.ç›®å‰å¹¶æ²¡æœ‰è¯æ˜æŸç§æ–¹æ³•å°±æ¯”å¦å¤–ä¸€ç§æ–¹æ³•æ›´å¥½.æ ¹æ®ç»éªŒï¼Œå­¦ä¹  ç‡ä¸ºå¸¸æ•°çš„æ—¶åºå·®åˆ†æ›´æ–°å¸¸å¸¸æ¯”å­¦ä¹ ç‡ä¸ºå¸¸æ•°çš„å›åˆæ›´æ–°æ›´å¿«æ”¶æ•›ï¼ä¸è¿‡æ—¶åºå·®åˆ†æ›´æ–°å¯¹ç¯å¢ƒçš„ Markov æ€§è¦æ±‚æ›´é«˜ï¼</p>
<p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥æ¯”è¾ƒå›åˆæ›´æ–°å’Œæ—¶åºå·®åˆ†æ›´æ–°ï¼è€ƒè™‘æŸä¸ª Markov å¥–åŠ±è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å®ƒçš„ 5 ä¸ªè½¨è¿¹æ ·æœ¬å¦‚ä¸‹ï¼ˆåªæ˜¾ç¤ºçŠ¶æ€å’Œå¥–åŠ±):
$$
\begin{aligned}
&amp;S_{A}, 0\
&amp;s_{B}, 0, s_{A}, 0\
&amp;S_{A}, 1\
&amp;S_{B}, 0, S_{A}, 0\
&amp;s_{A}, 1
\end{aligned}
$$
ä½¿ç”¨å›åˆæ›´æ–°å¾—åˆ°çš„çŠ¶æ€ä»·å€¼ä¼°è®¡å€¼ä¸º $v\left(s_{A}\right)=\frac{2}{5}, v\left(s_{B}\right)=0$ ï¼Œè€Œä½¿ç”¨æ—¶åºå·®åˆ†æ›´æ–°å¾—åˆ°çš„çŠ¶æ€ä»·å€¼ä¼°è®¡å€¼ä¸º $v\left(s_{A}\right)=v\left(s_{B}\right)=\frac{2}{5}$ ï¼è¿™ä¸¤ç§æ–¹æ³•å¯¹ $v\left(s_{A}\right)$ çš„ä¼°è®¡æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯¹äº $v\left(s_{B}\right)$ çš„ä¼°è®¡æœ‰æ˜æ˜¾ä¸åŒï¼šå›åˆæ›´æ–°åªè€ƒè™‘å…¶ä¸­ä¸¤ä¸ªå«æœ‰ $s_{B}$ çš„è½¨è¿¹æ ·æœ¬ï¼Œç”¨è¿™ä¸¤ä¸ªè½¨è¿¹æ ·æœ¬å›æŠ¥æ¥ä¼°è®¡çŠ¶æ€ä»·å€¼ï¼›æ—¶åºå·®åˆ†æ›´æ–°è®¤ä¸ºçŠ¶æ€ $s_{B}$ ä¸‹ä¸€æ­¥è‚¯å®šä¼šåˆ°è¾¾çŠ¶æ€ $s_{A}$ ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨å…¨éƒ¨è½¨è¿¹æ ·æœ¬æ¥ä¼°è®¡ $v\left(s_{A}\right)$ ï¼Œè¿›è€Œç”± $v\left(s_{A}\right)$ æ¨å‡º $v\left(s_{B}\right)$ ï¼è¯•æƒ³ï¼Œå¦‚æœè¿™ä¸ªç¯å¢ƒçœŸçš„æ˜¯ Markov å†³ç­–è¿‡ç¨‹ï¼Œå¹¶ä¸”æˆ‘ä»¬æ­£ç¡®åœ°è¯†åˆ«å‡ºäº†çŠ¶æ€ç©ºé—´ $\mathcal{S}=\left{s_{A}, s_{B}\right}$ ï¼Œé‚£ä¹ˆæ—¶åºå·®åˆ†æ›´æ–°æ–¹æ³•å¯ä»¥ç”¨æ›´å¤šçš„è½¨è¿¹æ ·æœ¬æ¥å¸®åŠ©ä¼°è®¡ $s_{B}$ çš„çŠ¶æ€ä»·å€¼ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨ç°æœ‰çš„æ ·æœ¬å¾—åˆ°æ›´ç²¾ç¡®çš„ä¼°è®¡ï¼ä½†æ˜¯ï¼Œå¦‚æœè¿™ä¸ªç¯å¢ƒå…¶å®å¹¶ä¸æ˜¯ Markov å†³ç­–è¿‡ç¨‹ï¼Œæˆ–æ˜¯ $\left{s_{A}, s_{B}\right}$ å¹¶ä¸æ˜¯å…¶çœŸæ­£çš„çŠ¶æ€ç©ºé—´ï¼é‚£ä¹ˆä¹Ÿæœ‰å¯èƒ½ $s_{A}$ ä¹‹åè·å¾—çš„å¥–åŠ±å€¼å…¶å®å’Œè¿™ä¸ªè½¨è¿¹æ˜¯å¦åˆ°è¾¾è¿‡ $s_{B}$ æœ‰å…³ï¼Œä¾‹å¦‚å¦‚æœè¾¾åˆ°è¿‡ $s_B$ åˆ™å¥–åŠ±æ€»æ˜¯ä¸º 0 ï¼è¿™ç§æƒ…å†µä¸‹ï¼Œå›åˆæ›´æ–°èƒ½å¤Ÿä¸å—åˆ°è¿™ä¸€é”™è¯¯çš„å½±å“ï¼Œåªé‡‡ç”¨æ­£ç¡®çš„ä¿¡æ¯ï¼Œä»è€Œä¸å—æ— å…³ä¿¡æ¯çš„å¹²æ‰°ï¼Œå¾—åˆ°æ­£ç¡®çš„ä¼°è®¡ï¼è¿™ä¸ªä¾‹å­æ¯”è¾ƒäº†å›åˆæ›´æ–°å’Œæ—¶åºå·®åˆ†æ›´æ–°çš„éƒ¨åˆ†åˆ©å¼Šã€‚</p>
<p>æ¥ä¸‹æ¥çœ‹å¦‚ä½•ç”¨å¤šæ­¥æ—¶åºå·®åˆ†ç›®æ ‡æ¥è¯„ä¼°ç­–ç•¥ä»·å€¼ï¼ç®—æ³• 3-3 å’Œç®—æ³• 3-4 åˆ†åˆ«ç»™å‡ºäº†ç”¨å¤šæ­¥æ—¶åºå·®åˆ†è¯„ä¼°åŠ¨ä½œä»·å€¼å’ŒçŠ¶æ€ä»·å€¼çš„ç®—æ³•ï¼å®é™…å®ç°æ—¶ï¼Œå¯ä»¥è®© $S_{t}, A_{t}, R_{,}$ å’Œ $S_{t+n+1}, A_{t+n+1}, R_{t+n+1}$ å…±äº«åŒä¸€å­˜å‚¨ç©ºé—´ï¼Œè¿™æ ·åªéœ€è¦ $n+1$ ä»½å­˜å‚¨ç©ºé—´ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-3</strong> $\quad n$ æ­¥æ—¶åºå·®åˆ†æ›´æ–°è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}(s)$<br />
å‚æ•°ï¼šæ­¥æ•° $n$ ï¼Œä¼˜åŒ–å™¨ (éšå«å­¦ä¹ ç‡ $\alpha$ )ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ $, s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(S_{\text {ç»ˆæ­¢ }}, a\right) \leftarrow 0, a \in \mathcal{A}$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆç”Ÿæˆ n æ­¥ï¼‰ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_0,A_0,R_1,...,R_n,S_n$ ï¼ˆè‹¥é‡åˆ°ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ä»¤åç»­å¥–åŠ±å‡ä¸º0ï¼ŒçŠ¶æ€å‡ä¸º $s_{\text{ç»ˆæ­¢}}$<br />
2.2 å¯¹äº $t=0,1,2, \ldots$ ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ° $S_{t}=S_{\text{ç»ˆæ­¢}}$ ï¼š
<ol>
<li>è‹¥ $S_{t+n} \neq S_{\text {ç»ˆæ­¢ }}$ ï¼Œåˆ™æ ¹æ® $\pi\left(\cdot|S_{t+n}\right)$ å†³å®šåŠ¨ä½œ $A_{t+n}$</li>
<li>ï¼ˆæ›´æ–°æ—¶åºå·®åˆ†ç›®æ ‡ï¼‰ $U_{t:t+n}^{(q)} U \leftarrow R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} q\left(S_{t+n}, A_{t+n}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\left[U-q\left(S_{t}, A_{t}\right)\right]^{2}$</li>
<li>è‹¥ $S_{t+n} \neq S_{\text {ç»ˆæ­¢ }}$ ï¼Œåˆ™æ‰§è¡Œ $A_{t+n}$ ï¼Œå¾—åˆ°å¥–åŠ± $R_{t+n+1}$ å’Œä¸‹ä¸€çŠ¶æ€ $S_{t+n+1}$ ï¼›è‹¥ $S_{t+n}=S_{\text {ç»ˆæ­¢ }}$, $R_{t+n+1} \leftarrow 0, \quad S_{t+n+1} \leftarrow S_{\text {ç»ˆæ­¢ }}$</li>
</ol>
</li>
</ol>
<hr />
<blockquote>
<p>ç®—æ³• 3-4 $n$ æ­¥æ—¶åºå·®åˆ†æ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼ä¼°è®¡ $v(s), s \in \mathcal{S}$<br />
å‚æ•°ï¼šæ­¥æ•° $n$ ï¼Œä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ ï¼‰ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>(åˆå§‹åŒ–ï¼‰ $v(s) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}$ å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $v\left(S_{\text {çµ‚æ­¢ }}\right) \leftarrow 0$</li>
<li>(æ—¶åºå·®åˆ†æ›´æ–°) å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1ï¼ˆç”Ÿæˆ $n$ æ­¥ï¼‰ç”¨ç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, \ldots, R_{n}, S_{n}$ ï¼ˆè‹¥é‡åˆ°ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ä»¤åç»­å¥–åŠ±å‡ä¸º 0 ï¼ŒçŠ¶æ€å‡ä¸º $S_{\text {ç»ˆæ­¢ }}$ ï¼‰ï¼<br />
2.2 å¯¹äº $t=0,1,2, \ldots$ ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ° $S_{t}=S_{\text {ç»ˆæ­¢ }}$ :
<ol>
<li>ï¼ˆæ›´æ–°æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t:t+n}^{(\nu)}$ï¼‰$U \leftarrow R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} v\left(S_{t+n}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $v\left(S_{t}\right)$ ä»¥å‡å° $\left[U-v\left(S_{t}\right)\right]^{2}$</li>
<li>è‹¥ $S_{t+n} \neq S_{\text {ç»ˆæ­¢ }}$ ï¼Œåˆ™æ ¹æ® $\pi\left(\cdot|S_{t+n}\right)$ å†³å®šåŠ¨ä½œ $A_{t+n}$ å¹¶æ‰§è¡Œï¼Œå¾—åˆ°å¥–åŠ± $R_{t+n+1}$ å’Œä¸‹ä¸€çŠ¶æ€ $S_{t+n+1}$ ï¼›è‹¥ $S_{t+n}=S_{\text {ç»ˆæ­¢ }}$ ï¼Œä»¤ $R_{t+n+1} \leftarrow 0, S_{t+n+1} \leftarrow S_{\text {ç»ˆæ­¢ }}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<h4 id="312-sarsaç®—æ³•"><a class="header" href="#312-sarsaç®—æ³•">3.1.2 SARSAç®—æ³•</a></h4>
<p>æœ¬èŠ‚æˆ‘ä»¬é‡‡ç”¨åŒç­–æ—¶åºå·®åˆ†æ›´æ–°æ¥æ±‚è§£æœ€ä¼˜ç­–ç•¥ï¼é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ â€œçŠ¶æ€ / åŠ¨ä½œ / å¥–åŠ± çŠ¶æ€ / åŠ¨ä½œâ€ï¼ˆState-Action-Reward-State-Action, SARSAï¼‰ç®—æ³•ï¼è¿™ä¸ªç®—æ³•å¾—åäºæ›´æ–°æ¶‰åŠçš„éšæœºå˜é‡ $\left(S_{t}, A_{t}, R_{t+1}, S_{t+1}, A_{t+1}\right)$ ï¼è¯¥ç®—æ³•åˆ©ç”¨ $R_{t+1}+\gamma q_{t}\left(S_{t+1}, A_{t+1}\right)$ å¾—åˆ°å•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t}$ ï¼Œè¿›è€Œæ›´æ–° $q\left(S_{t}, A_{t}\right)$ ï¼è¯¥ç®—æ³•çš„æ›´æ–°å¼ä¸ºï¼š
$$
q\left(S_{t}, A_{t}\right) \leftarrow q\left(S_{t}, A_{t}\right)+\alpha\left[U_{t}-q\left(S_{t}, A_{t}\right)\right]
$$
å…¶ä¸­ $\alpha$ æ˜¯å­¦ä¹ ç‡ï¼ç®—æ³• 3-5 ç»™å‡ºäº†ç”¨ SARSA ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„ç®—æ³•ï¼SARSA ç®—æ³•å°±æ˜¯åœ¨å•æ­¥åŠ¨ä½œä»·å€¼ä¼°è®¡çš„ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œåœ¨æ›´æ–°ä»·å€¼ä¼°è®¡åæ›´æ–°ç­–ç•¥ï¼åœ¨ç®—æ³• 3-5 ä¸­ï¼Œæ¯å½“æœ€ä¼˜åŠ¨ä½œä»·å€¼å‡½æ•°çš„ä¼°è®¡ $q$ æ›´æ–°æ—¶ï¼Œå°±è¿›è¡Œç­–ç•¥æ”¹è¿›ï¼Œä¿®æ”¹æœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi$ ï¼ç­–ç•¥çš„æå‡æ–¹æ³•å¯ä»¥é‡‡ç”¨ $\varepsilon$ è´ªå¿ƒç®—æ³•ï¼Œä½¿å¾— $\pi$ æ€»æ˜¯æŸ”æ€§ç­–ç•¥ï¼æ›´æ–°ç»“æŸåï¼Œå°±å¾—åˆ°æœ€ä¼˜åŠ¨ä½œä»·å€¼ä¼°è®¡å’Œæœ€ä¼˜ç­–ç•¥ä¼°è®¡ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-5</strong> $\quad$SARSA ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥ï¼ˆæ˜¾å¼æ›´æ–°ç­–ç•¥ï¼‰</p>
</blockquote>
<hr />
<p><strong>ä¸ Q-learning åŒºåˆ«åœ¨äºï¼ŒSARSA æ¯æ¬¡ç®—å¾—çš„ $a^{\prime}$ åœ¨ä¸‹ä¸€æ­¥ä¼šä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€æ­¥é€šè¿‡ Q å‡½æ•°é¢„æµ‹å¾—åˆ°çš„ä¸‹ä¸€æ­¥é‡‡å–çš„åŠ¨ä½œ $a^{\prime}$ ä¹Ÿæ˜¯åœ¨ä¸‹ä¸€æ­¥æ›´æ–°æ—¶çœŸæ­£ä½¿ç”¨çš„ï¼Œè€Œ Q-learning åœ¨ä¸‹ä¸€æ­¥æ›´æ–°æ—¶çš„ $a^{\prime}$ æ˜¯é‡æ–°ç®—çš„ï¼ˆç”¨è¿™ä¸€æ­¥æ›´æ–°åçš„ Q å‡½æ•°ç®—å¾—ï¼‰</strong></p>
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥ä¼°è®¡ $\pi(a|s)(s \in \mathcal{S}, a \in \mathcal{A}(s))$ å’Œæœ€ä¼˜åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a)(s \in \mathcal{S}, a \in \mathcal{A}(s))$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ ï¼‰ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œç­–ç•¥æ”¹è¿›çš„å‚æ•°ï¼ˆå¦‚ $\varepsilon$ ï¼‰ï¼Œå…¶ä»–æ§åˆ¶å›åˆæ•°å’Œå›åˆæ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}(s)$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(s_{\text {ç»ˆæ­¢}}, a\right) \leftarrow 0, a_{\in \mathcal{A}}$ ï¼ç”¨åŠ¨ä½œä»·å€¼ $q(s, a)(s \in \mathcal{S}, a \in \mathcal{A}(s))$ ç¡®å®šç­–ç•¥ $\pi($ å¦‚ä½¿ç”¨ $\varepsilon$ è´ªå¿ƒç­–ç•¥ $)$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œå†ç”¨ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼ˆæ¯”å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€$S$ ä¸æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ç”¨ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q(S, A)$ ä»¥å‡å° $[U-q(S, A)]^{2}($ å¦‚ $q(S, A) \leftarrow q(S, A)+\alpha [U-q(S, A)])$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ ¹æ® $q(S, \cdot)$ ä¿®æ”¹ $\pi(\cdot|S)($ å¦‚ $\varepsilon$ è´ªå¿ƒç­–ç•¥ $)$</li>
<li>$S \leftarrow S^{\prime}, A \leftarrow A^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<p>å…¶å®ï¼Œåœ¨åŒç­–è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œæœ€ä¼˜ç­–ç•¥ä¹Ÿå¯ä»¥ä¸æ˜¾å¼å­˜å‚¨ï¼å¦å¤–å¤šæ­¥ SARSA æ­¤å¤„çœç•¥ï¼</p>
<h4 id="313-æœŸæœ›sarsaç®—æ³•"><a class="header" href="#313-æœŸæœ›sarsaç®—æ³•">3.1.3 æœŸæœ›SARSAç®—æ³•</a></h4>
<p>SARSA ç®—æ³•æœ‰ä¸€ç§å˜åŒ–ä¸€ä¸€æœŸæœ› SARSA ç®—æ³•ï¼ˆExpected SARSAï¼‰ï¼æœŸæœ› SARSAç®—æ³•ä¸ SARSA ç®—æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒåœ¨ä¼°è®¡ $U_{t}$ æ—¶ï¼Œä¸ä½¿ç”¨åŸºäºåŠ¨ä½œä»·å€¼çš„æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t+1}^{(q)}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1}\right)$ ï¼Œè€Œä½¿ç”¨åŸºäºçŠ¶æ€ä»·å€¼çš„æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t=1}^{(v)}=R_{t+1}+\gamma v\left(S_{t+1}\right)$ ï¼åˆ©ç”¨
Bellman æ–¹ç¨‹ï¼Œè¿™æ ·çš„ç›®æ ‡åˆå¯ä»¥è¡¨ç¤ºä¸º
$$
U_{t}=R_{t+1}+\gamma \sum_{a \in A\left(S_{t+1}\right)} \pi\left(a|S_{t+1}\right) q\left(S_{t+1}, a\right)
$$
ä¸ SARSA ç®—æ³•ç›¸æ¯”ï¼ŒæœŸæœ› SARSA éœ€è¦è®¡ç®— $\sum_{a} \pi\left(a|S_{t+1}\right) q\left(S_{t+1}, a\right)$ ï¼Œæ‰€ä»¥è®¡ç®—é‡æ¯” SARSA å¤§ï¼ä½†æ˜¯ï¼Œè¿™æ ·çš„æœŸæœ›è¿ç®—å‡å°äº† SARSA ç®—æ³•ä¸­å‡ºç°çš„ä¸ªåˆ«ä¸æ°å½“å†³ç­–ï¼è¿™æ ·ï¼Œå¯ä»¥é¿å…åœ¨æ›´æ–°åæœŸæä¸ªåˆ«ä¸å½“å†³ç­–å¯¹æœ€ç»ˆæ•ˆæœå¸¦æ¥ä¸å¥½çš„å½±å“ï¼å› æ­¤ï¼ŒæœŸæœ› SARSA å¸¸å¸¸æœ‰æ¯” SARSA æ›´å¤§çš„å­¦ä¹ ç‡ï¼åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒæœŸæœ› SARSA çš„æ•ˆæœä¼šæ¯” SARSA ç¨å¾®å¥½ä¸€äº›ï¼</p>
<p>ç®—æ³• 3-6 ç»™å‡ºäº†æœŸæœ› SARSA æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„ç®—æ³•ï¼Œå®ƒå¯ä»¥è§†ä½œåœ¨å•æ­¥æ—¶åºå·®åˆ†çŠ¶æ€ä»·å€¼ä¼°è®¡ç®—æ³•ä¸Šä¿®æ”¹å¾—åˆ°çš„ï¼æœŸæœ› SARSA å¯¹å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„æ§åˆ¶æ–¹æ³•ç­‰éƒ½å’Œ SARSA ç›¸åŒï¼Œä½†æ˜¯ç”±äºæœŸæœ› SARSA åœ¨æ›´æ–° $q\left(S_{t}, A_{t}\right)$ æ—¶ä¸éœ€è¦ $A_{t+1}$ ï¼Œæ‰€ä»¥å…¶å¾ªç¯ç»“æ„æœ‰æ‰€ç®€åŒ–ï¼ç®—æ³•ä¸­è®© $\pi$ ä¿æŒä¸º $\varepsilon$ æŸ”æ€§ç­–ç•¥ï¼å¦‚æœ $\varepsilon$ å¾ˆå°ï¼Œé‚£ä¹ˆè¿™ä¸ª $\varepsilon$ æŸ”æ€§ç­–ç•¥å°±å¾ˆæ¥è¿‘äºç¡®å®šæ€§ç­–ç•¥ï¼Œåˆ™æœŸæœ› SARSA è®¡ç®—çš„ $\sum_{a} \pi\left(a|S_{t+1}\right) q\left(S_{t+1}, a\right)$ å°±å¾ˆæ¥è¿‘äº $q\left(S_{t+1}, A_{t+1}\right)$ ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-6</strong> $\quad$ æœŸæœ› SARSA æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(S_{\text{ç»ˆæ­¢}}, a\right) \leftarrow 0, a \in \mathcal{A}$ ï¼ç”¨åŠ¨ä½œä»·å€¼ $q(\cdot, \cdot)$ ç¡®å®šç­–ç•¥ $\pi$ (å¦‚ä½¿ç”¨ $\varepsilon$ è´ªå¿ƒç­–ç•¥)</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼ˆæ¯”å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€Sä¸æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ç”¨åŠ¨ä½œä»·å€¼ $q(S, \cdot)$ ç¡®å®šçš„ç­–ç•¥ï¼ˆå¦‚ $\varepsilon$ è´ªå¿ƒç­–ç•¥ï¼‰ç¡®å®šåŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆç”¨æœŸæœ›è®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma \sum_{a \in \mathcal{A}\left(s^{\prime}\right)} \pi\left(a|S^{\prime}\right) q\left(S^{\prime}, a\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q(S, A)$ ä»¥å‡å° $[U-q(S, A)]^{2}$ ï¼ˆå¦‚ $q(S, A) \leftarrow q(S, A)+\alpha\left[U-q(S, A)\right])$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<h3 id="32-å¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°"><a class="header" href="#32-å¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°">3.2 å¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°</a></h3>
<p>æœ¬èŠ‚ä»‹ç»å¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°ï¼å¼‚ç­–æ—¶åºå·®åˆ†æ›´æ–°æ˜¯æ¯”åŒç­–å·®åˆ†æ›´æ–°æ›´åŠ æµè¡Œçš„ç®—æ³•ï¼ç‰¹åˆ«æ˜¯ Q å­¦ä¹ ç®—æ³•ï¼Œå·²ç»æˆä¸ºæœ€é‡è¦çš„åŸºç¡€ç®—æ³•ä¹‹ä¸€ï¼</p>
<h4 id="321-åŸºäºé‡è¦æ€§é‡‡æ ·çš„å¼‚ç­–ç®—æ³•"><a class="header" href="#321-åŸºäºé‡è¦æ€§é‡‡æ ·çš„å¼‚ç­–ç®—æ³•">3.2.1 åŸºäºé‡è¦æ€§é‡‡æ ·çš„å¼‚ç­–ç®—æ³•</a></h4>
<p>æ—¶åºå·®åˆ†ç­–ç•¥è¯„ä¼°ä¹Ÿå¯ä»¥ä¸é‡è¦æ€§é‡‡æ ·ç»“åˆï¼Œè¿›è¡Œå¼‚ç­–çš„ç­–ç•¥è¯„ä¼°å’Œæœ€ä¼˜ç­–ç•¥æ±‚è§£ï¼å¯¹äº $n$ æ­¥æ—¶åºå·®åˆ†è¯„ä¼°ç­–ç•¥çš„åŠ¨ä½œä»·å€¼å’Œ SARSA ç®—æ³•ï¼Œå…¶æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t:t+n}^{(q)}$ ä¾èµ–äºè½¨è¿¹ $\mathrm{S}<em>{t}, A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}, A_{t+n}$ ï¼åœ¨ç»™å®š $S_{t}, A_{t}$ çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ç­–ç•¥ $\pi$ å’Œå¦å¤–çš„è¡Œä¸ºç­–ç•¥ $b$ ç”Ÿæˆè¿™ä¸ªè½¨è¿¹çš„æ¦‚ç‡åˆ†åˆ«ä¸ºï¼š
$$
\begin{array}{l}
\operatorname{\mathbb{P}}<em>{\pi}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}, A_{t}\right]=\prod_{\tau=t+1}^{t+n-1} \pi\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{t+n-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right) \
\operatorname{\mathbb{P}}<em>{b}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}, A_{t}\right]=\prod_{\tau=t+1}^{t+n-1} b\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{t+n-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right)
\end{array}
$$
å®ƒä»¬çš„æ¯”å€¼å°±æ˜¯é‡è¦æ€§é‡‡æ ·æ¯”ç‡ï¼š
$$
\rho_{t+1:t+n-1}=\frac{\operatorname{\mathbb{P}}<em>{\pi}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}, A_{t}\right]}{\operatorname{\mathbb{P}}<em>{b}\left[R</em>{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}, A_{t}\right]}=\prod_{\tau=t+1}^{t+n-1} \frac{\pi\left(A_{\tau}|S_{\tau}\right)}{b\left(A_{\tau}|S_{\tau}\right)}
$$
ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡è¡Œä¸ºç­–ç•¥ $b$ æ‹¿åˆ°çš„ä¼°è®¡ï¼Œåœ¨åŸç­–ç•¥ $\pi$ å‡ºç°çš„æ¦‚ç‡æ˜¯åœ¨ç­–ç•¥ $b$ ä¸­å‡ºç°æ¦‚ç‡çš„ $\rho_{t+1:t+n-1}$ å€ï¼æ‰€ä»¥ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œè¿™æ ·çš„æ—¶åºå·®åˆ†ç›®æ ‡çš„æƒé‡ä¸º $\rho_{t+1:t+n-1}$ ï¼å°†è¿™ä¸ªæƒé‡æ•´åˆåˆ°æ—¶åºå·®åˆ†ç­–ç•¥è¯„ä¼°åŠ¨ä½œä»·å€¼ç®—æ³•æˆ– SARSAç®—æ³•ä¸­ï¼Œå°±å¯ä»¥å¾—åˆ°å®ƒä»¬çš„é‡è¦æ€§é‡‡æ ·çš„ç‰ˆæœ¬ï¼ç®—æ³• 3-7 ç»™å‡ºäº†å¤šæ­¥æ—¶åºå·®åˆ†çš„ç‰ˆæœ¬ï¼Œå•æ­¥ç‰ˆæœ¬è¯·è‡ªè¡Œæ•´ç†ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-7</strong>ï¼š $\quad n$ æ­¥æ—¶åºå·®åˆ†ç­–ç•¥è¯„ä¼°åŠ¨ä½œä»·å€¼æˆ– SARSA ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼å‡½æ•° $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}(s)$ ï¼Œè‹¥æ˜¯æœ€ä¼˜ç­–ç•¥æ§åˆ¶åˆ™è¿˜è¦è¾“å‡ºç­–ç•¥ $\pi$<br />
å‚æ•°ï¼šæ­¥æ•° $n$ ï¼Œä¼˜åŒ–å™¨ (éšå«å­¦ä¹ ç‡ $\alpha$ )ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(S_{\text {ç»ˆæ­¢ }}, a\right) \leftarrow 0, \quad a \in \mathcal{A}$ ï¼è‹¥æ˜¯æœ€ä¼˜ç­–ç•¥æ§åˆ¶ï¼Œè¿˜åº”è¯¥ç”¨ $q$ å†³å®š $\pi$ ï¼ˆå¦‚ $\varepsilon$ è´ªå¿ƒç­–ç•¥ï¼‰</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆè¡Œä¸ºç­–ç•¥ï¼‰æŒ‡å®šè¡Œä¸ºç­–ç•¥ $b$ ï¼Œä½¿å¾— $\pi \ll b$<br />
2.2 ï¼ˆç”Ÿæˆ $n$ æ­¥ï¼‰ç”¨ç­–ç•¥ $b$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, \ldots, R_{n}, S_{n}$ ï¼ˆè‹¥é‡åˆ°ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ä»¤åç»­å¥–åŠ±å‡ä¸º 0 , çŠ¶æ€å‡ä¸º $S_{\text {ç»ˆæ­¢}}$ ï¼‰<br />
2.3 å¯¹äº $t=0,1,2, \ldots$ ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ° $S_{t}=S_{\text{ç»ˆæ­¢}}$ ï¼š
<ol>
<li>è‹¥ $S_{t+n} \neq S_{\text{ç»ˆæ­¢}}$ ï¼Œåˆ™æ ¹æ® $\pi\left(\cdot|S_{t+n}\right)$ å†³å®šåŠ¨ä½œ $A_{t+n}$</li>
<li>ï¼ˆæ›´æ–°æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t:t+n}^{(q)}$ ï¼‰ $U\leftarrow R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} q\left(S_{t+n}, A_{i+n}\right)$</li>
<li>ï¼ˆè®¡ç®—é‡è¦æ€§é‡‡æ ·æ¯”ç‡ $\rho_{t+1:t+n-1}$ï¼‰$\rho \leftarrow \prod_{\tau=t+1}^{\min {t+n, T}-1} \frac{\pi\left(A_{\tau}|S_{\tau}\right)}{b\left(A_{\tau}|S_{\tau}\right)}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $q\left(S_{t}, A_{t}\right)$ ä»¥å‡å° $\rho\left[U-q\left(S_{t}, A_{t}\right)\right]^{2}$</li>
<li>ï¼ˆæ›´æ–°ç­–ç•¥ï¼‰å¦‚æœæ˜¯æœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•ï¼Œéœ€è¦æ ¹æ® $q(S, \cdot)$ ä¿®æ”¹ $\pi(.|S)$</li>
<li>è‹¥ $S_{t+n} \neq S_{\text {ç»ˆæ­¢ }}$ ï¼Œåˆ™æ‰§è¡Œ $A_{t+n}$ ï¼Œå¾—åˆ°å¥–åŠ± $R_{t+n+1}$ å’Œä¸‹ä¸€çŠ¶æ€ $S_{t+n+1}$ ï¼›è‹¥ $S_{t+n}=S_{\text {ç»ˆæ­¢}}$ ï¼Œåˆ™ä»¤$R_{t+n+1} \leftarrow 0, \quad S_{t+n+1} \leftarrow S_{\text{ç»ˆæ­¢}}$ ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•å°†é‡è¦æ€§é‡‡æ ·è¿ç”¨äºæ—¶åºå·®åˆ†çŠ¶æ€ä»·å€¼ä¼°è®¡å’ŒæœŸæœ› SARSA ç®—æ³•ä¸­ï¼å…·ä½“è€Œè¨€ï¼Œè€ƒè™‘ä» $t$ å¼€å§‹çš„ $n$ æ­¥è½¨è¿¹ $S_{t}, A_{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}$ ï¼åœ¨ç»™å®š $S_{t}$ çš„æ¡ä»¶ä¸‹ï¼Œé‡‡ç”¨ç­–ç•¥ $\pi$ å’Œç­–ç•¥ $b$ ç”Ÿæˆè¿™ä¸ªè½¨è¿¹çš„æ¦‚ç‡åˆ†åˆ«ä¸º:
$$
\begin{array}{l}
\operatorname{\mathbb{P}}<em>{\pi}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}\right]=\prod_{\tau=t}^{t+n-1} \pi\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{t+n-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right) \
\operatorname{\mathbb{P}}<em>{b}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}\right]=\prod_{\tau=t}^{t+n-1} b\left(A_{\tau}|S_{\tau}\right) \prod_{\tau=t}^{t+n-1} p\left(S_{\tau+1}, R_{\tau+1}|S_{\tau}, A_{\tau}\right)
\end{array}
$$
å®ƒä»¬çš„æ¯”å€¼å°±æ˜¯æ—¶åºå·®åˆ†çŠ¶æ€è¯„ä¼°å’ŒæœŸæœ› SARSA ç®—æ³•ç”¨åˆ°çš„é‡è¦æ€§é‡‡æ ·æ¯”ç‡:
$$
\rho_{t:t+n-1}=\frac{\operatorname{\mathbb{P}}<em>{\pi}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}\right]}{\operatorname{\mathbb{P}}<em>{b}\left[A</em>{t}, R_{t+1}, S_{t+1}, A_{t+1}, \ldots, S_{t+n}|S_{t}\right]}=\prod_{\tau=t}^{t+n-1} \frac{\pi\left(A_{\tau}|S_{\tau}\right)}{b\left(A_{\tau}|S_{\tau}\right)}
$$</p>
<h4 id="322-qå­¦ä¹ "><a class="header" href="#322-qå­¦ä¹ ">3.2.2 Qå­¦ä¹ </a></h4>
<p>3.1.3 èŠ‚çš„æœŸæœ› SARSA ç®—æ³•å°†æ—¶åºå·®åˆ†ç›®æ ‡ä» SARSA ç®—æ³•çš„ $U_{t}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1}\right)$ æ”¹ä¸º $U_{t}=R_{t+1}+\gamma \mathrm{E}\left[q\left(S_{t+1}, A_{t+1}\right)|S_{t+1}\right]$ ï¼Œä»è€Œé¿å…äº†å¶å°”å‡ºç°çš„ä¸å½“è¡Œä¸ºç»™æ•´ä½“ç»“æœå¸¦æ¥çš„è´Ÿé¢å½±å“ï¼ Q å­¦ä¹ åˆ™æ˜¯ä»æ”¹è¿›åç­–ç•¥çš„è¡Œä¸ºå‡ºå‘ï¼Œå°†æ—¶åºå·®åˆ†ç›®æ ‡æ”¹ä¸º
$$
U_{t}=R_{t+1}+\gamma \max <em>{a \in \mathcal{A}\left(S</em>{i+1}\right)} q\left(S_{t+1}, a\right)
$$
Q å­¦ä¹ ç®—æ³•è®¤ä¸ºï¼Œåœ¨æ ¹æ® $S_{t+1}$ ä¼°è®¡ $U_{t}$ æ—¶ï¼Œä¸å…¶ä½¿ç”¨ $q\left(S_{t+1}, A_{t+1}\right)$ æˆ– $v\left(S_{t+1}\right)$ ï¼Œè¿˜ä¸å¦‚ä½¿ç”¨æ ¹æ® $q\left(S_{t+1}, \cdot\right)$ æ”¹è¿›åçš„ç­–ç•¥æ¥æ›´æ–°ï¼Œæ¯•ç«Ÿè¿™æ ·å¯ä»¥æ›´æ¥è¿‘æœ€ä¼˜ä»·å€¼ï¼å› æ­¤ Q å­¦ä¹ çš„æ›´æ–°å¼ä¸æ˜¯åŸºäºå½“å‰çš„ç­–ç•¥ï¼Œè€Œæ˜¯åŸºäºå¦å¤–ä¸€ä¸ªå¹¶ä¸ä¸€å®šè¦ä½¿ç”¨çš„ç¡®å®šæ€§ç­–ç•¥æ¥æ›´æ–°åŠ¨ä½œä»·å€¼ï¼ä»è¿™ä¸ªæ„ä¹‰ä¸Šçœ‹ï¼ŒQ å­¦ä¹ æ˜¯ä¸€ä¸ªå¼‚ç­–ç®—æ³•ï¼ç®—æ³• 3-8 ç»™å‡ºäº† Q å­¦ä¹ ç®—æ³•ï¼Q å­¦ä¹ ç®—æ³•å’ŒæœŸæœ› SARSA æœ‰å®Œå…¨ç›¸åŒçš„ç¨‹åºç»“æ„ï¼Œåªæ˜¯åœ¨æ›´æ–°æœ€ä¼˜åŠ¨ä½œä»·å€¼çš„ä¼°è®¡ $q\left(S_{t}, A_{t}\right)$ æ—¶ä½¿ç”¨äº†ä¸åŒçš„æ–¹æ³•æ¥è®¡ç®—ç›®æ ‡ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-8</strong>ï¼š$\quad$ Q å­¦ä¹ ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(s_{\text {ç»ˆæ­¢}}, a\right) \leftarrow 0, a \in \mathcal{A}$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼ˆä¾‹å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€Sä¸æ˜¯ç»ˆæ­¢çŠ¶æ€)ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ç”¨åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(S, \cdot)$ ç¡®å®šçš„ç­–ç•¥å†³å®šåŠ¨ä½œ $A($ å¦‚ $\varepsilon$ è´ªå¿ƒç­–ç•¥ $)$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆç”¨æ”¹è¿›åçš„ç­–ç•¥è®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma \max _{a \in \mathcal{A}\left(s^{\prime}\right)} q\left(S^{\prime}, a\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼å’Œç­–ç•¥ï¼‰æ›´æ–° $q(S, A)$ ä»¥å‡å° $[U-q(S, A)]^{2}($ å¦‚ $q(S, A) \leftarrow q(S, A)+\alpha[U-q(S, A)])$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<p>å½“ç„¶ï¼ŒQå­¦ä¹ ä¹Ÿæœ‰å¤šæ­¥çš„ç‰ˆæœ¬ï¼Œå…¶ç›®æ ‡ä¸ºï¼š
$$
U_{t}=R_{t+1}+\gamma R_{t+2}+\cdots+\gamma^{n-1} R_{t+n}+\gamma^{n} \max <em>{a \in \mathcal{A}\left(S</em>{t+n}\right)} q\left(S_{t+n}, a\right)
$$
å…·ä½“çœç•¥</p>
<h4 id="323-åŒé‡qå­¦ä¹ "><a class="header" href="#323-åŒé‡qå­¦ä¹ ">3.2.3 åŒé‡Qå­¦ä¹ </a></h4>
<p>ä¸Šä¸€èŠ‚ä»‹ç»çš„ Q å­¦ä¹ ç”¨ $\max_{a} q\left(S_{t+1}, a\right)$ æ¥æ›´æ–°åŠ¨ä½œä»·å€¼ï¼Œä¼šå¯¼è‡´â€œæœ€å¤§åŒ–åå·® (maximization bias)ï¼Œä½¿å¾—ä¼°è®¡çš„åŠ¨ä½œä»·å€¼åå¤§ï¼</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæœ€å¤§åŒ–åå·®çš„ä¾‹å­ï¼ä¸‹æ‰€ç¤ºçš„å›åˆåˆ¶ä»»åŠ¡ä¸­ï¼ŒMarkovå†³ç­–è¿‡ç¨‹çš„çŠ¶æ€ç©ºé—´ä¸º $\mathcal{S}=\left{s_{\text{å¼€å§‹}}, S_{\text{ä¸­é—´}}\right}$ ï¼Œå›åˆå¼€å§‹æ—¶æ€»æ˜¯å¤„åœ¨ $s_{\text {å¼€å§‹ }}$ çŠ¶æ€ï¼Œå¯ä»¥é€‰æ‹©çš„åŠ¨ä½œç©ºé—´ $\mathcal{A}\left(s_{\text{å¼€å§‹}}\right)=\left{a_{\text {å»ä¸­é—´ }}, a_{\text {å»ç»ˆæ­¢ }}\right}$ ï¼å¦‚æœé€‰æ‹©åŠ¨ä½œ $a_{\text {å»ä¸­é—´ }}$ ï¼Œåˆ™å¯ä»¥åˆ°è¾¾çŠ¶æ€ $s_{\text {ä¸­é—´ }}$ ï¼Œè¯¥æ­¥å¥–åŠ±ä¸º 0 ï¼›å¦‚æœé€‰æ‹©åŠ¨ä½œ $s_{\text {å»ç»ˆæ­¢ }}$ ï¼Œåˆ™å¯ä»¥è¾¾åˆ°ç»ˆæ­¢çŠ¶æ€å¹¶è·å¾—å¥–åŠ± $+1$ ï¼ä»çŠ¶æ€ $s_{\text {ä¸­é—´ }}$ å‡ºå‘ï¼Œæœ‰å¾ˆå¤šå¯é€‰çš„åŠ¨ä½œï¼ˆä¾‹å¦‚æœ‰ 1000 ä¸ªå¯é€‰çš„åŠ¨ä½œï¼‰ï¼Œä½†æ˜¯è¿™äº›åŠ¨ä½œéƒ½æŒ‡å‘ç»ˆæ­¢çŠ¶æ€ï¼Œå¹¶ä¸”å¥–åŠ±éƒ½æœä»å‡å€¼ä¸º 0 ã€æ–¹å·®ä¸º 100 çš„æ­£æ€åˆ†å¸ƒï¼ä»ç†è®ºä¸Šè¯´ï¼Œè¿™ä¸ªä¾‹å­çš„æœ€ä¼˜ä»·å€¼å‡½æ•°ä¸º: $v_{<em>}\left(s_{\text {ä¸­é—´ }}\right)=q_{</em>}\left(S_{\text {ä¸­é—´ }}, \cdot\right)=0$ ï¼Œ$v_{<em>}\left(S_{\text {å¼€å§‹ }}\right)=q_{</em>}\left(S_{\text {å¼€å§‹ }}, a_{\text {å»ç»ˆæ­¢ }}\right)=1$ ï¼Œæœ€ä¼˜ç­–ç•¥åº”å½“æ˜¯ $\pi_{<em>}\left(S_{\text {å¼€å§‹ }}\right)=a_{\text {å»ç»ˆæ­¢ }}$ ï¼ä½†æ˜¯ï¼Œå¦‚æœé‡‡ç”¨ Q å­¦ä¹ ï¼Œåœ¨ä¸­é—´è¿‡ç¨‹ä¸­ä¼šèµ°ä¸€äº›å¼¯è·¯ï¼šåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œä» $s_{\text {ä¸­é—´ }}$ å‡ºå‘çš„æŸäº›åŠ¨ä½œä¼šé‡‡æ ·åˆ°æ¯”è¾ƒå¤§çš„å¥–åŠ±å€¼ï¼Œä»è€Œå¯¼è‡´ $\max <em>{a \in \mathcal{A}\left(s</em>{\text {ä¸­è‹— }}\right)} q\left(S_{\text {ä¸­ä¼º }}, a\right)$ ä¼šæ¯”è¾ƒå¤§ï¼Œä½¿å¾—ä» $s_{\text {å¼€å§‹æ›´å€¾å‘äºé€‰æ‹© }} a_{\text {å»ä¸­é—´}}$ ï¼è¿™æ ·çš„é”™è¯¯éœ€è¦å¤§é‡çš„æ•°æ®æ‰èƒ½çº æ­£ï¼ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<strong>åŒé‡ Q å­¦ä¹ </strong> ( Double Q Learningï¼‰ç®—æ³•ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„åŠ¨ä½œä»·å€¼ä¼°è®¡å€¼ $q^{(0)}(\cdot, \cdot)$ å’Œ $q^{(1)}(\cdot, \cdot)$ ï¼Œç”¨ $q^{(0)}\left(S_{t+1}, \arg \max <em>{a} q^{(1)}\left(S</em>{t+1}, a\right)\right)$ æˆ– $q^{(1)}\left(S_{t+1}, \arg \max <em>{a} q^{(0)}\left(S</em>{t+1}, a\right)\right)$ æ¥ ä»£æ›¿ Q å­¦ä¹ ä¸­çš„ $\max <em>{a} q\left(S</em>{t+1}, a\right)$ ï¼ç”±äº $q^{(0)}$ å’Œ $q^{(1)}$ æ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¼°è®¡ï¼Œæ‰€ä»¥ $\mathrm{E}\left[q^{(0)}\left(S_{t+1}, A^{</em>}\right)\right]=q\left(S_{t+1}, A^{<em>}\right)$ ï¼Œå…¶ä¸­ $A^{</em>}=\arg \max <em>{a} q^{(1)}\left(S</em>{t+1}, a\right)$ ï¼Œè¿™æ ·å°±æ¶ˆé™¤äº†åå·®ï¼åœ¨åŒé‡å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œ $q^{(0)}$ å’Œ $q^{(1)}$ éƒ½éœ€è¦é€æ¸æ›´æ–°ï¼æ‰€ä»¥ï¼Œæ¯æ­¥å­¦ä¹ å¯ä»¥ç­‰æ¦‚ç‡é€‰æ‹©ä»¥ä¸‹ä¸¤ä¸ªæ›´æ–° ä¸­çš„ä»»æ„ä¸€ä¸ªï¼š</p>
<ul>
<li>ä½¿ç”¨ $U_{t}^{(0)}=R_{t+1}+\gamma q^{(1)}\left(S_{t+1}, \arg \max_{a} q^{(0)}\left(S_{t+1}, a\right)\right)$ æ¥æ›´æ–° $\left(S_{t}, A_{t}\right), \quad$ ä»¥å‡å° $U_{t}^{(0)}$ å’Œ
$q^{(0)}\left(S_{t}, A_{t}\right)$ ä¹‹é—´çš„å·®åˆ« (ä¾‹å¦‚è®¾å®šæŸå¤±ä¸º $\left[U_{t}^{(0)}-q^{(0)}\left(S_{t}, A_{t}\right)\right]^{2}$ ï¼Œæˆ–é‡‡ç”¨ $q^{(0)}\left(S_{t}, A_{t}\right) \leftarrow$
$q^{(0)}\left(S_{t}, A_{t}\right)+\alpha\left[U_{t}^{(0)}-q^{(0)}\left(S_{t}, A_{t}\right)\right]$ æ›´æ–° $)$</li>
<li>ä½¿ç”¨ $U_{t}^{(1)}=R_{t+1}+\gamma q^{(0)}\left(S_{t+1}, \arg \max_{a} q^{(1)}\left(S_{t+1}, a\right)\right)$ æ¥æ›´æ–° $\left(S_{t}, A_{t}\right)$ ï¼Œä»¥å‡å° $U_{t}^{(1)}$ å’Œ $q^{(1)}\left(S_{t}, A_{t}\right)$ ä¹‹é—´çš„å·®åˆ« (ä¾‹å¦‚è®¾å®šæŸå¤±ä¸º $\left[U_{t}^{(1)}-q^{(1)}\left(S_{t}, A_{2}\right)\right]^{2}$ ï¼Œæˆ–é‡‡ç”¨ $q^{(1)}\left(S_{t}, A_{t}\right) \leftarrow q^{(1)}\left(S_{t}, A_{t}\right)+$
$\alpha\left[U_{t}^{(1)}-q^{(1)}\left(S_{t}, A_{t}\right)\right]$ æ›´æ–° $)_{0}$</li>
</ul>
<p>ç®—æ³• 3-9 ç»™å‡ºäº†åŒé‡ Q å­¦ä¹ æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„ç®—æ³•ï¼è¿™ä¸ªç®—æ³•ä¸­æœ€ç»ˆè¾“å‡ºçš„åŠ¨ä½œä»·å€¼å‡½æ•°æ˜¯ $q^{(0)}$ å’Œ $q^{(1)}$ çš„å¹³å‡å€¼ï¼Œå³ $\frac{1}{2}\left(q^{(0)}+q^{(1)}\right)$ ï¼åœ¨ç®—æ³•çš„ä¸­é—´æ­¥éª¤ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸¤ä¸ªä¼°è®¡çš„å’Œ $q^{(0)}+q^{(1)}$ æ¥ä»£æ›¿å¹³å‡å€¼ $\frac{1}{2}\left(q^{(0)}+q^{(1)}\right)$ ï¼Œåœ¨ç•¥å¾®ç®€åŒ–çš„è®¡ç®—ä¸‹ä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-9</strong>ï¼š $\quad$ åŒé‡ Q å­¦ä¹ ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $q^{(i)}(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}(s), i \in{0,1}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ä»¤ $q^{(i)}\left(S_{\text {ç»ˆæ­¢ }}, a\right) \leftarrow$
$0, a \in \mathcal{A}, i \in{0,1}$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æŸï¼ˆæ¯”å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€ $S$ ä¸æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ç”¨åŠ¨ä½œä»·å€¼ $\left(q^{(0)}+q^{(1)}\right)(S, \cdot)$ ç¡®å®šçš„ç­–ç•¥å†³å®šåŠ¨ä½œ $A$ (å¦‚ $\varepsilon$ è´ªå¿ƒç­–ç•¥)</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆéšæœºé€‰æ‹©æ›´æ–° $q^{(0)}$ æˆ– $q^{(1)}$ï¼‰ä»¥ç­‰æ¦‚ç‡é€‰æ‹© $q^{(0)}$ æˆ– $q^{(1)}$ ä¸­çš„ä¸€ä¸ªåŠ¨ä½œä»·å€¼å‡½æ•°ä½œä¸ºæ›´æ–°å¯¹è±¡ï¼Œè®°é€‰æ‹©çš„æ˜¯ $q^{(i)}, i \in{0,1}$</li>
<li>ï¼ˆç”¨æ”¹è¿›åçš„ç­–ç•¥æ›´æ–°å›æŠ¥çš„ä¼°è®¡) $U\leftarrow R+\gamma q^{(1-i)}\left(S^{\prime}, \arg \max _{a} q^{(i)}\left(S^{\prime}, a\right)\right)$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼ï¼‰æ›´æ–° $q^{(i)}(S, A)$ ä»¥å‡å° $\left[U-q^{(i)}(S, A)\right]^{2}\left(\right.$ å¦‚ $q^{(i)}(S, A) \leftarrow q^{(i)}(S, A)+\left.\alpha\left[U-q^{(i)}(S, A)\right]\right)$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<h3 id="33-èµ„æ ¼è¿¹"><a class="header" href="#33-èµ„æ ¼è¿¹">3.3 èµ„æ ¼è¿¹</a></h3>
<p>èµ„æ ¼è¿¹æ˜¯ä¸€ç§è®©æ—¶åºå·®åˆ†å­¦ä¹ æ›´åŠ æœ‰æ•ˆçš„æœºåˆ¶ï¼å®ƒèƒ½åœ¨å›åˆæ›´æ–°å’Œå•æ­¥æ—¶åºå·®åˆ†æ›´æ–°ä¹‹é—´æŠ˜ä¸­ï¼Œå¹¶ä¸”å®ç°ç®€å•ï¼Œè¿è¡Œæœ‰æ•ˆï¼</p>
<h4 id="331-lambda-å›æŠ¥"><a class="header" href="#331-lambda-å›æŠ¥">3.3.1 $\lambda$ å›æŠ¥</a></h4>
<p>åœ¨æ­£å¼ä»‹ç»èµ„æ ¼è¿¹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹  $\lambda$ å›æŠ¥å’ŒåŸºäº $\lambda$ å›æŠ¥çš„ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•ï¼ç»™å®š $\lambda \in[0,1]$ ï¼Œ<strong>$\lambda$ å›æŠ¥</strong> $(\lambda$ return $)$ æ˜¯æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t:t+1}, U_{t:t+2}, U_{t:t+3}, \ldots$ æŒ‰ $(1-\lambda),(1-\lambda) \lambda,(1-\lambda)$
$\lambda^{2}, \ldots$ åŠ æƒå¹³å‡çš„ç»“æœï¼å¯¹äºè¿ç»­æ€§ä»»åŠ¡ï¼Œæœ‰
$$
U_{t}^{\lambda}=(1-\lambda) \sum_{n=1}^{+\infty} \lambda^{n-1} U_{t:t+n}
$$
å¯¹äºå›åˆåˆ¶ä»»åŠ¡ï¼Œåˆ™æœ‰
$$
U_{t}^{\lambda}=(1-\lambda) \sum_{n=1}^{T-t-1} \lambda^{n-1} U_{t:t+n}+\lambda^{T-t-1} G_{t}
$$
$\lambda$ å›æŠ¥ $U_{t}^{\lambda}$ å¯ä»¥çœ‹ä½œæ˜¯å›åˆæ›´æ–°ä¸­çš„ç›®æ ‡ $G_{t}$ å’Œå•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ $U_{t:t+1}$ çš„æ¨å¹¿ï¼šå½“ $\lambda=1$ æ—¶ï¼Œ $U_{t}^{1}=G_{t}$ å°±æ˜¯å›åˆæ›´æ–°çš„å›æŠ¥ï¼›å½“ $\lambda=0$ æ—¶ï¼Œ $U_{t}^{0}=U_{t:t+1}$ å°±æ˜¯å•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼</p>
<p><strong>ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•</strong>ï¼ˆ offline $\lambda$ -return algorithm ï¼‰åˆ™æ˜¯åœ¨æ›´æ–°ä»·å€¼ï¼ˆå¦‚åŠ¨ä½œä»·å€¼ $q\left(S_{t}, A_{t}\right)$ æˆ–çŠ¶æ€ä»·å€¼ $\left.v\left(S_{t}\right)\right)$ æ—¶ï¼Œç”¨ $U_{t}^{\lambda}$ ä½œä¸ºç›®æ ‡ï¼Œè¯•å›¾å‡å° $\left[U_{t}^{\lambda}-q\left(S_{t}, A_{t}\right)\right]^{2}$ æˆ– $\left[U_{t}^{\lambda}-v\left(S_{t}\right)\right]^{2}$ ï¼å®ƒä¸å›åˆæ›´æ–°ç®—æ³•ç›¸æ¯”ï¼Œåªæ˜¯å°†æ›´æ–°çš„ç›®æ ‡ä» $G_{t}$ æ¢ä¸ºäº† $U_{t}^{\lambda}$ ï¼å¯¹äºå›åˆåˆ¶ä»»åŠ¡ï¼Œåœ¨å›åˆç»“æŸåä¸ºæ¯ä¸€æ­¥ $t=0,1,2, \ldots$ è®¡ç®— $U_{t}^{\lambda}$ ï¼Œå¹¶ç»Ÿä¸€æ›´æ–°ä»·å€¼ï¼å› æ­¤ï¼Œè¿™æ ·çš„ç®—æ³•ç§°ä¸ºç¦»çº¿ç®—æ³•ï¼ˆ offline algorithm ï¼‰ï¼å¯¹äºè¿ç»­æ€§ä»»åŠ¡ï¼Œæ²¡æœ‰åŠæ³•è®¡ç®— $U_{t}^{\lambda}$ ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ç¦»çº¿ $\lambda$ ç®—æ³•ï¼</p>
<p>ç”±äºç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•ä½¿ç”¨çš„ç›®æ ‡åœ¨ $G_{t}$ å’Œ $U_{t:t+1}$ é—´åšäº†æŠ˜ä¸­ï¼Œæ‰€ä»¥ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•çš„æ•ˆæœå¯èƒ½æ¯”å›åˆæ›´æ–°å’Œå•æ­¥æ—¶åºå·®åˆ†æ›´æ–°éƒ½è¦å¥½ï¼ä½†æ˜¯ï¼Œç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•ä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹:
å…¶ä¸€ï¼Œå®ƒåªèƒ½ç”¨äºå›åˆåˆ¶ä»»åŠ¡ï¼Œä¸èƒ½ç”¨äºè¿ç»­æ€§ä»»åŠ¡ï¼›å…¶äºŒï¼Œåœ¨å›åˆç»“æŸåè¦è®¡ç®— $U_{t}^{\lambda}$ $(t=0,1, \ldots, T-1)$ ï¼Œè®¡ç®—é‡å·¨å¤§ï¼åœ¨ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†é‡‡ç”¨èµ„æ ¼è¿¹æ¥å¼¥è¡¥è¿™ä¸¤ä¸ªç¼ºç‚¹ï¼</p>
<h4 id="332-tdlambda"><a class="header" href="#332-tdlambda">3.3.2 TDï¼ˆ$\lambda$ï¼‰</a></h4>
<p>TD ($\lambda$) æ˜¯å†å²ä¸Šå…·æœ‰é‡è¦å½±å“åŠ›çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œåœ¨ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•çš„åŸºç¡€ä¸Šæ”¹è¿›è€Œæ¥ï¼ä»¥åŸºäºåŠ¨ä½œä»·å€¼çš„ç®—æ³•ä¸ºä¾‹ï¼Œåœ¨ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•ä¸­ï¼Œå¯¹ä»»æ„çš„ $n=1,2, \ldots$ ï¼Œåœ¨æ›´æ–° $q\left(S_{t-n}, A_{t-n}\right)\left(\right.$ æˆ– $\left.v\left(S_{t-n}\right)\right)$ æ—¶ï¼Œæ—¶åºå·®åˆ†ç›®æ ‡ $U_{t-n:t}$ çš„æƒé‡æ˜¯ $(1-\lambda) \lambda^{n-1}$ ï¼è™½ç„¶éœ€è¦ç­‰åˆ°å›åˆç»“æŸæ‰èƒ½è®¡ç®— $U_{t-n}^{\lambda}$ ï¼Œä½†æ˜¯åœ¨çŸ¥é“ $\left(S_{t}, A_{t}\right)$ åå°±èƒ½è®¡ç®— $U_{t-n:t}$ ï¼æ‰€ä»¥æˆ‘ä»¬åœ¨çŸ¥é“ $\left(S_{t}, A_{t}\right)$ åï¼Œå°±å¯
ä»¥ç”¨ $q\left(S_{t}, A_{\imath}\right)$ å»æ›´æ–°æ‰€æœ‰çš„ $q\left(S_{\tau}, A_{\tau}\right)(\tau=0,1, \ldots, t-1)$ ï¼Œå¹¶ä¸”æ›´æ–°çš„æƒé‡ä¸ $\lambda^{t-\tau}$ æˆæ­£æ¯”ï¼</p>
<p>æ®æ­¤ï¼Œç»™å®šè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{2}, \ldots$ ï¼Œå¯ä»¥å¼•å…¥èµ„æ ¼è¿¹ $e_{t}(s, a), s \in \mathcal{S}, a \in \mathcal{A}(s)$ æ¥è¡¨ç¤ºç¬¬ $t$ æ­¥çš„çŠ¶æ€åŠ¨ä½œå¯¹ $\left(S_{t}, A_{t}\right)$ çš„å•æ­¥è‡ªç›Šç»“æœ $U_{t:t+1}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1}\right)$ å¯¹æ¯ä¸ªçŠ¶æ€åŠ¨ä½œå¯¹ $(s, a)$ $(s \in \mathcal{S}, a \in \mathcal{A}(s))$ éœ€è¦æ›´æ–°çš„æƒé‡ï¼<strong>èµ„æ ¼è¿¹</strong>ï¼ˆeligibilityï¼‰ç”¨ä¸‹åˆ—é€’æ¨å¼å®šä¹‰ï¼šå½“ $t=0$ æ—¶ï¼Œ
$$
e_{0}(s, a)=0, s \in \mathcal{S}, a \in \mathcal{A}
$$
å½“ $t&gt;0$ æ—¶ï¼Œ
$$
e_{t}(s, a)=\left{\begin{array}{ll}
1+\beta \gamma \lambda e_{t-1}(s, a), &amp; S_{t}=s, A_{t}=a \
\gamma \lambda e_{t-1}(s, a), &amp; \text { å…¶ä»– }
\end{array}\right.
$$
å…¶ä¸­ $\beta \in[0,1]$ æ˜¯äº‹å…ˆç»™å®šçš„å‚æ•°ï¼èµ„æ ¼è¿¹çš„è¡¨è¾¾å¼åº”è¯¥è¿™ä¹ˆç†è§£ï¼šå¯¹äºå†å²ä¸Šçš„æŸä¸ªçŠ¶å¿µåŠ¨ä½œå¯¹ $\left(S_{\tau}, A_{\tau}\right)$ ï¼Œè·ç¦»ç¬¬ $t$ æ­¥é—´éš”äº† $t-\tau$ æ­¥ï¼Œ $U_{\tau:t}$ åœ¨ $\lambda$ å›æŠ¥ $U_{\tau}^{\lambda}$ ä¸­çš„æƒé‡ä¸º $(1-\lambda) \lambda^{t-\tau-1}$ ï¼Œå¹¶ä¸” $U_{\tau :t}=R_{\tau+1}+\cdots+\gamma^{t-\tau-1} U_{t-1:t}$ ï¼Œæ‰€ä»¥ $U_{t-1:t}$ æ˜¯ä»¥ $(1-\lambda)(\lambda \gamma)^{t-\tau-1}$ çš„æ¯”ç‡æŠ˜ç®—åˆ° $U_{\tau}^{\lambda}$ ä¸­ï¼é—´éš”çš„æ­¥æ•°æ¯å¢åŠ ä¸€æ­¥ï¼ŒåŸå…ˆçš„èµ„æ ¼è¿¹å¤§è‡´éœ€è¦è¡°å‡ä¸º $\gamma \lambda$ å€ï¼å¯¹å½“å‰æœ€æ–°å‡ºç°çš„çŠ¶æ€åŠ¨ä½œå¯¹ $\left(S_{t}, A_{t}\right)$ ï¼Œå¤§çš„æ›´æ–°æƒé‡åˆ™è¦è¿›è¡ŒæŸç§å¼ºåŒ–ï¼å¼ºåŒ–çš„å¼ºåº¦ $\beta$ å¸¸æœ‰ä»¥ä¸‹å–å€¼ï¼š</p>
<ul>
<li>$\beta=1$, è¿™æ—¶çš„èµ„æ ¼è¿¹ç§°ä¸º<strong>ç´¯ç§¯è¿¹</strong>ï¼ˆaccumulating traceï¼‰</li>
<li>$\beta=1-\alpha$ ï¼ˆå…¶ä¸­ $\alpha$ æ˜¯å­¦ä¹ ç‡ï¼‰,è¿™æ—¶çš„èµ„æ ¼è¿¹ç§°ä¸º<strong>è·å…°è¿¹</strong>ï¼ˆdutch trace)</li>
<li>$\beta=0$ ï¼Œè¿™æ—¶çš„èµ„æ ¼è¿¹ç§°ä¸º<strong>æ›¿æ¢è¿¹</strong>ï¼ˆreplacing traceï¼‰ï¼</li>
</ul>
<p>å½“ $\beta=1$ æ—¶ï¼Œç›´æ¥å°†å…¶èµ„æ ¼è¿¹åŠ  1 ï¼›å½“ $\beta=0$ æ—¶ï¼Œèµ„æ ¼è¿¹æ€»æ˜¯å–å€¼åœ¨ $[0,1]$ èŒƒå›´å†…ï¼Œæ‰€ä»¥è®©å…¶èµ„æ ¼è¿¹ç›´æ¥ç­‰äº 1 ä¹Ÿå®ç°äº†å¢åŠ ï¼Œåªæ˜¯å¢åŠ çš„å¹…åº¦æ²¡æœ‰ $\beta=1$ æ—¶é‚£ä¹ˆå¤§ï¼›å½“ $\beta \in(0,1)$ æ—¶ï¼Œå¢åŠ çš„å¹…åº¦åœ¨ $\beta=0$ å’Œ $\beta=1$ ä¹‹é—´ï¼</p>
<p><img src="DRL/img/1.jpg" alt="ä¸åŒèµ„æ ¼è¿¹" /></p>
<p>åˆ©ç”¨èµ„æ ¼è¿¹ï¼Œå¯ä»¥å¾—åˆ° $\mathrm{TD}(\lambda)$ ç­–ç•¥è¯„ä¼°ç®—æ³•ï¼ç®—æ³• 3-10 ç»™å‡ºäº†ç”¨ $\mathrm{TD}(\lambda)$ è¯„ä¼°åŠ¨ä½œä»·å€¼çš„ç®—æ³•ï¼å®ƒæ˜¯åœ¨å•æ­¥æ—¶åºå·®åˆ†çš„åŸºç¡€ä¸Šï¼ŒåŠ å…¥èµ„æ ¼è¿¹æ¥å®ç°çš„ï¼èµ„æ ¼è¿¹ä¹Ÿå¯ä»¥å’Œæœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•ç»“åˆï¼Œä¾‹å¦‚å’Œ $\mathrm{SARSA}$ ç®—æ³•ç»“åˆå¾—åˆ° $\operatorname{SARSA}(\lambda)$ ç®—æ³•ï¼ç®—æ³• 3-10 ä¸­å¦‚æœæ²¡æœ‰ç­–ç•¥è¾“å…¥ï¼Œåœ¨é€‰æ‹©åŠ¨ä½œæ—¶æŒ‰ç…§å½“å‰åŠ¨ä½œä»·å€¼æ¥é€‰æ‹©æœ€ä¼˜åŠ¨ä½œï¼Œå°±æ˜¯ $\operatorname{SARSA}(\lambda)$ ç®—æ³•ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 3-10</strong> $\quad \mathrm{TD}(\lambda)$ çš„åŠ¨ä½œä»·å€¼è¯„ä¼°æˆ– $\operatorname{SARSA}(\lambda)$ å­¦ä¹ </p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ï¼Œè‹¥è¯„ä¼°åŠ¨ä½œä»·å€¼åˆ™éœ€è¾“å…¥ç­–ç•¥ $\pi$ ï¼<br />
è¾“å‡ºï¼šåŠ¨ä½œä»·å€¼ä¼°è®¡ $q(s, a), s \in \mathcal{S}, a \in \mathcal{A}$<br />
å‚æ•°ï¼šèµ„æ ¼è¿¹å‚æ•° $\beta$ ï¼Œä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ )ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–ä»·å€¼ä¼°è®¡ $q(s, a) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}, a \in \mathcal{A}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œä»¤ $q\left(s_{\text {ç»ˆæ­¢ }}, a\right) \leftarrow 0, a \in \mathcal{A}$</li>
<li>å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–èµ„æ ¼è¿¹ï¼‰ $e(s, a) \leftarrow 0, s \in \mathcal{S}, a \in \mathcal{A}$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œå†æ ¹æ®è¾“å…¥ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A$<br />
2.3 å¦‚æœå›åˆæœªç»“æ±ï¼ˆæ¯”å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€Sä¸æ˜¯ç»ˆæ­¢çŠ¶æ€)ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>æ ¹æ®è¾“å…¥ç­–ç•¥ $\pi\left(\cdot|S^{\prime}\right)$ æˆ–æ˜¯è¿­ä»£çš„æœ€ä¼˜ä»·å€¼å‡½æ•° $q\left(S^{\prime}, \cdot\right)$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆæ›´æ–°èµ„æ ¼è¿¹ï¼‰ $e(s, a) \leftarrow \gamma \lambda e(s, a), s \in \mathcal{S}, a \in \mathcal{A}(s), e(S, A) \leftarrow 1+\beta e(S, A)$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰ $q(s, a) \leftarrow q(s, a)+\alpha e(s, a)[U-q(S, A)], s \in \mathcal{S}, a \in \mathcal{A}(s)$</li>
<li>è‹¥ $S^{\prime}=S_{\text {ç»ˆæ­¢ }}$ ï¼Œåˆ™é€€å‡º 2.2 æ­¥ï¼›å¦åˆ™ $S \leftarrow S^{\prime}, A \leftarrow A^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>èµ„æ ¼è¿¹ä¹Ÿå¯ä»¥ç”¨äºçŠ¶æ€ä»·å€¼ï¼ç»™å®šè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{2}, \ldots$ ï¼Œèµ„æ ¼è¿¹ $e_{t}(s), s \in \mathcal{S}$ æ¥è¡¨ç¤ºç¬¬ $t$ æ­¥çš„çŠ¶æ€åŠ¨ä½œå¯¹ $S_{t}$ å¯¹çš„å•æ­¥è‡ªç›Šç»“æœ $U_{t:t+1}=R_{t+1}+\gamma v\left(S_{t+1}\right)$ å¯¹æ¯ä¸ªçŠ¶æ€ $s(s \in \mathcal{S})$ éœ€è¦æ›´æ–°çš„æƒé‡ï¼Œå…¶å®šä¹‰ä¸ºï¼šå½“ $t=0$ æ—¶ï¼Œ
$$
e_{0}(s)=0, s \in \mathcal{S}
$$
å½“ $t&gt;0$ æ—¶ï¼Œ
$$
e_{t}(s)=\left{\begin{array}{ll}
1+\beta \gamma \lambda e_{t-1}(s), &amp; S_{t}=s \
\gamma \lambda e_{t-1}(s), &amp; \text { å…¶ä»–. }
\end{array}\right.
$$
ç®—æ³• 3-11 ç»™å‡ºäº†ç”¨èµ„æ ¼è¿¹è¯„ä¼°ç­–ç•¥çŠ¶æ€ä»·å€¼çš„ç®—æ³•ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 5-14</strong> $\quad \operatorname{TD}(\lambda)$ æ›´æ–°è¯„ä¼°ç­–ç•¥çš„çŠ¶æ€ä»·å€¼</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰ã€ç­–ç•¥ $\pi$<br />
è¾“å‡ºï¼šçŠ¶æ€ä»·å€¼å‡½æ•° $v(s), s \in \mathcal{S}$<br />
å‚æ•°ï¼šèµ„æ ¼è¿¹å‚æ•° $\beta$ ï¼Œä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ )ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–ä»·å€¼ $v(s) \leftarrow$ ä»»æ„å€¼ï¼Œ $s \in \mathcal{S}$ ï¼å¦‚æœæœ‰ç»ˆæ­¢çŠ¶æ€ï¼Œ $v\left(S_{\text {ç»ˆæ­¢ }}\right) \leftarrow 0$</li>
<li>å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ:<br />
2.1 ï¼ˆåˆå§‹åŒ–èµ„æ ¼è¿¹ï¼‰ $e(s) \leftarrow 0, s \in \mathcal{S}$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ Sï¼<br />
2.3 å¦‚æœå›åˆæœªç»“æ±ï¼ˆæ¯”å¦‚æœªè¾¾åˆ°æœ€å¤§æ­¥æ•°ã€ $S$ ä¸æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ:
<ol>
<li>æ ¹æ®è¾“å…¥ç­–ç•¥ $\pi$ ç¡®å®šåŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆæ›´æ–°èµ„æ ¼è¿¹ï¼‰ $e(s) \leftarrow \gamma \lambda e(s), s \in \mathcal{S}, e(S) \leftarrow 1+\beta e(S)$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma v\left(S^{\prime}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰ $v(s) \leftarrow v(s)+\alpha e(s)[U-v(S)], s \in \mathcal{S}$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<p>$\mathrm{TD}(\lambda)$ ç®—æ³•ä¸ç¦»çº¿ $\lambda$ å›æŠ¥ç®—æ³•ç›¸æ¯”ï¼Œå…·æœ‰ä¸‰å¤§ä¼˜ç‚¹ï¼š</p>
<ul>
<li>$\mathrm{TD}(\lambda)$ ç®—æ³•æ—¢å¯ä»¥ç”¨äºå›åˆåˆ¶ä»»åŠ¡ï¼Œåˆå¯ä»¥ç”¨äºè¿ç»­æ€§ä»»åŠ¡</li>
<li>$\mathrm{TD}(\lambda)$ ç®—æ³•åœ¨æ¯ä¸€æ­¥éƒ½æ›´æ–°ä»·å€¼ä¼°è®¡ï¼Œèƒ½å¤ŸåŠæ—¶åæ˜ å˜åŒ–</li>
<li>$\mathrm{TD}(\lambda)$ ç®—æ³•åœ¨æ¯ä¸€æ­¥éƒ½æœ‰å‡åŒ€çš„è®¡ç®—ï¼Œè€Œä¸”è®¡ç®—é‡éƒ½è¾ƒå°</li>
</ul>
<h2 id="å››-å‡½æ•°è¿‘ä¼¼æ–¹æ³•"><a class="header" href="#å››-å‡½æ•°è¿‘ä¼¼æ–¹æ³•">å››ï¼ å‡½æ•°è¿‘ä¼¼æ–¹æ³•</a></h2>
<p>ç¬¬ $3 \sim 5$ ç« ä¸­ä»‹ç»çš„æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£ç®—æ³•ã€å›åˆæ›´æ–°ç®—æ³•å’Œæ—¶åºå·®åˆ†æ›´æ–°ç®—æ³•ï¼Œåœ¨æ¯æ¬¡æ›´æ–°ä»·å€¼å‡½æ•°æ—¶éƒ½åªæ›´æ–°æŸä¸ªçŠ¶æ€ï¼ˆæˆ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰ä¸‹çš„ä»·å€¼ä¼°è®¡ï¼ä½†æ˜¯ï¼Œåœ¨æœ‰äº›ä»»åŠ¡ä¸­ï¼ŒçŠ¶æ€å’ŒåŠ¨ä½œçš„æ•°ç›®éå¸¸å¤§ï¼Œç”šè‡³å¯èƒ½æ˜¯æ— ç©·å¤§ï¼Œè¿™æ—¶ï¼Œä¸å¯èƒ½å¯¹æ‰€æœ‰çš„çŠ¶æ€ (æˆ–çŠ¶æ€åŠ¨ä½œå¯¹) é€ä¸€è¿›è¡Œæ›´æ–°ï¼å‡½æ•°è¿‘ä¼¼æ–¹æ³•ç”¨å‚æ•°åŒ–çš„æ¨¡å‹æ¥è¿‘ä¼¼æ•´ä¸ªçŠ¶æ€ä»·å€¼å‡½æ•°ï¼ˆæˆ–åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰ï¼Œå¹¶åœ¨æ¯æ¬¡å­¦ä¹ æ—¶æ›´æ–°æ•´ä¸ªå‡½æ•°ï¼è¿™æ ·ï¼Œé‚£äº›æ²¡æœ‰è¢«è®¿é—®è¿‡çš„çŠ¶æ€ï¼ˆæˆ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰çš„ä»·å€¼ä¼°è®¡ä¹Ÿèƒ½å¾—åˆ°æ›´æ–°ï¼æœ¬ç« å°†ä»‹ç»å‡½æ•°è¿‘ä¼¼æ–¹æ³•çš„ä¸€èˆ¬ç†è®ºï¼ŒåŒ…æ‹¬ç­–ç•¥è¯„ä¼°å’Œæœ€ä¼˜ç­–ç•¥æ±‚è§£çš„ä¸€èˆ¬ç†è®ºï¼å†ä»‹ç»ä¸¤ç§æœ€å¸¸è§çš„è¿‘ä¼¼å‡½æ•°ï¼šçº¿æ€§å‡½æ•°å’Œäººå·¥ç¥ç»ç½‘ç»œï¼åè€…å°†æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ç›¸ç»“åˆï¼Œç§°ä¸ºæ·±åº¦ Q å­¦ä¹ ï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œä¹Ÿæ˜¯ç›®å‰çš„çƒ­é—¨ç®—æ³•ï¼</p>
<h3 id="41-å‡½æ•°è¿‘ä¼¼åŸç†"><a class="header" href="#41-å‡½æ•°è¿‘ä¼¼åŸç†">4.1 å‡½æ•°è¿‘ä¼¼åŸç†</a></h3>
<p>æœ¬èŠ‚ä»‹ç»ç”¨<strong>å‡½æ•°è¿‘ä¼¼</strong>ï¼ˆfunction approximationï¼‰æ–¹æ³•æ¥ä¼°è®¡ç»™å®šç­–ç•¥ $\pi$ çš„çŠ¶æ€ä»·å€¼å‡½æ•° $v_{\pi}$ æˆ–åŠ¨ä½œä»·å€¼å‡½æ•° $q_{\pi}$ ï¼è¦è¯„ä¼°çŠ¶æ€ä»·å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå‚æ•°ä¸º $\mathbf{w}$ çš„å‡½æ•° $v(s ; \mathbf{w})$ $(s \in \mathcal{S})$ æ¥è¿‘ä¼¼çŠ¶æ€ä»·å€¼ï¼›è¦è¯„ä¼°åŠ¨ä½œä»·å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå‚æ•°ä¸º $\mathbf{w}$ çš„å‡½æ•° $q(s, a ; \mathbf{w})$ $(s \in \mathcal{S}, a \in \mathcal{A}(s))$ æ¥è¿‘ä¼¼åŠ¨ä½œä»·å€¼ï¼åœ¨åŠ¨ä½œé›† $\mathcal{A}$ æœ‰é™çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥ç”¨ä¸€ä¸ªçŸ¢é‡å‡½æ•°ä¸€ä¸ªåŠ¨ä½œï¼Œè€Œæ•´ä¸ªçŸ¢é‡å‡½æ•°é™¤å‚æ•°å¤–åªç”¨çŠ¶æ€ä½œä¸ºè¾“äººï¼è¿™é‡Œçš„å‡½æ•° $v(s ; \mathbf{w})(s \in \mathcal{S})$ ã€ $q(s, a ; w)(s \in \mathcal{S}, a \in \mathcal{A}(s)), \mathbf{q}(s ; \mathbf{w})(s \in \mathcal{S})$ å½¢å¼ä¸é™ï¼Œå¯ä»¥æ˜¯çº¿æ€§å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¥ç»ç½‘ç»œï¼ä½†æ˜¯ï¼Œå®ƒä»¬çš„å½¢å¼è¦äº‹å…ˆç»™å®šï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­åªæ›´æ–°å‚æ•° $\mathbf{w}$ ï¼ä¸€æ—¦å‚æ•° $\mathbf{w}$ å®Œå…¨ç¡®å®šï¼Œä»·å€¼ä¼°è®¡å°±å®Œå…¨ç»™å®šï¼æ‰€ä»¥ï¼Œæœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•æ›´æ–°å‚æ•° $\mathbf{w}$ ï¼æ›´æ–°å‚æ•°çš„æ–¹æ³•æ—¢å¯ä»¥ç”¨äºç­–ç•¥ä»·å€¼è¯„ä¼°ï¼Œä¹Ÿå¯ä»¥ç”¨äºæœ€ä¼˜ç­–ç•¥æ±‚è§£ï¼</p>
<h4 id="411-éšæœºæ¢¯åº¦ä¸‹é™"><a class="header" href="#411-éšæœºæ¢¯åº¦ä¸‹é™">4.1.1 éšæœºæ¢¯åº¦ä¸‹é™</a></h4>
<p>æœ¬èŠ‚æ¥çœ‹åŒç­–å›åˆæ›´æ–°ä»·å€¼ä¼°è®¡ï¼å°†åŒç­–å›åˆæ›´æ–°ä»·å€¼ä¼°è®¡ä¸å‡½æ•°è¿‘ä¼¼æ–¹æ³•ç›¸ç»“åˆï¼Œå¯ä»¥å¾—åˆ°å‡½æ•°è¿‘ä¼¼å›åˆæ›´æ–°ä»·å€¼ä¼°è®¡ç®—æ³•ï¼ˆç®—æ³• 4-1 ï¼‰ï¼è¿™ä¸ªç®—æ³•ä¸ç¬¬ 2 ç« ä¸­å›åˆæ›´æ–°ç®—æ³•çš„åŒºåˆ«å°±æ˜¯åœ¨ä»·å€¼æ›´æ–°æ—¶æ›´æ–°çš„å¯¹è±¡æ˜¯å‡½æ•°å‚æ•°ï¼Œè€Œä¸æ˜¯æ¯ä¸ªçŠ¶æ€æˆ–çŠ¶æ€åŠ¨ä½œå¯¹çš„ä»·å€¼ä¼°è®¡ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-1</strong>ï¼š $\quad$ éšæœºæ¢¯åº¦ä¸‹é™å‡½æ•°è¿‘ä¼¼è¯„ä¼°ç­–ç•¥çš„ä»·å€¼</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç¯å¢ƒå’Œç­–ç•¥ $\pi$ ç”Ÿæˆè½¨è¿¹æ ·æœ¬ $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{2}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$<br />
2.3 ï¼ˆé€æ­¥æ›´æ–°ï¼‰å¯¹ $t \leftarrow T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰è‹¥è¯„ä¼°çš„æ˜¯åŠ¨ä½œä»·å€¼åˆ™æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\left[G-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ (å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha\left[G-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right] \nabla q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right) ;$ è‹¥è¯„ä¼°çš„æ˜¯çŠ¶æ€ä»·å€¼åˆ™æ›´æ–° $\mathbf{w}$ ä»¥å‡å°
$\left[G-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}\left(\text { å¦‚ } \mathbf{w} \leftarrow \mathbf{w}+\alpha\left[G-v\left(S_{t} ; \mathbf{w}\right)\right] \nabla v\left(S_{t} ; \mathbf{w}\right)\right)$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>å¦‚æœæˆ‘ä»¬ç”¨ç®—æ³• 4-1 è¯„ä¼°åŠ¨ä½œä»·å€¼ï¼Œåˆ™æ›´æ–°å‚æ•°æ—¶åº”å½“è¯•å›¾å‡å°æ¯ä¸€æ­¥çš„å›æŠ¥ä¼°è®¡ $G$ å’ŒåŠ¨ä½œä»·å€¼ä¼°è®¡ $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ çš„å·®åˆ«ï¼æ‰€ä»¥ï¼Œå¯ä»¥å®šä¹‰æ¯ä¸€æ­¥æŸå¤±ä¸º $\left[G_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼Œè€Œæ•´ä¸ªå›åˆçš„æŸå¤±ä¸º $\sum_{t=0}^{T-1}\left[G_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼å¦‚æœæˆ‘ä»¬æ²¿ç€ $\sum_{t=0}^{T-1}\left[G_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ å¯¹ $\mathbf{w}$ çš„æ¢¯åº¦çš„åæ–¹å‘æ›´æ–°ç­–ç•¥å‚æ•° $\mathbf{w}$ ï¼Œå°±æœ‰æœºä¼šå‡å°æŸå¤±ï¼è¿™æ ·çš„æ–¹æ³•ç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆ stochastic gradient-descent, SGD ï¼‰ç®—æ³•ï¼å¯¹äºèƒ½æ”¯æŒè‡ªåŠ¨æ¢¯åº¦è®¡ç®—çš„è½¯ä»¶åŒ…ï¼Œå¾€å¾€è‡ªå¸¦æ ¹æ®æŸå¤±å‡½æ•°æ›´æ–°å‚æ•°çš„åŠŸèƒ½ï¼å¦‚æœä¸ä½¿ç”¨ç°æˆçš„å‚æ•°æ›´æ–°è½¯ä»¶åŒ…ï¼Œä¹Ÿå¯ä»¥è‡ªå·±è®¡ç®—å¾—åˆ° $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ çš„
æ¢¯åº¦ $\nabla q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ ï¼Œç„¶ååˆ©ç”¨ä¸‹å¼è¿›è¡Œæ›´æ–° :
$$
\mathbf{w} \leftarrow \mathbf{w}-\frac{1}{2} \alpha_{t} \nabla\left[G_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}=\mathbf{w}+\alpha_{t}\left[G_{t}-q\left(S_{t}, A_t ; \mathbf{w}\right)\right] \nabla q\left(S_{t}, A_{t} ; \mathbf{w}\right)
$$
å¯¹äºçŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„åˆ†æï¼å®šä¹‰æ¯ä¸€æ­¥çš„æŸå¤±ä¸º $\left[G_{t}-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼Œæ•´ä¸ªå›åˆçš„æŸå¤±ä¸º $\sum_{t=0}^{T}\left[G_{t}-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼å¯ä»¥åœ¨è‡ªåŠ¨æ¢¯åº¦è®¡ç®—å¹¶æ›´æ–°å‚æ•°çš„è½¯ä»¶åŒ…ä¸­å®šä¹‰è¿™ä¸ªæŸå¤±æ¥æ›´æ–°å‚æ•° $\mathbf{w}$, ä¹Ÿå¯ä»¥ç”¨ä¸‹å¼æ›´æ–°ï¼š
$$
\mathbf{w} \leftarrow \mathbf{w}-\frac{1}{2} \alpha_{t} \nabla\left[G_{t}-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}=\mathbf{w}+\alpha_{t}\left[G_{t}-v\left(S_{t} ; \mathbf{w}\right)\right] \nabla v\left(S_{t} ; \mathbf{w}\right)
$$
ç›¸åº”çš„å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°ç®—æ³•ä¸ç®—æ³• 4-1 ç±»ä¼¼ï¼Œæ­¤å¤„ä»ç•¥ï¼</p>
<p>å°†ç­–ç•¥æ”¹è¿›å¼•å…¥éšæœºæ¢¯åº¦ä¸‹é™è¯„ä¼°ç­–ç•¥ï¼Œå°±èƒ½å®ç°éšæœºæ¢¯åº¦ä¸‹é™æœ€ä¼˜ç­–ç•¥æ±‚è§£ï¼ç®—æ³• 4-2 ç»™å‡ºäº†éšæœºæ¢¯åº¦ä¸‹é™æœ€ä¼˜ç­–ç•¥æ±‚è§£çš„ç®—æ³•ï¼å®ƒä¸ç¬¬ 2 ç« å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•çš„åŒºåˆ«ä¹Ÿä»…ä»…åœ¨äºè¿­ä»£çš„è¿‡ç¨‹ä¸­ä¸æ˜¯ç›´æ¥ä¿®æ”¹ä»·å€¼ä¼°è®¡ï¼Œè€Œæ˜¯æ›´æ–°ä»·å€¼å‚æ•° $\mathbf{w}$ ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 4-2</strong>ï¼š$\quad$ éšæœºæ¢¯åº¦ä¸‹é™æ±‚æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç¯å¢ƒå’Œå½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(\cdot, \cdot ; \mathbf{w})$ å¯¼å‡ºçš„ç­–ç•¥ï¼ˆå¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ï¼‰ç”Ÿæˆè½¨è¿¹æ ·
æœ¬ $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{2}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$<br />
2.3 ï¼ˆé€æ­¥æ›´æ–°ï¼‰å¯¹ $t \leftarrow T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰æ›´æ–°å‚æ•° $\mathbf{w}$ ä»¥å‡å° $\left[G-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}($ å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[G-$
$\left.\left.q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right] \nabla q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right)$ï¼</li>
</ol>
</li>
</ol>
<hr />
<h4 id="412-åŠæ¢¯åº¦ä¸‹é™"><a class="header" href="#412-åŠæ¢¯åº¦ä¸‹é™">4.1.2 åŠæ¢¯åº¦ä¸‹é™</a></h4>
<p>åŠ¨æ€è§„åˆ’å’Œæ—¶åºå·®åˆ†å­¦ä¹ éƒ½ç”¨äº†â€œè‡ªç›Šâ€æ¥ä¼°è®¡å›æŠ¥ï¼Œå›æŠ¥çš„ä¼°è®¡å€¼ä¸ $\mathbf{w}$ æœ‰å…³ï¼Œæ˜¯å­˜åœ¨åå·®çš„ï¼ä¾‹å¦‚ï¼Œå¯¹äºå•æ­¥æ›´æ–°æ—¶åºå·®åˆ†ä¼°è®¡çš„åŠ¨ä½œä»·å€¼å‡½æ•°ï¼Œå›æŠ¥çš„ä¼°è®¡ä¸º $U_{t}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1} ; \mathbf{w}\right)$ ï¼Œè€ŒåŠ¨ä½œä»·å€¼çš„ä¼°è®¡ä¸º $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ ï¼Œè¿™ä¸¤ä¸ªä¼°è®¡éƒ½ä¸æƒé‡ $\mathbf{w}$ æœ‰å…³ï¼åœ¨è¯•å›¾å‡å°æ¯ä¸€æ­¥çš„å›æŠ¥ä¼°è®¡ $U_{t}$ å’ŒåŠ¨ä½œä»·å€¼ä¼°è®¡ $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ çš„å·®åˆ«æ—¶ï¼Œå¯ä»¥å®šä¹‰æ¯ä¸€æ­¥æŸå¤±ä¸º $\left[U_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼Œè€Œæ•´ä¸ªå›åˆçš„æŸå¤±ä¸º $\sum_{t=0}^{T-1}\left[U_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right]^{2}$ ï¼åœ¨æ›´æ–°å‚æ•° $\mathbf{w}$ ä»¥å‡å°æŸå¤±æ—¶ï¼Œåº”å½“æ³¨æ„ä¸å¯¹å›æŠ¥çš„ä¼°è®¡ $U_{t}=R_{t+1}+\gamma q\left(S_{t+1}, A_{t+1} ; \mathbf{w}\right)$ æ±‚æ¢¯åº¦ï¼Œåªå¯¹åŠ¨ä½œä»·å€¼çš„ä¼°è®¡ $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ æ±‚å…³äº $\mathbf{w}$ çš„æ¢¯åº¦ï¼Œè¿™å°±æ˜¯<strong>åŠæ¢¯åº¦ä¸‹é™</strong>ï¼ˆsemi-gradient descentï¼‰ç®—æ³•ï¼åŠæ¢¯åº¦ä¸‹é™ç®—æ³•åŒæ ·æ—¢å¯ä»¥ç”¨äºç­–ç•¥è¯„ä¼°ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ±‚è§£æœ€ä¼˜ç­–ç•¥ï¼ˆè§ç®—æ³• 4-3 å’Œç®—æ³• 4-4 ï¼‰ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 4-3</strong>ï¼š$\quad$ åŠæ¢¯åº¦ä¸‹é™ç®—æ³•ä¼°è®¡åŠ¨ä½œä»·å€¼æˆ– $\mathrm{SARSA}$ ç®—æ³•æ±‚æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi(\cdot|S)$ ç¡®å®šåŠ¨ä½œ $A$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œåˆ™ç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(S, \cdot ; \mathbf{w})$ å¯¼å‡ºçš„ç­–ç•¥ $($ å¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ $)$ ç¡®å®šåŠ¨ä½œ $A$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi\left(\cdot|S^{\prime}\right)$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œåˆ™ç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q\left(S^{\prime}, ; \mathbf{w}\right)$ å¯¼å‡ºçš„ç­–ç•¥ $\left(\right.$ å¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ï¼‰ç¡®å®šåŠ¨ä½œ $A_{0}^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰æ›´æ–°å‚æ•° $\mathbf{w}$ ä»¥å‡å° $[U-q(S, A ; \mathbf{w})]^{2}($ å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-q(S, A ; \mathbf{w})] \nabla q(S, A ; \mathbf{w}))$ ï¼æ³¨æ„æ­¤æ­¥ä¸å¯ä»¥é‡æ–°è®¡ç®— $U$</li>
<li>$S\leftarrow S^{\prime}, \quad A \leftarrow A^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<blockquote>
<p><strong>ç®—æ³• 4-4</strong>ï¼š$\quad$ åŠæ¢¯åº¦ä¸‹é™ä¼°è®¡çŠ¶æ€ä»·å€¼æˆ–æœŸæœ› SARSA ç®—æ³•æˆ– $\mathrm{Q}$ å­¦ä¹ </p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ
<ol>
<li>å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi(\cdot|S)$ ç¡®å®šåŠ¨ä½œ $A$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œåˆ™ç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(S, \cdot ; \mathbf{w})$ å¯¼å‡ºçš„ç­–ç•¥ï¼ˆå¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ï¼‰ç¡®å®šåŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S_{0}^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰å¦‚æœæ˜¯çŠ¶æ€ä»·å€¼è¯„ä¼°ï¼Œåˆ™ $U \leftarrow R+\gamma v\left(S^{\prime} ; \mathbf{w}\right)$ ï¼å¦‚æœæ˜¯æœŸæœ› SARSA ç®—æ³•ï¼Œåˆ™ $U \leftarrow R+\gamma \sum_{a} \pi\left(a|S^{\prime} ; \mathbf{w}\right) q\left(S^{\prime}, a ; \mathbf{w}\right)$ ï¼Œå…¶ä¸­ $\pi\left(\cdot|S^{\prime} ; \mathbf{w}\right)$ æ˜¯ $q\left(S^{\prime}, \cdot ; \mathbf{w}\right)$ ç¡®å®šçš„ç­–ç•¥ï¼ˆå¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ï¼‰è‹¥æ˜¯ $\mathrm{Q}$ å­¦ä¹ åˆ™ $U \leftarrow R+\gamma \max_{a} q\left(S^{\prime}, a ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰è‹¥æ˜¯çŠ¶æ€ä»·å€¼è¯„ä¼°åˆ™æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $[U-v(S ; \mathbf{w})]^{2}$ (å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-v(S ; \mathbf{w})] \nabla v(S ; \mathbf{w}))$ ï¼Œè‹¥æ˜¯æœŸæœ› $\operatorname{SARSA}$ ç®—æ³•æˆ– $\mathrm{Q}$ å­¦ä¹ åˆ™æ›´æ–°å‚æ•° $\mathbf{w}$ ä»¥å‡å° $[U-q(S, A ; \mathbf{w})]^{2}($ å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-q(S, A ; \mathbf{w})] \nabla q(S, A ; \mathbf{w}))$ ï¼æ³¨æ„æ­¤æ­¥ä¸å¯ä»¥é‡æ–°è®¡ç®— $U_{0}$</li>
<li>$S \leftarrow S^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>å¦‚æœé‡‡ç”¨èƒ½å¤Ÿè‡ªåŠ¨è®¡ç®—å¾®åˆ†å¹¶æ›´æ–°å‚æ•°çš„è½¯ä»¶åŒ…æ¥å‡å°æŸå¤±ï¼Œåˆ™åŠ¡å¿…æ³¨æ„ä¸èƒ½å¯¹å›æŠ¥çš„ä¼°è®¡æ±‚æ¢¯åº¦ï¼æœ‰äº›è½¯ä»¶åŒ…å¯ä»¥é˜»æ­¢è®¡ç®—è¿‡ç¨‹ä¸­æ¢¯åº¦çš„ä¼ æ’­ï¼Œä¹Ÿå¯ä»¥åœ¨è®¡ç®—å›æŠ¥ä¼°è®¡çš„è¡¨è¾¾å¼æ—¶ä½¿ç”¨é˜»æ­¢æ¢¯åº¦ä¼ æ’­çš„åŠŸèƒ½ï¼è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯å¤åˆ¶ä¸€ä»½å‚æ•° $\mathbf{w}<em>{\text {ç›®æ ‡ }} \leftarrow \mathbf{w}$ ï¼Œåœ¨è®¡ç®—å›æŠ¥ä¼°è®¡çš„è¡¨è¾¾å¼æ—¶ç”¨è¿™ä»½å¤åˆ¶åçš„å‚æ•° $\mathbf{w}</em>{\text {ç›®æ ‡ }}$ æ¥è®¡ç®—å›æŠ¥ä¼°è®¡ï¼Œè€Œåœ¨è‡ªåŠ¨å¾®åˆ†æ—¶åªå¯¹åŸæ¥çš„å‚æ•°è¿›è¡Œå¾®åˆ†ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¯¹å›æŠ¥ä¼°è®¡æ±‚æ¢¯åº¦ï¼</p>
<h4 id="413-å¸¦èµ„æ ¼è¿¹çš„åŠæ¢¯åº¦ä¸‹é™"><a class="header" href="#413-å¸¦èµ„æ ¼è¿¹çš„åŠæ¢¯åº¦ä¸‹é™">4.1.3 å¸¦èµ„æ ¼è¿¹çš„åŠæ¢¯åº¦ä¸‹é™</a></h4>
<p>åœ¨ç¬¬ 3 ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†èµ„æ ¼è¿¹ç®—æ³•ï¼èµ„æ ¼è¿¹å¯ä»¥åœ¨å›åˆæ›´æ–°å’Œå•æ­¥æ—¶åºå·®åˆ†æ›´æ–°ä¹‹é—´è¿›è¡ŒæŠ˜ä¸­ï¼Œå¯èƒ½è·å¾—æ¯”å›åˆæ›´æ–°æˆ–å•æ­¥æ—¶åºå·®åˆ†æ›´æ–°éƒ½æ›´å¥½çš„ç»“æœï¼å›é¡¾å‰æ–‡ï¼Œåœ¨èµ„æ ¼è¿¹ç®—æ³•ä¸­ï¼Œæ¯ä¸ªä»·å€¼ä¼°è®¡çš„æ•°å€¼éƒ½å¯¹åº”ç€ä¸€ä¸ªèµ„æ ¼è¿¹å‚æ•°ï¼Œè¿™ä¸ªèµ„æ ¼è¿¹å‚æ•°è¡¨ç¤ºè¿™ä¸ªä»·å€¼ä¼°è®¡æ•°å€¼åœ¨æ›´æ–°ä¸­çš„æƒé‡ï¼æœ€è¿‘é‡åˆ°çš„çŠ¶æ€åŠ¨ä½œå¯¹ï¼ˆæˆ–çŠ¶æ€ï¼‰çš„æƒé‡å¤§ï¼Œæ¯”è¾ƒä¹…ä»¥å‰é‡åˆ°çš„çŠ¶æ€åŠ¨ä½œå¯¹ï¼ˆæˆ–çŠ¶æ€ï¼‰çš„æƒé‡å°ï¼Œä»æ¥æ²¡æœ‰é‡åˆ°è¿‡çš„çŠ¶æ€åŠ¨ä½œå¯¹ï¼ˆæˆ–çŠ¶æ€ï¼‰çš„æƒé‡ä¸º 0 ï¼æ¯æ¬¡æ›´æ–°æ—¶ï¼Œéƒ½å¯ä»¥æ›´æ–°æ•´æ¡è½¨è¿¹ä¸Šçš„èµ„æ ¼è¿¹ï¼Œå†åˆ©ç”¨èµ„æ ¼è¿¹ä½œä¸ºæƒé‡ï¼Œæ›´æ–°æ•´æ¡è½¨è¿¹ä¸Šçš„ä»·å€¼ä¼°è®¡ï¼</p>
<p>èµ„æ ¼è¿¹åŒæ ·å¯ä»¥è¿ç”¨åœ¨å‡½æ•°è¿‘ä¼¼ç®—æ³•ä¸­ï¼Œå®ç°å›åˆæ›´æ–°å’Œå•æ­¥æ—¶åºå·®åˆ†çš„æŠ˜ä¸­ï¼è¿™æ—¶ï¼Œèµ„æ ¼è¿¹å¯¹åº”ä»·å€¼å‚æ•° $\mathbf{w}$ ï¼å…·ä½“è€Œè¨€ï¼Œèµ„æ ¼è¿¹å‚æ•° $\mathbf{z}$ å’Œä»·å€¼å‚æ•° $\mathbf{w}$ å…·æœ‰ç›¸åŒçš„å½¢çŠ¶å¤§å°ï¼Œå¹¶ä¸”é€å…ƒç´ ä¸€ä¸€å¯¹åº”ï¼èµ„æ ¼è¿¹å‚æ•°ä¸­çš„æ¯ä¸ªå…ƒç´ è¡¨ç¤ºäº†åœ¨æ›´æ–°ä»·å€¼å‚æ•°å¯¹åº”å…ƒç´ æ—¶åº”å½“ä½¿ç”¨çš„æƒé‡ä¹˜ä»¥ä»·å€¼ä¼°è®¡å¯¹è¯¥åˆ†é‡çš„æ¢¯åº¦ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ›´æ–°ä»·å€¼å‚æ•° $\mathbf{w}$ çš„æŸä¸ªåˆ†é‡ $w$ å¯¹åº”ç€èµ„æ ¼è¿¹å‚æ•° $\mathrm{z}$ ä¸­çš„æŸä¸ªåˆ†é‡ $z$ æ—¶ï¼Œé‚£ä¹ˆåœ¨æ›´æ–° $w$ æ—¶åº”å½“ä½¿ç”¨ä»¥ä¸‹è¿­ä»£å¼æ›´æ–°ï¼š
$$
\begin{aligned}
&amp;w \leftarrow w+\alpha z\left[U-q\left(S_{t}, A ; \mathbf{w}\right)\right], \quad &amp;æ›´æ–°åŠ¨ä½œä»·å€¼\
&amp;w \leftarrow w+\alpha z\left[U-v\left(S_{t} ; \mathbf{w}\right)\right], \quad &amp;æ›´æ–°çŠ¶æ€ä»·å€¼
\end{aligned}
$$
å¯¹ä»·å€¼å‚æ•°æ•´ä½“è€Œè¨€ï¼Œå°±æœ‰
$$
\begin{aligned}
&amp;\mathbf{w} \leftarrow \mathbf{w}+\alpha\left[U-q\left(S_{t}, A_{t} ; \mathbf{w}\right)\right] \mathbf{z}, &amp;æ›´æ–°åŠ¨ä½œä»·å€¼\
&amp;\mathbf{w} \leftarrow \mathbf{w}+\alpha\left[U-v\left(S_{t} ; \mathbf{w}\right)\right] \mathbf{z}, \quad &amp;æ›´æ–°çŠ¶æ€ä»·å€¼
\end{aligned}
$$
å½“é€‰å–èµ„æ ¼è¿¹ä¸ºç´¯ç§¯è¿¹æ—¶ï¼Œèµ„æ ¼è¿¹çš„é€’æ¨å®šä¹‰å¼å¦‚ä¸‹ï¼šå½“ $t=0$ æ—¶ $\mathbf{z}<em>{0}=\mathbf{0} ;$ å½“ $t&gt;0$ æ—¶
$$
\begin{aligned}
&amp;\mathbf{z}</em>{t}=\gamma \lambda \mathbf{z}<em>{t-1}+\nabla q\left(S</em>{t}, A_{t} ; \mathbf{w}\right) &amp;æ›´æ–°åŠ¨ä½œä»·å€¼å¯¹åº”çš„èµ„æ ¼è¿¹\
&amp;\mathbf{z}<em>{t}=\gamma \lambda \mathbf{z}</em>{t-1}+\nabla v\left(S_{t} ; \mathbf{w}\right) &amp;æ›´æ–°çŠ¶æ€ä»·å€¼å¯¹åº”çš„èµ„æ ¼è¿¹
\end{aligned}
$$
èµ„æ ¼è¿¹çš„é€’æ¨å¼ç”± 2 é¡¹ç»„æˆï¼é€’æ¨å¼çš„ç¬¬ä¸€é¡¹æ˜¯å¯¹å‰ä¸€æ¬¡æ›´æ–°æ—¶ä½¿ç”¨çš„èµ„æ ¼è¿¹è¡°å‡è€Œæ¥ï¼Œè¡°å‡ç³»æ•°æ˜¯ $\gamma \lambda$ ï¼Œè¿™æ˜¯ä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„æ•°ï¼å¯ä»¥é€šè¿‡æ”¹å˜ $\lambda$ çš„å€¼ï¼Œå†³å®šè¡°å‡çš„é€Ÿåº¦ï¼
å½“ $\lambda$ æ¥è¿‘ 0 æ—¶ï¼Œè¡°å‡å¿«ï¼›å½“ $\lambda$ æ¥è¿‘ 1 æ—¶ï¼Œè¡°å‡æ…¢ï¼é€’æ¨å¼çš„ç¬¬äºŒé¡¹æ˜¯åŠ å¼ºé¡¹ï¼Œå®ƒç”±åŠ¨ä½œä»·å€¼çš„æ¢¯åº¦å€¼å†³å®šï¼åŠ¨ä½œä»·å€¼çš„æ¢¯åº¦å€¼äº‹å®ä¸Šç¡®å®šäº†ä»·å€¼å‚æ•°å¯¹æ€»ä½“ä»·å€¼ä¼°è®¡çš„å½±å“ï¼å¯¹æ€»ä½“ä»·å€¼ä¼°è®¡å½±å“å¤§çš„é‚£äº›ä»·å€¼å‚æ•°åˆ†é‡æ˜¯å½“å‰æ¯”è¾ƒé‡è¦çš„åˆ†é‡ï¼Œåº”å½“åŠ å¼ºå®ƒçš„èµ„æ ¼è¿¹ï¼ä¸è¿‡ï¼Œæ¢¯åº¦çš„åˆ†é‡å€¼ä¸ä¸€å®šæ˜¯æ­£æ•°æˆ– 0 ï¼Œä¹Ÿå¯èƒ½æ˜¯è´Ÿæ•°ï¼æ‰€ä»¥ï¼Œæ›´æ–°åçš„èµ„æ ¼è¿¹åˆ†é‡ä¹Ÿå¯èƒ½æ˜¯è´Ÿå€¼ï¼å½“èµ„æ ¼è¿¹çš„æŸäº›åˆ†é‡æ˜¯è´Ÿå€¼æ—¶ï¼Œå¯¹åº”ä»·å€¼å‚æ•°åˆ†é‡çš„æƒé‡å€¼å°±æ˜¯è´Ÿå€¼ï¼è¿›ä¸€æ­¥è€Œè¨€ï¼Œåœ¨ä»·å€¼å‚æ•°æ›´æ–°æ—¶ï¼Œé¢å¯¹ç›¸åŒçš„æ—¶åºå·®åˆ†è¯¯å·®ï¼Œä¼šå‡ºç°ä»·å€¼å‚æ•°çš„æŸäº›åˆ†é‡å¢å¤§è€Œå¦ä¸€äº›
åˆ†é‡å‡å°çš„æƒ…å†µï¼ ç®—æ³• 4-5 å’Œç®—æ³• 4-6 ç»™å‡ºäº†ä½¿ç”¨èµ„æ ¼è¿¹çš„ä»·å€¼ä¼°è®¡å’Œæœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•ï¼è¿™ä¸¤ä¸ªç®—æ³•éƒ½
ä½¿ç”¨äº†ç´¯ç§¯è¿¹ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-5</strong> $\quad$ $\mathrm{TD}(\lambda)$ ç®—æ³•ä¼°è®¡åŠ¨ä½œä»·å€¼æˆ– $\operatorname{SARSA}(\lambda)$ ç®—æ³•</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S_{0}$ å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi(\cdot|S)$ ç¡®å®šåŠ¨ä½œ $A$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œåˆ™ç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(S, \cdot ; \mathbf{w})$ å¯¼å‡ºçš„ç­–ç•¥ï¼ˆå¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ $)$ ç¡®å®šåŠ¨ä½œ $A$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi\left(\cdot|S^{\prime}\right)$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q\left(S^{\prime}, ; \mathbf{w}\right)$ å¯¼å‡ºçš„ç­–ç•¥ $($ å¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ $)$ ç¡®å®šåŠ¨ä½œ $A^{\prime}$ï¼›</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°èµ„æ ¼è¿¹ï¼‰ $\mathbf{z} \leftarrow \gamma \lambda \mathbf{z}+\nabla q(S, A ; \mathbf{w})$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-q(S, A ; \mathbf{w})] \mathbf{z}$</li>
<li>$S \leftarrow S^{\prime}, A \leftarrow A^{\prime}$.</li>
</ol>
</li>
</ol>
<hr />
<blockquote>
<p><strong>ç®—æ³• 4-6</strong> $\quad$ TD(\lambda) ä¼°è®¡çŠ¶æ€ä»·å€¼æˆ–æœŸæœ› SARSA(\lambda) ç®—æ³•æˆ– $Q$ å­¦ä¹ </p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–èµ„æ ¼è¿¹ï¼‰ $\mathbf{z} \leftarrow \mathbf{0}$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ S<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ
<ol>
<li>å¦‚æœæ˜¯ç­–ç•¥è¯„ä¼°ï¼Œåˆ™ç”¨è¾“å…¥ç­–ç•¥ $\pi(\cdot|S)$ ç¡®å®šåŠ¨ä½œ $A$ ï¼›å¦‚æœæ˜¯å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Œç”¨å½“å‰åŠ¨ä½œä»·å€¼ä¼°è®¡ $q(S, \cdot ; \mathbf{w})$ å¯¼å‡ºçš„ç­–ç•¥ $($ å¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ $)$ ç¡®å®šåŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰å¦‚æœæ˜¯çŠ¶æ€ä»·å€¼è¯„ä¼°ï¼Œåˆ™$U\leftarrow R+\gamma v(S^{\prime};\mathbf{w})$ ï¼å¦‚æœæ˜¯æœŸæœ› SARSA ç®—æ³•ï¼Œåˆ™ $U \leftarrow R+\gamma \sum_{a} \pi\left(a|S^{\prime} ; \mathbf{w}\right) q\left(S^{\prime}, a ; \mathbf{w}\right)$ ï¼Œå…¶ä¸­ $\pi\left(\cdot|S^{\prime} ; \mathbf{w}\right)$ æ˜¯ $q\left(S^{\prime},\cdot:, \mathbf{w}\right)$ ç¡®å®šçš„ç­–ç•¥ (å¦‚ $\varepsilon$ æŸ”æ€§ç­–ç•¥ $)$ ï¼è‹¥æ˜¯ $Q$ å­¦ä¹ åˆ™ $U \leftarrow R+\gamma \max_{a} q\left(S^{\prime}, a ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°èµ„æ ¼è¿¹ï¼‰è‹¥æ˜¯çŠ¶æ€ä»·å€¼è¯„ä¼°ï¼Œåˆ™ $\mathbf{z} \leftarrow \gamma \lambda \mathbf{z}+\nabla v(S ; \mathbf{w})$ ï¼›è‹¥æ˜¯æœŸæœ› $\mathrm{SARSA}$ æ³•æˆ– $\mathrm{Q}$ å­¦ä¹ ï¼Œåˆ™ $\mathbf{z} \leftarrow \gamma \lambda \mathbf{z}+\nabla q(S, A ; \mathbf{w})$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰è‹¥æ˜¯çŠ¶æ€ä»·å€¼è¯„ä¼°ï¼Œåˆ™ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-v(S ; \mathbf{w})] \mathbf{z}$ ï¼›è‹¥æ˜¯æœŸæœ› $\mathrm{SARSA}$ ç®—æ³•æˆ– $\mathrm{Q}$ å­¦ä¹ ï¼Œåˆ™ $\mathbf{w} \leftarrow \mathbf{w}+\alpha[U-q(S, A ; \mathbf{w})] \mathbf{z}$</li>
<li>$S \leftarrow S^{\prime}$.</li>
</ol>
</li>
</ol>
<hr />
<p>TODO:çº¿æ€§è¿‘ä¼¼</p>
<p>TODO:4.3å‡½æ•°è¿‘ä¼¼çš„æ”¶æ•›æ€§</p>
<h3 id="44-æ·±åº¦qå­¦ä¹ "><a class="header" href="#44-æ·±åº¦qå­¦ä¹ ">4.4 æ·±åº¦Qå­¦ä¹ </a></h3>
<p>æœ¬èŠ‚ä»‹ç»ä¸€ç§ç›®å‰éå¸¸çƒ­é—¨çš„å‡½æ•°è¿‘ä¼¼æ–¹æ³•â€”â€”æ·±åº¦ Q å­¦ä¹ ï¼æ·±åº¦ Q å­¦ä¹ å°†æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ç›¸ç»“åˆï¼Œæ˜¯ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼æ·±åº¦ Q å­¦ä¹ çš„æ ¸å¿ƒå°±æ˜¯ç”¨ä¸€ä¸ªäººå·¥ç¥ç»ç½‘ç»œ $q(s, a ; \mathbf{w}), s \in \mathcal{S}, a \in \mathcal{A}$ æ¥ä»£æ›¿åŠ¨ä½œä»·å€¼å‡½æ•°ï¼ç”±äºç¥ç»ç½‘ç»œå…·æœ‰å¼ºå¤§çš„è¡¨è¾¾èƒ½åŠ›ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å¯»æ‰¾ç‰¹å¾ï¼Œæ‰€ä»¥é‡‡ç”¨ç¥ç»ç½‘ç»œæœ‰æ½œåŠ›æ¯”ä¼ ç»Ÿäººå·¥ç‰¹å¾å¼ºå¤§å¾—å¤šï¼æœ€è¿‘åŸºäºæ·±åº¦ Q ç½‘ç»œçš„æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•æœ‰äº†é‡å¤§çš„è¿›å±•ï¼Œåœ¨ç›®å‰å­¦æœ¯ç•Œæœ‰éå¸¸å¤§çš„å½±å“åŠ›ï¼å½“åŒæ—¶å‡ºç°å¼‚ç­–ã€è‡ªç›Šå’Œå‡½æ•°è¿‘ä¼¼æ—¶ï¼Œæ— æ³•ä¿è¯æ”¶æ•›æ€§ï¼Œä¼šå‡ºç°è®­ç»ƒä¸ç¨³å®šæˆ–è®­ç»ƒå›°éš¾ç­‰é—®é¢˜ï¼é’ˆå¯¹å‡ºç°çš„å„ç§é—®é¢˜ï¼Œç ”ç©¶äººå‘˜ä¸»è¦ä»ä»¥ä¸‹ä¸¤æ–¹é¢è¿›è¡Œäº†æ”¹è¿›ï¼</p>
<ul>
<li><strong>ç»éªŒå›æ”¾</strong>ï¼ˆexperience replay): å°†ç»éªŒï¼ˆå³å†å²çš„çŠ¶æ€ã€åŠ¨ä½œã€å¥–åŠ±ç­‰ï¼‰å­˜å‚¨èµ·æ¥ï¼Œå†åœ¨å­˜å‚¨çš„ç»éªŒä¸­æŒ‰ä¸€å®šçš„è§„åˆ™é‡‡æ ·ï¼</li>
<li><strong>ç›®æ ‡ç½‘ç»œ</strong>ï¼ˆtarget network): ä¿®æ”¹ç½‘ç»œçš„æ›´æ–°æ–¹å¼ï¼Œä¾‹å¦‚ä¸æŠŠåˆšå­¦ä¹ åˆ°çš„ç½‘ç»œæƒé‡é©¬ä¸Šç”¨äºåç»­çš„è‡ªç›Šè¿‡ç¨‹ï¼</li>
</ul>
<p>æœ¬èŠ‚åç»­å†…å®¹å°†ä»è¿™ä¸¤æ¡ä¸»çº¿å‡ºå‘ï¼Œä»‹ç»åŸºäºæ·±åº¦ Q ç½‘ç»œçš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼</p>
<h4 id="441-ç»éªŒå›æ”¾"><a class="header" href="#441-ç»éªŒå›æ”¾">4.4.1 ç»éªŒå›æ”¾</a></h4>
<p>V. Mnih ç­‰åœ¨ 2013 å¹´å‘è¡¨æ–‡ç« ã€ŠPlaying Atari with deep reinforcement learning ã€‹ï¼Œæå‡ºäº†åŸºäºç»éªŒå›æ”¾çš„æ·±åº¦ Q ç½‘ç»œï¼Œæ ‡å¿—ç€æ·±åº¦ Q ç½‘ç»œçš„è¯ç”Ÿï¼Œä¹Ÿæ ‡å¿—ç€æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„è¯ç”Ÿï¼åœ¨ 4.2 èŠ‚ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œé‡‡ç”¨æ‰¹å¤„ç†çš„æ¨¡å¼èƒ½å¤Ÿæä¾›ç¨³å®šæ€§ï¼ç»éªŒå›æ”¾å°±æ˜¯ä¸€ç§è®©ç»éªŒçš„æ¦‚ç‡åˆ†å¸ƒå˜å¾—ç¨³å®šçš„æŠ€æœ¯ï¼Œå®ƒèƒ½æé«˜è®­ç»ƒçš„ç¨³å®šæ€§ï¼ç»éªŒå›æ”¾ä¸»è¦æœ‰â€œå­˜å‚¨â€å’Œâ€œé‡‡æ ·å›æ”¾â€ä¸¤å¤§å…³é”®æ­¥éª¤ï¼</p>
<ul>
<li>å­˜å‚¨ï¼šå°†è½¨è¿¹ä»¥ $\left(S_{t}, A_{t}, R_{t+1}, S_{t+1}\right)$ ç­‰å½¢å¼å­˜å‚¨èµ·æ¥ï¼›</li>
<li>é‡‡æ ·å›æ”¾ï¼šä½¿ç”¨æŸç§è§„åˆ™ä»å­˜å‚¨çš„ $\left(S_{t}, A_{t}, R_{t+1}, S_{t+1}\right)$ ä¸­éšæœºå–å‡ºä¸€æ¡æˆ–å¤šæ¡ç»éªŒ</li>
</ul>
<p>ç®—æ³• 4-8 ç»™å‡ºäº†å¸¦ç»éªŒå›æ”¾çš„ Q å­¦ä¹ æœ€ä¼˜ç­–ç•¥æ±‚è§£ç®—æ³•</p>
<blockquote>
<p><strong>ç®—æ³• 6-8</strong>$\quad$ å¸¦ç»éªŒå›æ”¾çš„ $\mathrm{Q}$ å­¦ä¹ æœ€ä¼˜ç­–ç•¥æ±‚è§£</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ä»»æ„åˆå§‹åŒ–å‚æ•° $\mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æ±ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ® $q(S, \cdot ; \mathbf{w})$ é€‰æ‹©åŠ¨ä½œ $A$ å¹¶æ‰§è¡Œï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆå­˜å‚¨ï¼‰å°†ç»éªŒ $\left(S, A, R, S^{\prime}\right)$ å­˜å…¥ç»éªŒåº“ä¸­</li>
<li>ï¼ˆå›æ”¾ï¼‰ä»ç»éªŒåº“ä¸­é€‰å–ç»éªŒ $\left(S_{i}, A_{t}, R_{i}, S_{i}^{\prime}\right)$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U_{i} \leftarrow R_{i}+\gamma \max <em>{a} q\left(S</em>{i}^{\prime}, a ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\left[U_{i}-q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right]^{2}$ (å¦‚ $\mathbf{w \leftarrow w}+\alpha\left[U_{i}-\right.\left.\left.q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right] \nabla q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right)$</li>
<li>$S \leftarrow S^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<p>ç»éªŒå›æ”¾æœ‰ä»¥ä¸‹å¥½å¤„ï¼</p>
<ul>
<li>åœ¨è®­ç»ƒ $\mathrm{Q}$ ç½‘ç»œæ—¶ï¼Œå¯ä»¥æ¶ˆé™¤æ•°æ®çš„å…³è”ï¼Œä½¿å¾—æ•°æ®æ›´åƒæ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼ˆç‹¬ç«‹åŒåˆ†å¸ƒæ˜¯å¾ˆå¤šæœ‰ç›‘ç£å­¦ä¹ çš„è¯æ˜æ¡ä»¶ï¼‰è¿™æ ·å¯ä»¥å‡å°å‚æ•°æ›´æ–°çš„æ–¹å·®ï¼ŒåŠ å¿«æ”¶æ•›ï¼</li>
<li>èƒ½å¤Ÿé‡å¤ä½¿ç”¨ç»éªŒï¼Œå¯¹äºæ•°æ®è·å–å›°éš¾çš„æƒ…å†µå°¤å…¶æœ‰ç”¨ï¼</li>
</ul>
<p>ä»å­˜å‚¨çš„è§’åº¦ï¼Œç»éªŒå›æ”¾å¯ä»¥åˆ†ä¸ºé›†ä¸­å¼å›æ”¾å’Œåˆ†å¸ƒå¼å›æ”¾ï¼</p>
<ul>
<li><strong>é›†ä¸­å¼å›æ”¾</strong>ï¼šæ™ºèƒ½ä½“åœ¨ä¸€ä¸ªç¯å¢ƒä¸­è¿è¡Œï¼ŒæŠŠç»éªŒç»Ÿä¸€å­˜å‚¨åœ¨ç»éªŒæ± ä¸­ï¼</li>
<li><strong>åˆ†å¸ƒå¼å›æ”¾</strong>ï¼šæ™ºèƒ½ä½“çš„å¤šä»½æ‹·è´ï¼ˆworker) åŒæ—¶åœ¨å¤šä¸ªç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶å°†ç»éªŒç»Ÿä¸€å­˜å‚¨äºç»éªŒæ± ä¸­ï¼ç”±äºå¤šä¸ªæ™ºèƒ½ä½“æ‹·è´åŒæ—¶ç”Ÿæˆç»éªŒï¼Œæ‰€ä»¥èƒ½å¤Ÿåœ¨ä½¿ç”¨æ›´å¤šèµ„æºçš„åŒ
æ—¶æ›´å¿«åœ°æ”¶é›†ç»éªŒ</li>
</ul>
<p>ä»é‡‡æ ·çš„è§’åº¦ï¼Œç»éªŒå›æ”¾å¯ä»¥åˆ†ä¸ºå‡åŒ€å›æ”¾å’Œä¼˜å…ˆå›æ”¾ï¼</p>
<ul>
<li><strong>å‡åŒ€å›æ”¾</strong>ï¼šç­‰æ¦‚ç‡ä»ç»éªŒé›†ä¸­å–ç»éªŒï¼Œå¹¶ä¸”ç”¨å–å¾—çš„ç»éªŒæ¥æ›´æ–°æœ€ä¼˜ä»·å€¼å‡½æ•°</li>
<li><strong>ä¼˜å…ˆå›æ”¾</strong>ï¼ˆPrioritized Experience Replay, PERï¼‰ï¼šä¸ºç»éªŒæ± é‡Œçš„æ¯ä¸ªç»éªŒæŒ‡å®šä¸€ä¸ªä¼˜å…ˆçº§ï¼Œåœ¨é€‰å–ç»éªŒæ—¶æ›´å€¾å‘äºé€‰æ‹©ä¼˜å…ˆçº§é«˜çš„ç»éªŒï¼</li>
</ul>
<p>T. Schaul ç­‰äº 2016 å¹´å‘è¡¨æ–‡ç«  ã€ŠPrioritized experience replayã€‹ï¼Œæå‡ºäº†ä¼˜å…ˆå›æ”¾ï¼ä¼˜å…ˆå›æ”¾çš„åŸºæœ¬æ€æƒ³æ˜¯ä¸ºç»éªŒæ± é‡Œçš„ç»éªŒæŒ‡å®šä¸€ä¸ªä¼˜å…ˆçº§ï¼Œåœ¨é€‰å–ç»éªŒæ—¶æ›´å€¾å‘äºé€‰æ‹©ä¼˜å…ˆçº§é«˜çš„ç»éªŒï¼ä¸€èˆ¬çš„åšæ³•æ˜¯ï¼Œå¦‚æœæŸä¸ªç»éªŒï¼ˆä¾‹å¦‚ç»éªŒ $i$ ï¼‰çš„ä¼˜å…ˆçº§ä¸º $p_{i}$ ï¼Œé‚£ä¹ˆé€‰å–è¯¥ç»éªŒçš„æ¦‚ç‡ä¸º
$$
\frac{p_{i}}{\sum_{k} p_{k}}
$$
ç»éªŒå€¼æœ‰è®¸å¤šä¸åŒçš„é€‰å–æ–¹æ³•ï¼Œæœ€å¸¸è§çš„é€‰å–æ–¹æ³•æœ‰æˆæ¯”ä¾‹ä¼˜å…ˆå’ŒåŸºäºæ’åºä¼˜å…ˆï¼</p>
<ul>
<li><strong>æˆæ¯”ä¾‹ä¼˜å…ˆ</strong>ï¼ˆproportional priorityï¼‰ï¼šç¬¬ $i$ ä¸ªç»éªŒçš„ä¼˜å…ˆçº§ä¸º $p_{i}=\left(\delta_{i}+\varepsilon\right)^{\alpha}$ ï¼å…¶ä¸­ $\delta_{i}$ æ˜¯æ—¶åºå·®åˆ†è¯¯å·® $\left(\right.$ å®šä¹‰ä¸º $\delta_{i}=U_{t}-q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ æˆ– $\left.\delta_{i}=U_{t}-v\left(S_{t} ; \mathbf{w}\right)\right), \quad \varepsilon$ æ˜¯é¢„å…ˆé€‰æ‹©
çš„ä¸€ä¸ªå°æ­£æ•°ï¼Œ $\alpha$ æ˜¯æ­£å‚æ•°ï¼</li>
<li><strong>åŸºäºæ’åºä¼˜å…ˆ</strong>ï¼ˆrank-based priority): ç¬¬ $i$ ä¸ªç»éªŒçš„ä¼˜å…ˆçº§ä¸º $p_{i}=\left(\frac{1}{\operatorname{rank}<em>{i}}\right)^{\alpha}$ ï¼å…¶ä¸­ $\mathrm{rank}</em>{i}$ æ˜¯ç¬¬ $i$ ä¸ªç»éªŒä»å¤§åˆ°å°æ’åºçš„æ’åï¼Œæ’åä» 1 å¼€å§‹ï¼</li>
</ul>
<p>D. Horgan ç­‰åœ¨ 2018 å‘è¡¨æ–‡ç«  ã€Š Distributed prioritized experience replayã€‹ï¼Œå°†åˆ†å¸ƒå¼ç»
ç­¾å›æ”¾å’Œä¼˜å…ˆç»éªŒå›æ”¾ç›¸ç»“åˆï¼Œå¾—åˆ°åˆ†å¸ƒå¼ä¼˜å…ˆç»éªŒå›æ”¾ï¼ˆdistributed prioritized experience replayï¼‰ï¼</p>
<h4 id="442-å¸¦ç›®æ ‡ç½‘ç»œçš„æ·±åº¦qå­¦ä¹ "><a class="header" href="#442-å¸¦ç›®æ ‡ç½‘ç»œçš„æ·±åº¦qå­¦ä¹ ">4.4.2 å¸¦ç›®æ ‡ç½‘ç»œçš„æ·±åº¦Qå­¦ä¹ </a></h4>
<p>å¯¹äºåŸºäºè‡ªç›Šçš„ Q å­¦ä¹ ï¼Œå…¶å›æŠ¥çš„ä¼°è®¡å’ŒåŠ¨ä½œä»·å€¼çš„ä¼°è®¡éƒ½å’Œæƒé‡ $\mathbf{w}$ æœ‰å…³ï¼å½“æƒé‡å€¼å˜åŒ–æ—¶ï¼Œå›æŠ¥çš„ä¼°è®¡å’ŒåŠ¨ä½œä»·å€¼çš„ä¼°è®¡éƒ½ä¼šå˜åŒ–ï¼åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼ŒåŠ¨ä½œä»·å€¼è¯•å›¾è¿½é€ä¸€ä¸ªå˜åŒ–çš„å›æŠ¥ï¼Œä¹Ÿå®¹æ˜“å‡ºç°ä¸ç¨³å®šçš„æƒ…å†µï¼åœ¨ 4.1.2 èŠ‚ä¸­ç»™å‡ºäº†åŠæ¢¯åº¦ä¸‹é™çš„ç®—æ³•æ¥è§£å†³ è¿™ä¸ªé—®é¢˜ï¼åœ¨åŠæ¢¯åº¦ä¸‹é™ä¸­ï¼Œåœ¨æ›´æ–°ä»·å€¼å‚æ•° $\mathbf{w}$ æ—¶ï¼Œä¸å¯¹åŸºäºè‡ªç›Šå¾—åˆ°çš„å›æŠ¥ä¼°è®¡ $U_{t}$ æ±‚æ¢¯ åº¦ï¼å…¶ä¸­ä¸€ç§é˜»æ­¢å¯¹ $U_{t}$ æ±‚æ¢¯åº¦çš„æ–¹æ³•å°±æ˜¯å°†ä»·å€¼å‚æ•°å¤åˆ¶ä¸€ä»½å¾—åˆ° $\mathbf{w}<em>{\text {ç›®æ ‡ }}$ ï¼Œåœ¨è®¡ç®— $U</em>{t}$ æ—¶ç”¨ $\mathbf{w}_{\text {ç›®æ ‡ }}$ è®¡ç®—ï¼åŸºäºè¿™ä¸€æ–¹æ³•ï¼ŒV. Mnih ç­‰åœ¨ 2015 å¹´å‘è¡¨äº†è®ºæ–‡ã€ŠHuman-level control through deep reinforcement learningã€‹ï¼Œæå‡ºäº†ç›®æ ‡ç½‘ï¼ˆtarget networkï¼‰è¿™ä¸€æ¦‚å¿µï¼ç›®æ ‡ç½‘ç»œæ˜¯åœ¨åŸæœ‰çš„ç¥ç»ç½‘ç»œä¹‹å¤–å†æ­å»ºä¸€ä»½ç»“æ„å®Œå…¨ç›¸åŒçš„ç½‘ç»œï¼åŸå…ˆå°±æœ‰çš„ç¥ç»ç½‘ç»œç§°ä¸ºè¯„ä¼°ç½‘ç»œï¼ˆevaluation networkï¼‰ï¼åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ç›®æ ‡ç½‘ç»œæ¥è¿›è¡Œè‡ªç›Šå¾—åˆ°å›æŠ¥çš„è¯„ä¼°å€¼ï¼Œä½œä¸ºå­¦ä¹ çš„ç›®æ ‡ï¼åœ¨æƒé‡æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œåªæ›´æ–°è¯„ä¼°ç½‘ç»œçš„æƒé‡ï¼Œè€Œä¸æ›´æ–°ç›®æ ‡ç½‘ç»œçš„æƒé‡ï¼è¿™æ ·ï¼Œæ›´æ–°æƒé‡æ—¶é’ˆå¯¹çš„ç›®æ ‡ä¸ä¼šåœ¨æ¯æ¬¡è¿­ä»£éƒ½å˜åŒ–ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„ç›®æ ‡ï¼åœ¨å®Œæˆä¸€å®šæ¬¡æ•°çš„æ›´æ–°åï¼Œå†å°†è¯„ä¼°ç½‘ç»œçš„æƒé‡å€¼èµ‹ç»™ç›®æ ‡ç½‘ç»œï¼Œè¿›è€Œè¿›è¡Œä¸‹ä¸€æ‰¹æ›´æ–°ï¼è¿™æ ·ï¼Œç›®æ ‡ç½‘ç»œä¹Ÿèƒ½å¾—åˆ°æ›´æ–°ï¼ç”±äºåœ¨ç›®æ ‡ç½‘ç»œæ²¡æœ‰å˜åŒ–çš„ä¸€æ®µæ—¶é—´å†…å›æŠ¥çš„ä¼°è®¡æ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œç›®æ ‡ç½‘ç»œçš„å¼•å…¥å¢åŠ äº†å­¦ä¹ çš„ç¨³å®šæ€§ï¼æ‰€ä»¥ï¼Œç›®æ ‡ç½‘ç»œç›®å‰å·²ç»æˆä¸ºæ·±åº¦ Q å­¦ä¹ çš„ä¸»æµåšæ³•ï¼</p>
<p>ç®—æ³• 4-9 ç»™å‡ºäº†å¸¦ç›®æ ‡ç½‘ç»œçš„æ·±åº¦ Q å­¦ä¹ ç®—æ³•ï¼ç®—æ³•å¼€å§‹æ—¶å°†è¯„ä¼°ç½‘ç»œå’Œç›®æ ‡ç½‘ç»œåˆå§‹åŒ–ä¸ºç›¸åŒçš„å€¼ï¼ä¸ºäº†å¾—åˆ°å¥½çš„è®­ç»ƒæ•ˆæœï¼Œåº”å½“æŒ‰ç…§ç¥ç»ç½‘ç»œçš„ç›¸å…³è§„åˆ™ä»”ç»†åˆå§‹åŒ–ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 4-9</strong>$\quad$ å¸¦ç»éªŒå›æ”¾å’Œç›®æ ‡ç½‘ç»œçš„æ·±åº¦ $\mathrm{Q}$ å­¦ä¹ æœ€ä¼˜ç­–ç•¥æ±‚è§£</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰åˆå§‹åŒ–è¯„ä¼°ç½‘ç»œ $q(\cdot, \cdot ; \mathbf{w})$ çš„å‚æ•° $\mathbf{w}$ ï¼›ç›®æ ‡ç½‘ç»œ $q\left(\cdot, \cdot ; \mathbf{w}<em>{\text {ç›®æ ‡ }}\right)$ çš„å‚æ•° $\mathbf{w}</em>{\text {ç›®æ ‡ }} \leftarrow \mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.2 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ® $q(S, \cdot ; \mathbf{w})$ é€‰æ‹©åŠ¨ä½œ $A$ å¹¶æ‰§è¡Œï¼Œè§‚æµ‹å¾—åˆ°å¥–åŠ± $R$ å’Œæ–°çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆç»éªŒå­˜å‚¨ï¼‰å°†ç»éªŒ $\left(S, A, R, S^{\prime}\right)$ å­˜å…¥ç»éªŒåº“ $\mathcal{D}$ ä¸­</li>
<li>ï¼ˆç»éªŒå›æ”¾ï¼‰ä»ç»éªŒåº“ $\mathcal{D}$ ä¸­é€‰å–ä¸€æ‰¹ç»éªŒ $\left(S_{i}, A_{t}, R_{i}, S_{i}^{\prime}\right)(i \in \mathcal{B})$</li>
<li>ï¼ˆè®¡ç®—å›æŠ¥çš„ä¼°è®¡å€¼ï¼‰ $U_{i} \leftarrow R_{i}+\gamma \max <em>{a} q\left(S</em>{i}^{\prime}, a ; \mathbf{w}_{\text {ç›®æ ‡ }}\right)(i \in \mathcal{B})$</li>
<li>ï¼ˆæ›´æ–°åŠ¨ä½œä»·å€¼å‡½æ•°ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\frac{1}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}\left[U_{i}-q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right]^{2}$ (å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha \frac{1}{|\mathcal{B}|}\left.\sum_{i \in \mathcal{B}}\left[U_{i}-q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right] \nabla q\left(S_{i}, A_{t} ; \mathbf{w}\right)\right)$</li>
<li>$S \leftarrow S^{\prime}$</li>
<li>ï¼ˆæ›´æ–°ç›®æ ‡ç½‘ç»œï¼‰åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼ˆä¾‹å¦‚è®¿é—®æœ¬æ­¥è‹¥åƒæ¬¡ï¼‰æ›´æ–°ç›®æ ‡ç½‘ç»œçš„æƒé‡ $\mathbf{w}_{\text {ç›®æ ‡ }} \leftarrow \mathbf{w}$</li>
</ol>
</li>
</ol>
<hr />
<p>åœ¨æ›´æ–°ç›®æ ‡ç½‘ç»œæ—¶ï¼Œå¯ä»¥ç®€å•åœ°æŠŠè¯„ä¼°ç½‘ç»œçš„å‚æ•°ç›´æ¥èµ‹å€¼ç»™ç›®æ ‡ç½‘ç»œ $\left(\right.$ å³ $\left.\mathbf{w}<em>{\text {ç›®æ ‡ }} \leftarrow \mathbf{w}\right)$ ï¼Œä¹Ÿå¯ä»¥å¼•äººä¸€ä¸ªå­¦ä¹ ç‡ $\alpha</em>{\text {ç›®æ ‡ }}$ æŠŠæ—§çš„ç›®æ ‡ç½‘ç»œå‚æ•°å’Œæ–°çš„è¯„ä¼°ç½‘ç»œå‚æ•°ç›´æ¥åšåŠ æƒå¹³å‡åçš„å€¼èµ‹å€¼ç»™ç›®æ ‡ç½‘ç»œ $\left(\right.$ å³ $\left.\mathbf{w}<em>{\text {ç›®æ ‡ }} \leftarrow\left(1-\alpha</em>{\text {ç›®æ ‡ }}\right) \mathbf{w}<em>{\text {ç›®æ ‡ }}+\alpha</em>{\text {ç›®æ ‡ }} \mathbf{w}\right)$ ï¼äº‹å®ä¸Šï¼Œç›´æ¥èµ‹å€¼çš„ç‰ˆæœ¬æ˜¯å¸¦å­¦ä¹ ç‡ç‰ˆæœ¬åœ¨ $\alpha_{\text {ç›®æ ‡ }}=1$ æ—¶çš„ç‰¹ä¾‹ï¼å¯¹äºåˆ†å¸ƒå¼å­¦ä¹ çš„æƒ…å½¢ï¼Œæœ‰å¾ˆå¤šç‹¬ç«‹çš„æ‹·è´ï¼ˆworkerï¼‰åŒæ—¶ä¼šä¿®æ”¹ç›®æ ‡ç½‘ç»œï¼Œåˆ™å°±æ›´å¸¸ç”¨å­¦ä¹ ç‡ $\alpha_{\text {ç›®æ ‡ }} \in(0,1)$ ï¼</p>
<h4 id="443-åŒé‡æ·±åº¦qå­¦ä¹ "><a class="header" href="#443-åŒé‡æ·±åº¦qå­¦ä¹ ">4.4.3 åŒé‡æ·±åº¦Qå­¦ä¹ </a></h4>
<p>ç¬¬ 3 ç« æ›¾æåˆ° $\mathrm{Q}$ å­¦ä¹ ä¼šå¸¦æ¥æœ€å¤§åŒ–åå·®ï¼Œè€ŒåŒé‡ $\mathrm{Q}$ å­¦ä¹ å´å¯ä»¥æ¶ˆé™¤æœ€å¤§åŒ–åå·®ï¼åŸºäºæŸ¥æ‰¾è¡¨çš„åŒé‡ Q å­¦ä¹ å¼•å…¥äº†ä¸¤ä¸ªåŠ¨ä½œä»·å€¼çš„ä¼°è®¡ $q^{(0)}$ å’Œ $q^{(1)}$ ï¼Œæ¯æ¬¡æ›´æ–°åŠ¨ä½œä»·å€¼æ—¶ç”¨å…¶ä¸­çš„ä¸€ä¸ªç½‘ç»œç¡®å®šåŠ¨ä½œï¼Œç”¨ç¡®å®šçš„åŠ¨ä½œå’Œå¦å¤–ä¸€ä¸ªç½‘ç»œæ¥ä¼°è®¡å›æŠ¥ï¼</p>
<p>å¯¹äºæ·±åº¦ Q å­¦ä¹ ä¹Ÿæœ‰åŒæ ·çš„ç»“è®ºï¼Deepmind äº 2015 å¹´å‘è¡¨è®ºæ–‡ ã€Š Deep reinforcement learning with double Q-learning ã€‹ï¼Œå°†åŒé‡ Q å­¦ä¹ ç”¨äºæ·±åº¦ Q ç½‘ç»œï¼Œå¾—åˆ°äº†åŒé‡æ·±åº¦ Q ç½‘ç»œï¼ˆDouble Deep Q Network, Double $\mathrm{DQN}$ ï¼‰ï¼è€ƒè™‘åˆ°æ·±åº¦ Q ç½‘ç»œå·²ç»æœ‰äº†è¯„ä¼°ç½‘ç»œå’Œç›®æ ‡ç½‘ç»œä¸¤ä¸ªç½‘ç»œï¼Œæ‰€ä»¥åŒé‡æ·±åº¦ Q å­¦ä¹ åœ¨ä¼°è®¡å›æŠ¥æ—¶åªéœ€è¦ç”¨è¯„ä¼°ç½‘ç»œç¡®å®šåŠ¨ä½œï¼Œç”¨ç›®æ ‡ç½‘ç»œç¡®å®šå›æŠ¥çš„ä¼°è®¡å³å¯ï¼æ‰€ä»¥ï¼Œåªéœ€è¦å°†ç®—æ³• 4-10 ä¸­çš„
$$
U_{i} \leftarrow R_{i}+\gamma \max <em>{a} q\left(S</em>{i}^{\prime}, a ; \mathbf{w}<em>{\text {ç›®æ ‡ }}\right)
$$
æ›´æ¢ä¸º
$$
U</em>{i} \leftarrow R_{i}+\gamma q\left(S_{i}^{\prime}, \arg \max <em>{a} q\left(S</em>{i}^{\prime}, a ; \mathbf{w}\right) ; \mathbf{w}_{\text {ç›®æ ‡ }}\right)
$$
å°±å¾—åˆ°äº†å¸¦ç»éªŒå›æ”¾çš„åŒé‡æ·±åº¦ Q ç½‘ç»œç®—æ³•ï¼</p>
<h4 id="444-å¯¹å¶æ·±åº¦-q-ç½‘ç»œ"><a class="header" href="#444-å¯¹å¶æ·±åº¦-q-ç½‘ç»œ">4.4.4 å¯¹å¶æ·±åº¦ Q ç½‘ç»œ</a></h4>
<p>Z. Wang ç­‰åœ¨ 2015 å¹´å‘è¡¨è®ºæ–‡ã€ŠDueling network architectures for deep reinforcement learning ã€‹ï¼Œæå‡ºäº†ä¸€ç§ç¥ç»ç½‘ç»œçš„ç»“æ„â€”â€”å¯¹å¶ç½‘ç»œï¼ˆ duel networkï¼‰ï¼å¯¹å¶ç½‘ç»œç†è®ºåˆ©ç”¨åŠ¨ä½œä»·å€¼å‡½æ•°å’ŒçŠ¶æ€ä»·å€¼å‡½æ•°ä¹‹å·®å®šä¹‰äº†ä¸€ä¸ªæ–°çš„å‡½æ•°â€”â€”ä¼˜åŠ¿å‡½æ•°ï¼ˆadvantage function)ï¼š
$$
a(s, a)=q(s, a)-v(s), \quad s \in \mathcal{S}, a \in \mathcal{A}
$$
$$
a(s, a)=q(s, a)-v(s), \quad s \in \mathcal{S}, a \in \mathcal{A}
$$
å¯¹å¶ $\mathrm{Q}$ ç½‘ç»œä»ç„¶ç”¨ $q(\mathbf{w})$ æ¥ä¼°è®¡åŠ¨ä½œä»·å€¼ï¼Œåªä¸è¿‡è¿™æ—¶å€™ $q(\mathbf{w})$ æ˜¯çŠ¶æ€ä»·å€¼ä¼°è®¡ $v(s ; \mathbf{w})$ å’Œä¼˜
åŠ¿å‡½æ•°ä¼°è®¡ $a(s, a ; \mathbf{w})$ çš„å åŠ ï¼Œå³
$$
q(s, a ; \mathbf{w})=v(s ; \mathbf{w})+a(s, a ; \mathbf{w})
$$
å…¶ä¸­ $v(\mathbf{w})$ å’Œ $a(\mathbf{w})$ å¯èƒ½éƒ½åªç”¨åˆ°äº† $\mathbf{w}$ ä¸­çš„éƒ¨åˆ†å‚æ•°ï¼åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œ $v(\mathbf{w})$ å’Œ $a(\mathbf{w})$ æ˜¯å…±
åŒè®­ç»ƒçš„ï¼Œè®­ç»ƒè¿‡ç¨‹å’Œå•ç‹¬è®­ç»ƒæ™®é€šæ·±åº¦ Q ç½‘ç»œå¹¶æ— ä¸åŒä¹‹å¤„ï¼ä¸è¿‡ï¼ŒåŒä¸€ä¸ª $q(\mathbf{w})$ äº‹å®ä¸Šå­˜åœ¨ç€æ— ç©·å¤šç§åˆ†è§£ä¸º $v(\mathbf{w})$ å’Œ $a(\mathbf{w})$ çš„æ–¹å¼ï¼å¦‚æœæŸä¸ª $q(s, a ; w)$ å¯ä»¥åˆ†è§£ä¸ºæŸä¸ª $v(s ; \mathbf{w})$ å’Œ $a(s, a ; \mathbf{w})$ ï¼Œé‚£ä¹ˆå®ƒä¹Ÿèƒ½åˆ†è§£ä¸º $v(s ; \mathbf{w})+c(s)$ å’Œ $a(s, a ; \mathbf{w})-c(s)$ ï¼Œå…¶ä¸­ $c(s)$ æ˜¯ä»»æ„ä¸€ä¸ªåªå’ŒçŠ¶æ€ $s$ æœ‰å…³çš„å‡½æ•°ï¼ä¸ºäº†ä¸ç»™è®­ç»ƒå¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªç”±ä¼˜åŠ¿å‡½æ•°å¯¼å‡ºçš„é‡ï¼Œä½¿å¾—ç­‰æ•ˆçš„ä¼˜åŠ¿å‡½æ•°æ»¡è¶³å›ºå®šçš„ç‰¹å¾ï¼Œä½¿å¾—åˆ†è§£å”¯ä¸€ï¼å¸¸è§çš„æ–¹æ³•æœ‰ä»¥ä¸‹ä¸¤ç§:</p>
<ul>
<li>è€ƒè™‘ä¼˜åŠ¿å‡½æ•°çš„æœ€å¤§å€¼ï¼Œä»¤
$$
q(s, a ; \mathbf{w})=v(s ; \mathbf{w})+a(s, a ; \mathbf{w})-\max <em>{a \in \mathcal{A}} a(s, a ; \mathbf{w})
$$
ä½¿å¾—ç­‰æ•ˆä¼˜åŠ¿å‡½æ•° $a</em>{\text {ç­‰æ•ˆ }}(s, a ; \mathbf{w})=a(s, a ; \mathbf{w})-\max <em>{a \in \mathcal{A}} a(s, a ; \mathbf{w})$ æ»¡è¶³
$$
\max</em>{\sigma \in \mathcal{A}} a_{\text {ç­‰æ•ˆ }}(s, a ; \mathbf{w})=0, \quad s \in \mathcal{S}
$$</li>
<li>è€ƒè™‘ä¼˜åŠ¿å‡½æ•°çš„å¹³å‡å€¼ï¼Œä»¤
$$
q(s, a ; \mathbf{w})=v(s ; \mathbf{w})+a(s, a ; \mathbf{w})-\frac{1}{|\mathcal{A}|} \sum_{a \in \mathcal{A}} a(s, a ; \mathbf{w})
$$
ä½¿å¾—ç­‰æ•ˆä¼˜åŠ¿å‡½æ•° $a_{\text {ç­‰æ•ˆ }}(s, a ; \mathbf{w})=a(s, a ; \mathbf{w})-\frac{1}{|\mathcal{A}|} \sum_{a \in \mathcal{A}} a(s, a ; \mathbf{w})$ æ»¡è¶³
$$
\sum_{a \in \mathcal{A}} a_{\text {ç­‰æ•ˆ }}(s, a ; \mathbf{w})=0, \quad s \in \mathcal{S}
$$</li>
</ul>
<h2 id="äº”-å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦æ–¹æ³•"><a class="header" href="#äº”-å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦æ–¹æ³•">äº”ï¼ å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦æ–¹æ³•</a></h2>
<p>æœ¬ä¹¦å‰å‡ ç« çš„ç®—æ³•éƒ½åˆ©ç”¨äº†ä»·å€¼å‡½æ•°ï¼Œåœ¨æ±‚è§£æœ€ä¼˜ç­–ç•¥çš„è¿‡ç¨‹ä¸­è¯•å›¾ä¼°è®¡æœ€ä¼˜ä»·å€¼å‡½æ•°ï¼Œæ‰€ä»¥é‚£äº›ç®—æ³•éƒ½ç§°ä¸º<strong>æœ€ä¼˜ä»·å€¼ç®—æ³•</strong>ï¼ˆoptimal value algorithm)ï¼ä½†æ˜¯ï¼Œè¦æ±‚è§£æœ€ä¼˜ç­–ç•¥ä¸ä¸€å®šè¦ä¼°è®¡æœ€ä¼˜ä»·å€¼å‡½æ•°ï¼æœ¬ç« å°†ä»‹ç»ä¸ç›´æ¥ä¼°è®¡æœ€ä¼˜ä»·å€¼å‡½æ•°çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œå®ƒä»¬è¯•å›¾ç”¨å«å‚å‡½æ•°è¿‘ä¼¼æœ€ä¼˜ç­–ç•¥ï¼Œå¹¶é€šè¿‡è¿­ä»£æ›´æ–°å‚æ•°å€¼ï¼ç”±äºè¿­ä»£è¿‡ç¨‹ä¸ç­–ç•¥çš„æ¢¯åº¦æœ‰å…³ï¼Œæ‰€ä»¥è¿™æ ·çš„è¿­ä»£ç®—æ³•åˆç§°ä¸ºç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼ˆpolicy gradient algorithmï¼‰ï¼</p>
<h3 id="51-ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„åŸç†"><a class="header" href="#51-ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„åŸç†">5.1 ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„åŸç†</a></h3>
<p>åŸºäºç­–ç•¥çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•æœ‰ä¸¤å¤§æ ¸å¿ƒæ€æƒ³ï¼š</p>
<ul>
<li>ç”¨å«å‚å‡½æ•°è¿‘ä¼¼æœ€ä¼˜ç­–ç•¥</li>
<li>ç”¨ç­–ç•¥æ¢¯åº¦ä¼˜åŒ–ç­–ç•¥å‚æ•°</li>
</ul>
<p>æœ¬èŠ‚ä»‹ç»è¿™ä¸¤éƒ¨åˆ†å†…å®¹ï¼</p>
<h3 id="511-å‡½æ•°è¿‘ä¼¼ä¸åŠ¨ä½œåå¥½"><a class="header" href="#511-å‡½æ•°è¿‘ä¼¼ä¸åŠ¨ä½œåå¥½">5.1.1 å‡½æ•°è¿‘ä¼¼ä¸åŠ¨ä½œåå¥½</a></h3>
<p>ç”¨å‡½æ•°è¿‘ä¼¼æ–¹æ³•ä¼°è®¡æœ€ä¼˜ç­–ç•¥ $\pi_*(a|s)$ çš„åŸºæœ¬æ€æƒ³æ˜¯ç”¨å«å‚å‡½æ•° $\pi(a|s ; \theta)$ æ¥è¿‘ä¼¼æœ€ä¼˜ç­–ç•¥ï¼ç”±äºä»»æ„ç­–ç•¥ $\pi$ éƒ½éœ€è¦æ»¡è¶³å¯¹äºä»»æ„çš„çŠ¶æ€ $s \in \mathcal{S}$ ï¼Œå‡æœ‰ $\sum_{a} \pi(a|s)=1$ ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ› $\pi(a|s ; \theta)$ æ»¡è¶³å¯¹äºä»»æ„çš„çŠ¶æ€ $s \in \mathcal{S}$ ï¼Œå‡æœ‰ $\sum_{a} \pi(a|s ; \theta)=1$ ï¼ä¸ºæ­¤å¼•å…¥åŠ¨ä½œåå¥½å‡½æ•°ï¼ˆaction preference functionï¼‰ $h(s, a ; \theta)$ ï¼Œå…¶ softmax çš„å€¼ä¸º $\pi(a|s ; \theta)$ ï¼Œå³
$$
\pi(a|s ; \theta)=\frac{\exp h(s, a ; \theta)}{\sum_{o^{\prime}} \exp h\left(s, a^{\prime} ; \theta\right)}, \quad s \in \mathcal{S}, a \in \mathcal{A}(s)
$$
åœ¨ç¬¬ 3~4 ç« ä¸­ï¼Œä»åŠ¨ä½œä»·å€¼å‡½æ•°å¯¼å‡ºæœ€ä¼˜ç­–ç•¥ä¼°è®¡å¾€å¾€æœ‰ç‰¹å®šçš„å½¢å¼ (å¦‚ $\varepsilon$ è´ªå¿ƒç­–
ç•¥)ï¼ä¸ä¹‹ç›¸æ¯”ï¼Œä»åŠ¨ä½œåå¥½å¯¼å‡ºçš„æœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ä¸æ‹˜æ³¥äºç‰¹å®šçš„å½¢å¼ï¼Œå…¶æ¯ä¸ªåŠ¨ä½œéƒ½å¯ä»¥æœ‰ä¸åŒçš„æ¦‚ç‡å€¼ï¼Œå½¢å¼æ›´åŠ çµæ´»ï¼å¦‚æœé‡‡ç”¨è¿­ä»£æ–¹æ³•æ›´æ–°å‚æ•° $\boldsymbol{\theta}$ ï¼Œéšç€è¿­ä»£çš„è¿›è¡Œï¼Œ $\pi(a|s ; \theta)$ å¯ä»¥è‡ªç„¶è€Œç„¶åœ°é€¼è¿‘ç¡®å®šæ€§ç­–ç•¥ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨è°ƒèŠ‚ $\varepsilon$ ç­‰å‚æ•°ï¼</p>
<p>åŠ¨ä½œåå¥½å‡½æ•°å¯ä»¥å…·æœ‰çº¿æ€§ç»„åˆã€äººå·¥ç¥ç»ç½‘ç»œç­‰å¤šç§å½¢å¼ï¼åœ¨ç¡®å®šåŠ¨ä½œåå¥½çš„å½¢å¼ä¸­ï¼Œåªéœ€è¦å†ç¡®å®šå‚æ•° $\theta$ çš„å€¼ï¼Œå°±å¯ä»¥ç¡®å®šæ•´ä¸ªæœ€ä¼˜çŠ¶æ€ä¼°è®¡ï¼å‚æ•° $\boldsymbol{\theta}$ çš„å€¼å¸¸é€šè¿‡åŸºäºæ¢¯åº¦çš„è¿­ä»£ç®—æ³•æ›´æ–°ï¼Œæ‰€ä»¥ï¼ŒåŠ¨ä½œåå¥½å‡½æ•°å¾€å¾€éœ€è¦å¯¹å‚æ•° $\boldsymbol{\theta}$ å¯å¯¼ï¼</p>
<h3 id="512-ç­–ç•¥æ¢¯åº¦å®šç†"><a class="header" href="#512-ç­–ç•¥æ¢¯åº¦å®šç†">5.1.2 ç­–ç•¥æ¢¯åº¦å®šç†</a></h3>
<p>ç­–ç•¥æ¢¯åº¦å®šç†ç»™å‡ºäº†æœŸæœ›å›æŠ¥å’Œç­–ç•¥æ¢¯åº¦ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ç­–ç•¥æ¢¯åº¦æ–¹æ³•çš„åŸºç¡€ï¼æœ¬èŠ‚å­¦ä¹ ç­–ç•¥æ¢¯åº¦å®šç†ï¼</p>
<p>åœ¨å›åˆåˆ¶ä»»åŠ¡ä¸­ï¼Œç­–ç•¥ $\pi(\theta)$ æœŸæœ›å›æŠ¥å¯ä»¥è¡¨ç¤ºä¸º $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ ï¼<strong>ç­–ç•¥æ¢¯åº¦å®šç†</strong>ï¼ˆpolicy gradient theorem) ç»™å‡ºäº†å®ƒå¯¹ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ çš„æ¢¯åº¦ä¸º
$$
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\sum_{t=0}^{+\infty} \gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
$$
å…¶ç­‰å¼å³è¾¹æ˜¯å’Œçš„æœŸæœ›ï¼Œæ±‚å’Œçš„ $\gamma^{\prime} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)$ ä¸­ï¼Œåªæœ‰ $\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)$ æ˜¾å¼å«æœ‰å‚æ•° $\theta$ ï¼</p>
<p>ç­–ç•¥æ¢¯åº¦å®šç†å‘Šè¯‰æˆ‘ä»¬ï¼Œåªè¦çŸ¥é“äº† $\nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)$ çš„å€¼ï¼Œå†é…åˆå…¶ä»–ä¸€äº›å®¹æ˜“è·å¾—çš„ å€¼ï¼ˆå¦‚ $\gamma^{t}$ å’Œ $\left.G_{t}\right)$ ï¼Œå°±å¯ä»¥å¾—åˆ°æœŸæœ›å›æŠ¥çš„æ¢¯åº¦ï¼è¿™æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é¡ºç€æ¢¯åº¦æ–¹å‘æ”¹å˜ $\theta$ ä»¥å¢å¤§æœŸæœ›å›æŠ¥ï¼</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¯æ˜è¿™ä¸ªå®šç†ï¼å›é¡¾ï¼Œç­–ç•¥ $\pi(\boldsymbol{\theta})$ æ»¡è¶³ $\mathrm{Bellman}$ æœŸæœ›æ–¹ç¨‹ï¼Œå³
$$
\begin{array}{ll}
v_{\pi(\theta)}(s)=\sum_{a} \pi(a|s ; \theta) q_{\pi(\theta)}(s, a), &amp; s \in \mathcal{S} \
q_{\pi(\theta)}(s, a)=r(s, a)+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) v_{\pi(\theta)}\left(s^{\prime}\right), &amp; s \in \mathcal{S}, a \in \mathcal{A}(s)
\end{array}
$$
å°†ä»¥ä¸Šä¸¤å¼å¯¹ $\boldsymbol{\theta}$ æ±‚æ¢¯åº¦ï¼Œæœ‰
$$
\begin{array}{ll}
\nabla v_{\pi(\theta)}(s)=\sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \theta)+\sum_{a} \pi(a|s ; \theta) \nabla q_{\pi(\theta)}(s, a), &amp; s \in \mathcal{S} \
\nabla q_{\pi(\theta)}(s, a)=\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right), &amp; s \in \mathcal{S}
\end{array}
$$
å°† $\nabla q_{\pi(\theta)}(s, a)$ çš„è¡¨è¾¾å¼ä»£äºº $\nabla v_{\pi(\theta)}(s)$ çš„è¡¨è¾¾å¼ä¸­ï¼Œæœ‰
$$
\begin{aligned}
\nabla v_{\pi(\theta)}(s) &amp;=\sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \boldsymbol{\theta})+\sum_{a} \pi(a|s ; \boldsymbol{\theta}) \gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, a\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
&amp;=\sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \boldsymbol{\theta})+\sum_{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \boldsymbol{\theta}\right] \gamma v_{\pi(\theta)}\left(s^{\prime}\right), \quad s \in \mathcal{S}
\end{aligned}
$$
åœ¨ç­–ç•¥ $\pi(\theta)$ ä¸‹ï¼Œå¯¹ $S_{t}$ æ±‚ä¸Šå¼çš„æœŸæœ›ï¼Œæœ‰
$$
\begin{array}{l}
\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{t}\right)\right] \
\quad =\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \nabla v_{\pi(\theta)}(s)\
\quad =\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right]\left[\sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \theta)+\sum_{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \theta\right] \gamma\nabla v_{\pi(\theta)}\left(s^{\prime}\right)\right] \
\quad =\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \theta)+\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \sum_{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \theta\right] \gamma\nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
\quad =\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \sum_{a} q_{\pi(\theta)}(s, a) \nabla \pi(a|s ; \theta)+\gamma \sum_{s} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime} ; \theta\right] \nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
\quad =E\left[\sum_{\sigma} q_{\pi(\theta)}\left(S_{t}, a\right) \nabla \pi\left(a|S_{t} ; \theta\right)\right]+\gamma E\left[\nabla v_{\pi(\theta)}\left(S_{t+1}\right)\right]
\end{array}
$$
è¿™æ ·å°±å¾—åˆ°äº†ä» $\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{t}\right)\right]$ åˆ° $\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{t+1}\right)\right]$ çš„é€’æ¨å¼ï¼æ³¨æ„åˆ°æœ€ç»ˆå…³æ³¨çš„æ¢¯åº¦å€¼å°±æ˜¯
$$
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\nabla \mathrm{E}\left[v_{\pi(\theta)}\left(S_{0}\right)\right]=\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{0}\right)\right]
$$
æ‰€ä»¥æœ‰
$$
\begin{array}{l}
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{0}\right)\right] \
\quad=\mathrm{E}\left[\sum_{a} q_{\pi(\theta)}\left(S_{0}, a\right) \nabla \pi\left(a|S_{0} ; \boldsymbol{\theta}\right)\right]+\gamma \mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{1}\right)\right] \
\quad=\mathrm{E}\left[\sum_{a} q_{\pi(\theta)}\left(S_{0}, a\right) \nabla \pi\left(a|S_{0} ; \boldsymbol{\theta}\right)\right]+\mathrm{E}\left[\sum_{a} \gamma q_{\pi(\theta)}\left(S_{1}, a\right) \nabla \pi\left(a|S_{1} ; \boldsymbol{\theta}\right)\right]+\gamma^{2} \mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{1}\right)\right] \
\quad=\cdots \
\quad=\sum_{t=0}^{+\infty} \mathrm{E}\left[\sum_{a} \gamma^{t} q_{\pi(\theta)}\left(S_{t}, a\right) \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)\right]
\end{array}
$$
è€ƒè™‘åˆ°
$$
\nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)=\pi\left(a|S_{t} ; \boldsymbol{\theta}\right) \nabla \ln \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)
$$
æ‰€ä»¥
$$
\begin{array}{l}
\mathrm{E}\left[\sum_{a} \gamma^{t} q_{\pi(\theta)}\left(S_{t}, a\right) \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)\right] \
\quad=\mathrm{E}\left[\sum_{a} \pi\left(a|S_{t} ; \boldsymbol{\theta}\right) \gamma^{t} q_{\pi(\theta)}\left(S_{t}, a\right) \nabla \ln \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)\right] \
\quad=\mathrm{E}\left[\gamma^{t} q_{\pi(\theta)}\left(S_{t}, A_{t}\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
\end{array}
$$
åˆç”±äº $q_{\pi(\theta)}\left(S_{t}, A_{t}\right)=\mathrm{E}\left[G_{t}|S_{t}, A_{t}\right]$ ï¼Œæ‰€ä»¥
$$
\mathrm{E}\left[\sum_{a} \gamma^{t} q_{\pi(\theta)}\left(S_{t}, a\right) \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}\left[\gamma^{t} q_{\pi(\theta)}\left(S_{t}, A_{t}\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}\left[\gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
$$
å¾—è¯ï¼</p>
<h3 id="52-åŒç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#52-åŒç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•">5.2 åŒç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h3>
<p>ç­–ç•¥æ¢¯åº¦å®šç†å‘Šè¯‰æˆ‘ä»¬ï¼Œæ²¿ç€ $\nabla E_{\pi(\theta)}\left[G_{0}\right]=\mathrm{E}\left[\sum_{t=0}^{+\infty} \gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ çš„æ–¹å‘æ”¹å˜ç­–ç•¥å‚æ•° $\theta$ çš„å€¼ï¼Œå°±æœ‰æœºä¼šå¢åŠ æœŸæœ›å›æŠ¥ï¼åŸºäºè¿™ä¸€ç»“è®ºï¼Œå¯ä»¥è®¾è®¡ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼æœ¬èŠ‚è€ƒè™‘åŒç­–æ›´æ–°ç®—æ³•</p>
<h4 id="521-ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#521-ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•">5.2.1 ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h4>
<p>åœ¨æ¯ä¸€ä¸ªå›åˆç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å°±å›åˆä¸­çš„æ¯ä¸€æ­¥ç”¨å½¢å¦‚
$$
\boldsymbol{\theta}<em>{t+1} \leftarrow \boldsymbol{\theta}</em>{t}+\alpha \gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right), \quad t=0,1, \ldots
$$
çš„è¿­ä»£å¼æ›´æ–°å‚æ•° $\boldsymbol{\theta}$ ï¼è¿™æ ·çš„ç®—æ³•ç§°ä¸ºç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼ˆVanilla Policy Gradient, VPG)ï¼</p>
<p>R Willims åœ¨æ–‡ç« ã€ŠSimple statistical gradient-following algorithms for connectionist reinforcement learning ã€‹ä¸­ç»™å‡ºäº†è¯¥ç®—æ³•ï¼Œå¹¶ç§°å®ƒä¸ºâ€œREward Increment = Nonnegative Factor $\times$ Offset Reinforcement $\times$ Characteristic Eligibilityâ€ ( $\mathrm{REINFORCE})$ ï¼Œè¡¨ç¤ºå¢é‡ $\alpha \gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta_{t}\right)$ æ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†çš„ç§¯ç»„æˆçš„ï¼è¿™æ ·è¿­ä»£å®Œè¿™ä¸ªå›åˆè½¨è¿¹å°±å®ç°äº†
$$
\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha \sum_{t=0}^{+\infty} \gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)
$$
åœ¨å…·ä½“çš„æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¸ä¸€å®šè¦ä¸¥æ ¼é‡‡ç”¨è¿™æ ·çš„å½¢å¼ï¼å½“é‡‡ç”¨ TensorFlow ç­‰è‡ªåŠ¨å¾®åˆ†çš„è½¯ä»¶åŒ…æ¥å­¦ä¹ å‚æ•°æ—¶ï¼Œå¯ä»¥å®šä¹‰å•æ­¥çš„æŸå¤±ä¸º $-\gamma^{\prime} G_{t} \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)$ ï¼Œè®©è½¯ä»¶åŒ…ä¸­çš„ä¼˜åŒ–å™¨å‡å°æ•´ä¸ªå›åˆä¸­æ‰€æœ‰æ­¥çš„å¹³å‡æŸå¤±ï¼Œå°±ä¼šæ²¿ç€ $\sum_{t=0}^{+\infty} \gamma^{\prime} G_{t} \nabla \ln \pi\left(A,|S_{t} ; \theta\right)$ çš„æ¢¯åº¦æ–¹å‘æ”¹å˜ $\theta$ çš„å€¼ï¼</p>
<p>ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•è§ç®—æ³• 5-1ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 5-1</strong>ï¼š$\quad$ ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\alpha$ ï¼‰ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ä»»æ„å€¼</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $\pi(\theta)$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$
2.3 å¯¹ $t=T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ç­–ç•¥ï¼‰æ›´æ–° $\boldsymbol{\theta}$ ä»¥å‡å° $-\gamma^{\prime} G \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\left(\text { å¦‚ } \boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha \gamma^{t} G \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right)$</li>
</ol>
</li>
</ol>
<hr />
<h3 id="522-å¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#522-å¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•">5.2.2 å¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h3>
<p>æœ¬èŠ‚ä»‹ç»ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„ä¸€ç§æ”¹è¿›ä¸€å¸¦åŸºçº¿çš„ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼ˆREINFOCE with baselines)ï¼ä¸ºäº†é™ä½å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ–¹å·®ï¼Œå¯ä»¥å¼•äººåŸºçº¿å‡½æ•° $B(s)(s \in \mathcal{S})$ ï¼åŸºçº¿å‡½æ•° $B$ å¯ä»¥æ˜¯ä»»æ„éšæœºå‡½æ•°æˆ–ç¡®å®šå‡½æ•°ï¼Œå®ƒå¯ä»¥ä¸çŠ¶æ€ $s$ æœ‰å…³ï¼Œä½†æ˜¯ä¸èƒ½å’ŒåŠ¨ä½œ $a$ æœ‰å…³ï¼æ»¡è¶³è¿™æ ·çš„æ¡ä»¶åï¼ŒåŸºçº¿å‡½æ•° $B$ è‡ªç„¶ä¼šæ»¡è¶³
$$
\mathrm{E}\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}\left[\gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
$$
è¯æ˜å¦‚ä¸‹ï¼šç”±äº $B$ ä¸ $a$ æ— å…³ï¼Œæ‰€ä»¥
$$
\sum_{a} B\left(S_{t}\right) \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)=B\left(S_{t}\right) \nabla \sum_{a} \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)=B\left(S_{t}\right) \nabla 1=0
$$
è¿›è€Œ
$$
\begin{aligned}
\mathrm{E} &amp;\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right] \
&amp;=\sum_{a} \gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right) \
&amp;=\sum_{a} \gamma^{t} G_{t} \nabla \pi\left(a|S_{t} ; \boldsymbol{\theta}\right) \
&amp;=\mathrm{E}\left[\gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
\end{aligned}
$$
å¾—è¯ï¼
åŸºçº¿å‡½æ•°å¯ä»¥ä»»æ„é€‰æ‹©ï¼Œä¾‹å¦‚ä»¥ä¸‹æƒ…å†µ</p>
<ol>
<li>é€‰æ‹©åŸºçº¿å‡½æ•°ä¸ºç”±è½¨è¿¹ç¡®å®šçš„éšæœºå˜é‡ $B\left(S_{t}\right)=-\sum_{\tau=0}^{t-1} \gamma^{\tau-t} R_{\tau+1}$ ï¼Œè¿™æ—¶ $\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right)=G_{0}$ ï¼Œæ¢¯åº¦çš„å½¢å¼ä¸º $\mathrm{E}\left[G_{0} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$</li>
<li>é€‰æ‹©åŸºçº¿å‡½æ•°ä¸º $B\left(S_{t}\right)=\gamma^{t} v_{<em>}\left(S_{t}\right)$ ï¼Œè¿™æ—¶æ¢¯åº¦çš„å½¢å¼ ä¸º $\mathrm{E}\left[\gamma^{t}\left(G_{t}-v_{</em>}\left(S_{t}\right)\right) \nabla \ln \pi\right.$
$\left.\left(A_{t}|S_{t} ; \theta\right)\right]$</li>
</ol>
<p>ä½†æ˜¯ï¼Œåœ¨å®é™…é€‰æ‹©åŸºçº¿æ—¶ï¼Œåº”å½“å‚ç…§ä»¥ä¸‹ä¸¤ä¸ªæ€æƒ³ï¼</p>
<ul>
<li>åŸºçº¿çš„é€‰æ‹©åº”å½“æœ‰æ•ˆé™ä½æ–¹å·®ï¼ä¸€ä¸ªåŸºçº¿å‡½æ•°èƒ½ä¸èƒ½é™ä½æ–¹å·®ä¸å®¹æ˜“åœ¨ç†è®ºä¸Šåˆ¤åˆ«ï¼Œ å¾€å¾€éœ€è¦é€šè¿‡å®è·µè·çŸ¥ï¼- åŸºçº¿å‡½æ•°åº”å½“æ˜¯å¯ä»¥å¾—åˆ°çš„ï¼ä¾‹å¦‚æˆ‘ä»¬ä¸çŸ¥é“æœ€ä¼˜ä»·å€¼å‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥å¾—åˆ°æœ€ä¼˜ä»·å€¼å‡½æ•°çš„ä¼°è®¡ï¼ä»·å€¼å‡½æ•°çš„ä¼°è®¡ä¹Ÿå¯ä»¥éšç€è¿­ä»£è¿‡ç¨‹æ›´æ–°ï¼</li>
</ul>
<p>ä¸€ä¸ªèƒ½æœ‰æ•ˆé™ä½æ–¹å·®çš„åŸºçº¿æ˜¯çŠ¶æ€ä»·å€¼å‡½æ•°çš„ä¼°è®¡ï¼ç®—æ³• 5-2 ç»™å‡ºäº†ç”¨çŠ¶æ€ä»·å€¼å‡½æ•°çš„ä¼°è®¡ä½œä¸ºåŸºçº¿çš„ç®—æ³•ï¼è¿™ä¸ªç®—æ³•æœ‰ä¸¤å¥—å‚æ•° $\boldsymbol{\theta}$ å’Œ $\mathbf{w}$ ï¼Œåˆ†åˆ«æ˜¯æœ€ä¼˜ç­–ç•¥ä¼°è®¡å’Œæœ€ä¼˜çŠ¶æ€ä»·å€¼å‡½æ•°ä¼°è®¡çš„å‚æ•°ï¼æ¯æ¬¡è¿­ä»£æ—¶ï¼Œå®ƒä»¬éƒ½ä»¥å„è‡ªçš„å­¦ä¹ ç®—æ³•è¿›è¡Œå­¦ä¹ ï¼ç®—æ³• 5-2 é‡‡ç”¨äº†éšæœºæ¢¯åº¦ä¸‹é™æ³•æ¥æ›´æ–°è¿™ä¸¤å¥—å‚æ•°ï¼ˆäº‹å®ä¸Šä¹Ÿå¯ä»¥ç”¨å…¶ä»–ç®—æ³•)ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­éƒ½ç”¨åˆ°äº† $G-v\left(S_{t} ; \mathbf{w}\right)$ ï¼Œå¯ä»¥åœ¨æ›´æ–°å‰é¢„å…ˆè®¡ç®—ä»¥å‡å°è®¡ç®—é‡ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 5-2</strong>ï¼š$\quad$ å¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\left.\alpha^{(\mathbf{w})}, \alpha^{(0)}\right)$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼ï¼</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $\pi(\boldsymbol{\theta})$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.2 ï¼ˆåˆå§‹åŒ–å›æŠ¥ï¼‰ $G \leftarrow 0$<br />
2.3 å¯¹ $t=T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰ $G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\left[G-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}\left(\right.$ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}\left[G-v\left(S_{t} ; \mathbf{w}\right)\right] \nabla v\left(S_{t} ; \mathbf{w}\right)\right)$</li>
<li>ï¼ˆæ›´æ–°ç­–ç•¥ï¼‰æ›´æ–° $\boldsymbol{\theta}$ ä»¥å‡å° $-\gamma^{t}\left[G-v\left(S_{t} ; \mathbf{w}\right)\right] \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\left(\right.$ å¦‚ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} \gamma^{t}\left.\left[G-v\left(S_{t} ; \mathbf{w}\right)\right] \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right)_{0}$</li>
</ol>
</li>
</ol>
<hr />
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åˆ†æä»€ä¹ˆæ ·çš„åŸºçº¿å‡½æ•°èƒ½æœ€å¤§ç¨‹åº¦åœ°å‡å°æ–¹å·®ï¼è€ƒè™‘ $\mathrm{E}\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right)\right.$ $\left.\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ çš„æ–¹å·®ä¸º
$$
\mathrm{E}\left[\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]^{2}\right]-\left[\mathrm{E}\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]\right]^{2}
$$
å…¶å¯¹ $B\left(S_{t}\right)$ æ±‚åå¯¼æ•°ä¸º
$$
\mathrm{E}\left[-2 \gamma^{2 t}\left(G_{t}-B\left(S_{t}\right)\right)\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]^{2}\right]
$$
ï¼ˆæ±‚åå¯¼æ•°æ—¶ç”¨åˆ°äº† $\frac{\partial}{\partial B\left(S_{t}\right)} \mathrm{E}\left[\gamma^{t}\left(G_{t}-B\left(S_{t}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=0$ï¼‰ï¼ä»¤è¿™ä¸ªåå¯¼æ•°ä¸º 0 ï¼Œå¹¶å‡è®¾
$$
\mathrm{E}\left[B\left(S_{t}\right)\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]^{2}\right]=\mathrm{E}\left[B\left(S_{t}\right)\right] \mathrm{E}\left[\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]^{2}\right]
$$
å¯çŸ¥
$$
\mathrm{E}\left[B\left(S_{t}\right)\right]=\frac{\mathrm{E}\left[G_{t}\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]^{2}\right]}{E\left[\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]^{2}\right]}
$$
è¿™æ„å‘³ç€ï¼Œæœ€ä½³çš„åŸºçº¿å‡½æ•°åº”å½“æ¥è¿‘å›æŠ¥ $G_{t}$ ä»¥æ¢¯åº¦ $\left[\nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]^{2}$ ä¸ºæƒé‡åŠ æƒå¹³å‡çš„ç»“æœï¼ä½†æ˜¯ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ— æ³•äº‹å…ˆçŸ¥é“è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨è¿™æ ·çš„åŸºçº¿å‡½æ•°ï¼</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“ç­–ç•¥å‚æ•°å’Œä»·å€¼å‚æ•°åŒæ—¶éœ€è¦å­¦ä¹ çš„æ—¶å€™ï¼Œç®—æ³•çš„æ”¶æ•›æ€§éœ€è¦é€šè¿‡åŒæ—¶é—´è½´ Robbins-Monro ç®—æ³•ï¼ˆtwo timescale Robbins-Monro algorithmï¼‰æ¥åˆ†æï¼</p>
<h3 id="53-å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#53-å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•">5.3 å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h3>
<p>åœ¨ç®€å•çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•çš„åŸºç¡€ä¸Šå¼•å…¥é‡è¦æ€§é‡‡æ ·ï¼Œå¯ä»¥å¾—åˆ°å¯¹åº”çš„å¼‚ç­–ç®—æ³•ï¼è®°è¡Œä¸ºç­–ç•¥ä¸º $b(a|s)$ ï¼Œæœ‰
$$
\begin{array}{c}
\sum_{a} \pi(a|s ; \boldsymbol{\theta}) \gamma^{t} G_{t} \nabla \ln \pi(a|s ; \boldsymbol{\theta}) \
\qquad=\sum_{\sigma} b(a|s) \frac{\pi(a|s ; \boldsymbol{\theta})}{b(a|s)} \gamma^{t} G_{t} \nabla \ln \pi(a|s ; \boldsymbol{\theta}) \
=\sum_{a} b(a|s) \frac{1}{b(a|s)} \gamma^{t} G_{t} \nabla \pi(a|s ; \boldsymbol{\theta})
\end{array}
$$
å³
$$
E_{\pi(\theta)}\left[\gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}<em>{b}\left[\frac{1}{b\left(A</em>{t}|S_{t}\right)} \gamma^{t} G_{t} \nabla \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]
$$
æ‰€ä»¥ï¼Œé‡‡ç”¨é‡è¦æ€§é‡‡æ ·çš„ç¦»çº¿ç®—æ³•ï¼Œåªéœ€è¦æŠŠç”¨åœ¨çº¿ç­–ç•¥é‡‡æ ·å¾—åˆ°çš„æ¢¯åº¦æ–¹å‘ $\gamma^{\prime} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)$ æ”¹ä¸ºç”¨è¡Œä¸ºç­–ç•¥ $b$ é‡‡æ ·å¾—åˆ°çš„æ¢¯åº¦æ–¹å‘ $\frac{1}{b\left(A_{t}|S_{t}\right)} \gamma^{t} G_{t} \nabla \pi\left(A_{t}|S_{t} ; \theta\right)$ å³å¯ï¼è¿™å°±æ„å‘³ç€ï¼Œåœ¨æ›´æ–°å‚æ•° $\boldsymbol{\theta}$ æ—¶å¯ä»¥è¯•å›¾å¢å¤§ $\frac{1}{b\left(A_{t}|S_{t}\right)} \gamma^{t} G_{t} \pi\left(A_{t}|S_{t} ; \theta\right)$ ï¼</p>
<blockquote>
<p><strong>ç®—æ³•5-3</strong>ï¼š$\quad$ é‡è¦æ€§é‡‡æ ·ç®€å•ç­–ç•¥æ¢¯åº¦æ±‚è§£æœ€ä¼˜ç­–ç•¥</p>
</blockquote>
<hr />
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta \leftarrow}$ä»»æ„å€¼</li>
<li>ï¼ˆå›åˆæ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆè¡Œä¸ºç­–ç•¥ï¼‰æŒ‡å®šè¡Œä¸ºç­–ç•¥ $b$ ï¼Œä½¿å¾— $\pi(\boldsymbol{\theta}) \ll b$<br />
2.2 ï¼ˆé‡‡æ ·ï¼‰ç”¨ç­–ç•¥ $b$ ç”Ÿæˆè½¨è¿¹ï¼š$S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$<br />
2.3 ï¼ˆåˆå§‹åŒ–å›æŠ¥å’Œæƒé‡ï¼‰ $G \leftarrow 0$<br />
2.4 å¯¹ $t=T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
<ol>
<li>ï¼ˆæ›´æ–°å›æŠ¥ï¼‰$G \leftarrow \gamma G+R_{t+1}$</li>
<li>ï¼ˆæ›´æ–°ç­–ç•¥ï¼‰æ›´æ–°å‚æ•° $\theta$ ä»¥å‡å° $-\frac{1}{b\left(A_{t}|S_{t}\right)} \gamma^{t} G_{t} \pi\left(A_{t}|S_{t} ; \theta\right)\left(\right.$ å¦‚ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha \frac{1}{b\left(A_{t}|S_{t}\right)}\left.\gamma^{t} G \nabla \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right)_{0}$</li>
</ol>
</li>
</ol>
<hr />
<p>é‡è¦æ€§é‡‡æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä»–ç­–ç•¥çš„æ ·æœ¬æ¥æ›´æ–°ç­–ç•¥å‚æ•°ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¸¦æ¥è¾ƒå¤§çš„åå·®ï¼Œç®—æ³•ç¨³å®šæ€§æ¯”åŒç­–ç®—æ³•å·®ï¼</p>
<h3 id="54-ç­–ç•¥æ¢¯åº¦æ›´æ–°å’Œæå¤§ä¼¼ç„¶ä¼°è®¡çš„å…³ç³»"><a class="header" href="#54-ç­–ç•¥æ¢¯åº¦æ›´æ–°å’Œæå¤§ä¼¼ç„¶ä¼°è®¡çš„å…³ç³»">5.4 ç­–ç•¥æ¢¯åº¦æ›´æ–°å’Œæå¤§ä¼¼ç„¶ä¼°è®¡çš„å…³ç³»</a></h3>
<p>è‡³æ­¤ï¼Œæœ¬ç« å·²ç»ä»‹ç»äº†å„ç§å„æ ·çš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼è¿™äº›ç®—æ³•åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½æ˜¯é€šè¿‡æ›´æ–°ç­–ç•¥å‚æ•° $\theta$ ä»¥è¯•å›¾å¢å¤§å½¢å¦‚ $\mathrm{E}\left[\Psi_{t} \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ çš„ç›®æ ‡ï¼ˆè€ƒè™‘å•ä¸ªæ¡ç›®åˆ™ä¸º
$\left.\Psi_{t} \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right)$ ï¼Œå…¶ä¸­ $\Psi_{t}$ å¯å– $G_{0}, G_{t}$ ç­‰å€¼ï¼å°†è¿™ä¸€å­¦ä¹ è¿‡ç¨‹ä¸ä¸‹åˆ—æœ‰ç›‘ç£å­¦ä¹ æœ€å¤§ä¼¼ç„¶é—®é¢˜çš„è¿‡ç¨‹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå·²ç»æœ‰ä¸€ä¸ªè¡¨è¾¾å¼æœªçŸ¥çš„ç­–ç•¥ $\pi$ ï¼Œæˆ‘ä»¬è¦ç”¨ç­–ç•¥ $\pi(\boldsymbol{\theta})$ æ¥è¿‘ä¼¼å®ƒï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘ç”¨æœ€å¤§ä¼¼ç„¶çš„æ–¹æ³•æ¥ä¼°è®¡ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ ï¼å…·ä½“è€Œè¨€ï¼Œå¦‚æœå·²ç»ç”¨æœªçŸ¥ç­–ç•¥ $\pi$ ç”Ÿæˆäº†å¾ˆå¤šæ ·æœ¬ï¼Œé‚£ä¹ˆè¿™äº›æ ·æœ¬å¯¹äºç­–ç•¥ $\pi(\boldsymbol{\theta})$ çš„å¯¹æ•°ä¼¼ç„¶å€¼æ­£æ¯”äº $\mathrm{E}\left[\ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ ï¼ç”¨è¿™äº›æ ·æœ¬è¿›è¡Œæœ‰ç›‘ç£å­¦ä¹ ï¼Œéœ€è¦æ›´æ–°ç­–ç•¥å‚æ•° $\theta$ ä»¥å¢å¤§ $\mathrm{E}\left[\ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ (è€ƒè™‘å•ä¸ªæ¡ç›®åˆ™ä¸º $\left.\ln \pi\left(A_{t}|S_{t} ; \theta\right)\right)$ ï¼å¯ä»¥çœ‹å‡ºï¼Œ$\mathrm{E}\left[\ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ å¯ä»¥é€šè¿‡ $\mathrm{E}\left[\Psi_{t} \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ ä¸­å– $\Psi_{t}=1$ å¾—åˆ°ï¼Œåœ¨å½¢å¼ä¸Šå…·æœ‰ç›¸ä¼¼æ€§ï¼ç­–ç•¥æ¢¯åº¦ç®—æ³•åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­å·§å¦™åœ°åˆ©ç”¨è§‚æµ‹åˆ°çš„å¥–åŠ±ä¿¡å·å†³å®šæ¯æ­¥å¯¹æ•°ä¼¼ç„¶å€¼ $\ln \pi\left(A_{t}|S_{t} ; \theta\right)$ å¯¹ç­–ç•¥å¥–åŠ±çš„è´¡çŒ®ï¼Œä¸ºå…¶åŠ æƒ $\Psi_{t}$ (è¿™é‡Œçš„ $\Psi_{t}$ å¯èƒ½æ˜¯æ­£æ•°ï¼Œå¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä¹Ÿå¯ èƒ½æ˜¯ 0 )ï¼Œä½¿å¾—ç­–ç•¥ $\pi(\boldsymbol{\theta})$ èƒ½å¤Ÿå˜å¾—è¶Šæ¥è¶Šå¥½ï¼æ³¨æ„ï¼Œå¦‚æœå– $\Psi$ ï¼Œåœ¨æ•´ä¸ªå›åˆä¸­æ˜¯ä¸å˜çš„ï¼ˆä¾‹å¦‚ $\left.\Psi_{t}=G_{0}\right)$ ï¼Œé‚£ä¹ˆåœ¨å•ä¸€å›åˆä¸­çš„ $\mathrm{E}\left[G_{0} \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=G_{0} \mathrm{E}\left[\ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ å°±æ˜¯å¯¹æ•´ä¸ªå›åˆçš„å¯¹æ•°ä¼¼ç„¶å€¼è¿›è¡ŒåŠ æƒåå¯¹ç­–ç•¥çš„è´¡çŒ®ï¼Œä½¿å¾—ç­–ç•¥ $\pi(\boldsymbol{\theta})$ èƒ½å¤Ÿå˜å¾—è¶Šæ¥è¶Šå¥½ï¼è¯•æƒ³ï¼Œå¦‚æœæœ‰çš„å›åˆè¡¨ç°å¾ˆå¥½ (æ¯”å¦‚ $G_{0}$ æ˜¯å¾ˆå¤§çš„æ­£æ•° )ï¼Œåœ¨ç­–ç•¥æ¢¯åº¦æ›´æ–°çš„æ—¶å€™è¿™ä¸ªå›åˆçš„ä¼¼ç„¶å€¼ $\mathrm{E}\left[\ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æƒé‡ $\Psi_{t}\left(\right.$ ä¾‹å¦‚ $\left.\Psi_{t}=G_{0}\right)$ ï¼Œè¿™æ ·è¿™ä¸ªè¡¨ç°æ¯”è¾ƒå¥½çš„å›åˆå°±ä¼šæ›´å€¾å‘äºå‡ºç°ï¼›å¦‚æœæœ‰çš„å›åˆè¡¨ç°å¾ˆå·®ï¼ˆæ¯”å¦‚ $G_{0}$ æ˜¯å¾ˆå°çš„è´Ÿæ•°ï¼Œå³ç»å¯¹å€¼å¾ˆå¤§çš„è´Ÿæ•°ï¼‰åˆ™ç­–ç•¥æ¢¯åº¦æ›´æ–°æ—¶è¿™ä¸ªå›åˆçš„ä¼¼ç„¶å€¼å°±ä¼šæœ‰æ¯”è¾ƒå°çš„æƒé‡ï¼Œè¿™æ ·è¿™ä¸ªè¡¨ç°è¾ƒå·®çš„å›åˆå°±æ›´å€¾å‘äºä¸å‡ºç°ï¼</p>
<h2 id="å…­-æ‰§è¡Œè€…è¯„è®ºè€…æ–¹æ³•"><a class="header" href="#å…­-æ‰§è¡Œè€…è¯„è®ºè€…æ–¹æ³•">å…­ï¼ æ‰§è¡Œè€…/è¯„è®ºè€…æ–¹æ³•</a></h2>
<p>æœ¬ç« ä»‹ç»å¸¦è‡ªç›Šçš„ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼è¿™ç±»ç®—æ³•å°†ç­–ç•¥æ¢¯åº¦å’Œè‡ªç›Šç»“åˆäº†èµ·æ¥ï¼šä¸€æ–¹é¢ï¼Œç”¨ä¸€ä¸ªå«å‚å‡½æ•°è¿‘ä¼¼ä»·å€¼å‡½æ•°ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªä»·å€¼å‡½æ•°çš„è¿‘ä¼¼å€¼æ¥ä¼°è®¡å›æŠ¥å€¼ï¼›å¦ä¸€æ–¹é¢ï¼Œåˆ©ç”¨ä¼°è®¡å¾—åˆ°çš„å›æŠ¥å€¼ä¼°è®¡ç­–ç•¥æ¢¯åº¦ï¼Œè¿›è€Œæ›´æ–°ç­–ç•¥å‚æ•°ï¼è¿™ä¸¤æ–¹é¢åˆå¸¸å¸¸è¢«ç§°ä¸º<strong>è¯„è®ºè€…</strong> (critic) å’Œ<strong>æ‰§è¡Œè€…</strong>ï¼ˆactorï¼‰ï¼æ‰€ä»¥ï¼Œå¸¦è‡ªç›Šçš„ç­–ç•¥æ¢¯åº¦ç®—æ³•è¢«ç§°ä¸º<strong>æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</strong>ï¼ˆactorcritic algorithm)ï¼</p>
<h3 id="61-æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#61-æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">6.1 æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h3>
<p>åŒæ ·ç”¨å«å‚å‡½æ•° $h(s, a ; \theta)$ è¡¨ç¤ºåå¥½ï¼Œç”¨å…¶ $\operatorname{softmax}$ è¿ç®—çš„ç»“æœ $\pi(a|s ; \boldsymbol{\theta})$ æ¥è¿‘ä¼¼æœ€ä¼˜ç­–ç•¥ï¼åœ¨æ›´æ–°å‚æ•° $\boldsymbol{\theta}$ æ—¶ï¼Œæ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ä¾ç„¶ä¹Ÿæ˜¯æ ¹æ®ç­–ç•¥æ¢¯åº¦å®šç†ï¼Œå– $\mathrm{E}\left[\Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ ä¸ºæ¢¯åº¦æ–¹å‘è¿­ä»£æ›´æ–°ï¼å…¶ä¸­ï¼Œ $\Psi_{t}=\gamma^{t}\left(G_{t}-B(s)\right)\mathrm{J} .$ Schulman ç­‰åœ¨æ–‡ç« ã€Š High-dimensional continuous control using generalized advantage estimation ã€‹ä¸­æŒ‡å‡ºï¼Œ $\Psi_{t}$ å¹¶ä¸æ‹˜æ³¥äºä»¥ä¸Šå½¢å¼ï¼ $\Psi_{t}$ å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š</p>
<ul>
<li>ï¼ˆåŠ¨ä½œä»·å€¼ï¼‰ $\Psi_{t}=\gamma^{t} q_{\pi}\left(S_{t}, A_{t}\right)$</li>
<li>ï¼ˆä¼˜åŠ¿å‡½æ•°ï¼‰ $\Psi_{t}=\gamma^{t}\left[q_{\pi}\left(S_{t}, A_{t}\right)-v_{\pi}\left(S_{t}\right)\right]$</li>
<li>ï¼ˆæ—¶åºå·®åˆ†ï¼‰ $\Psi_{t}=\gamma^{t}\left[R_{t+1}+\gamma v_{\pi}\left(S_{t+1}\right)-v_{\pi}\left(S_{t}\right)\right]$</li>
</ul>
<p>åœ¨ä»¥ä¸Šå½¢å¼ä¸­ï¼Œå¾€å¾€ç”¨ä»·å€¼å‡½æ•°æ¥ä¼°è®¡å›æŠ¥ï¼ä¾‹å¦‚ï¼Œç”±äº $\mathrm{E}\left[\gamma^{t} G_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}\left[\gamma^{t} q_{\pi(\theta)}\left(S_{t}, A_{t}\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ ï¼Œè€Œä¸” $\mathrm{E}\left[q_{\pi(\theta)}\left(S_{t}, A_{t}\right) \nabla \ln \pi\left(A,|S_{t} ; \theta\right)\right]$ ä¹Ÿè¡¨å¾æœŸæœ›æ–¹å‘ï¼Œæ‰€ä»¥
$\Psi_{t}=\gamma^{t} q_{\pi}\left(S_{t}, A_{t}\right)$ ï¼Œç›¸å½“äºç”¨ $q_{\pi}\left(S_{t}, A_{t}\right)$ è¡¨ç¤ºæœŸæœ›ï¼å†ä¾‹å¦‚ï¼Œå¯¹äº $\Psi_{t}=\gamma^{t}\left[q_{\pi}\left(S_{t}, A_{t}\right)-v_{\pi}\left(S_{t}\right)\right]$ ï¼Œå°±ç›¸å½“äºåœ¨å›æŠ¥ $q_{\pi}\left(S_{t}, A_{t}\right)$ çš„åŸºç¡€ä¸Šå‡å»åŸºçº¿ $B(s)=v_{\pi}(s)$ ä»¥å‡å°æ–¹å·®ï¼å¯¹äºæ—¶åºå·®åˆ† $\Psi_{t}=\gamma^{t}\left[R_{t+1}+\gamma v_{\pi}\left(S_{t+1}\right)-v_{\pi}\left(S_{t}\right)\right]$ ï¼Œä¹Ÿæ˜¯ç”¨ $R_{t+1}+\gamma v_{\pi}\left(S_{t+1}\right)$ ä»£è¡¨å›æŠ¥ï¼Œå†å‡å»åŸºçº¿ $B(s)=v_{\pi}(s)$ ä»¥å‡å°æ–¹å·®ï¼</p>
<p>ä¸è¿‡åœ¨å®é™…ä½¿ç”¨æ—¶ï¼ŒçœŸå®çš„ä»·å€¼å‡½æ•°æ˜¯ä¸çŸ¥é“çš„ï¼ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å»ä¼°è®¡è¿™äº›ä»·å€¼å‡½æ•°ï¼å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•°è¿‘ä¼¼çš„æ–¹æ³•ï¼Œç”¨å«å‚å‡½æ•° $v(s ; w)(s \in \mathcal{S})$ æˆ– $q(s, a ; \mathbf{w})$ $(s \in \mathcal{S}, a \in \mathcal{A}(s))$ æ¥è¿‘ä¼¼ $v_{\pi}$ å’Œ $q_{\pi}$ ï¼åœ¨ä¸Šä¸€ç« ä¸­ï¼Œå¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•å·²ç»ä½¿ç”¨äº†å«å‚å‡½æ•° $v(\mathrm{~s} ; \mathbf{w})(s \in \mathcal{S})$ ä½œä¸ºåŸºçº¿å‡½æ•°ï¼æˆ‘ä»¬å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›ä¸€æ­¥å¼•äººè‡ªç›Šçš„æ€æƒ³ï¼Œç”¨ä»·å€¼çš„ä¼°è®¡ $U_{t}$ æ¥ä»£æ›¿ $\Psi_{t}$ ä¸­è¡¨ç¤ºå›æŠ¥çš„éƒ¨åˆ†ï¼ä¾‹å¦‚ï¼Œå¯¹äºæ—¶åºå·®åˆ†ï¼Œç”¨ä¼°è®¡æ¥ä»£æ›¿ä»·å€¼å‡½æ•°å¯ä»¥å¾—åˆ° $\Psi_{t}=\gamma^{t}\left[R_{t+1}+\gamma v\left(S_{t+1} ; \mathbf{w}\right)-v\left(S_{t} ; \mathbf{w}\right)\right]$ ï¼è¿™é‡Œçš„ä¼°è®¡å€¼ $v(\mathbf{w})$ å°±æ˜¯è¯„è®ºè€…ï¼Œè¿™æ ·çš„ç®—æ³•å°±æ˜¯æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼
&gt;æ³¨æ„ï¼šåªæœ‰é‡‡ç”¨äº†è‡ªç›Šçš„æ–¹æ³•ï¼Œå³ç”¨ä»·å€¼ä¼°è®¡æ¥ä¼°è®¡å›æŠ¥ï¼Œå¹¶å¼•å…¥äº†åå·®ï¼Œæ‰æ˜¯æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼ç”¨ä»·å€¼ä¼°è®¡æ¥åšåŸºçº¿å¹¶æ²¡æœ‰å¸¦æ¥åå·®ï¼ˆå› ä¸ºåŸºçº¿æœ¬æ¥å°±å¯ä»¥ä»»æ„é€‰æ‹©ï¼‰ï¼æ‰€ä»¥ï¼Œå¸¦åŸºçº¿çš„ç®€å•ç­–ç•¥æ¢¯åº¦ç®—æ³•ä¸æ˜¯æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼</p>
<h4 id="611-åŠ¨ä½œä»·å€¼æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#611-åŠ¨ä½œä»·å€¼æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">6.1.1 åŠ¨ä½œä»·å€¼æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h4>
<p>æ ¹æ®å‰è¿°åˆ†æï¼ŒåŒç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•åœ¨æ›´æ–°ç­–ç•¥å‚æ•° $\theta$ æ—¶ä¹Ÿåº”è¯¥è¯•å›¾å‡å° $-\Psi_{t} \ln \pi\left(A_{t}|S_{t} ; \theta\right)$ ï¼Œåªæ˜¯åœ¨è®¡ç®— $\Psi_{t}$ æ—¶é‡‡ç”¨äº†åŸºäºè‡ªç›Šçš„å›æŠ¥ä¼°è®¡ï¼ç®—æ³• 6-1 ç»™å‡ºäº†åœ¨å›æŠ¥ä¼°è®¡ä¸º $q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ ï¼Œå¹¶å– $\Psi_{1}=\gamma^{\prime} q\left(S_{t}, A_{t} ; \mathbf{w}\right)$ æ—¶çš„åŒç­–ç®—æ³•ï¼Œç§°ä¸ºåŠ¨ä½œä»·å€¼æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼ç®—æ³•ä¸€å¼€å§‹åˆå§‹åŒ–äº†ç­–ç•¥å‚æ•°å’Œä»·å€¼å‚æ•°ï¼è™½ç„¶ç®—æ³•ä¸­å†™çš„æ˜¯å¯ä»¥å°†è¿™ä¸ªå‚æ•°åˆå§‹åŒ–ä¸ºä»»æ„å€¼ï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬æ˜¯ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼Œè¿˜æ˜¯åº”è¯¥æŒ‰ç…§ç¥ç»ç½‘ç»œçš„è¦æ±‚æ¥åˆå§‹åŒ–å‚æ•°ï¼åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æœ‰ä¸ªå˜é‡ $I$ ï¼Œç”¨æ¥å­˜å‚¨ç­–ç•¥æ¢¯åº¦çš„è¡¨è¾¾å¼ä¸­çš„æŠ˜æ‰£å› å­ $\gamma^{t}$ ï¼åœ¨åŒä¸€å›åˆä¸­ï¼Œæ¯ä¸€æ­¥éƒ½æŠŠè¿™ä¸ªæŠ˜æ‰£å› å­ä¹˜ä¸Š $\gamma$ ï¼Œæ‰€ä»¥ç¬¬ $t$ æ­¥å°±æ˜¯ $\gamma^{t}$ ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-1</strong>ï¼š$\quad$ åŠ¨ä½œä»·å€¼åŒç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\left.\alpha^{(\mathrm{w})}, \alpha^{(\theta)}\right)$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œ:<br />
2.1 ï¼ˆåˆå§‹åŒ–ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow 1$<br />
2.2 ï¼ˆå†³å®šåˆå§‹çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œå¹¶ç”¨ $\pi(\cdot|S ; \boldsymbol{\theta})$ å¾—åˆ°åŠ¨ä½œ $A$<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ®çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$ å¾—åˆ°å¥–åŠ± $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆæ‰§è¡Œï¼‰ç”¨ $\pi\left(\cdot|S^{\prime} ; \boldsymbol{\theta}\right)$ å¾—åˆ°åŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ›´æ–° $\theta$ ä»¥å‡å° $-I q(S, A ; \mathbf{w}) \ln \pi(A|S ; \boldsymbol{\theta})\left(\right.$ å¦‚ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} I q(S, A ; \mathbf{w})\nabla \ln \pi(A|S ; \boldsymbol{\theta}))$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $[U-q(S, A ; \mathbf{w})]^{2}\left(\right.$ å¦‚ $\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}[U-q(S, A ; \mathbf{w})]\nabla q(S, A ; w))$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow \gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰ $S \leftarrow S^{\prime}, \quad A \leftarrow A^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<h4 id="612-ä¼˜åŠ¿æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#612-ä¼˜åŠ¿æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">6.1.2 ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h4>
<p>åœ¨åŸºæœ¬æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ä¸­å¼•å…¥åŸºçº¿å‡½æ•° $B\left(S_{t}\right)=v\left(S_{t} ; \mathbf{w}\right)$ ï¼Œå°±ä¼šå¾—åˆ° $\Psi_{t}=\gamma^{t}\left[q\left(S_{t}, A_{t} ; \mathbf{w}\right)-\right.$
$\left.v\left(S_{t} ; \mathbf{w}\right)\right]$ ï¼Œå…¶ä¸­ï¼Œ $q\left(S_{t}, A_{t} ; \mathbf{w}\right)-v\left(S_{t} ; \mathbf{w}\right)$ æ˜¯ä¼˜åŠ¿å‡½æ•°çš„ä¼°è®¡ï¼è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¼˜åŠ¿æ‰§è¡Œè€…
è¯„è®ºè€…ç®—æ³•ï¼ä¸è¿‡ï¼Œå¦‚æœé‡‡ç”¨ $q\left(S_{t}, A_{t} ; \mathbf{w}\right)-v\left(S_{t} ; \mathbf{w}\right)$ è¿™æ ·å½¢å¼çš„ä¼˜åŠ¿å‡½æ•°ä¼°è®¡å€¼ï¼Œæˆ‘ä»¬å°±éœ€æ­å»ºä¸¤ä¸ªå‡½æ•°åˆ†åˆ«è¡¨ç¤º $q(\mathbf{w})$ å’Œ $v(\mathbf{w})$ ï¼ä¸ºäº†é¿å…è¿™æ ·çš„éº»çƒ¦ï¼Œè¿™é‡Œç”¨äº† $U_{t}=R_{t+1}+\gamma v\left(S_{t+1} ; w\right)$ åšç›®æ ‡ï¼Œè¿™æ ·ä¼˜åŠ¿å‡½æ•°çš„ä¼°è®¡å°±å˜ä¸ºå•æ­¥æ—¶åºå·®åˆ†çš„å½¢å¼ $R_{t+1}+\gamma v\left(S_{t+1} ; \mathbf{w}\right)-v\left(S_{t} ; \mathbf{w}\right)$ï¼</p>
<p>å¦‚æœä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸æ˜¯æ¯ä¸€æ­¥éƒ½æ›´æ–°å‚æ•°ï¼Œè€Œæ˜¯åœ¨å›åˆç»“æŸåç”¨æ•´ä¸ªè½¨è¿¹æ¥è¿›è¡Œæ›´æ–°ï¼Œå°±å¯ä»¥æŠŠç®—æ³•åˆ†ä¸ºç»éªŒæœé›†å’Œç»éªŒä½¿ç”¨ä¸¤ä¸ªéƒ¨åˆ†ï¼è¿™æ ·çš„åˆ†éš”å¯ä»¥è®©è¿™ä¸ªç®—æ³•åŒæ—¶æœ‰å¾ˆå¤šæ‰§è¡Œè€…åœ¨åŒæ—¶æ‰§è¡Œï¼ä¾‹å¦‚ï¼Œè®©å¤šä¸ªæ‰§è¡Œè€…åŒæ—¶åˆ†åˆ«æ”¶é›†å¾ˆå¤šç»éªŒï¼Œç„¶åéƒ½ç”¨è‡ªå·±çš„é‚£äº›ç»éªŒå¾—åˆ°ä¸€æ‰¹ç»éªŒæ‰€å¸¦æ¥çš„æ¢¯åº¦æ›´æ–°å€¼ï¼æ¯ä¸ªæ‰§è¡Œè€…åœ¨ä¸€å®šçš„æ—¶æœºæ›´æ–°å‚æ•°ï¼ŒåŒæ—¶æ›´æ–°ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ å’Œä»·å€¼å‚æ•° $\mathbf{w}$ ï¼æ¯ä¸ªæ‰§è¡Œè€…çš„æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼æ‰€ä»¥ï¼Œè¿™æ ·çš„å¹¶è¡Œç®—æ³•ç§°ä¸º<strong>å¼‚æ­¥ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</strong>ï¼ˆ Asynchronous Advantage Actor-Critic, $\mathrm{A} 3 \mathrm{C}$ )ï¼å¼‚æ­¥ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ä¸­çš„è‡ªç›Šéƒ¨åˆ†ï¼Œä¸ä»…å¯ä»¥é‡‡ç”¨å•æ­¥æ—¶åºå·®åˆ†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤šæ­¥æ—¶åºå·®åˆ†ï¼å¦å¤–ï¼Œè¿˜å¯ä»¥å¯¹å‡½æ•°å‚æ•°çš„è®¿é—®è¿›è¡Œæ§åˆ¶ï¼Œä½¿å¾—æ‰€æœ‰æ‰§è¡Œè€…ç»Ÿä¸€æ›´æ–°å‚æ•°ï¼è¿™æ ·çš„å¹¶è¡Œç®—æ³•ç§°ä¸º<strong>ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</strong>ï¼ˆAdvantage Actor-Critic, $\mathrm{A} 2 \mathrm{C}$ )ï¼ç®—æ³• $6-3$ ç»™å‡ºäº†å¼‚æ­¥ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼å¼‚æ­¥ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å¯ä»¥æœ‰è®¸å¤šæ‰§è¡Œè€… (æˆ–ç§°å¤šä¸ªçº¿ç¨‹ )ï¼Œæ‰€ä»¥é™¤äº†æœ‰å…¨å±€çš„ä»·å€¼å‚æ•° $\mathbf{w}$ å’Œç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ å¤–ï¼Œæ¯ä¸ªçº¿ç¨‹è¿˜å¯èƒ½æœ‰è‡ªå·±ç»´æŠ¤çš„ä»·å€¼å‚æ•° $\mathbf{w}^{\prime}$ å’Œ $\boldsymbol{\theta}^{\prime}$ ï¼æ‰§è¡Œè€…æ‰§è¡Œæ—¶ï¼Œå…ˆä»å…¨å±€åŒæ­¥å‚æ•°ï¼Œç„¶åå†è‡ªå·±å­¦ä¹ ï¼Œæœ€åç»Ÿä¸€åŒæ­¥å…¨å±€å‚æ•°ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-2</strong>ï¼š $\quad$ ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\left.\alpha^{(\theta)}, \alpha^{(\mathbf{w})}\right)$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼ï¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow 1$<br />
2.2 ï¼ˆå†³å®šåˆå§‹çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰ç”¨ $\pi(\cdot|S ; \theta)$ å¾—åˆ°åŠ¨ä½œ $A$</li>
<li>ï¼ˆæ‰§è¡Œï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œå¾—åˆ°å¥–åŠ± $R$ å’Œè§‚æµ‹ $S^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma v\left(S^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ›´æ–° $\boldsymbol{\theta}$ ä»¥å‡å° $-I[U-v(S ; \mathbf{w})] \ln \pi(A|S ; \theta)\left(\right.$ å¦‚ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} I[U-v(S ; \mathbf{w})]\nabla \ln \pi(A|S ; \theta))$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $[U-v(S ; \mathbf{w})]^{2}\left(\right.$ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}[U-v(S ; \mathbf{w})] \nabla v(S ; \mathbf{w})\right)$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow \gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰$S\leftarrow S^\prime$ï¼</li>
</ol>
</li>
</ol>
<hr />
<blockquote>
<p><strong>ç®—æ³• 6-3</strong>ï¼š$\quad$ å¼‚æ­¥ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³• (æ¼”ç¤ºæŸä¸ªçº¿ç¨‹çš„è¡Œä¸º)</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\left.\alpha^{(\theta)}, \alpha^{(\mathbf{w})}\right)$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°</p>
<ol>
<li>ï¼ˆåŒæ­¥å…¨å±€å‚æ•°ï¼‰ $\boldsymbol{\theta}^{\prime} \leftarrow \boldsymbol{\theta}, \mathbf{w}^{\prime} \leftarrow \mathbf{w}$</li>
<li>é€å›åˆæ‰§è¡Œä»¥ä¸‹è¿‡ç¨‹ï¼š<br />
2.1 ç”¨ç­–ç•¥ $\pi\left(\boldsymbol{\theta}^{\prime}\right)$ ç”Ÿæˆè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, A_{1}, R_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$ ï¼Œç›´åˆ°å›åˆç»“æŸæˆ–æ‰§è¡Œæ­¥æ•°è¾¾
åˆ°ä¸Šé™ $T$<br />
2.2 ä¸ºæ¢¯åº¦è®¡ç®—åˆå§‹åŒ–ï¼š
<ul>
<li>ï¼ˆåˆå§‹åŒ–ç›®æ ‡ $U_{T}$ï¼‰è‹¥ $S_{T}$ æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ $U \leftarrow 0$ ï¼›å¦åˆ™ $U \leftarrow v\left(S_{T} ; \mathbf{w}^{\prime}\right)$</li>
<li>ï¼ˆåˆå§‹åŒ–æ¢¯åº¦ï¼‰$\mathbf{g}^{(\theta)} \leftarrow \mathbf{0}, \mathbf{g}^{(\mathbf{w})} \leftarrow \mathbf{0}$<br />
2.3 ï¼ˆå¼‚æ­¥è®¡ç®—æ¢¯åº¦ï¼‰å¯¹ $t=T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹å†…å®¹ï¼š</li>
<li>ï¼ˆä¼°è®¡ç›®æ ‡ï¼‰è®¡ç®— $U \leftarrow \gamma U+R_{t+1}$</li>
<li>ï¼ˆä¼°è®¡ç­–ç•¥æ¢¯åº¦æ–¹å‘ï¼‰$\mathbf{g}^{(\theta)} \leftarrow \mathbf{g}^{(\theta)}+\left[U-v\left(S_{t} ; \mathbf{w}^{\prime}\right)\right] \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}^{\prime}\right)$</li>
<li>ï¼ˆä¼°è®¡ä»·å€¼æ¢¯åº¦æ–¹å‘ï¼‰ $\mathbf{g}^{(w)} \leftarrow \mathbf{g}^{(\mathbf{w})}+\left[U-v\left(S_{t} ; \mathbf{w}^{\prime}\right)\right] \nabla v\left(S_{t} ; \mathbf{w}^{\prime}\right)$</li>
</ul>
</li>
<li>ï¼ˆåŒæ­¥æ›´æ–°ï¼‰æ›´æ–°å…¨å±€å‚æ•°<br />
3.1 ï¼ˆç­–ç•¥æ›´æ–°ï¼‰ç”¨æ¢¯åº¦æ–¹å‘ $\mathbf{g}^{(\theta)}$ æ›´æ–°ç­–ç•¥å‚æ•° $\boldsymbol{\theta}\left(\right.$ å¦‚ $\left.\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} \mathbf{g}^{(\mathbf{\theta})}\right)$<br />
3.2 ï¼ˆä»·å€¼æ›´æ–°ï¼‰ç”¨æ¢¯åº¦æ–¹å‘ $\mathbf{g}^{(\mathbf{w})}$ æ›´æ–°ä»·å€¼å‚æ•° $\mathbf{w}\left(\right.$ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})} \mathbf{g}^{(\mathbf{w})}\right)$ï¼</li>
</ol>
<hr />
<h4 id="613-å¸¦èµ„æ ¼è¿¹çš„æ‰§è¡Œè€…--è¯„è®ºè€…æ–¹æ³•"><a class="header" href="#613-å¸¦èµ„æ ¼è¿¹çš„æ‰§è¡Œè€…--è¯„è®ºè€…æ–¹æ³•">6.1.3 å¸¦èµ„æ ¼è¿¹çš„æ‰§è¡Œè€… / è¯„è®ºè€…æ–¹æ³•</a></h4>
<p>æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å¼•å…¥äº†è‡ªç›Šï¼Œé‚£ä¹ˆå®ƒä¹Ÿå°±å¯ä»¥å¼•å…¥èµ„æ ¼è¿¹ï¼ç®—æ³• 6-4 ç»™å‡ºäº†å¸¦èµ„æ ¼è¿¹çš„ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼è¿™ä¸ªç®—æ³•é‡Œæœ‰ä¸¤ä¸ªèµ„æ ¼è¿¹ $\mathbf{z}^{(0)}$ å’Œ $\mathbf{z}^{(\mathbf{w})}$ ï¼Œå®ƒä»¬åˆ†åˆ«ä¸ç­–ç•¥å‚æ•° $\theta$ å’Œä»·å€¼å‚æ•° $\mathbf{w}$ å¯¹åº”ï¼Œå¹¶å¯ä»¥åˆ†åˆ«æœ‰è‡ªå·±çš„ $\lambda^{(\theta)}$ å’Œ $\lambda^{(\mathbf{w})}$ ï¼å…·ä½“è€Œè¨€ï¼Œ $\mathbf{z}^{(\mathbf{w})}$ ä¸ä»·å€¼å‚æ•° $\mathbf{w}$ å¯¹åº”ï¼Œè¿ç”¨æ¢¯åº¦ä¸º $\nabla v(S ; \mathbf{w})$ ï¼Œå‚æ•°ä¸º $\lambda^{(\mathbf{w})}$ çš„ç´¯ç§¯è¿¹ï¼› $\mathbf{z}^{(\mathbf{\theta})}$ ä¸ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ å¯¹åº”ï¼Œè¿ç”¨çš„æ¢¯åº¦æ˜¯ $\nabla \ln \pi(A|S ; \mathbf{w})$ å‚æ•°ä¸º $\lambda^{(\theta)}$ çš„ç´¯ç§¯è¿¹ï¼Œåœ¨è¿ç”¨ä¸­å¯ä»¥å°†æŠ˜æ‰£ $\gamma^{t}$ æ•´åˆåˆ°èµ„æ ¼è¿¹ä¸­ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-4</strong>ï¼š$\quad$ å¸¦èµ„æ ¼è¿¹çš„ä¼˜åŠ¿æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šèµ„æ ¼è¿¹å‚æ•° $\lambda^{(\theta)}, \lambda^{(\mathbf{w})}$ ï¼Œå­¦ä¹ ç‡ $\alpha^{(0)}, \alpha^{(\mathbf{w})}$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼ï¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–èµ„æ ¼è¿¹å’Œç´¯ç§¯æŠ˜æ‰£ï¼‰ $\mathbf{z}^{(\theta)} \leftarrow \mathbf{0}, \mathbf{z}^{(\mathbf{w})} \leftarrow \mathbf{0}, I \leftarrow 1$<br />
2.2 ï¼ˆå†³å®šåˆå§‹çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰ç”¨ $\pi(\cdot|S ï¼›\boldsymbol{\theta})$ å¾—åˆ°åŠ¨ä½œ $A$</li>
<li>ï¼ˆæ‰§è¡Œï¼‰æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œå¾—åˆ°å¥–åŠ± $R$ å’Œè§‚æµ‹ $S^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma v\left(S^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°ç­–ç•¥èµ„æ ¼è¿¹ï¼‰ $\mathbf{z}^{(\theta)} \leftarrow \gamma \lambda^{(\theta)} \mathbf{z}^{(\theta)}+I \nabla \ln \pi(A|S ; \mathbf{w})$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(0)}[U-v(S ; \mathbf{w})] \mathbf{z}^{(\theta)}$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼èµ„æ ¼è¿¹ï¼‰ $\mathbf{z}^{(\mathbf{w})} \leftarrow \gamma \lambda^{(\mathbf{w})} \mathbf{z}^{(\mathbf{w})}+\nabla v(S ; \mathbf{w})$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰ $\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}[U-v(S ; \mathbf{w})] \mathbf{z}^{(\mathbf{w})}$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow \gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰ $S \leftarrow S^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<h3 id="62-åŸºäºä»£ç†ä¼˜åŠ¿çš„åŒç­–ç®—æ³•"><a class="header" href="#62-åŸºäºä»£ç†ä¼˜åŠ¿çš„åŒç­–ç®—æ³•">6.2 åŸºäºä»£ç†ä¼˜åŠ¿çš„åŒç­–ç®—æ³•</a></h3>
<p>æœ¬èŠ‚ä»‹ç»é¢å‘ä»£ç†ä¼˜åŠ¿çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼è¿™äº›ç®—æ³•åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰ç›´æ¥ä¼˜åŒ–æœŸæœ›ç›®æ ‡ï¼Œè€Œæ˜¯è¯•å›¾ä¼˜åŒ–æœŸæœ›ç›®æ ‡è¿‘ä¼¼ä¸€ä»£ç†ä¼˜åŠ¿ï¼åœ¨å¾ˆå¤šé—®é¢˜ä¸Šï¼Œè¿™äº›ç®—æ³•ä¼šæ¯”ç®€å•çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å¾—åˆ°æ›´å¥½çš„æ€§èƒ½ï¼</p>
<h4 id="621-ä»£ç†ä¼˜åŠ¿"><a class="header" href="#621-ä»£ç†ä¼˜åŠ¿">6.2.1 ä»£ç†ä¼˜åŠ¿</a></h4>
<p>è€ƒè™‘é‡‡ç”¨è¿­ä»£çš„æ–¹æ³•æ›´æ–°ç­–ç•¥ $\pi(\boldsymbol{\theta})$ ï¼åœ¨æŸæ¬¡è¿­ä»£åï¼Œå¾—åˆ°äº†ç­–ç•¥ $\pi\left(\boldsymbol{\theta}<em>{k}\right)$ ï¼æ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„ç­–ç•¥ $\pi(\boldsymbol{\theta})$ ï¼Kakade ç­‰åœ¨æ–‡ç«  ã€Š Approximately optimal approximate reinforcement learning ã€‹ä¸­è¯æ˜äº†ç­–ç•¥ $\pi(\boldsymbol{\theta})$ å’Œç­–ç•¥ $\pi\left(\boldsymbol{\theta}</em>{k}\right)$ çš„æœŸæœ›å›æŠ¥æ»¡è¶³<strong>æ€§èƒ½å·®åˆ«å¼•ç†</strong> (Performance Difference Lemma):
$$
\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}<em>{\pi\left(\theta</em>{k}\right)}\left[G_{0}\right]+\mathrm{E}<em>{\pi(\theta)}\left[\sum</em>{t=0}^{+\infty} \gamma^{t} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]
$$
ï¼ˆè¯æ˜ï¼š
$$
\begin{array}{l}
\mathrm{E}<em>{\pi(\theta)}\left[\sum</em>{t=0}^{+\infty} \gamma^{t} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right] \
\quad=\mathrm{E}<em>{\pi(0)}\left[\sum</em>{t=0}^{+\infty} \gamma^{t}\left(R_{t+1}+\gamma v_{\pi\left(\theta_{k}\right)}\left(S_{t+1}\right)-v_{\pi\left(\theta_{k}\right)}\left(S_{t}\right)\right)\right] \
\quad=\mathrm{E}<em>{\pi(0)}\left[-v</em>{\pi\left(\theta_{k}\right)}\left(S_{0}\right)+\sum_{t=0}^{+\infty} \gamma^{t} R_{t+1}\right] \
\quad=-\mathrm{E}<em>{S</em>{0}}\left[v_{\pi\left(\theta_{k}\right)}\left(S_{0}\right)\right]+\mathrm{E}<em>{\pi(\theta)}\left[\sum</em>{t=0}^{+\infty} \gamma^{t} R_{t+1}\right] \
\quad=-\mathrm{E}<em>{\pi\left(\theta</em>{k}\right)}\left[G_{0}\right]+\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]
\end{array}
$$
å¾—è¯ï¼ï¼‰</p>
<p>æ‰€ä»¥ï¼Œè¦æœ€å¤§åŒ– $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ ï¼Œå°±æ˜¯è¦æœ€å¤§åŒ–ä¼˜åŠ¿çš„æœŸæœ› $\mathrm{E}<em>{\pi(\theta)}\left[\sum</em>{t=0}^{+\infty} \gamma^{t} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]$ ï¼è¿™ä¸ªæœŸæœ›æ˜¯å¯¹å«å‚ç­–ç•¥è€Œè¨€çš„ï¼è¦ä¼˜åŒ–è¿™æ ·çš„æœŸæœ›ï¼Œå¯ä»¥åˆ©ç”¨ä»¥ä¸‹å½¢å¼çš„é‡é‡‡æ ·ï¼Œå°†å…¶ä¸­å¯¹ $A_{t} \sim \pi(\boldsymbol{\theta})$ æ±‚æœŸæœ›è½¬åŒ–ä¸ºå¯¹ $A_{t} \sim \pi\left(\boldsymbol{\theta}<em>{k}\right)$ æ±‚æœŸæœ›ï¼š
$$
\mathrm{E}</em>{S_{t}, A_{t}\sim\pi(\theta)}\left[a_{\pi_{k}}\left(S_{t}, A_{t}\right)\right]=\mathrm{E}<em>{S</em>{t}\sim\pi(\theta), \mathcal{A}<em>t \sim \pi\left(\theta</em>{k}\right)}\left[\frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]
$$
ä½†æ˜¯ï¼Œå¯¹ $S_{t} \sim \pi(\boldsymbol{\theta})$ æ±‚æœŸæœ›æ— æ³•è¿›ä¸€æ­¥è½¬åŒ–ï¼<strong>ä»£ç†ä¼˜åŠ¿</strong>ï¼ˆ surrogate advantageï¼‰å°±æ˜¯åœ¨ä¸Šè¿°é‡é‡‡æ ·çš„åŸºç¡€ä¸Šï¼Œå°†å¯¹ $S_{t} \sim \pi(\boldsymbol{\theta})$ æ±‚æœŸæœ›è¿‘ä¼¼ä¸ºå¯¹ $S_{t} \sim \pi\left(\boldsymbol{\theta}<em>{k}\right)$ æ±‚æœŸæœ›ï¼š
$$
\mathrm{E}</em>{S_{t}, A_{t} \sim \pi(\theta)}\left[a_{\pi_{k}}\left(S_{t}, A_{t}\right)\right] \approx \mathrm{E}<em>{S</em>{t}, A_{t}\sim \pi\left(\theta_{k}\right)}\left[\frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]
$$
è¿™æ ·å¾—åˆ°äº† $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ çš„è¿‘ä¼¼è¡¨è¾¾å¼ $l(\boldsymbol{\theta})$ ï¼Œå…¶ä¸­
$$
l(\boldsymbol{\theta})=\mathrm{E}<em>{\pi\left(\theta</em>{k}\right)}\left[G_{0}\right]+\mathrm{E}<em>{S</em>{t}, \mathcal{A}<em>t \sim \pi\left(\theta</em>{k}\right)}\left[\sum_{t=0}^{+\infty} \gamma^{t} \frac{\pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)}{\pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}<em>{k}\right)} a</em>{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]
$$
å¯ä»¥è¯æ˜ï¼Œ $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ å’Œ $l(\boldsymbol{\theta})$ åœ¨ $\boldsymbol{\theta}=\boldsymbol{\theta}<em>{k}$ å¤„æœ‰ç›¸åŒçš„å€¼ $\mathrm{E}</em>{\pi\left(\theta_{k}\right)}\left[G_{0}\right]$ å’Œæ¢¯åº¦ï¼</p>
<p>è™½ç„¶ $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ æ²¡æœ‰ç›´æ¥çš„è¡¨è¾¾å¼è€Œå¾ˆéš¾ç›´æ¥ä¼˜åŒ–ï¼Œä½†æ˜¯åªè¦æ²¿ç€å®ƒçš„æ¢¯åº¦æ–¹å‘æ”¹è¿›ç­–ç•¥å‚æ•°ï¼Œå°±æœ‰æœºä¼šå¢å¤§å®ƒï¼ç”±äº $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ å’Œ $l(\boldsymbol{\theta})$ åœ¨ $\boldsymbol{\theta}=\boldsymbol{\theta}<em>{k}$ å¤„æœ‰ç€ç›¸åŒçš„å€¼å’Œæ¢¯åº¦æ–¹å‘ï¼Œ $\mathrm{E}</em>{\pi(\theta)}\left[G_{0}\right]$ å’Œä»£ç†ä¼˜åŠ¿æœ‰ç€ç›¸åŒçš„æ¢¯åº¦æ–¹å‘ï¼æ‰€ä»¥ï¼Œæ²¿ç€
$$
\mathrm{E}<em>{S</em>{t}, A_t\sim \pi\left(\theta_{k}\right)}\left[\sum_{t=0}^{+\infty} \gamma^{t} \frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{n\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right]
$$
çš„æ¢¯åº¦æ–¹å‘å°±æœ‰æœºä¼šæ”¹è¿› $\mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]$ ï¼æ®æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼šé€šè¿‡ä¼˜åŒ–ä»£ç†ä¼˜åŠ¿ï¼Œæœ‰å¸Œæœ›æ‰¾åˆ°æ›´å¥½çš„ç­–ç•¥ï¼</p>
<h4 id="622-é‚»è¿‘ç­–ç•¥ä¼˜åŒ–"><a class="header" href="#622-é‚»è¿‘ç­–ç•¥ä¼˜åŒ–">6.2.2 é‚»è¿‘ç­–ç•¥ä¼˜åŒ–</a></h4>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“ä»£ç†ä¼˜åŠ¿ä¸çœŸå®çš„ç›®æ ‡ç›¸æ¯”ï¼Œåœ¨ $\theta=\theta_{k}$ å¤„æœ‰ç›¸åŒçš„å€¼å’Œæ¢¯åº¦ï¼ä½†æ˜¯ï¼Œå¦‚æœ $\theta$ å’Œ $\theta_{k}$ å·®åˆ«è¾ƒè¿œï¼Œåˆ™è¿‘ä¼¼å°±ä¸å†æˆç«‹ï¼æ‰€ä»¥é’ˆå¯¹ä»£ç†ä¼˜åŠ¿çš„ä¼˜åŒ–ä¸èƒ½ç¦»åŸæœ‰çš„ç­–ç•¥å¤ªè¿œï¼åŸºäºè¿™ä¸€æ€æƒ³ï¼ŒJ. Schulman ç­‰åœ¨æ–‡ç«  ã€Š Proximal policy optimization algorithms ã€‹ä¸­æå‡ºäº†<strong>é‚»è¿‘ç­–ç•¥ä¼˜åŒ–</strong> (Proximal Policy Optimization) ç®—æ³•ï¼Œå°†ä¼˜åŒ–ç›®æ ‡è®¾è®¡ä¸º
$$
\mathrm{E}<em>{\pi\left(\theta</em>{k}\right)}\left[\min \left(\frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right), a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)+\varepsilon\left|a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right|\right)\right]
$$
å…¶ä¸­ $\varepsilon \in(0,1)$ æ˜¯æŒ‡å®šçš„å‚æ•°ï¼é‡‡ç”¨è¿™æ ·çš„ä¼˜åŒ–ç›®æ ‡åï¼Œä¼˜åŒ–ç›®æ ‡è‡³å¤šæ¯” $a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)$ å¤§ $\varepsilon\left|a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right|$ ï¼Œæ‰€ä»¥ä¼˜åŒ–é—®é¢˜å°±æ²¡æœ‰åŠ¨åŠ›è®©ä»£ç†ä¼˜åŠ¿ $\frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{2}\right)$ å˜å¾—éå¸¸å¤§ï¼Œå¯ä»¥é¿å…è¿­ä»£åçš„ç­–ç•¥ä¸è¿­ä»£å‰çš„ç­–ç•¥å·®è·è¿‡å¤§ï¼</p>
<p>ç®—æ³• 6-5 ç»™å‡ºäº†é‚»è¿‘ç­–ç•¥ä¼˜åŒ–ç®—æ³•çš„ç®€åŒ–ç‰ˆæœ¬ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-5</strong>ï¼š $\quad$ é‚»è¿‘ç­–ç•¥ä¼˜åŒ–ç®—æ³• (ç®€åŒ–ç‰ˆæœ¬ )</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šç­–ç•¥æ›´æ–°æ—¶ç›®æ ‡çš„é™åˆ¶å‚æ•° $\varepsilon(\varepsilon&gt;0)$ ï¼Œä¼˜åŒ–å™¨ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼</li>
<li>ï¼ˆæ—¶åºå·®åˆ†æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ç”¨ç­–ç•¥ $\pi(\boldsymbol{\theta})$ ç”Ÿæˆè½¨è¿¹<br />
2.2 ç”¨ç”Ÿæˆçš„è½¨è¿¹ç”± $\mathbf{w}$ ç¡®å®šçš„ä»·å€¼å‡½æ•°ä¼°è®¡ä¼˜åŠ¿å‡½æ•° $\left(\right.$ å¦‚ $a\left(S_{t}, A_{t}\right) \leftarrow \sum_{\tau=t}^{T-1}(\gamma \lambda)^{\tau-t}\left[U_{\tau: \tau+1}^{(v)}-\right.\left.\left.v\left(S_{\tau} ; \mathbf{w}\right)\right]\right)$<br />
2.3 ï¼ˆç­–ç•¥æ›´æ–°ï¼‰æ›´æ–° $\theta$ ä»¥å¢å¤§ $\min \left(\frac{\pi\left(A_{t}|S_{t} ; \theta\right)}{\pi\left(A_{t}|S_{t} ; \theta_{k}\right)} a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right), a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)+\varepsilon\left|a_{\pi\left(\theta_{k}\right)}\left(S_{t}, A_{t}\right)\right|\right)$<br />
2.4 ï¼ˆä»·å€¼æ›´æ–°ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å°ä»·å€¼å‡½æ•°çš„è¯¯å·®ï¼ˆå¦‚æœ€å°åŒ– $\left.\left[G_{t}-v\left(S_{t} ; \mathbf{w}\right)\right]^{2}\right)$</li>
</ol>
<hr />
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¸¸å¸¸åŠ äººç»éªŒå›æ”¾ï¼å…·ä½“çš„æ–¹æ³•æ˜¯ï¼Œæ¯æ¬¡æ›´æ–°ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ å’Œä»·å€¼å‚æ•° $\mathrm{w}$ å‰å¾—åˆ°å¤šä¸ªè½¨è¿¹ï¼Œä¸ºè¿™äº›è½¨è¿¹çš„æ¯ä¸€æ­¥ä¼°è®¡ä¼˜åŠ¿å’Œä»·å€¼ç›®æ ‡ï¼Œå¹¶å­˜å‚¨åœ¨ç»éªŒåº“ $\mathcal{D}$ ä¸­ï¼æ¥ç€å¤šæ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼šä»ç»éªŒåº“ $\mathcal{D}$ ä¸­æŠ½å–ä¸€æ‰¹ç»éªŒ $\mathcal{B}$ ï¼Œå¹¶åˆ©ç”¨è¿™æ‰¹ç»éªŒå›æ”¾å¹¶å­¦ä¹ ï¼Œå³ä»ç»éªŒåº“ä¸­éšæœºæŠ½å–ä¸€æ‰¹ç»éªŒå¹¶ç”¨è¿™æ‰¹ç»éªŒæ›´æ–°ç­–ç•¥å‚æ•°å’Œä»·å€¼å‚æ•°ï¼</p>
<blockquote>
<p>æ³¨æ„ï¼šé‚»è¿‘ç­–ç•¥ä¼˜åŒ–ç®—æ³•åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ç»éªŒéƒ½æ˜¯å½“å‰ç­–ç•¥äº§ç”Ÿçš„ç»éªŒï¼Œæ‰€ä»¥ä½¿ç”¨äº†ç»éªŒå›æ”¾çš„é‚»è¿‘ç­–ç•¥ä¼˜åŒ–ä¾ç„¶æ˜¯åŒç­–å­¦ä¹ ç®—æ³•ï¼</p>
</blockquote>
<h3 id="63-ä¿¡ä»»åŸŸç®—æ³•"><a class="header" href="#63-ä¿¡ä»»åŸŸç®—æ³•">6.3 ä¿¡ä»»åŸŸç®—æ³•</a></h3>
<p><strong>ä¿¡ä»»åŸŸæ–¹æ³•</strong>ï¼ˆTrust Region Method, TRMï¼‰æ˜¯æ±‚è§£éçº¿æ€§ä¼˜åŒ–çš„å¸¸ç”¨æ–¹æ³•ï¼Œå®ƒå°†ä¸€ä¸ªå¤æ‚çš„ä¼˜åŒ–é—®é¢˜è¿‘ä¼¼ä¸ºç®€å•çš„ä¿¡ä»»åŸŸå­é—®é¢˜å†è¿›è¡Œæ±‚è§£ï¼</p>
<p>æœ¬èŠ‚å°†ä»‹ç»ä¸‰ç§åŒç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼š</p>
<ul>
<li>è‡ªç„¶ç­–ç•¥æ¢¯åº¦ç®—æ³•</li>
<li>ä¿¡ä»»åŸŸç­–ç•¥ä¼˜åŒ–ç®—æ³•</li>
<li>Kronecker å› å­ä¿¡ä»»åŸŸæ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</li>
</ul>
<p>è¿™ä¸‰ä¸ªç®—æ³•ååˆ†æ¥è¿‘ï¼Œå®ƒä»¬éƒ½æ˜¯ä»¥è¯•å›¾é€šè¿‡ä¼˜åŒ–ä»£ç†ä¼˜åŠ¿ï¼Œè¿­ä»£æ›´æ–°ç­–ç•¥å‚æ•°ï¼Œè¿›è€Œæ‰¾åˆ°æœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ï¼åœ¨ä¼˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿéœ€è¦è®©æ–°çš„ç­–ç•¥å’Œæ—§çš„ç­–ç•¥ä¸èƒ½ç›¸å·®å¤ªè¿œï¼å’Œä¸ŠèŠ‚ä»‹ç»çš„é‚»è¿‘ç­–ç•¥ä¼˜åŒ–ç›¸æ¯”ï¼Œå®ƒä»¬åœ¨ä»£ç†ä¼˜åŠ¿çš„åŸºç¡€ä¸Šå¯ä»¥è¿›ä¸€æ­¥å¼•å…¥ä¿¡ä»»åŸŸï¼Œè¦æ±‚æ–°çš„ç­–ç•¥åœ¨ä¸€ä¸ªä¿¡ä»»åŸŸå†…ï¼æœ¬èŠ‚å°†ä»‹ç»ä¿¡ä»»åŸŸçš„å®šä¹‰ï¼ˆåŒ…æ‹¬ç”¨æ¥å®šä¹‰ä¿¡ä»»åŸŸçš„ $\mathrm{KL}$ æ•£åº¦çš„å®šä¹‰ï¼‰ï¼Œå†ä»‹ç»å¦‚ä½•åˆ©ç”¨ä¿¡ä»»åŸŸå®ç°è¿™äº›ç®—æ³•ï¼</p>
<h4 id="631-kl-æ•£åº¦"><a class="header" href="#631-kl-æ•£åº¦">6.3.1 KL æ•£åº¦</a></h4>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ $\mathrm{KL}$ æ•£åº¦çš„å®šä¹‰ï¼å›é¡¾é‡è¦æ€§é‡‡æ ·çš„ç« èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸¤ä¸ªåˆ†å¸ƒ $p(x)(x \in \mathcal{X})$ å’Œ $q(x)(x \in \mathcal{X})$ ï¼Œæ»¡è¶³å¯¹äºä»»æ„çš„ $p(x)&gt;0$ ï¼Œå‡æœ‰ $q(x)&gt;0$ ï¼Œåˆ™ç§°åˆ†å¸ƒ $p$ å¯¹ åˆ†å¸ƒ $q$ ç»å¯¹è¿ç»­ï¼Œè®°ä¸º $p \ll q$ ï¼åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä»åˆ†å¸ƒ $q$ åˆ°åˆ†å¸ƒ $p$ çš„ KL æ•£åº¦ (Kullback-Leibler divergence)ï¼š
$$
d_{\mathrm{KL}}(p | q)=\mathrm{E}<em>{X \sim p}\left[\ln \frac{p(X)}{q(X)}\right]
$$
å½“$p$ å’Œ $q$ æ˜¯ç¦»æ•£åˆ†å¸ƒæ—¶ï¼Œ
$$
d</em>{\mathrm{KL}}(p | q)=\sum_{x} p(x) \ln \frac{p(x)}{q(x)}
$$
å½“ $p$ å’Œ $q$ æ˜¯è¿ç»­åˆ†å¸ƒæ—¶ï¼Œ
$$
d_{\mathrm{KL}}(p | q)=\int_{x} p(x) \ln \frac{p(x)}{q(x)} \mathrm{d} x
$$
$\mathrm{KL}$ æ•£åº¦æœ‰ä¸ªæ€§è´¨ï¼šç›¸åŒåˆ†å¸ƒçš„ $\mathrm{KL}$ æ•£åº¦ä¸º 0 ï¼Œå³ $d_{\mathrm{KL}}(p | p)=0$ ï¼</p>
<p>TODO:ä¿¡ä»»åŸŸA-Cç®—æ³•</p>
<h4 id="é‡è¦æ€§é‡‡æ ·å¼‚ç­–æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#é‡è¦æ€§é‡‡æ ·å¼‚ç­–æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">é‡è¦æ€§é‡‡æ ·å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h4>
<p>æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å¯ä»¥å’Œé‡è¦æ€§é‡‡æ ·ç»“åˆï¼Œå¾—åˆ°å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼æœ¬èŠ‚ä»‹ç»åŸºäºé‡è¦æ€§é‡‡æ ·çš„å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼</p>
<h4 id="641-åŸºæœ¬çš„å¼‚ç­–ç®—æ³•"><a class="header" href="#641-åŸºæœ¬çš„å¼‚ç­–ç®—æ³•">6.4.1 åŸºæœ¬çš„å¼‚ç­–ç®—æ³•</a></h4>
<p>æœ¬èŠ‚ä»‹ç»åŸºäºé‡è¦æ€§é‡‡æ ·çš„<strong>å¼‚ç­–çš„æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•</strong>ï¼ˆOff-Policy Actor-Critic, OffPAC )ï¼</p>
<p>ç”¨ $b(\cdot|\cdot)$ è¡¨ç¤ºè¡Œä¸ºç­–ç•¥ï¼Œåˆ™æ¢¯åº¦æ–¹å‘å¯ç”± $\mathrm{E}<em>{\pi(\theta)}\left[\Psi</em>{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ å˜ä¸º $\mathrm{E}<em>{b}\left[\frac{\pi\left(A</em>{t}|S_{t} ; \theta\right)}{b\left(A_{t}|S_{t}\right)}\right.\left.\Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]=\mathrm{E}<em>{b}\left[\frac{1}{b\left(A</em>{t}|S_{t}\right)} \Psi_{t} \nabla \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ ï¼è¿™æ—¶ï¼Œæ›´æ–°ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ æ—¶å°±åº”è¯¥è¯•å›¾å‡å°
$-\frac{1}{b\left(A_{t}|S_{t}\right)} \Psi_{t} \nabla \pi\left(A_{t}|S_{t} ; \theta\right)$ ï¼æ®æ­¤ï¼Œå¯ä»¥å¾—åˆ°å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼Œè§ç®—æ³• 6-10ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 8-10</strong>ï¼š$\quad$ å¼‚ç­–åŠ¨ä½œä»·å€¼æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šä¼˜åŒ–å™¨ï¼ˆéšå«å­¦ä¹ ç‡ $\left.\alpha^{(\theta)}, \alpha^{(\mathbf{w})}\right)$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta \leftarrow}$ ä»»æ„å€¼ï¼Œ $\boldsymbol{W \leftarrow}$ ä»»æ„å€¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow 1$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œç”¨è¡Œä¸ºç­–ç•¥ $b(.|S)$ å¾—åˆ°åŠ¨ä½œ $A$<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ®çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$ å¾—åˆ°é‡‡æ · $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆæ‰§è¡Œï¼‰ç”¨ $b\left(\cdot|S^{\prime}\right)$ å¾—åˆ°åŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ›´æ–° $\theta$ ä»¥å‡å° $-\frac{1}{b(A|S)} I q(S, A ; \mathbf{w}) \pi(A|S ; \theta) \quad\left(\right.$ å¦‚ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} I \frac{1}{b(A|S)}q(S, A ; \mathbf{w}) \nabla \pi(A|S ; \boldsymbol{\theta}))$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\frac{\pi(A|S ; \boldsymbol{\theta})}{b(A|S)}[U-q(S, A ; \mathbf{w})]^{2}\left(\right.$ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(w)} \frac{\pi(A|S ; \boldsymbol{\theta})}{b(A|S)}\right)[U-q(S, A ; \mathbf{w})] \nabla q(S, A ; \mathbf{w})$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰$I\leftarrow\gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰ $S \leftarrow S^{\prime}, A \leftarrow A^{\prime}$</li>
</ol>
</li>
</ol>
<hr />
<h4 id="642-å¸¦ç»éªŒå›æ”¾çš„å¼‚ç­–ç®—æ³•"><a class="header" href="#642-å¸¦ç»éªŒå›æ”¾çš„å¼‚ç­–ç®—æ³•">6.4.2 å¸¦ç»éªŒå›æ”¾çš„å¼‚ç­–ç®—æ³•</a></h4>
<p>æœ¬èŠ‚ä»‹ç» $\mathrm{Z} .$ Wang ç­‰åœ¨æ–‡ç«  ã€Š Sample efficient actor-critic with experience replayã€‹ä¸­æå‡ºçš„<strong>å¸¦ç»éªŒå›æ”¾çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</strong> ( Actor-Critic with Experiment Replay, $\mathrm{ACER})$ ï¼å¦‚æœè¯´ $6.4.1$ èŠ‚ä»‹ç»çš„åŸºæœ¬å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•æ˜¯ $6.1.1$ èŠ‚ä»‹ç»çš„åŸºæœ¬åŒç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•çš„å¼‚ç­–ç‰ˆæœ¬ï¼Œé‚£ä¹ˆæœ¬èŠ‚ä»‹ç»çš„å¸¦ç»éªŒå›æ”¾çš„å¼‚ç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å°±ç›¸å½“äº $6.1.2$ èŠ‚ä»‹ç»çš„ $\mathrm{A} 3 \mathrm{C}$ ç®—æ³•çš„å¼‚ç­–ç‰ˆæœ¬ï¼å®ƒåŒæ ·å¯ä»¥æ”¯æŒå¤šä¸ªçº¿ç¨‹çš„å¼‚æ­¥å­¦ä¹ ï¼šæ¯ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå‰å…ˆåŒæ­¥å…¨å±€å‚æ•°ï¼Œç„¶åç‹¬ç«‹æ‰§è¡Œå’Œå­¦ä¹ ï¼Œå†åˆ©ç”¨å­¦åˆ°çš„æ¢¯åº¦æ–¹å‘è¿›è¡Œå…¨å±€æ›´æ–°ï¼</p>
<p>6.1.2 èŠ‚ä¸­ä»‹ç»çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•æ˜¯åŸºäºæ•´ä¸ªè½¨è¿¹è¿›è¡Œæ›´æ–°çš„ï¼å¯¹äºå¼•å…¥è¡Œä¸ºç­–ç•¥å’Œé‡é‡‡æ ·åï¼Œå¯¹äºç›®æ ‡ $U_{t}$ çš„é‡é‡‡æ ·ç³»æ•°å˜ä¸º $\prod_{\tau=0}^{t} \rho_{\tau}$, å…¶ä¸­ $\rho_{\tau}=\frac{\pi\left(A_{\tau}|S_{\tau} ; \theta\right)}{b\left(A_{\tau}|S_{\tau}\right)}$ ï¼åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œæ¯ä¸ª $\rho_{\tau}$ éƒ½æœ‰æ¯”è¾ƒå¤§çš„æ–¹å·®ï¼Œæœ€ç»ˆä¹˜ç§¯å¾—åˆ°çš„æ–¹å·®ä¼šç‰¹åˆ«å¤§ï¼ä¸€ç§é™åˆ¶æ–¹å·®çš„æ–¹æ³•æ˜¯æ§åˆ¶é‡é‡‡æ ·æ¯”ä¾‹çš„èŒƒå›´ï¼Œä¾‹å¦‚ç»™å®šä¸€ä¸ªå¸¸æ•° $c$ ï¼Œå°†é‡é‡‡æ ·æ¯”ä¾‹æˆªæ–­ä¸º $\min \left{\rho_{\tau}, c\right}$ ï¼ä½†æ˜¯ï¼Œå¦‚æœç›´æ¥å°†æ¢¯åº¦æ–¹å‘ä¸­çš„é‡é‡‡æ ·ç³»æ•°è¿›è¡Œæˆªæ–­ï¼ˆä¾‹å¦‚ä» $\mathrm{E}<em>{b}\left[\rho</em>{t} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]$ ä¿®æ”¹ä¸º
$\mathrm{E}<em>{b}\left[\min \left{\rho</em>{t}, c\right} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ ï¼‰ï¼Œä¼šå¸¦æ¥åå·®ï¼è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å†åŠ ä¸€é¡¹æ¥å¼¥è¡¥è¿™ä¸ªåå·®ï¼åˆ©ç”¨æ’ç­‰å¼ $\rho=\min {\rho, c}+\max {\rho-c, 0}$ ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¢¯åº¦ $\mathrm{E}<em>{b}\left[\rho</em>{t} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ æ‹†æˆä»¥ä¸‹ä¸¤é¡¹:
$\mathrm{E}<em>{b}\left[\min \left{\rho</em>{t}, c\right} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]:$ æœŸæœ›é’ˆå¯¹è¡Œä¸ºç­–ç•¥ $b$ ï¼Œæ­¤é¡¹æ–¹å·®æ˜¯å¯æ§çš„ï¼›
$\mathrm{E}<em>{b}\left[\max \left{\rho</em>{t}-c, 0\right} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right]$ å³ $\mathrm{E}<em>{\pi(\theta)}\left[\max \left{1-c / \rho</em>{t}, 0\right} \Psi_{t} \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right)\right]:$ é‡‡ç”¨é’ˆå¯¹åŸæœ‰ç›®æ ‡ç­–ç•¥ $\pi(\boldsymbol{\theta})$ çš„æœŸæœ›åï¼Œ $\max \left{1-c / \rho_{t}, 0\right}$ ä¹Ÿæ˜¯æœ‰ç•Œçš„ (å³ $\max \left{1-c / \rho_{t}, 0\right} \leqslant 1$ )ï¼</p>
<p>é‡‡ç”¨è¿™æ ·çš„æ‹†åˆ†åï¼Œä¸¤é¡¹çš„æ–¹å·®éƒ½æ˜¯å¯æ§çš„ï¼ä½†æ˜¯ï¼Œè¿™ä¸¤é¡¹ä¸­å…¶ä¸­ä¸€é¡¹é’ˆå¯¹çš„æ˜¯è¡Œä¸ºç­–ç•¥ï¼Œå¦å¤–ä¸€é¡¹é’ˆå¯¹çš„æ˜¯åŸç­–ç•¥ï¼Œè¿™å°±è¦æ±‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å…¼é¡¾è¿™ä¸¤ç§ç­–ç•¥ï¼</p>
<p>å¾—åˆ°æ¢¯åº¦æ–¹å‘åï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹è¿™ä¸ªæ¢¯åº¦æ–¹å‘åšä¿®æ­£ï¼Œä»¥å…è¶…å‡ºèŒƒå›´ï¼ä¸ºæ­¤ï¼Œç”¨ $\mathrm{KL}$ æ•£åº¦å¢åŠ äº†çº¦æŸã€‚è®°åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ç­–ç•¥å‚æ•°çš„æŒ‡æ•°æ»‘åŠ¨å¹³å‡å€¼ä¸º $\theta^{\mathrm{EMA}}$ ï¼Œå¯¹åº”çš„å¹³å‡ç­–ç•¥ä¸º $\pi\left(\mathbf{\theta}^{\mathrm{EMA}}\right)$ ï¼æˆ‘
ä»¬å¯ä»¥å¸Œæœ›è¿­ä»£å¾—åˆ°çš„æ–°ç­–ç•¥å‚æ•°ä¸è¦ä¸è¿™ä¸ªå¹³å‡ç­–ç•¥ $\pi\left(\mathbf{\theta}^{\mathrm{EMA}}\right)$ å‚æ•°å·®åˆ«å¤ªå¤§ï¼æ‰€ä»¥ï¼Œå¯ä»¥é™å®šè¿™ä¸¤ä¸ªç­–ç•¥åœ¨å½“å‰çŠ¶æ€ $S_{t}$ ä¸‹çš„åŠ¨ä½œåˆ†å¸ƒä¸è¦å·®åˆ«å¤ªå¤§ï¼è€ƒè™‘åˆ° KL æ•£åº¦å¯ä»¥åˆ»ç”»ä¸¤ä¸ªåˆ†å¸ƒç›´æ¥çš„å·®åˆ«ï¼Œæ‰€ä»¥å¯ä»¥é™å®šæ–°å¾—åˆ°çš„æ¢¯åº¦æ–¹å‘ï¼ˆè®°ä¸º $\mathbf{z}<em>{t}$ ) ä¸ $\nabla</em>{\theta} d_{\mathrm{KL}}\left(\pi\left(\cdot|S_{t} ; \boldsymbol{\theta}^{\mathrm{EMA}}\right) | \pi\left(\cdot|S_{t} ; \boldsymbol{\theta}\right)\right)$ çš„å†…ç§¯ä¸è¦å¤ªå¤§ï¼å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ $\nabla_{\theta} d_{\mathrm{KL}}\left(\pi\left(\cdot|S_{t} ; \theta^{\mathrm{EMA}}\right) | \pi\left(\cdot|S_{t} ; \boldsymbol{\theta}\right)\right)$ å®é™…ä¸Šæœ‰å’Œé‡é‡‡æ ·æ¯”ä¾‹ç±»ä¼¼çš„å½¢å¼ï¼š
$$
\begin{aligned}
\nabla_{\theta} &amp; d_{\mathrm{KL}}\left(\pi\left(\cdot|S_{t} ; \theta^{\mathrm{EMA}}\right) | \pi\left(\cdot|S_{t} ; \theta\right)\right) \
&amp;=\nabla_{\theta} \sum_{a} \pi\left(a|S_{t} ; \theta^{\mathrm{EMA}}\right) \ln \frac{\pi\left(a|S_{t} ; \theta^{\mathrm{EMA}}\right)}{\pi\left(a|S_{t} ; \theta\right)} \
&amp;=-\nabla_{\theta} \sum_{a} \pi\left(a|S_{t} ; \theta^{\mathrm{EMA}}\right) \ln \pi\left(a|S_{t} ; \boldsymbol{\theta}\right) \
&amp;=-\sum_{a} \frac{\pi\left(a|S_{t} ; \theta^{\mathrm{EMA}}\right)}{\pi\left(a|S_{t} ; \theta\right)} \nabla_{\theta} \pi\left(a|S_{t} ; \boldsymbol{\theta}\right)
\end{aligned}
$$
è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç¡®å®šæ–°çš„æ¢¯åº¦æ–¹å‘çš„ä¼˜åŒ–é—®é¢˜ï¼è®°æ–°çš„æ¢¯åº¦æ–¹å‘ä¸º $\mathbf{z}<em>{t}$ ï¼Œå®šä¹‰
$$
\begin{array}{l}
\mathbf{g}</em>{t}=\min \left{\rho_{t}, c\right}\left(U_{t}-v\left(S_{t} ; \mathbf{w}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \theta\right) \
\quad+E_{A_t \sim \pi(\theta)}\left[\max \left{1-\frac{\rho_{t}}{c}\right}\left(q\left(S_{t}, A_{t} ; \mathbf{w}\right)-v\left(S_{t} ; \mathbf{w}\right)\right) \nabla \ln \pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}\right)\right] \
\mathbf{k}<em>{t}=\nabla</em>{\theta} d_{\mathrm{KL}}\left(\pi\left(\cdot|S_{t} ; \boldsymbol{\theta}^{\mathrm{EMA}}\right) | \pi\left(\cdot|S_{t} ; \boldsymbol{\theta}\right)\right)
\end{array}
$$
æˆ‘ä»¬ä¸€æ–¹é¢å¸Œæœ›æ–°çš„æ¢¯åº¦æ–¹å‘ $\mathbf{z}<em>{t}$ è¦å’Œ $\mathbf{g}</em>{t}$ å°½é‡æ¥è¿‘ï¼Œå¦å¤–ä¸€æ–¹é¢è¦æ»¡è¶³ $\mathbf{k}<em>{t}^{\mathrm{T}}\mathbf{z}<em>t$ ï¼Œä¸è¶…è¿‡ä¸€ä¸ªç»™å®šçš„å‚æ•° $\delta$ ï¼è¿™æ ·è¿™ä¸ªä¼˜åŒ–é—®é¢˜ä¸º
$$
\begin{array}{ll}
\text { minimize } &amp; \frac{1}{2}\left|\mathbf{g}</em>{t}-\mathbf{z}\right|</em>{2}^{2} \
\text { over } &amp; \mathbf{z} \
\text { s.t. } &amp; \mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{z} \leqslant \delta ï¼
\end{array}
$$
æ¥ä¸‹æ¥æ±‚è§£è¿™ä¸ªä¼˜åŒ–é—®é¢˜ï¼ä½¿ç”¨ Lagrange ä¹˜å­æ³•ï¼Œæ„é€ å‡½æ•°ï¼š
$$
l(\mathbf{z}, \lambda)=\frac{1}{2}\left|\mathbf{g}</em>{t}-\mathbf{z}\right|<em>{2}^{2}+\lambda\left(\mathbf{k}</em>{t}^{\mathrm{T}} \mathbf{z}-\delta\right)
$$
å°†å‰å¼ä»£äººåå¼å¯å¾— $\lambda_{t}=\frac{\mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{g}</em>{t}-\delta}{\mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{k}</em>{t}}$ ï¼ç”±äº Lagrange ä¹˜å­åº”å¤§ç­‰äº 0 ï¼Œæ‰€ä»¥ï¼ŒLagrange ä¹˜å­åº”ä¸º $\max \left{\frac{\mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{g}</em>{t}-\delta}{\mathbf{k}<em>{t}^{T} \mathbf{k}</em>{t}}, 0\right}$ ï¼Œä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£ä¸º
$$
\mathbf{z}<em>{t}=\mathbf{g}</em>{t}-\max \left{\frac{\mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{g}</em>{t}-\delta}{\mathbf{k}<em>{t}^{\mathrm{T}} \mathbf{k}</em>{t}}, 0\right} \mathbf{k}<em>{t}
$$
è¿™ä¸ªæ–¹å‘æ‰æ˜¯æˆ‘ä»¬çœŸæ­£è¦ç”¨çš„æ¢¯åº¦æ–¹å‘ï¼ç»¼åˆä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¸¦ç»éªŒå›æ”¾çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•çš„ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼è¿™ä¸ªç®—æ³•å¯ä»¥æœ‰ä¸€ä¸ªå›æ”¾å› å­ï¼Œå¯ä»¥æ§åˆ¶æ¯æ¬¡è¿è¡Œå¾—åˆ°çš„ç»éªŒå¯ä»¥å›æ”¾å¤šå°‘æ¬¡ï¼ç®—æ³• 6-11 ç»™å‡ºäº†ç»éªŒå›æ”¾çš„çº¿ç¨‹çš„ç®—æ³•ï¼å¯¹äºç»éªŒå›æ”¾çš„çº¿ç¨‹æ‰€å›æ”¾çš„ç»éªŒæ˜¯ä»å…¶ä»–çº¿ç¨‹å·²ç»æ‰§è¡Œè¿‡çš„çº¿ç¨‹ç”Ÿæˆå¹¶å­˜å‚¨çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨ç®—æ³• 6-11 ä¸­æ²¡æœ‰å±•ç¤ºï¼Œä½†æ˜¯æ˜¯è¿™ä¸ªç®—æ³•å¿…éœ€çš„ï¼åœ¨å­˜å‚¨å’Œå›æ”¾çš„æ—¶å€™ï¼Œä¸ä»…è¦å­˜å‚¨å’Œå›æ”¾çŠ¶æ€ $S</em>{t}$, åŠ¨ä½œ $A_{t}$ ã€å¥–åŠ± $R_{t+1}$ ç­‰ï¼Œè¿˜éœ€è¦å­˜å‚¨å’Œå›æ”¾åœ¨çŠ¶æ€ $S_{t}$ äº§ç”ŸåŠ¨ä½œ $A_{t}$ çš„æ¦‚ç‡ $b\left(A_{t}|S_{t}\right)$ ï¼æœ‰äº†è¿™ä¸ªæ¦‚ç‡å€¼ï¼Œæ‰èƒ½è®¡ç®—é‡é‡‡æ ·ç³»æ•°ï¼åœ¨ä»·å€¼ç½‘ç»œçš„è®¾è®¡æ–¹é¢ï¼Œåªç»´æŠ¤åŠ¨ä½œä»·å€¼ç½‘ç»œï¼åœ¨éœ€è¦çŠ¶æ€ä»·å€¼çš„ä¼°è®¡æ—¶ï¼Œç”±åŠ¨ä½œä»·å€¼ç½‘ç»œè®¡ç®—å¾—åˆ°ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 6-11</strong>ï¼š$\quad$ å¸¦ç»éªŒå›æ”¾çš„æ‰§è¡Œè€… / è¯„
è®ºè€…ç®—æ³• (å¼‚ç­–ç®€åŒ–ç‰ˆæœ¬)</p>
</blockquote>
<hr />
<p>å‚æ•°: å­¦ä¹ ç‡ $\alpha^{(\theta)}, \alpha^{(\mathrm{w})}$ ï¼ŒæŒ‡æ•°æ»‘åŠ¨å¹³å‡ç³»æ•° $\alpha^{\mathrm{EMA}}$ ï¼Œé‡é‡‡æ ·å› å­æˆªæ–­ç³»æ•° $c$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåŒæ­¥å…¨å±€å‚æ•°ï¼‰ $\boldsymbol{\theta}^{\prime} \leftarrow \boldsymbol{\theta}, \quad \mathbf{w}^{\prime} \leftarrow \mathbf{w}$</li>
<li>ï¼ˆç»éªŒå›æ”¾ï¼‰å›æ”¾å­˜å‚¨çš„ç»éªŒè½¨è¿¹ $S_{0}, A_{0}, R_{1}, S_{1}, \ldots, S_{T-1}, A_{T-1}, R_{T}, S_{T}$ ï¼Œä»¥åŠç»éªŒå¯¹åº”çš„è¡Œä¸ºç­–ç•¥æ¦‚ç‡ $b\left(A_{t}|S_{t}\right)(t=0,1, \ldots)$</li>
<li>æ¢¯åº¦ä¼°è®¡<br />
3.1 ä¸ºæ¢¯åº¦è®¡ç®—åˆå§‹åŒ–:
<ol>
<li>ï¼ˆåˆå§‹åŒ–ç›®æ ‡ $U_{T}$ ï¼‰è‹¥ $S_{T}$ æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ $U \leftarrow 0$ ï¼›å¦åˆ™ $U \leftarrow \sum_{a} \pi\left(a|S_{t} ; \boldsymbol{\theta}^{\prime}\right)q\left(S_{t}, a ; \mathbf{w}^{\prime}\right)$</li>
<li>ï¼ˆåˆå§‹åŒ–æ¢¯åº¦ï¼‰ $\mathrm{g}^{(\mathrm{w})} \leftarrow \mathbf{0}, \mathrm{g}^{(0)} \leftarrow \mathbf{0}$<br />
3.2 ï¼ˆå¼‚æ­¥è®¡ç®—æ¢¯åº¦ï¼‰ å¯¹ $t=T-1, T-2, \ldots, 0$ ï¼Œæ‰§è¡Œä»¥ä¸‹å†…å®¹:</li>
</ol>
<ul>
<li>ï¼ˆä¼°è®¡ç›®æ ‡ï¼‰è®¡ç®— $U \leftarrow \gamma U+R_{t+1}$</li>
<li>ï¼ˆä¼°è®¡ä»·å€¼æ¢¯åº¦æ–¹å‘ï¼‰ $\mathbf{g}^{(\mathbf{w})} \leftarrow \mathbf{g}^{(\mathbf{w})}+\left[U-q\left(S_{t}, A_{t} ; \mathbf{w}^{\prime}\right)\right] \nabla q\left(S_{t}, A_{t} ; \mathbf{w}^{\prime}\right)$</li>
<li>ï¼ˆä¼°è®¡ç­–ç•¥æ¢¯åº¦æ–¹å‘ï¼‰è®¡ç®—åŠ¨ä½œä»·å€¼ $V \leftarrow \sum_{a} \pi\left(a|S_{t} ; \boldsymbol{\theta}^{\prime}\right) q\left(S_{t}, a ; \mathbf{w}^{\prime}\right)$ ï¼Œé‡é‡‡æ ·ç³»æ•° $\rho \leftarrow \frac{\pi\left(A_{t}|S_{t} ; \boldsymbol{\theta}^{\prime}\right)}{b\left(A_{t}|S_{t}\right)}, \quad$ ä»¥åŠ $\mathbf{g}, \quad \mathbf{k} \leftarrow \nabla_{\mathbf{\theta}} d_{\mathrm{KL}}\left(\pi\left(\cdot|S_{t} ; \boldsymbol{\theta}^{\mathrm{EMA}}\right) | \pi\left(\cdot|S_{t} ; \boldsymbol{\theta}^{\prime}\right)\right), \quad \mathbf{z} \leftarrow \mathbf{g}-\max \left{\frac{\mathbf{k}^{\mathrm{T}} \mathbf{g}-\delta}{\mathbf{k}^{\mathrm{T}} \mathbf{k}}, 0\right} \mathbf{k} .\mathbf{g}^{(\theta)} \leftarrow \mathbf{g}^{(\theta)}+\mathbf{z}$</li>
<li>ï¼ˆæ›´æ–°å›æº¯ç›®æ ‡ï¼‰ $U \leftarrow \min {\rho, 1}\left[U-q\left(S_{t}, A_{t} ; \mathbf{w}^{\prime}\right)\right]+V$</li>
</ul>
</li>
<li>ï¼ˆåŒæ­¥æ›´æ–°ï¼‰æ›´æ–°å…¨å±€å‚æ•°ï¼<br />
4.1 ï¼ˆä»·å€¼æ›´æ–°ï¼‰ $\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})} \mathbf{g}^{(\mathbf{w})}$<br />
4.2 ï¼ˆç­–ç•¥æ›´æ–°ï¼‰ $\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} \mathbf{g}^{(\theta)}$<br />
4.3 ï¼ˆæ›´æ–°å¹³å‡ç­–ç•¥ï¼‰ $\theta^{\mathrm{EMA}} \leftarrow\left(1-\alpha^{\mathrm{EMA}}\right) \theta^{\mathrm{EMA}}+\alpha^{\mathrm{EMA}} \boldsymbol{\theta}$</li>
</ol>
<hr />
<p>TODO:æŸ”æ€§A-C</p>
<h2 id="ä¸ƒ-è¿ç»­åŠ¨ä½œç©ºé—´çš„ç¡®å®šæ€§ç­–ç•¥"><a class="header" href="#ä¸ƒ-è¿ç»­åŠ¨ä½œç©ºé—´çš„ç¡®å®šæ€§ç­–ç•¥">ä¸ƒï¼ è¿ç»­åŠ¨ä½œç©ºé—´çš„ç¡®å®šæ€§ç­–ç•¥</a></h2>
<p>ç®€å•æ˜“æ‡‚ï¼š<a href="https://www.bilibili.com/video/BV1rv41167yx?t=53">bç«™æ¬è¿ShuSenWangæ•™ç¨‹</a></p>
<blockquote>
<p><strong>å¦‚ä½•ç†è§£</strong>ï¼šä¸¤ä¸ªç½‘ç»œï¼šç­–ç•¥ç½‘ç»œä¸ä»·å€¼å‡½æ•°ç½‘ç»œ( $q$ å‡½æ•° ) ï¼Œ$t$ æ—¶åˆ»ï¼Œå…ˆåˆ©ç”¨ç­–ç•¥æ—¶åºå·®åˆ†åœ°æ›´æ–°ä»·å€¼å‡½æ•°ï¼Œå†æ›´æ–°ç­–ç•¥ç½‘ç»œï¼Œç­–ç•¥ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™æƒ³æ³•æ˜¯ï¼šå‚æ•°æœç€ä½¿ $q$ å‡½æ•°å¢å¤§çš„æ–¹å‘èµ°ï¼Œå³ $q$ å‡½æ•°å…³äºç­–ç•¥ç½‘ç»œçš„å‚æ•°æ±‚æ¢¯åº¦ï¼Œæ‰€ä»¥æœ€åæ¨å¾—çš„å…³ç³»å¼ç­–ç•¥ç½‘ç»œçš„æ›´æ–°å¼å½¢å¼ä¸ºè¿å¼æ³•åˆ™çš„æ ·å­ $\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\sum_{t=0}^{+\infty} \gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{\alpha} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}\right]$ï¼</p>
</blockquote>
<p>æœ¬ç« ä»‹ç»åœ¨è¿ç»­åŠ¨ä½œç©ºé—´é‡Œçš„ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼åœ¨è¿ç»­çš„åŠ¨ä½œç©ºé—´ä¸­ï¼ŒåŠ¨ä½œçš„ä¸ªæ•°æ˜¯æ— ç©·å¤§çš„ï¼å¦‚æœé‡‡ç”¨å¸¸è§„æ–¹æ³•ï¼Œéœ€è¦è®¡ç®— $\max _{a} q(s, a ; \boldsymbol{\theta})$ ï¼è€Œå¯¹äºæ— ç©·å¤šçš„åŠ¨ä½œï¼Œæœ€å¤§å€¼å¾€å¾€å¾ˆéš¾æ±‚å¾—ï¼ä¸ºæ­¤ï¼ŒD. Silver ç­‰äººåœ¨æ–‡ç« ã€Š Deterministic Policy Gradient Algorithms ã€‹ä¸­æå‡ºäº†ç¡®å®šæ€§ç­–ç•¥çš„æ–¹æ³•ï¼Œæ¥å¤„ç†è¿ç»­åŠ¨ä½œç©ºé—´æƒ…å†µï¼æœ¬ç« å°†é’ˆå¯¹è¿ç»­åŠ¨ä½œç©ºé—´ï¼Œæ¨å¯¼å‡ºç¡®å®šæ€§ç­–ç•¥çš„ç­–ç•¥æ¢¯åº¦å®šç†ï¼Œå¹¶æ®æ­¤ç»™å‡ºç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼</p>
<h3 id="71-åŒç­–ç¡®å®šæ€§ç®—æ³•"><a class="header" href="#71-åŒç­–ç¡®å®šæ€§ç®—æ³•">7.1 åŒç­–ç¡®å®šæ€§ç®—æ³•</a></h3>
<p>å¯¹äºè¿ç»­åŠ¨ä½œç©ºé—´é‡Œçš„ç¡®å®šæ€§ç­–ç•¥ï¼Œ $\pi(a|s ; \theta)$ å¹¶ä¸æ˜¯ä¸€ä¸ªé€šå¸¸æ„ä¹‰ä¸Šçš„å‡½æ•°ï¼Œå®ƒå¯¹ç­–ç•¥å‚æ•° $\theta$ çš„æ¢¯åº¦ï¼ $\nabla \pi(a|s ; \theta)$ ä¹Ÿä¸å¤å­˜åœ¨ï¼æ‰€ä»¥ï¼Œç¬¬ 6 ç« ä»‹ç»çš„æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å°±ä¸å†é€‚ç”¨ï¼å¹¸è¿çš„æ˜¯ï¼Œæ›¾æåˆ°ç¡®å®šæ€§ç­–ç•¥å¯ä»¥è¡¨ç¤ºä¸º $\pi(s ; \boldsymbol{\theta})(s \in \mathcal{S})$ ï¼è¿™ç§è¡¨ç¤ºå¯ä»¥ç»•è¿‡ç”±äº $\pi(a|s ; \boldsymbol{\theta})$ å¹¶ä¸æ˜¯é€šå¸¸æ„ä¹‰ä¸Šçš„å‡½æ•°è€Œå¸¦æ¥çš„å›°éš¾ï¼</p>
<p>æœ¬èŠ‚ä»‹ç»åœ¨è¿ç»­ç©ºé—´ä¸­çš„ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦å®šç†ï¼Œå¹¶æ®æ­¤ç»™å‡ºåŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼</p>
<h4 id="711-ç­–ç•¥æ¢¯åº¦å®šç†çš„ç¡®å®šæ€§ç‰ˆæœ¬"><a class="header" href="#711-ç­–ç•¥æ¢¯åº¦å®šç†çš„ç¡®å®šæ€§ç‰ˆæœ¬">7.1.1 ç­–ç•¥æ¢¯åº¦å®šç†çš„ç¡®å®šæ€§ç‰ˆæœ¬</a></h4>
<p>å½“ç­–ç•¥æ˜¯ä¸€ä¸ªè¿ç»­åŠ¨ä½œç©ºé—´ä¸Šçš„ç¡®å®šæ€§çš„ç­–ç•¥ $\pi(s ; \boldsymbol{\theta})(s \in \mathcal{S})$ æ—¶ï¼Œç­–ç•¥æ¢¯åº¦å®šç†ä¸º
$$
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\sum_{t=0}^{+\infty} \gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{\alpha} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}\right]
$$
ï¼ˆè¯æ˜ï¼šçŠ¶æ€ä»·å€¼å’ŒåŠ¨ä½œä»·å€¼æ»¡è¶³ä»¥ä¸‹å…³ç³»
$$
\begin{aligned}
v_{\pi(0)}(s) &amp;=q_{\pi(\theta)}(s, \pi(s ; \boldsymbol{\theta})), &amp;  s \in \mathcal{S} \
q_{\pi(\theta)}(s, \pi(s ; \boldsymbol{\theta})) &amp;=r(s, \pi(s ; \boldsymbol{\theta}))+\gamma \sum_{s^{\prime}} p\left(s^{\prime}|s, \pi(s ; \boldsymbol{\theta})\right) v_{\pi(\theta)}\left(s^{\prime}\right), &amp; s \in \mathcal{S}
\end{aligned}
$$
ä»¥ä¸Šä¸¤å¼å¯¹ $\theta$ æ±‚æ¢¯åº¦ï¼Œæœ‰
$$
\begin{array}{l}
\nabla v_{\pi(\theta)}(s)=\nabla q_{\pi(\theta)}(s, \pi(s ; \theta)), \quad s \in \mathcal{S} \
\nabla q_{\pi(\theta)}(s, \pi(s ; \theta))=\left[\nabla_{a} r(s, a)\right]<em>{a=\pi(s ; \theta)} \nabla \pi(s ; \theta)+ \
\quad\gamma \sum</em>{s^{\prime}}\left{\left[\nabla_{a} p\left(s^{\prime}|s, a\right)\right]<em>{a=\pi(s ; \theta)}[\nabla \pi(s ; \theta)] v</em>{\pi(\theta)}\left(s^{\prime}\right)+p\left(s^{\prime}|s, \pi(s ; \theta)\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right)\right} \
\quad=\nabla \pi(s ; \theta)\left[\nabla_{a} r(s, a)+\gamma \sum_{s^{\prime}} \nabla_{a} p\left(s^{\prime}|s, a\right) v_{\pi(\theta)}\left(s^{\prime}\right)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} p\left(s^{\prime}|s, \pi(s ; \theta)\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
\quad=\nabla \pi(s ; \theta)\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} p\left(s^{\prime}|s, \pi(s ; \theta)\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right), \quad s \in \mathcal{S}
\end{array}
$$
å°† $\nabla q_{\pi(\theta)}(s, \pi(s ; \theta))$ çš„è¡¨è¾¾å¼ä»£äºº $\nabla v_{\pi(\theta)}(s)$ çš„è¡¨è¾¾å¼ä¸­ï¼Œæœ‰
$$
\nabla v_{\pi(\theta)}(s)=\nabla \pi(s ; \theta)\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} p\left(s^{\prime}|s, \pi(s ; \theta)\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right), \quad s \in \mathcal{S}
$$
å¯¹ä¸Šå¼æ±‚å…³äº $S_{t}$ çš„æœŸæœ›ï¼Œå¹¶è€ƒè™‘åˆ° $p\left(s^{\prime}|s, \pi(s ; \theta)\right)=\operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \pi(\theta)\right]$ (å…¶ä¸­ $t$ ä»»å–)ï¼Œæœ‰
$$
\begin{array}{l}
E\left[\nabla v_{\pi(\theta)}\left(S_{t}\right)\right] \
=\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \nabla v_{\pi(\theta)}\left(S_{t}\right) \
=\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right]\left[\nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} p\left(s^{\prime}|s, \pi(s ; \theta)\right) \nabla v_{\pi(\theta)}\left(s^{\prime}\right)\right] \
=\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right]\left[\nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \pi(\boldsymbol{\theta})\right] \nabla v_{\pi(\theta)}\left(s^{\prime}\right)\right] \
=\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \sum_{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime}|S_{t}=s ; \pi(\boldsymbol{\theta})\right] \nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
=\sum_{s} \operatorname{\mathbb{P}}\left[S_{t}=s\right] \nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)}+\gamma \sum</em>{s^{\prime}} \operatorname{\mathbb{P}}\left[S_{t+1}=s^{\prime} ; \pi(\boldsymbol{\theta})\right] \nabla v_{\pi(\theta)}\left(s^{\prime}\right) \
=\mathrm{E}\left[\nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(S, a)\right]<em>{a=\pi(s ; \theta)}\right]+\gamma \mathrm{E}\left[\nabla v</em>{\pi(\theta)}\left(S_{t+1}\right)\right],
\end{array}
$$
è¿™æ ·å°±å¾—åˆ°äº†ä» $\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{t}\right)\right]$ åˆ° $\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{t+1}\right)\right]$ çš„é€’æ¨å¼ï¼æ³¨æ„ï¼Œæœ€ç»ˆå…³æ³¨çš„æ¢¯åº¦å€¼å°±æ˜¯
$$
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{0}\right)\right]
$$
æ‰€ä»¥æœ‰
$$
\begin{array}{l}
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}\left[\nabla v_{\pi(\mathbf{\theta})}\left(S_{0}\right)\right] \
=\mathrm{E}\left[\nabla \pi\left(S_{0} ; \boldsymbol{\theta}\right)\left[\nabla_{\alpha} q_{\pi(\theta)}\left(S_{0}, a\right)\right]<em>{a=\pi\left(S</em>{0} ; \theta\right)}\right]+\gamma \mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{1}\right)\right] \
=\mathrm{E}\left[\nabla \pi\left(S_{0} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q_{\pi(\theta)}\left(S_{0}, a\right)\right]<em>{a=\pi\left(S</em>{0} ; \theta\right)}\right]+\gamma \mathrm{E}\left[\nabla \pi\left(S_{1} ; \boldsymbol{\theta}\right)\left[\nabla_{0} q_{\pi(\theta)}\left(S_{1}, a\right)\right]<em>{a=\pi\left(S</em>{1} ; \theta\right)}\right]+\gamma^{2} \mathrm{E}\left[\nabla v_{\pi(\theta)}\left(S_{2}\right)\right] \
=\cdots \
=\sum_{t=0}^{+\infty} \mathrm{E}\left[\gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}\right]
\end{array}
$$
å°±å¾—åˆ°å’Œä¹‹å‰æ¢¯åº¦ç­–ç•¥å®šç†ç±»ä¼¼çš„å½¢å¼ $_{0}$ )ï¼</p>
<p>å¯¹äºè¿ç»­åŠ¨ä½œç©ºé—´ä¸­çš„ç¡®å®šæ€§ç­–ç•¥ï¼Œæ›´å¸¸ä½¿ç”¨çš„æ˜¯å¦å¤–ä¸€ç§å½¢å¼ï¼š
$$
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\mathrm{E}<em>{S \sim \rho</em>{\pi(0)}}\left[\nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{\alpha} q_{\pi(\theta)}(S, a)\right]<em>{a=\pi(S ; \theta)}\right]
$$
å…¶ä¸­çš„æœŸæœ›æ˜¯é’ˆå¯¹æŠ˜æ‰£çš„çŠ¶æ€åˆ†å¸ƒ (discounted state distribution)
$$
\rho</em>{\pi}(s)=\int_{s_{0} \in S} p_{s_{0}}\left(s_{0}\right) \sum_{t=0}^{+\infty} \gamma^{t} \operatorname{\mathbb{P}}\left[S_{t}=s|S_{0}=s_{0} ; \boldsymbol{\theta}\right] \mathrm{d} s_{0}
$$
è€Œè¨€çš„ã€‚ï¼ˆè¯æ˜ï¼š
$$
\begin{array}{l}
\nabla \mathrm{E}<em>{\pi(\theta)}\left[G</em>{0}\right]=\sum_{t=0}^{+\infty} \mathrm{E}\left[\gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}\right] \
=\sum_{t=0}^{+\infty} \int_{s} p_{S_{t}}(s) \gamma^{t} \nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)} \mathrm{d} s \
=\sum_{t=0}^{+\infty} \int_{s}\left(\int_{s_{0}} p_{s_{0}}\left(s_{0}\right) \operatorname{\mathbb{P}}\left[S_{t}=s|S_{0}=s_{0} ; \boldsymbol{\theta}\right] \mathrm{d} s_{0}\right) \gamma^{t} \nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)} \mathrm{d} s \
=\int</em>{s}\left(\int_{s_{0}} p_{s_{0}}\left(s_{0}\right) \sum_{t=0}^{+\infty} \gamma^{t} \operatorname{\mathbb{P}}\left[S_{t}=s|S_{0}=s_{0} ; \boldsymbol{\theta}\right] \mathrm{d} s_{0}\right) \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)} \mathrm{d} s \
=\int</em>{s} \rho_{\pi(\theta)}(s) \nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]<em>{a=\pi(s ; \theta)} \mathrm{d} s \
=\mathrm{E}</em>{\rho_{\pi(\theta)}}\left[\nabla \pi(s ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(s, a)\right]_{a=\pi(s ; \theta)}\right]
\end{array}
$$
å¾—è¯ï¼ï¼‰</p>
<h4 id="712-åŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#712-åŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">7.1.2 åŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h4>
<p>æ ¹æ®ç­–ç•¥æ¢¯åº¦å®šç†çš„ç¡®å®šæ€§ç‰ˆæœ¬ï¼Œå¯¹äºè¿ç»­åŠ¨ä½œç©ºé—´ä¸­çš„ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼Œæ¢¯åº¦çš„æ–¹å‘å˜ä¸º
$$
\mathrm{E}\left[\sum_{t=0}^{+\infty} \gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}\right]
$$
ç¡®å®šæ€§çš„åŒç­–æ‰§è¡Œè€… $/$ è¯„è®ºè€…ç®—æ³•è¿˜æ˜¯ç”¨ $q(s, a ; \mathbf{w})$ æ¥è¿‘ä¼¼ $q_{\pi(\theta)}(s, a)$ ï¼è¿™æ—¶ï¼Œ $\gamma^{t} \nabla \pi\left(S_{t} ; \theta\right)$ $\left[\nabla_{a} q_{\pi(\theta)}\left(S_{t}, a\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}$ è¿‘ä¼¼ä¸º
$$
\gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q\left(S_{t}, a ; \mathbf{w}\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}=\nabla_{\theta}\left[\gamma^{t} q\left(S_{t}, \pi\left(S_{t} ; \theta\right) ; \mathbf{w}\right)\right]
$$
æ‰€ä»¥ï¼Œä¸éšæœºç‰ˆæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ç›¸æ¯”ï¼Œç¡®å®šæ€§åŒç­–æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•åœ¨æ›´æ–°ç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ æ—¶è¯•å›¾å‡å° $-\gamma^{t} q\left(S_{t}, \pi\left(S_{t} ; \boldsymbol{\theta}\right) ; \mathbf{w}\right)$ ï¼è¿­ä»£å¼å¯ä»¥æ˜¯
$$
\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\gamma^{t} \nabla \pi\left(S_{t} ; \boldsymbol{\theta}\right)\left[\nabla_{a} q\left(S_{t}, a ; \mathbf{w}\right)\right]<em>{a=\pi\left(S</em>{t} ; \theta\right)}
$$
ç®—æ³• 7-1 ç»™å‡ºäº†åŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•ï¼å¯¹äºåŒç­–çš„ç®—æ³•ï¼Œå¿…é¡»è¿›è¡Œæ¢ç´¢ï¼è¿ç»­æ€§åŠ¨ä½œç©ºé—´çš„ç¡®å®šæ€§ç®—æ³•å°†æ¯ä¸ªçŠ¶æ€éƒ½æ˜ å°„åˆ°ä¸€ä¸ªç¡®å®šçš„åŠ¨ä½œä¸Šï¼Œéœ€è¦åœ¨åŠ¨ä½œç©ºé—´æ·»åŠ æ‰°åŠ¨å®ç°æ¢ç´¢ï¼å…·ä½“è€Œè¨€ï¼Œåœ¨çŠ¶æ€ $S_{t}$ ä¸‹ç¡®å®šæ€§ç­–ç•¥ $\pi(\boldsymbol{\theta})$ æŒ‡å®šçš„åŠ¨ä½œä¸º $\pi\left(S_{t} ; \theta\right)$ ï¼Œåˆ™åœ¨åŒç­–ç®—æ³•ä¸­ä½¿ç”¨çš„åŠ¨ä½œå¯ä»¥å…·æœ‰ $\pi\left(S_{t} ; \boldsymbol{\theta}\right)+N_{t}$ çš„å½¢å¼ï¼Œå…¶ä¸­ $N_{t}$ æ˜¯æ‰°åŠ¨é‡ï¼åœ¨åŠ¨ä½œç©ºé—´æ— ç•Œçš„æƒ…å†µä¸‹ï¼ˆå³æ²¡æœ‰é™åˆ¶åŠ¨ä½œæœ‰æœ€å¤§å€¼å’Œæœ€å°å€¼)ï¼Œå¸¸å¸¸å‡è®¾æ‰°åŠ¨é‡ $N_{t}$ æ»¡è¶³æ­£æ€åˆ†å¸ƒï¼åœ¨åŠ¨ä½œç©ºé—´æœ‰ç•Œçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç”¨ clip å‡½æ•°è¿›ä¸€æ­¥é™åˆ¶åŠ æ‰°åŠ¨åçš„èŒƒå›´ï¼ˆå¦‚ $\operatorname{clip}\left(\pi\left(S_{t} ; \theta\right)+N_{t}, A_{\text {low }}, A_{\text {tigh }}\right)$ ï¼Œå…¶ä¸­ $A_{\text {low }}$ å’Œ $A_{\text {high }}$ æ˜¯åŠ¨ä½œçš„æœ€å°å–å€¼å’Œæœ€å¤§å–å€¼)ï¼Œæˆ–ç”¨ sigmoid å‡½æ•°å°†å¯¹åŠ æ‰°åŠ¨åçš„åŠ¨ä½œå˜æ¢åˆ°åˆé€‚çš„åŒºé—´é‡Œ $\left(\right.$ å¦‚ $\left.A_{\text {low }}+\left(A_{\text {righ }}-A_{\text {low }}\right) \operatorname{expit}\left(\pi\left(S_{t} ; \theta\right)+N_{t}\right)\right)$ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 7-1</strong>ï¼š$\quad$ åŸºæœ¬çš„åŒç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šå­¦ä¹ ç‡ $\alpha^{(\mathrm{w})}, \alpha^{(0)}$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta \leftarrow}$ ä»»æ„å€¼ï¼Œ$W \leftarrow$ä»»æ„å€¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow 1$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€åŠ¨ä½œå¯¹ï¼‰é€‰æ‹©çŠ¶æ€ $S$ ï¼Œå¯¹ $\pi(S ; \theta)$ åŠ æ‰°åŠ¨è¿›è€Œç¡®å®šåŠ¨ä½œ $A$ (å¦‚ç”¨æ­£æ€åˆ†å¸ƒéšæœºå˜é‡æ‰°åŠ¨)<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ®çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$ å¾—åˆ°é‡‡æ · $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆæ‰§è¡Œï¼‰å¯¹ $\pi\left(S^{\prime} ; \theta\right)$ åŠ æ‰°åŠ¨è¿›è€Œç¡®å®šåŠ¨ä½œ $A^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, A^{\prime} ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $[U-q(S, A ; \mathbf{w})]^{2} ï¼ˆ$ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}[U-q(S, A ; \mathbf{w})] \nabla q(S, A ; \mathbf{w})\right)$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ›´æ–° $\theta$ ä»¥å‡å° $-I q(S, \pi(S ; \theta) ; \mathbf{w}) ï¼ˆ$ å¦‚ $\left.\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} I \nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q(S, a ; \mathbf{w})\right]_{a=\pi(s ; \theta)}\right)$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰$I\leftarrow\gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰ $S \leftarrow S^{\prime}, A \leftarrow A^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<p>åœ¨æœ‰äº›ä»»åŠ¡ä¸­ï¼ŒåŠ¨ä½œçš„æ•ˆæœç»è¿‡ä½é€šæ»¤æ³¢å™¨å¤„ç†ååæ˜ åœ¨ç³»ç»Ÿä¸­ï¼Œè€Œç‹¬ç«‹åŒåˆ†å¸ƒçš„ Gaussian å™ªå£°ä¸èƒ½æœ‰æ•ˆå®ç°æ¢ç´¢ï¼ä¾‹å¦‚ï¼Œåœ¨æŸä¸ªä»»åŠ¡ä¸­ï¼ŒåŠ¨ä½œçš„ç›´æ¥æ•ˆæœæ˜¯æ”¹å˜ä¸€ä¸ªè´¨ç‚¹çš„åŠ é€Ÿåº¦ï¼å¦‚æœåœ¨è¿™ä¸ªä»»åŠ¡ä¸­ç”¨ç‹¬ç«‹åŒåˆ†å¸ƒçš„ Gaussian å™ªå£°å åŠ åœ¨åŠ¨ä½œä¸Šï¼Œé‚£ä¹ˆå¯¹è´¨ç‚¹ä½ç½®çš„æ•´ä½“æ•ˆæœæ˜¯åœ¨æ²¡æœ‰å™ªå£°çš„ä½ç½®é™„è¿‘ç§»åŠ¨ï¼è¿™æ ·çš„æ¢ç´¢å°±æ²¡æœ‰åŠæ³•ä¸ºè´¨ç‚¹çš„ä½ç½®æä¾›æŒç»­çš„åç§»ï¼Œä½¿å¾—è´¨ç‚¹åˆ°æ¯”è¾ƒè¿œçš„ä½ç½®ï¼åœ¨è¿™ç±»ä»»åŠ¡ä¸­ï¼Œå¸¸å¸¸ç”¨ Ornstein Uhlenbeck è¿‡ ç¨‹ä½œä¸ºåŠ¨ä½œå™ªå£°ï¼Ornstein Uhlenbeck è¿‡ç¨‹æ˜¯ç”¨ä¸‹åˆ—éšæœºå¾®åˆ†æ–¹ç¨‹å®šä¹‰çš„ (ä»¥ä¸€ç»´çš„æƒ…å†µä¸ºä¾‹ )
$$
\mathrm{d} N_{t}=\theta\left(\mu-N_{t}\right) \mathrm{d} t+\sigma \mathrm{d} B_{t}
$$
å…¶ä¸­ $\theta, \mu, \sigma$ æ˜¯å‚æ•° $(\theta&gt;0, \sigma&gt;0), B_{t}$ æ˜¯æ ‡å‡† Brownian è¿åŠ¨ï¼å½“åˆå§‹æ‰°åŠ¨æ˜¯åœ¨åŸç‚¹çš„å•ç‚¹åˆ†å¸ƒï¼ˆå³é™å®š $N_{0}=0$ ï¼‰ï¼Œå¹¶ä¸” $\mu=0$ æ—¶ï¼Œä¸Šè¿°æ–¹ç¨‹çš„è§£ä¸º
$$
N_{t}=\sigma \int_{0}^{t} e^{\theta(\tau-t)} \mathrm{d} B_{t}
$$
ï¼ˆè¯æ˜ï¼šå°† $\mathrm{d} N_{t}=\theta\left(\mu-N_{t}\right) \mathrm{d} t+\sigma \mathrm{d} B_{t}$ ä»£å…¥ $\mathrm{d}\left(N_{t} e^{\theta t}\right)=\theta N_{t} e^{\theta t} \mathrm{~d} t+e^{\theta t} \mathrm{~d} N_{t}, \quad$ åŒ–ç®€å¯å¾— $\mathrm{d}\left(N_{t} e^{\theta t}\right)=\mu \theta e^{\theta t} \mathrm{~d} t+\sigma e^{\theta t} \mathrm{~d} B_{t}$ ï¼å°†æ­¤å¼ä» 0 ç§¯åˆ° $t$ ï¼Œå¾— $N_{t} e^{\theta t}-N_{0}=\mu\left(e^{\theta t}-1\right)+\sigma \int_{0}^{t} e^{\theta \tau} \mathrm{d} B_{\tau}$ ï¼å½“ $N_{0}=0$ ä¸” $\mu=0$
æ—¶åŒ–ç®€å¯å¾—ç»“æœï¼‰ï¼</p>
<p>è¿™ä¸ªè§£çš„å‡å€¼ä¸º 0 ï¼Œæ–¹å·®ä¸º $\frac{\sigma^{2}}{2 \theta}\left(1-e^{-2 \theta t}\right)$ ï¼Œåæ–¹å·®ä¸º
$$
\operatorname{Cov}\left(N_{t}, N_{s}\right)=\frac{\sigma^{2}}{2 \theta}\left(e^{-\theta|t-s|}-e^{-\theta(t+s)}\right)
$$
ï¼ˆè¯æ˜ï¼šç”±äºå‡å€¼ä¸º 0 ï¼Œæ‰€ä»¥ $\operatorname{Cov}\left(N_{t}, N_{s}\right)=\mathrm{E}\left[N_{t} N_{s}\right]=\sigma^{2} e^{-\theta(t+s)} \mathrm{E}\left[\int_{0}^{t} e^{\theta \tau} \mathrm{d} B_{t} \int_{0}^{s} e^{\theta \tau} \mathrm{d} B_{t}\right]$ ï¼å¦å¤–ï¼ŒIto Isometry å‘Šè¯‰æˆ‘ä»¬ $\mathrm{E}\left[\int_{0}^{t} e^{\theta \tau} \mathrm{d} B_{\tau} \int_{0}^{s} e^{\theta \tau} \mathrm{d} B_{\tau}\right]=\mathrm{E}\left[\int_{0}^{\min (t, s)} e^{2 \theta \tau} \mathrm{d} \tau\right]$ ï¼Œæ‰€ä»¥ $\operatorname{Cov}\left(N_{t}, N_{s}\right)=\sigma^{2} e^{-\theta(t+s)}$
$\int_{0}^{\min (t, s)} e^{2 \theta \tau} \mathrm{d} \tau$ ï¼Œè¿›ä¸€æ­¥åŒ–ç®€å¯å¾—ç»“æœï¼ï¼‰</p>
<p>å¯¹äº $t \neq s$ æ€»æœ‰ $|t-s|&lt;t+s$ ï¼Œæ‰€ä»¥ $\operatorname{Cov}\left(N_{t}, N_{s}\right)&gt;0$ ï¼æ®æ­¤å¯çŸ¥ï¼Œä½¿ç”¨ Ornstein Uhlenbeck è¿‡ç¨‹è®©ç›¸é‚»æ‰°åŠ¨æ­£ç›¸å…³ï¼Œè¿›è€Œè®©åŠ¨ä½œå‘ç›¸è¿‘çš„æ–¹å‘åç§»ï¼</p>
<h3 id="72-å¼‚ç­–ç¡®å®šæ€§ç®—æ³•"><a class="header" href="#72-å¼‚ç­–ç¡®å®šæ€§ç®—æ³•">7.2 å¼‚ç­–ç¡®å®šæ€§ç®—æ³•</a></h3>
<p>å¯¹äºè¿ç»­çš„åŠ¨ä½œç©ºé—´ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥ï¼Œä½¿å¾—æ¯æ¡è½¨è¿¹çš„å›æŠ¥æœ€å¤§ï¼åŒç­–ç¡®å®šæ€§ç®—æ³•åˆ©ç”¨ç­–ç•¥ $\pi(\boldsymbol{\theta})$ ç”Ÿæˆè½¨è¿¹ï¼Œå¹¶åœ¨è¿™äº›è½¨è¿¹ä¸Šæ±‚å¾—å›æŠ¥çš„å¹³å‡å€¼ï¼Œé€šè¿‡è®©å¹³å‡å›æŠ¥æœ€å¤§ï¼Œä½¿å¾—æ¯æ¡è½¨è¿¹ä¸Šçš„å›æŠ¥å°½å¯èƒ½å¤§ï¼äº‹å®ä¸Šï¼Œå¦‚æœæ¯æ¡è½¨è¿¹çš„å›æŠ¥éƒ½è¦æœ€å¤§ï¼Œé‚£ä¹ˆå¯¹äºä»»æ„ç­–ç•¥ $b$ é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›åœ¨è¿™å¥—è½¨è¿¹ä¸Šçš„å¹³å‡å›æŠ¥æœ€å¤§ï¼æ‰€ä»¥å¼‚ç­–ç¡®å®šæ€§ç­–ç•¥ç®—æ³•å¼•å…¥ç¡®å®šæ€§è¡Œä¸ºç­–ç•¥ $b$ ï¼Œå°†è¿™ä¸ªå¹³å‡æ”¹ä¸ºé’ˆå¯¹ç­–ç•¥ $b$ é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹ï¼Œå¾—åˆ°å¼‚ç­–ç¡®å®šæ€§æ¢¯åº¦ä¸º
$$
\nabla \mathrm{E}<em>{\rho</em>{b}}\left[q_{\pi(\theta)}(S, \pi(S ; \boldsymbol{\theta}))\right]=\mathrm{E}<em>{\rho</em>{b}}\left[\nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q_{\pi(\theta)}(S, a)\right]_{a=\pi(S ; \theta)}\right]
$$
è¿™ä¸ªè¡¨è¾¾å¼ä¸åŒç­–çš„æƒ…å½¢ç›¸æ¯”ï¼ŒæœŸæœ›è¿ç®—é’ˆå¯¹çš„è¡¨è¾¾å¼ç›¸åŒï¼æ‰€ä»¥ï¼Œå¼‚ç­–ç¡®å®šæ€§ç®—æ³•çš„è¿­ä»£å¼ä¸åŒç­–ç¡®å®šæ€§ç®—æ³•çš„è¿­ä»£å¼ç›¸åŒï¼</p>
<p>å¼‚ç­–ç¡®å®šæ€§ç®—æ³•å¯èƒ½æ¯”åŒç­–ç¡®å®šæ€§ç®—æ³•æ€§èƒ½å¥½çš„åŸå› åœ¨äºï¼Œè¡Œä¸ºç­–ç•¥å¯èƒ½ä¼šä¿ƒè¿›æ¢ç´¢ï¼Œç”¨è¡Œä¸ºç­–ç•¥é‡‡æ ·å¾—åˆ°çš„è½¨è¿¹èƒ½å¤Ÿæ›´åŠ å…¨é¢çš„æ¢ç´¢è½¨è¿¹ç©ºé—´ï¼è¿™æ—¶å€™ï¼Œæœ€å¤§åŒ–å¯¹è½¨è¿¹åˆ†å¸ƒçš„å¹³å‡æœŸæœ›æ—¶èƒ½å¤ŸåŒæ—¶è€ƒè™‘åˆ°æ›´å¤šä¸åŒçš„è½¨è¿¹ï¼Œä½¿å¾—åœ¨æ•´ä¸ªè½¨è¿¹ç©ºé—´ä¸Šçš„æ‰€æœ‰è½¨è¿¹çš„å›æŠ¥ä¼šæ›´å¤§ï¼</p>
<h4 id="721-åŸºæœ¬çš„å¼‚ç­–ç¡®å®šæ€§æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•"><a class="header" href="#721-åŸºæœ¬çš„å¼‚ç­–ç¡®å®šæ€§æ‰§è¡Œè€…--è¯„è®ºè€…ç®—æ³•">7.2.1 åŸºæœ¬çš„å¼‚ç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</a></h4>
<p>åŸºäºä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<strong>å¼‚ç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</strong> (Off-Policy Deterministic Actor-Critic, $\mathrm{OPDAC}$ )ï¼Œè§ç®—æ³• 7-2 ï¼</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè™½ç„¶å¼‚ç­–ç®—æ³•å’ŒåŒç­–ç®—æ³•æœ‰ç›¸åŒå½¢å¼çš„è¿­ä»£å¼ï¼Œä½†æ˜¯åœ¨ç®—æ³•ç»“æ„ä¸Šå¹¶ä¸å®Œå…¨ç›¸åŒï¼åœ¨åŒç­–ç®—æ³•è¿­ä»£æ›´æ–°æ—¶ï¼Œç›®æ ‡ç­–ç•¥çš„åŠ¨ä½œå¯ä»¥åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ç›´æ¥å¾—åˆ°ï¼›ä½†æ˜¯åœ¨å¼‚ç­–ç®—æ³•è¿­ä»£æ›´æ–°ç­–ç•¥å‚æ•°æ—¶ï¼Œå¯¹ç¯å¢ƒä½¿ç”¨çš„æ˜¯è¡Œä¸ºç­–ç•¥å†³å®šçš„åŠ¨ä½œï¼Œè€Œä¸æ˜¯ç›®æ ‡ç­–ç•¥å†³å®šçš„åŠ¨ä½œï¼Œæ‰€ä»¥éœ€è¦é¢å¤–è®¡ç®—ç›®æ ‡ç­–ç•¥çš„åŠ¨ä½œï¼åœ¨æ›´æ–°ä»·å€¼å‡½æ•°æ—¶ï¼Œé‡‡ç”¨çš„æ˜¯ $\mathrm{Q}$ å­¦ä¹ ï¼Œä¾ç„¶éœ€è¦è®¡ç®—ç›®æ ‡ç­–ç•¥çš„åŠ¨ä½œï¼</p>
<blockquote>
<p><strong>ç®—æ³• 9-2</strong>ï¼š$\quad$ åŸºæœ¬çš„å¼‚ç­–ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•</p>
</blockquote>
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šå­¦ä¹ ç‡ $\alpha^{(\mathbf{w})}, \alpha^{(0)}$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w} \leftarrow$ ä»»æ„å€¼ï¼</li>
<li>ï¼ˆå¸¦è‡ªç›Šçš„ç­–ç•¥æ›´æ–°ï¼‰å¯¹æ¯ä¸ªå›åˆæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆåˆå§‹åŒ–ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow 1$<br />
2.2 ï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰é€‰æ‹©çŠ¶æ€ $S$<br />
2.3 å¦‚æœå›åˆæœªç»“æŸï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol>
<li>ï¼ˆæ‰§è¡Œï¼‰ç”¨ $b(\cdot|S)$ å¾—åˆ°åŠ¨ä½œ $A$</li>
<li>ï¼ˆé‡‡æ ·ï¼‰æ ¹æ®çŠ¶æ€ $S$ å’ŒåŠ¨ä½œ $A$ å¾—åˆ°é‡‡æ · $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ $U \leftarrow R+\gamma q\left(S^{\prime}, \pi\left(S^{\prime} ; \boldsymbol{\theta}\right) ; \mathbf{w}\right)$</li>
<li>ï¼ˆæ›´æ–°ä»·å€¼ï¼‰æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $[U-q(S, A ; \mathbf{w})]^{2}($ å¦‚ $\left.\mathbf{w} \leftarrow \mathbf{w}+\alpha^{(\mathbf{w})}[U-q(S, A ; \mathbf{w})] \nabla q(S, A ; \mathbf{w})\right)$</li>
<li>ï¼ˆç­–ç•¥æ”¹è¿›ï¼‰æ›´æ–° $\boldsymbol{\theta}$ ä»¥å‡å° $-\operatorname{Iq}(S, \pi(S ; \boldsymbol{\theta}) ; \mathbf{w})$ (å¦‚$\left.\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} I \nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q(S, a ; \mathbf{w})\right]_{a=\pi(s ; \theta)}\right)$</li>
<li>ï¼ˆæ›´æ–°ç´¯ç§¯æŠ˜æ‰£ï¼‰ $I \leftarrow \gamma I$</li>
<li>ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰ $S \leftarrow S_{0}^{\prime}$ï¼</li>
</ol>
</li>
</ol>
<hr />
<h4 id="722-æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#722-æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•">7.2.2 æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h4>
<p><strong>æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•</strong>ï¼ˆDeep Deterministic Policy Gradient, $\mathrm{DDPG}$ï¼‰å°†åŸºæœ¬çš„å¼‚ç­– ç¡®å®šæ€§æ‰§è¡Œè€… / è¯„è®ºè€…ç®—æ³•å’Œæ·±åº¦ Q ç½‘ç»œä¸­å¸¸ç”¨çš„æŠ€æœ¯ç»“åˆï¼å…·ä½“è€Œè¨€ï¼Œç¡®å®šæ€§æ·±åº¦ç­–ç•¥æ¢¯åº¦ç®—æ³•ç”¨åˆ°äº†ä»¥ä¸‹æŠ€æœ¯ï¼</p>
<ul>
<li>ç»éªŒå›æ”¾ï¼šæ‰§è¡Œè€…å¾—åˆ°çš„ç»éªŒ $\left(S, A, R, S^{\prime}\right)$ æ”¶é›†åæ”¾åœ¨ä¸€ä¸ªå­˜å‚¨ç©ºé—´ä¸­ï¼Œç­‰æ›´æ–°å‚æ•°æ—¶æ‰¹é‡å›æ”¾ï¼Œç”¨æ‰¹å¤„ç†æ›´æ–°ï¼</li>
<li>ç›®æ ‡ç½‘ç»œï¼šåœ¨å¸¸è§„ä»·å€¼å‚æ•° $\mathbf{w}$ å’Œç­–ç•¥å‚æ•° $\boldsymbol{\theta}$ å¤–å†ä½¿ç”¨ä¸€å¥—ç”¨äºä¼°è®¡ç›®æ ‡çš„ç›®æ ‡ä»·å€¼å‚æ•° $\mathbf{w}<em>{\text {ç›®æ ‡ }}$ å’Œç›®æ ‡ç­–ç•¥å‚æ•° $\boldsymbol{\theta}</em>{\text {ç›®æ ‡ã€‚ }}$ åœ¨æ›´æ–°ç›®æ ‡ç½‘ç»œæ—¶ï¼Œä¸ºäº†é¿å…å‚æ•°æ›´æ–°è¿‡å¿«ï¼Œè¿˜å¼•å…¥äº†ç›®æ ‡ç½‘ç»œçš„å­¦ä¹ ç‡ $\alpha_{\text {ç›®æ ‡ }} \in(0,1)$</li>
</ul>
<p>ç®—æ³• 7-3 ç»™å‡ºäº†æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 7-3</strong>ï¼š$\quad$ æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³• (å‡è®¾ $\pi(S ; \theta)+N$ æ€»æ˜¯åœ¨åŠ¨ä½œç©ºé—´å†…)</p>
</blockquote>
<hr />
<p>è¾“å…¥ï¼šç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
è¾“å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šå­¦ä¹ ç‡ $\alpha^{(\mathbf{w})}, \alpha^{(\theta)}$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼Œç›®æ ‡ç½‘ç»œå­¦ä¹ ç‡ $\alpha_{\text {ç›®æ ‡}}$</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta \leftarrow}$ ä»»æ„å€¼ï¼Œ $\boldsymbol{\theta}<em>{\text {ç›®æ ‡ }} \leftarrow \boldsymbol{\theta}, \mathbf{w} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w}</em>{\text {ç›®æ ‡ }} \leftarrow \mathbf{w}$</li>
<li>å¾ªç¯æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆç´¯ç§¯ç»éªŒï¼‰ä»èµ·å§‹çŠ¶æ€ $S$ å‡ºå‘ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ»¡è¶³ç»ˆæ­¢æ¡ä»¶ï¼š
<ul>
<li>ç”¨å¯¹ $\pi(S ; \boldsymbol{\theta})$ åŠ æ‰°åŠ¨è¿›è€Œç¡®å®šåŠ¨ä½œ $A$ (å¦‚ç”¨æ­£æ€åˆ†å¸ƒéšæœºå˜é‡æ‰°åŠ¨)</li>
<li>æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹åˆ°æ”¶ç›Š $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>å°†ç»éªŒ $\left(S, A, R, S^{\prime}\right)$ å­˜å‚¨åœ¨ç»éªŒå­˜å‚¨ç©ºé—´ $\mathcal{D}$<br />
2.2 ï¼ˆæ›´æ–°ï¼‰åœ¨æ›´æ–°çš„æ—¶æœºï¼Œæ‰§è¡Œä¸€æ¬¡æˆ–å¤šæ¬¡ä»¥ä¸‹æ›´æ–°æ“ä½œï¼š</li>
<li>ï¼ˆå›æ”¾ï¼‰ä»å­˜å‚¨ç©ºé—´ $\mathcal{D}$ é‡‡æ ·å‡ºä¸€æ‰¹ç»éªŒ $\mathcal{B}$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ä¸ºç»éªŒä¼°è®¡å›æŠ¥ $U \leftarrow R+\gamma q\left(S^{\prime}, \pi\left(S^{\prime} ; \theta_{\text {ç›®æ ‡ }}\right) ; \mathbf{w}_{\text {ç›®æ ‡ }}\right)\left(\left(S, A, R, S^{\prime}\right) \in \mathcal{B}\right)$</li>
<li>ï¼ˆä»·å€¼æ›´æ–°)æ›´æ–° $\mathbf{w}$ ä»¥å‡å° $\frac{1}{|\mathcal{B}|} \sum_{\left(S, A, R, S^{\prime}\right) \in \mathcal{B}}[U-q(S, A ; \mathbf{w})]^{2}$</li>
<li>ï¼ˆç­–ç•¥æ›´æ–°ï¼‰æ›´æ–° $\boldsymbol{\theta}$ ä»¥å‡å° $-\frac{1}{|\mathcal{B}|} \sum_{\left(s, A, R, S^{\prime}\right) \in \mathcal{B}} q(S, \pi(S ; \boldsymbol{\theta}) ; \mathbf{w})$ (å¦‚ $\left.\boldsymbol{\theta} \leftarrow \boldsymbol{\theta}+\alpha^{(\theta)} \frac{1}{|\mathcal{B}|} \sum_{\left(S, A, R, S^{\prime}\right) \in \mathcal{B}} \nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q(S, a ; \mathbf{w})\right]_{a=\pi(S ; \theta)}\right)$</li>
<li>ï¼ˆæ›´æ–°ç›®æ ‡ï¼‰åœ¨æ°å½“çš„æ—¶æœºæ›´æ–°ç›®æ ‡ç½‘ç»œå’Œç›®æ ‡ç­–ç•¥ï¼Œ $\mathbf{w}<em>{\text {ç›®æ ‡ }} \leftarrow\left(1-\alpha</em>{\text {ç›®æ ‡ }}\right) \mathbf{w}<em>{\text {ç›®æ ‡ }}+$ $\alpha</em>{\text {ç›®æ ‡ }} \mathbf{w}, \quad \boldsymbol{\theta}<em>{\text {ç›®æ ‡ }} \leftarrow\left(1-\alpha</em>{\text {ç›®æ ‡ }}\right) \boldsymbol{\theta}<em>{\text {ç›®æ ‡ }}+\alpha</em>{\text {ç›®æ ‡ }} \boldsymbol{\theta}$ï¼</li>
</ul>
</li>
</ol>
<hr />
<h4 id="723-åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•"><a class="header" href="#723-åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•">7.2.3 åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•</a></h4>
<p>S. Fujimoto ç­‰äººåœ¨æ–‡ç«  ã€Š Addressing function approximation error in actor-critic methodsã€‹ ä¸­ç»™å‡ºäº†<strong>åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•</strong>ï¼ˆTwin Delay Deep Deterministic Policy Gradient, TD3 )ï¼Œç»“åˆäº†æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•å’ŒåŒé‡ Q å­¦ä¹ ï¼</p>
<p>å›é¡¾å‰æ–‡ï¼ŒåŒé‡ $\mathrm{Q}$ å­¦ä¹ å¯ä»¥æ¶ˆé™¤æœ€å¤§åå·®ï¼åŸºäºæŸ¥æ‰¾è¡¨çš„åŒé‡ Q å­¦ä¹ ç”¨äº†ä¸¤å¥—åŠ¨ä½œä»·å€¼å‡½æ•° $q^{(0)}(s, a)$ å’Œ $q^{(1)}(s, a)(s \in \mathcal{S}, a \in \mathcal{A})$ ï¼Œå…¶ä¸­ä¸€å¥—åŠ¨ä½œä»·å€¼å‡½æ•°ç”¨æ¥è®¡ç®—æœ€ä¼˜åŠ¨ä½œï¼ˆå¦‚ $\left.A^{\prime}=\arg \max <em>{a} q^{(0)}\left(S^{\prime}, a\right)\right)$ ï¼Œå¦å¤–ä¸€å¥—ä»·å€¼å‡½æ•°ç”¨æ¥ä¼°è®¡å›æŠ¥ï¼ˆå¦‚ $\left.q^{(1)}\left(S^{\prime}, A^{\prime}\right)\right)$ ï¼›åŒé‡ $\mathrm{Q}$ ç½‘ç»œåˆ™è€ƒè™‘åˆ°æœ‰äº†ç›®æ ‡ç½‘ç»œåå·²ç»æœ‰äº†ä¸¤å¥—ä»·å€¼å‡½æ•°çš„å‚æ•° $\mathbf{w}$ å’Œ $\mathbf{w}</em>{\text {ç›®æ ‡ï¼Œ }}$ æ‰€ä»¥ç”¨å…¶ä¸­ä¸€å¥—å‚æ•° $\mathbf{w}$ è®¡ç®—æœ€ä¼˜åŠ¨ä½œï¼ˆå¦‚ $A^{\prime}=\arg \max <em>{a} q\left(S^{\prime}, a ; \mathbf{w}\right)$ ï¼‰ï¼Œå†ç”¨ç›®æ ‡ç½‘ç»œçš„å‚æ•° $\mathbf{w}</em>{\text {ç›®æ ‡ }}$ ä¼°è®¡ç›®æ ‡ ï¼ˆå¦‚ $q\left(S^{\prime}, A^{\prime} ; \mathbf{w}<em>{\text {ç›®æ ‡ }}\right)$ ï¼‰ï¼
ä½†æ˜¯å¯¹äºç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼ŒåŠ¨ä½œå·²ç»ç”±å«å‚ç­–ç•¥ $\pi(\boldsymbol{\theta})$ å†³å®šäº† (å¦‚ $\pi\left(S^{\prime} ; \boldsymbol{\theta}\right)$ )ï¼ŒåŒé‡ç½‘ç»œåˆ™è¦ç”±åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•ç»´æŠ¤ä¸¤ä»½å­¦ä¹ è¿‡ç¨‹çš„ä»·å€¼ç½‘ç»œå‚æ•° $\mathbf{w}^{(i)}$ å’Œç›®æ ‡ç½‘ç»œå‚æ•° $\mathbf{w}</em>{\text {ç›®æ ‡ }}^{(i)}(i=0,1)$ ï¼åœ¨ä¼°è®¡ç›®æ ‡æ—¶ï¼Œé€‰å–ä¸¤ä¸ªç›®æ ‡ç½‘ç»œå¾—åˆ°çš„ç»“æœä¸­è¾ƒå°çš„é‚£ä¸ªï¼Œå³ $\min <em>{i=0,1} q\left(\cdot, ; ; \mathbf{w}</em>{\text {ç›®æ ‡ }}^{(i)}\right)$ï¼</p>
<p>ç®—æ³• 7-4 ç»™å‡ºäº†åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•ï¼</p>
<blockquote>
<p><strong>ç®—æ³• 7-4</strong> ï¼š$\quad$åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦</p>
</blockquote>
<hr />
<p>è¾“å…¥: ç¯å¢ƒï¼ˆæ— æ•°å­¦æè¿°ï¼‰<br />
æ¦†å‡ºï¼šæœ€ä¼˜ç­–ç•¥çš„ä¼°è®¡ $\pi(\boldsymbol{\theta})$<br />
å‚æ•°ï¼šå­¦ä¹ ç‡ $\alpha^{(\mathrm{w})}, \alpha^{(\theta)}$ ï¼ŒæŠ˜æ‰£å› å­ $\gamma$ ï¼Œæ§åˆ¶å›åˆæ•°å’Œå›åˆå†…æ­¥æ•°çš„å‚æ•°ï¼Œç›®æ ‡ç½‘ç»œå­¦ä¹ ç‡ $\alpha_{\text {ç›®æ ‡ }}$ï¼</p>
<ol>
<li>ï¼ˆåˆå§‹åŒ–ï¼‰ $\boldsymbol{\theta} \leftarrow$ ä»»æ„å€¼ï¼Œ $\boldsymbol{\theta}<em>{\text {ç›®æ ‡ }} \leftarrow \boldsymbol{\theta}, \mathbf{w}^{(i)} \leftarrow$ ä»»æ„å€¼ï¼Œ $\mathbf{w}</em>{\text {ç›®æ ‡ }}^{(i)} \leftarrow \mathbf{w}^{(i)}, i \in{0,1}$</li>
<li>å¾ªç¯æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br />
2.1 ï¼ˆç´¯ç§¯ç»éªŒï¼‰ä»èµ·å§‹çŠ¶æ€ $S$ å‡ºå‘ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ»¡è¶³ç»ˆæ­¢æ¡ä»¶ï¼š
<ul>
<li>ç”¨å¯¹ $\pi(S ; \boldsymbol{\theta})$ åŠ æ‰°åŠ¨è¿›è€Œç¡®å®šåŠ¨ä½œ $A$ (å¦‚ç”¨æ­£æ€åˆ†å¸ƒéšæœºå˜é‡æ‰°åŠ¨)</li>
<li>æ‰§è¡ŒåŠ¨ä½œ $A$ ï¼Œè§‚æµ‹åˆ°æ”¶ç›Š $R$ å’Œä¸‹ä¸€çŠ¶æ€ $S^{\prime}$</li>
<li>å°†ç»éªŒ $\left(S, A, R, S^{\prime}\right)$ å­˜å‚¨åœ¨ç»éªŒå­˜å‚¨ç©ºé—´ $\mathcal{D}$<br />
2.2 ï¼ˆæ›´æ–°ï¼‰ä¸€æ¬¡æˆ–å¤šæ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</li>
<li>ï¼ˆå›æ”¾ï¼‰ä»å­˜å‚¨ç©ºé—´ $\mathcal{D}$ é‡‡æ ·å‡ºä¸€æ‰¹ç»éªŒ $\mathcal{B}$</li>
<li>ï¼ˆæ‰°åŠ¨åŠ¨ä½œï¼‰ä¸ºç›®æ ‡åŠ¨ä½œ $\pi\left(S^{\prime} ; \theta_{\text {ç›®æ ‡ }}\right)$ åŠ å—é™çš„æ‰°åŠ¨ï¼Œå¾—åˆ°åŠ¨ä½œ $A^{\prime}\left(\left(S, A, R, S^{\prime}\right) \in \mathcal{B}\right)$</li>
<li>ï¼ˆä¼°è®¡å›æŠ¥ï¼‰ä¸ºç»éªŒä¼°è®¡å›æŠ¥ $U=R+\gamma \min _{i=0,1} q\left(S^{\prime}, A^{\prime} ; w^{(i)}\right)\left(\left(S, A, R, S^{\prime}\right) \in \mathcal{B}\right)$</li>
<li>ï¼ˆä»·å€¼æ›´æ–°ï¼‰æ›´æ–° $\mathbf{w}^{(i)}$ ä»¥å‡å° $\frac{1}{|\mathcal{B}|} \sum_{\left(S, A, R, S^{\prime}\right) \in \mathcal{B}}\left[U-q\left(S, A ; \mathbf{w}^{(i)}\right)\right]^{2}(i=0,1)$</li>
<li>ï¼ˆç­–ç•¥æ›´æ–°ï¼‰åœ¨æ°å½“çš„æ—¶æœºï¼Œæ›´æ–° $\theta$ ä»¥å‡å° $-\frac{1}{|\mathcal{B}|<em>{\left(S, A, R, S^{\prime}\right) \in \mathcal{B}}} q\left(S, \pi(S ; \boldsymbol{\theta}) ; \mathbf{w}^{(0)}\right)($ å¦‚ $\boldsymbol{\theta} \leftarrow \left.\boldsymbol{\theta}+\alpha^{(0)} \frac{1}{|\mathcal{B}|} \sum</em>{\left(S, A, R, S^{\prime}\right) \in \mathcal{B}} \nabla \pi(S ; \boldsymbol{\theta})\left[\nabla_{a} q\left(S, a ; \mathbf{w}^{(0)}\right)\right]_{a=\pi(s ; \theta)}\right)$</li>
<li>ï¼ˆæ›´æ–°ç›®æ ‡ï¼‰åœ¨æ°å½“çš„æ—¶æœºï¼Œæ›´æ–°ç›®æ ‡ç½‘ç»œå’Œç›®æ ‡ç­–ç•¥ï¼Œ $\mathbf{w}<em>{\text {ç›®æ ‡ }}^{(i)} \leftarrow\left(1-\alpha</em>{\text {ç›®æ ‡ }}\right)\mathbf{w}<em>{\text {ç”˜æ ‡ }}^{(i)}+\alpha</em>{\text {ç›®æ ‡ }} \mathbf{W}^{(i)}(i=0,1), \quad \boldsymbol{\theta}<em>{\text {ç›®æ ‡ }} \leftarrow\left(1-\alpha</em>{\text {ç›®æ ‡ }}\right) \boldsymbol{\theta}<em>{\text {ç›®æ ‡ }}+\alpha</em>{\text {ç›®æ ‡ }} \boldsymbol{\theta}$ï¼</li>
</ul>
</li>
</ol>
<hr />
<p>TODO:AlphaZeroç®—æ³•</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drl"><a class="header" href="#drl">DRL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rl-åœ¨é‡‘èä¸­çš„åº”ç”¨"><a class="header" href="#rl-åœ¨é‡‘èä¸­çš„åº”ç”¨">RL åœ¨é‡‘èä¸­çš„åº”ç”¨</a></h1>
<p>å‚è§<a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3449401">Modern Perspectivs on RL in Finance</a>å’Œ<a href="https://link.springer.com/article/10.1007/s10614-021-10119-4">RL in economics and finance 2021</a>ï¼</p>
<p>æœ¬æ¥åº”è¯¥é€šè¿‡åŠ¨æ€è§„åˆ’æ–¹æ³•è§£è¿™äº›é—®é¢˜ï¼ç”¨åŠ¨æ€è§„åˆ’è§£ä¼˜åŒ–é—®é¢˜é€šå¸¸éœ€è¦ä¸‹è¿°ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
<ol>
<li>æ˜ç¡®çŸ¥é“æ¨¡å‹çš„çŠ¶æ€è½¬ç§»æ¦‚ç‡</li>
<li>æœ‰è¶³å¤Ÿçš„ç®—åŠ›æ¥æ±‚è§£DP</li>
<li>Markovæ€§è´¨</li>
</ol>
<p>RLï¼Œç»“åˆäº†DPï¼Œè’™ç‰¹å¡æ´›æ¨¡æ‹Ÿï¼Œå‡½æ•°è¿‘ä¼¼å’Œæœºå™¨å­¦ä¹ ï¼</p>
<p>RLåœ¨é‡‘èä¸­ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªåº”ç”¨æ–¹å‘ï¼š</p>
<ol>
<li>è¡ç”Ÿå“å®šä»·/å¯¹å†²</li>
<li>æŠ•èµ„ç»„åˆ/èµ„äº§é…ç½®</li>
<li>åšå¸‚</li>
</ol>
<h2 id="ä¸€-rl-for-risk-management"><a class="header" href="#ä¸€-rl-for-risk-management">ä¸€ï¼ RL for Risk Management</a></h2>
<p>é€šå¸¸è€Œè¨€ï¼Œå­¦æœ¯ä¸­å¯¹è¡ç”Ÿå“å®šä»·å’Œå¯¹å†²éƒ½æ˜¯åŸºäºéšæœºç¯å¢ƒä¸‹çš„æœ‰æ¨¡å‹å†³ç­–ï¼ˆmodel-driven decision rules in a stochastic environmentï¼‰ï¼Œå¸¸è§„å¯¹å†²ç­–ç•¥éƒ½ä¼šç”¨åˆ°å¸Œè…Šå€¼ Greeksï¼Œä»£è¡¨æ¨¡å‹å¯¹ä¸åŒå‚æ•°é£é™©å®šä»·çš„æ•æ„Ÿç¨‹åº¦ï¼</p>
<p>è¿™ç§æ–¹æ³•åœ¨é«˜ç»´æƒ…å†µæ—¶é€šå¸¸ç¼ºå°‘æœ‰æ•ˆçš„æ•°å€¼æ¨¡æ‹Ÿæ–¹æ³•ï¼</p>
<h3 id="deep-hedging"><a class="header" href="#deep-hedging">Deep Hedging</a></h3>
<p>å‚è€ƒ<a href="https://arxiv.org/abs/1802.03042">Deep Hedging, Buehler et al.</a></p>
<blockquote>
<p><strong>å¸‚åœºæ‘©æ“¦</strong>(market frictions)ï¼šæŒ‡é‡‘èèµ„äº§åœ¨äº¤æ˜“ä¸­å­˜åœ¨çš„éš¾åº¦ï¼Œå¦‚æ‰‹ç»­è´¹(transaction costs)ã€ä¹°å–ä»·å·®(bid/ask spread)ã€æµåŠ¨æ€§çº¦æŸ(liquidity constraints)ç­‰ï¼</p>
</blockquote>
<p>æœ¬æ–‡ä¸­çš„å¯¹å†²çš„å¯¹è±¡æ˜¯å¯¹å†²æ‰<strong>ä¸€äº›è¡ç”Ÿå“çš„æŠ•èµ„ç»„åˆ</strong>ï¼</p>
<p>æŠŠ trading decision å»ºæ¨¡æˆä¸€ä¸ªç½‘ç»œï¼Œç‰¹å¾ä¸ä»…ä»…æœ‰ä»·æ ¼ï¼Œè¿˜æœ‰äº¤æ˜“ä¿¡å·ï¼Œæ–°é—»åˆ†æ(news analytics)ï¼Œè¿‡å»å¯¹å†²å†³ç­–ç­‰ç­‰ï¼</p>
<p>ç®—æ³•æ˜¯å®Œå…¨ model-freeï¼Œä¸ä¾èµ–å¯¹åº”å¸‚åœºçš„åŠ¨åŠ›ï¼æˆ‘ä»¬åªéœ€ç¡®å®šä¸‹æ¥å¸‚åœºçš„çŠ¶æ€ç”Ÿæˆ(scenario generator)ï¼ŒæŸå¤±å‡½æ•°ï¼Œå¸‚åœºæ‘©æ“¦å’Œäº¤æ˜“è¡Œä¸º(trading instruments)ï¼æ‰€ä»¥æ­¤æ–¹æ³• lends itself to a <strong>statistically driven market dynamics</strong>ï¼Œæˆ‘ä»¬ä¸éœ€è¦åƒä¼ ç»Ÿæ–¹æ³•é‚£æ ·è®¡ç®—å•ä¸ªè¡ç”Ÿå“çš„å¸Œè…Šå€¼ï¼Œåº”å°†å»ºæ¨¡çš„ç²¾åŠ›èŠ±åœ¨å®ç°çœŸå®çš„å¸‚åœºåŠ¨åŠ›å’Œæ ·æœ¬å¤–è¡¨ç°ï¼</p>
<h4 id="å»ºæ¨¡å¸¦å¸‚åœºæ‘©æ“¦çš„ç¦»æ•£å¸‚åœº"><a class="header" href="#å»ºæ¨¡å¸¦å¸‚åœºæ‘©æ“¦çš„ç¦»æ•£å¸‚åœº">å»ºæ¨¡ï¼šå¸¦å¸‚åœºæ‘©æ“¦çš„ç¦»æ•£å¸‚åœº</a></h4>
<p>è€ƒè™‘æœ‰é™æ—¶åŸŸçš„ç¦»æ•£é‡‘èå¸‚åœº $T$ å’Œäº¤æ˜“æ—¶åˆ» $0=t_{0}&lt;t_{1}&lt;\ldots&lt;t_{n}=T$. å›ºå®šä¸€ä¸ªæœ‰é™æ¦‚ç‡ç©ºé—´ $\Omega=\left{\omega_{1}, \ldots, \omega_{N}\right}$ å’Œä¸€ä¸ªæ¦‚ç‡æµ‹åº¦ $\mathbb{P}$ s.t. $\mathbb{P}\left[\left{\omega_{i}\right}\right]&gt;0$ å¯¹æ‰€æœ‰çš„ $i$. å®šä¹‰æ‰€æœ‰ $\Omega$ ä¸Šçš„å®å€¼éšæœºå˜é‡ $\mathcal{X}:={X: \Omega \rightarrow$ $\mathbb{R}}$ï¼</p>
<p>è®° $I_{k}\in \mathbb{R}^{r}$ åœ¨ $t_{k}$ available çš„æ–°å¸‚åœºæ•°æ®ï¼Œ including market costs and mid-prices of liquid instruments-typically quoted in auxiliary terms such as implied volatilities-news, balance sheet information, any trading signals, risk limits etc. è¿‡ç¨‹ $I=\left(I_{k}\right)<em>{k=0, \ldots, n}$ ç”ŸæˆåŸŸæµ $\mathbb{F}=\left(\mathcal{F}</em>{k}\right)<em>{k=0, \ldots, n}$, i.e. $\mathcal{F}</em>{k}$ è¡¨ç¤ºåˆ° $t_{k}$ æ—¶åˆ»æ‰€æœ‰å¯ç”¨çš„ä¿¡æ¯. æ³¨æ„åˆ°æ¯ä¸ª $\mathcal{F}<em>{k}$ å¯æµ‹çš„éšæœºå˜é‡å¯ä»¥å†™æˆ $I</em>{0}, \ldots, I_{k}$çš„å‡½æ•°ï¼</p>
<p>å¸‚åœºæœ‰ $d$ ä¸ª<strong>hedging instruments</strong> with mid-prices å–å€¼äº $\mathbb{R}^{d}$ -valued $\mathbb{F}$ -adapted éšæœºè¿‡ç¨‹ <strong>$S=\left(S_{k}\right)_{k=0, \ldots, n}$</strong>. å³å¯ä»¥ç”¨æ¥åšå¯¹å†²çš„èµ„äº§ï¼</p>
<p>è¡ç”Ÿå“çš„æŠ•èµ„ç»„åˆå³<strong>è´Ÿå€º</strong>(liability)æ˜¯ä¸€ä¸ª $\mathcal{F}_{T}$ å¯æµ‹çš„éšæœºå˜é‡ <strong>$Z$</strong>. åˆ°æœŸæ—¥ $T$ æ˜¯æ‰€æœ‰è¡ç”Ÿå“ç§æœ€å¤§çš„é‚£ä¸€ä¸ªï¼æ­¤ä¸ºæƒ³è¦å¯¹å†²æ‰çš„ä¸œè¥¿ï¼</p>
<p>å³ ç”¨$S å¯¹å†² Z$ï¼</p>
<p>æƒ³è¦åœ¨ $T$ å¯¹å†²æ‰ $Z$ , æˆ‘ä»¬è¦ç”¨ $\mathbb{R}^{d}$ -valued $\mathbb{F}$ -adapted stochastic process $\delta=\left(\delta_{k}\right)<em>{k=0, \ldots, n-1}$ with $\delta</em>{k}=\left(\delta_{k}^{1}, \ldots, \delta_{k}^{d}\right)$ æ¥äº¤æ˜“ $S$ï¼$\delta_{k}^{i}$ è¡¨ç¤ºæ™ºèƒ½ä½“åœ¨ $t_{k}$ æ—¶åˆ»å¯¹ç¬¬ $i$ ä¸ªèµ„äº§çš„æŒæœ‰. åŒæ ·å®šä¹‰ $\delta_{-1}=\delta_{n}:=0$ï¼</p>
<p>è®° $\mathcal{H}^{u}$ æ˜¯è¿™æ ·çš„äº¤æ˜“ç­–ç•¥çš„æ— çº¦æŸé›†åˆ. ä½†æ˜¯æ¯ä¸ª $\delta_{k}$ æœ‰å…¶äº¤æ˜“çº¦æŸ. å¯èƒ½æ¥è‡ª liquidity, asset availability or trading restrictions. They are also used to restrict trading in a particular option prior to its availability. In the example above of an option which is listed in $3 \mathrm{M}$, the respective trading constraints would be ${0}$ until the $3 \mathrm{M}$ point. æ‰€ä»¥æˆ‘ä»¬å‡å®š $\delta_{k}$ å— $\mathcal{H}<em>{k}$ çº¦æŸï¼Œç”±ä¸€ä¸ªè¿ç»­ $\mathcal{F}</em>{k}$ å¯æµ‹æ˜ å°„ç»™å‡º $H_{k}: \mathbb{R}^{d(k+1)} \rightarrow \mathbb{R}^{d}$, i.e. $\mathcal{H}<em>{k}:=H</em>{k}\left(\mathbb{R}^{d(k+1)}\right) .$</p>
<p>å¯¹æ— çº¦æŸç­–ç•¥ $\delta^{u} \in \mathcal{H}^{u}$, æˆ‘ä»¬å®šä¹‰å®ƒåœ¨ $\mathcal{H}<em>{k}$ çš„æœ‰çº¦æŸæŠ•å½± $(H \circ \delta^{u})</em>{k}:=H_{k}((H \circ \delta^{u})<em>{0}, \ldots,(H \circ \delta^{u})</em>{k-1}, \delta_{k}^{u}$ï¼è®° $\mathcal{H}:=\left(H \circ \mathcal{H}^{u}\right) \subset \mathcal{H}^{u}$ ä¸ºå—çº¦æŸçš„äº¤æ˜“ç­–ç•¥ç›¸åº”çš„éç©ºé›†ï¼</p>
<p><strong>EXAMPLE 1</strong> Assume that $S$ are a range of options and that $\mathcal{V}<em>{k}^{i}\left(S</em>{k}^{i}\right)$ computes the Black-Scholes Vega of each option using the various market parameters available at time $t_{k}$. The overall Vega traded with $\delta_{k}$ is then $\mathcal{V}<em>{k}\left(\delta</em>{k}-\delta_{k-1}\right):=$ $\left|\sum_{i=1}^{d} \mathcal{V}<em>{k}^{i}\left(S</em>{k}^{i}\right)\left(\delta_{k}^{i}-\delta_{k-1}^{i}\right)\right| .$ A liquidity limit of a maximum 
tradable Vega of $\mathcal{V}<em>{\max }$ could then be implemented by the map:
$$
\begin{aligned}
H</em>{k}\left(\delta_{0}, \ldots, \delta_{k}\right):&amp;= \delta_{k-1}+\left(\delta_{k}-\delta_{k-1}\right) \
&amp; \times \frac{\mathcal{V}<em>{\max }}{\max \left{\mathcal{V}</em>{k}\left(\delta_{k}-\delta_{k-1}\right), \mathcal{V}_{\max }\right}} .
\end{aligned}
$$</p>
<h4 id="å¯¹å†²"><a class="header" href="#å¯¹å†²">å¯¹å†²</a></h4>
<p>äº¤æ˜“æ˜¯è‡ªèèµ„çš„ï¼ä¸å¸¦äº¤æ˜“è´¹ç”¨çš„ $T$ æ—¶åˆ»æœ€ç»ˆè´¢å¯Œä¸º $-Z+p_{0}+(\delta \cdot S)<em>{T}$, å…¶ä¸­
$$
(\delta \cdot S)</em>{T}:=\sum_{k=0}^{n-1} \delta_{k} \cdot\left(S_{k+1}-S_{k}\right) .
$$
å½“è€ƒè™‘äº¤æ˜“è´¹ç”¨æ—¶ï¼Œåœ¨$t_{k}$ æ—¶åˆ»ä¹°å…¥ $n \in \mathbb{R}^{d}$ çš„ $S$ è‚¡ç¥¨aäº§ç”Ÿè´¹ç”¨ $c_{k}(n)$. $\delta$ ç­–ç•¥æ€»çš„äº¤æ˜“è´¹ç”¨ä¸º
$$
C_{T}(\delta):=\sum_{k=0}^{n} c_{k}\left(\delta_{k}-\delta_{k-1}\right)
$$
å›å¿† $\delta_{-1}=\delta_{n}:=0$ï¼æ‰€ä»¥æ™ºèƒ½ä½“æ€»çš„èŠ±è´¹å˜ä¸º
$$
\mathrm{PL}<em>{T}\left(Z, p</em>{0}, \delta\right):=-Z+p_{0}+(\delta \cdot S)<em>{T}-C</em>{T}(\delta)
$$</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
